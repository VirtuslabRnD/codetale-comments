[
  {
    "id" : "8bc48a44-652f-4d7e-afc6-24122b60b045",
    "prId" : 4850,
    "prUrl" : "https://github.com/conda-forge/staged-recipes/pull/4850#pullrequestreview-91871625",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "04c77552-be11-4f78-a484-61a6a27265f7",
        "parentId" : null,
        "authorId" : "a3f1fdb0-47ad-411e-b63d-af6fc71a1fa6",
        "body" : "Hmm...what's the reason for these not being `import` tests?",
        "createdAt" : "2018-01-26T15:28:45Z",
        "updatedAt" : "2018-01-26T15:28:45Z",
        "lastEditedBy" : "a3f1fdb0-47ad-411e-b63d-af6fc71a1fa6",
        "tags" : [
        ]
      }
    ],
    "commit" : "490ea2fd4de040848675ae861118fe01b837d48f",
    "line" : 46,
    "diffHunk" : "@@ -1,1 +44,48 @@    - \"$WEST_PYTHON -c 'import westtools'\"\n    - \"$WEST_PYTHON -c 'import fasthist'\"\n    - \"$WEST_PYTHON -c 'import mclib'\"\n    # Currently blocked by https://github.com/westpa/westpa/issues/70\n    #- \"$WEST_PYTHON -c 'import trajtree'\""
  },
  {
    "id" : "5daf64e7-668b-4ead-a90c-0bbd3d074c32",
    "prId" : 4850,
    "prUrl" : "https://github.com/conda-forge/staged-recipes/pull/4850#pullrequestreview-91875712",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6779b785-e0e8-442e-8814-4f2e42ba09ff",
        "parentId" : null,
        "authorId" : "a3f1fdb0-47ad-411e-b63d-af6fc71a1fa6",
        "body" : "What all is getting copied in this `cp` step?",
        "createdAt" : "2018-01-26T15:29:53Z",
        "updatedAt" : "2018-01-26T15:29:53Z",
        "lastEditedBy" : "a3f1fdb0-47ad-411e-b63d-af6fc71a1fa6",
        "tags" : [
        ]
      },
      {
        "id" : "710da19e-0958-48a9-96f9-b375e7c6da31",
        "parentId" : "6779b785-e0e8-442e-8814-4f2e42ba09ff",
        "authorId" : "085a9c6b-569e-49bd-9434-7f128372cf0c",
        "body" : "Basically westpa builds a bunch of cython modules in-place. Previously it was always run from the source. A user would clone the repo or grab the tarball, run the setup script and then point environment variable to the location and then westpa would adjust the `PYTHONPATH`. So it was never a proper python package that was installed into `site-packages`. With that setup in mind, we needed to but it somewhere so it seemed like copying the directory into `~/miniconda/env/xxx/westpa-yyy` (for example) was the best solution. ",
        "createdAt" : "2018-01-26T15:33:18Z",
        "updatedAt" : "2018-01-26T15:33:18Z",
        "lastEditedBy" : "085a9c6b-569e-49bd-9434-7f128372cf0c",
        "tags" : [
        ]
      },
      {
        "id" : "427969fc-cac8-411e-b437-c8ed04c4ca89",
        "parentId" : "6779b785-e0e8-442e-8814-4f2e42ba09ff",
        "authorId" : "a3f1fdb0-47ad-411e-b63d-af6fc71a1fa6",
        "body" : "What if we move it to the location where we want to live and then build it there? That should allow `conda-build` to do much of its magic detecting paths. Hopefully should save you some maintenance burden. ;)",
        "createdAt" : "2018-01-26T15:36:27Z",
        "updatedAt" : "2018-01-26T15:36:27Z",
        "lastEditedBy" : "a3f1fdb0-47ad-411e-b63d-af6fc71a1fa6",
        "tags" : [
        ]
      },
      {
        "id" : "07e8d604-c992-4dd9-a595-0755153b20cf",
        "parentId" : "6779b785-e0e8-442e-8814-4f2e42ba09ff",
        "authorId" : "085a9c6b-569e-49bd-9434-7f128372cf0c",
        "body" : "In that scheme, how would you do it?",
        "createdAt" : "2018-01-26T15:37:57Z",
        "updatedAt" : "2018-01-26T15:37:58Z",
        "lastEditedBy" : "085a9c6b-569e-49bd-9434-7f128372cf0c",
        "tags" : [
        ]
      },
      {
        "id" : "445ce00b-b24f-45fd-bb5d-9c1df1fc3303",
        "parentId" : "6779b785-e0e8-442e-8814-4f2e42ba09ff",
        "authorId" : "a3f1fdb0-47ad-411e-b63d-af6fc71a1fa6",
        "body" : "I guess copy all of the source to the directory in the `PREFIX` that we want to build in. Build the package. Then remove any content we don't want distributed (e.g. `.o` files).",
        "createdAt" : "2018-01-26T15:40:47Z",
        "updatedAt" : "2018-01-26T15:40:47Z",
        "lastEditedBy" : "a3f1fdb0-47ad-411e-b63d-af6fc71a1fa6",
        "tags" : [
        ]
      }
    ],
    "commit" : "490ea2fd4de040848675ae861118fe01b837d48f",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +14,18 @@build:\n  number: 0\n  script: './setup.sh && cp -r $SRC_DIR $PREFIX'\n  skip: True  # [win or py3k]\n"
  },
  {
    "id" : "a02f5dd2-930c-4ea4-a373-4fe43b17d253",
    "prId" : 4850,
    "prUrl" : "https://github.com/conda-forge/staged-recipes/pull/4850#pullrequestreview-91876608",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "1d65e951-d4da-4321-9f55-d6868d9ed1ce",
        "parentId" : null,
        "authorId" : "a3f1fdb0-47ad-411e-b63d-af6fc71a1fa6",
        "body" : "If we are needing to `source` things, maybe we should use an `activate.sh` script. The `toolchain` is a good example to pull from here.",
        "createdAt" : "2018-01-26T15:30:59Z",
        "updatedAt" : "2018-01-26T15:30:59Z",
        "lastEditedBy" : "a3f1fdb0-47ad-411e-b63d-af6fc71a1fa6",
        "tags" : [
        ]
      },
      {
        "id" : "f5aac7f0-9cb9-480c-8246-ee5e5c7f2c3f",
        "parentId" : "1d65e951-d4da-4321-9f55-d6868d9ed1ce",
        "authorId" : "085a9c6b-569e-49bd-9434-7f128372cf0c",
        "body" : "An `activate.sh` seems like a good fit for what `source` is functionally doing here. My only concern is that using `source` is how all of the documentation suggests doing things historically before we ever attempted to install via something like conda. For consistency (at least in the short term), I'm wondering if we should stick with the current scheme if there isn't any issue other than verbosity on the user end of things.  ",
        "createdAt" : "2018-01-26T15:36:59Z",
        "updatedAt" : "2018-01-26T15:36:59Z",
        "lastEditedBy" : "085a9c6b-569e-49bd-9434-7f128372cf0c",
        "tags" : [
        ]
      },
      {
        "id" : "d5514dbb-6502-489e-a1e3-a6dec7436ec6",
        "parentId" : "1d65e951-d4da-4321-9f55-d6868d9ed1ce",
        "authorId" : "a3f1fdb0-47ad-411e-b63d-af6fc71a1fa6",
        "body" : "I don't have strong opinions here. These are more suggestions that I think would keep the recipe maintainable, follow more common `conda` recipe strategies, and hopefully minimize the work needed by the end user.\r\n\r\nFWIW this can probably be done in a way where running this separate `source` step again is just a no-op.",
        "createdAt" : "2018-01-26T15:43:25Z",
        "updatedAt" : "2018-01-26T15:43:25Z",
        "lastEditedBy" : "a3f1fdb0-47ad-411e-b63d-af6fc71a1fa6",
        "tags" : [
        ]
      }
    ],
    "commit" : "490ea2fd4de040848675ae861118fe01b837d48f",
    "line" : 36,
    "diffHunk" : "@@ -1,1 +34,38 @@  commands:\n    - \"source ${PREFIX}/${PKG_NAME}-${PKG_VERSION}/westpa.sh\"\n    - \"source ${WEST_ROOT}/bin/w_env\"\n    - \"$WEST_PYTHON -c 'import west'\"\n    - \"$WEST_PYTHON -c 'import west.propagators'\""
  }
]