[
  {
    "id" : "4ce3ec62-01ad-4550-b155-940c59fe160b",
    "prId" : 7665,
    "prUrl" : "https://github.com/conda-forge/staged-recipes/pull/7665#pullrequestreview-220684557",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "aa433cd5-f8cc-43eb-a5c6-35ec3d83ebb4",
        "parentId" : null,
        "authorId" : "0f29bd0f-303b-45ad-ad89-d387d332dd9c",
        "body" : "Please, delete the ``build.sh`` and ``bld.bat``. After that please add in your ``build`` section\r\n```\r\n  script:\r\n    - {{ PYTHON }} -m pip install . --no-deps --ignore-installed -vv\r\n    - {{ PYTHON }} -m sos_notebook.install --sys-prefix\r\n```\r\n\r\nOtherwise, this recipe cannot be ``noarch``",
        "createdAt" : "2019-03-29T17:44:33Z",
        "updatedAt" : "2019-04-23T19:03:04Z",
        "lastEditedBy" : "0f29bd0f-303b-45ad-ad89-d387d332dd9c",
        "tags" : [
        ]
      },
      {
        "id" : "01b599db-a1d1-4450-a6c5-aa8fc4bb4ddf",
        "parentId" : "aa433cd5-f8cc-43eb-a5c6-35ec3d83ebb4",
        "authorId" : "bcb2cf02-fd92-412e-87ea-49178f8652d0",
        "body" : "@marcelotrevisani Thanks! I just pushed this change.",
        "createdAt" : "2019-03-29T17:59:23Z",
        "updatedAt" : "2019-04-23T19:03:04Z",
        "lastEditedBy" : "bcb2cf02-fd92-412e-87ea-49178f8652d0",
        "tags" : [
        ]
      }
    ],
    "commit" : "27e99d6a71487fa251ccc7df96b5e943c7695673",
    "line" : 12,
    "diffHunk" : "@@ -1,1 +10,14 @@  sha256: 91fc849a9d8c0b5fb975ec82eb1f2b9be2603ff936b8241a928cc8d738a57e16\n\nbuild:\n  noarch: python\n  number: 0"
  },
  {
    "id" : "23fa7fa1-eb72-4e85-b845-64a9e9d71eec",
    "prId" : 7665,
    "prUrl" : "https://github.com/conda-forge/staged-recipes/pull/7665#pullrequestreview-222470225",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f879ef31-21ee-4958-9aa4-ae628a6eb1fe",
        "parentId" : null,
        "authorId" : "1c00ea84-f4ad-4409-9693-3b7569a5c8a0",
        "body" : "This does not work under mac here. It seems that `|` split the commands into two.\r\n\r\n```\r\n+ jupyter kernelspec list\r\n+ grep -w /Users/bpeng1/anaconda3/conda-bld/sos-notebook_1554269979093/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_plac/share/jupyter/kernels/sos\r\nTests failed for sos-notebook-0.19.1-py_0.tar.bz2 - moving package to /Users/bpeng1/anaconda3/conda-bld/broken\r\nWARNING:conda_build.build:Tests failed for sos-notebook-0.19.1-py_0.tar.bz2 - moving package to /Users/bpeng1/anaconda3/conda-bld/broken\r\nremoving: sos-notebook-0.19.1-py_0.tar.bz2\r\nTESTS FAILED: sos-notebook-0.19.1-py_0.tar.bz2\r\n```",
        "createdAt" : "2019-04-03T05:41:42Z",
        "updatedAt" : "2019-04-23T19:03:04Z",
        "lastEditedBy" : "1c00ea84-f4ad-4409-9693-3b7569a5c8a0",
        "tags" : [
        ]
      },
      {
        "id" : "74a8c09e-94fe-48ef-8630-2e522e478a11",
        "parentId" : "f879ef31-21ee-4958-9aa4-ae628a6eb1fe",
        "authorId" : "1c00ea84-f4ad-4409-9693-3b7569a5c8a0",
        "body" : "@isuruf I would also appreciate your guidance here. Did `|` really separate the command into two? Then the second `grep` command should hang indefinitely.",
        "createdAt" : "2019-04-03T14:46:40Z",
        "updatedAt" : "2019-04-23T19:03:04Z",
        "lastEditedBy" : "1c00ea84-f4ad-4409-9693-3b7569a5c8a0",
        "tags" : [
        ]
      },
      {
        "id" : "1cb7f734-b73b-49ab-bc4b-77e9d018653a",
        "parentId" : "f879ef31-21ee-4958-9aa4-ae628a6eb1fe",
        "authorId" : "fa18c2b0-9128-4c2b-b6e0-433b177f7cf1",
        "body" : "No, it doesn't split the command into two. It's just that when the commands are echoed they are shown like that",
        "createdAt" : "2019-04-03T14:48:07Z",
        "updatedAt" : "2019-04-23T19:03:04Z",
        "lastEditedBy" : "fa18c2b0-9128-4c2b-b6e0-433b177f7cf1",
        "tags" : [
        ]
      },
      {
        "id" : "a7b8709d-e3c5-4005-8518-ec55603996fa",
        "parentId" : "f879ef31-21ee-4958-9aa4-ae628a6eb1fe",
        "authorId" : "1c00ea84-f4ad-4409-9693-3b7569a5c8a0",
        "body" : "Figured out the problem, the build and test steps use different environments with different python.\r\n\r\n@jdblischak Please change\r\n\r\n```\r\n    - jupyter kernelspec list | grep -w $PREFIX/share/jupyter/kernels/sos  # [unix]\r\n    - jupyter kernelspec list | findstr \\share\\jupyter\\kernels\\sos  # [win]\r\n```\r\nto\r\n```\r\n    - jupyter kernelspec list | grep kernels/sos  # [unix]\r\n    - jupyter kernelspec list | findstr kernels\\sos  # [win]\r\n```",
        "createdAt" : "2019-04-03T15:22:48Z",
        "updatedAt" : "2019-04-23T19:03:04Z",
        "lastEditedBy" : "1c00ea84-f4ad-4409-9693-3b7569a5c8a0",
        "tags" : [
        ]
      },
      {
        "id" : "7ff7840e-5d06-462a-9c2b-d30627d1f19d",
        "parentId" : "f879ef31-21ee-4958-9aa4-ae628a6eb1fe",
        "authorId" : "bcb2cf02-fd92-412e-87ea-49178f8652d0",
        "body" : "@BoPeng I don't understand your concern. This test passes on macOS, which you can see at the line below:\r\n\r\nhttps://travis-ci.org/conda-forge/staged-recipes/builds/513186637#L1626",
        "createdAt" : "2019-04-03T16:49:48Z",
        "updatedAt" : "2019-04-23T19:03:04Z",
        "lastEditedBy" : "bcb2cf02-fd92-412e-87ea-49178f8652d0",
        "tags" : [
        ]
      },
      {
        "id" : "4f39571b-1d3d-43f3-a22a-10e97ff2a483",
        "parentId" : "f879ef31-21ee-4958-9aa4-ae628a6eb1fe",
        "authorId" : "1c00ea84-f4ad-4409-9693-3b7569a5c8a0",
        "body" : "It failed locally on my mac. I think the problem was that I have locally installed kernels and multiple jupyter commands so `jupyter kernelspec list` returned my local specs. The test machine does not have this problem.",
        "createdAt" : "2019-04-03T19:09:05Z",
        "updatedAt" : "2019-04-23T19:03:04Z",
        "lastEditedBy" : "1c00ea84-f4ad-4409-9693-3b7569a5c8a0",
        "tags" : [
        ]
      },
      {
        "id" : "50743099-d835-476a-96dc-be337e1cf47c",
        "parentId" : "f879ef31-21ee-4958-9aa4-ae628a6eb1fe",
        "authorId" : "bcb2cf02-fd92-412e-87ea-49178f8652d0",
        "body" : "Hmmm....that still doesn't seem right. Even though you have local kernels installed, the sos kernel should still be installed in the conda environment, and thus the `grep` command should find it. I'm not sure what is going on. Is the command `python -m sos_notebook.install --sys-prefix` affected by the presence of locally installed kernels? (e.g. maybe it won't install if it already exists locally?)",
        "createdAt" : "2019-04-03T21:07:28Z",
        "updatedAt" : "2019-04-23T19:03:04Z",
        "lastEditedBy" : "bcb2cf02-fd92-412e-87ea-49178f8652d0",
        "tags" : [
        ]
      },
      {
        "id" : "120dc0f4-b271-405a-a23a-2d715854e5ee",
        "parentId" : "f879ef31-21ee-4958-9aa4-ae628a6eb1fe",
        "authorId" : "1c00ea84-f4ad-4409-9693-3b7569a5c8a0",
        "body" : "The jupyter command used in the test might be from local environment. The change can be useful because it makes a bit easier to test the recipe locally, even if the wrong jupyter or python was used. Not a big deal though. ",
        "createdAt" : "2019-04-03T21:11:49Z",
        "updatedAt" : "2019-04-23T19:03:04Z",
        "lastEditedBy" : "1c00ea84-f4ad-4409-9693-3b7569a5c8a0",
        "tags" : [
        ]
      },
      {
        "id" : "6cd6521c-571b-48bf-827e-57b88df22b36",
        "parentId" : "f879ef31-21ee-4958-9aa4-ae628a6eb1fe",
        "authorId" : "1c00ea84-f4ad-4409-9693-3b7569a5c8a0",
        "body" : "The jupyter command used in the test might be from local environment. The change can be useful because it makes a bit easier to test the recipe locally, even if the wrong jupyter or python was used. Not a big deal though. ",
        "createdAt" : "2019-04-03T21:11:51Z",
        "updatedAt" : "2019-04-23T19:03:04Z",
        "lastEditedBy" : "1c00ea84-f4ad-4409-9693-3b7569a5c8a0",
        "tags" : [
        ]
      },
      {
        "id" : "2d6b60ad-16ba-40be-8a05-e81113b422dd",
        "parentId" : "f879ef31-21ee-4958-9aa4-ae628a6eb1fe",
        "authorId" : "bcb2cf02-fd92-412e-87ea-49178f8652d0",
        "body" : "> The jupyter command used in the test might be from local environment.\r\n\r\nThat shouldn't happen. In a conda environment, the first `jupyter` found via `PATH` should always be the one installed as part of the conda environment.\r\n\r\n> The change can be useful because it makes a bit easier to test the recipe locally, even if the wrong jupyter or python was used.\r\n\r\nIf the wrong jupyter or python is being used, it is good that the test fails since this indicates something is wrong with the isolation of the conda environment.",
        "createdAt" : "2019-04-03T21:46:17Z",
        "updatedAt" : "2019-04-23T19:03:04Z",
        "lastEditedBy" : "bcb2cf02-fd92-412e-87ea-49178f8652d0",
        "tags" : [
        ]
      }
    ],
    "commit" : "27e99d6a71487fa251ccc7df96b5e943c7695673",
    "line" : 47,
    "diffHunk" : "@@ -1,1 +45,49 @@    - sos_notebook\n  commands:\n    - jupyter kernelspec list | grep -w $PREFIX/share/jupyter/kernels/sos  # [unix]\n    - jupyter kernelspec list | findstr \\share\\jupyter\\kernels\\sos  # [win]\n    - jupyter run --kernel=sos ex.py"
  },
  {
    "id" : "89a9a720-4393-4035-b1c1-e33aa96ae773",
    "prId" : 7665,
    "prUrl" : "https://github.com/conda-forge/staged-recipes/pull/7665#pullrequestreview-222250298",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9aa714cb-d382-4938-9122-17e14eed2fcb",
        "parentId" : null,
        "authorId" : "1c00ea84-f4ad-4409-9693-3b7569a5c8a0",
        "body" : "OK, fiddling this for a long time... because `sos` is not in the default channel, and conda build [does not yet support specifying channels for requirements](https://stackoverflow.com/questions/25610843/conda-build-requirement-add-package-from-specific-channel), I will have to run\r\n\r\n```\r\nconda config --add channels conda-forge \r\n```\r\nbefore running\r\n```\r\nconda build sos-notebook\r\n```\r\n\r\nIt is a shame that conda-forge does not allow dependency from conda-forge.",
        "createdAt" : "2019-04-03T13:57:34Z",
        "updatedAt" : "2019-04-23T19:03:04Z",
        "lastEditedBy" : "1c00ea84-f4ad-4409-9693-3b7569a5c8a0",
        "tags" : [
        ]
      },
      {
        "id" : "23aa68b5-96b5-4db2-bec0-706e3629d42c",
        "parentId" : "9aa714cb-d382-4938-9122-17e14eed2fcb",
        "authorId" : "fa18c2b0-9128-4c2b-b6e0-433b177f7cf1",
        "body" : "> It is a shame that conda-forge does not allow dependency from conda-forge.\r\n\r\nHuh? This is not true",
        "createdAt" : "2019-04-03T13:58:49Z",
        "updatedAt" : "2019-04-23T19:03:04Z",
        "lastEditedBy" : "fa18c2b0-9128-4c2b-b6e0-433b177f7cf1",
        "tags" : [
        ]
      },
      {
        "id" : "0bf45934-cf37-47b4-a59b-2c63259c2e6e",
        "parentId" : "9aa714cb-d382-4938-9122-17e14eed2fcb",
        "authorId" : "1c00ea84-f4ad-4409-9693-3b7569a5c8a0",
        "body" : "As I described, `conda-forge` packages are allowed, but users have to run\r\n\r\n```\r\nconda config --add channels conda-forge\r\n```\r\noutside of `conda build`, rather than allowing things like\r\n\r\n```\r\nchannels:\r\n   - conda-forge\r\n```\r\nor\r\n```\r\nrequirements:\r\n    - conda-forge:\r\n        - sos\r\n```\r\nin the configuration file.\r\n\r\nI apologize for my \"shame\" word but it was frustrating to spend a few hours debugging this simple problem.",
        "createdAt" : "2019-04-03T14:32:15Z",
        "updatedAt" : "2019-04-23T19:03:04Z",
        "lastEditedBy" : "1c00ea84-f4ad-4409-9693-3b7569a5c8a0",
        "tags" : [
        ]
      },
      {
        "id" : "454952f1-4173-44e7-96e9-4e83bde1e858",
        "parentId" : "9aa714cb-d382-4938-9122-17e14eed2fcb",
        "authorId" : "1c00ea84-f4ad-4409-9693-3b7569a5c8a0",
        "body" : "At least the error message could be more informative such as \"package xxx cannot be found in channels xxxx\".",
        "createdAt" : "2019-04-03T14:33:59Z",
        "updatedAt" : "2019-04-23T19:03:04Z",
        "lastEditedBy" : "1c00ea84-f4ad-4409-9693-3b7569a5c8a0",
        "tags" : [
        ]
      }
    ],
    "commit" : "27e99d6a71487fa251ccc7df96b5e943c7695673",
    "line" : 38,
    "diffHunk" : "@@ -1,1 +36,40 @@    - prompt_toolkit\n    - python >=3.6\n    - sos >=0.19.2\n    - tabulate\n"
  },
  {
    "id" : "3268d9f5-c681-4bf1-9bf6-9e33a4a3d589",
    "prId" : 7665,
    "prUrl" : "https://github.com/conda-forge/staged-recipes/pull/7665#pullrequestreview-229734590",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "30a72f28-29cb-4b2a-a5ec-d189dc0dbac9",
        "parentId" : null,
        "authorId" : "d838053f-6fcd-47a0-a593-accf1cf846b0",
        "body" : "If this can't be `noarch` you should add `skip: True  # [py<36]` to the `build` section and specify remove the version constraint from Python:\r\n```suggestion\r\n    - python\r\n```\r\n(same applies in the `run` section)",
        "createdAt" : "2019-04-23T18:47:40Z",
        "updatedAt" : "2019-04-23T19:03:04Z",
        "lastEditedBy" : "d838053f-6fcd-47a0-a593-accf1cf846b0",
        "tags" : [
        ]
      },
      {
        "id" : "2fc5cc7e-0764-420b-924c-b7907430ac2b",
        "parentId" : "30a72f28-29cb-4b2a-a5ec-d189dc0dbac9",
        "authorId" : "d838053f-6fcd-47a0-a593-accf1cf846b0",
        "body" : "Having looked more closely it looks like this could be `noarch: python`?",
        "createdAt" : "2019-04-23T18:52:23Z",
        "updatedAt" : "2019-04-23T19:03:04Z",
        "lastEditedBy" : "d838053f-6fcd-47a0-a593-accf1cf846b0",
        "tags" : [
        ]
      }
    ],
    "commit" : "27e99d6a71487fa251ccc7df96b5e943c7695673",
    "line" : 24,
    "diffHunk" : "@@ -1,1 +22,26 @@    - notebook >=5.0.0\n    - pip\n    - python >=3.6\n    - setuptools\n  run:"
  }
]