[
  {
    "id" : "0da03b26-ad12-44ea-a2d9-bfa0074db69a",
    "prId" : 15308,
    "prUrl" : "https://github.com/conda-forge/staged-recipes/pull/15308#pullrequestreview-684606142",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "1e6592b4-abba-45df-83cb-20823c6e97f5",
        "parentId" : null,
        "authorId" : "f2a8b72f-e001-4606-a1c7-b774f81c945f",
        "body" : "This looks like it's pure python and could be `noarch: python`. If the only reason it's not is because the build fails due to `hkl` not being available on Windows/Mac, we can ignore those failures (noarch only builds on Linux). Being noarch drastically reduces the number of builds and makes it easier for the package to appear on future Python versions.",
        "createdAt" : "2021-06-15T22:35:18Z",
        "updatedAt" : "2021-06-15T22:35:18Z",
        "lastEditedBy" : "f2a8b72f-e001-4606-a1c7-b774f81c945f",
        "tags" : [
        ]
      },
      {
        "id" : "40c51b58-b5e8-43ca-b56f-d80eb32edd41",
        "parentId" : "1e6592b4-abba-45df-83cb-20823c6e97f5",
        "authorId" : "f0113c11-8798-48e0-953b-241c93aa835d",
        "body" : "That would be a mistake as core functionality is provided by that requirement.  Pinning to linux-64 ensures that no user on Mac or Windows or linux-32 will assume it can used.",
        "createdAt" : "2021-06-15T22:39:23Z",
        "updatedAt" : "2021-06-15T22:39:23Z",
        "lastEditedBy" : "f0113c11-8798-48e0-953b-241c93aa835d",
        "tags" : [
        ]
      },
      {
        "id" : "36f16717-ed5e-44d2-8db7-6eaa8994de17",
        "parentId" : "1e6592b4-abba-45df-83cb-20823c6e97f5",
        "authorId" : "f2a8b72f-e001-4606-a1c7-b774f81c945f",
        "body" : "But isn't that already gated by the fact that `hkl` itself doesn't exist on those platforms?",
        "createdAt" : "2021-06-15T22:51:55Z",
        "updatedAt" : "2021-06-15T22:51:55Z",
        "lastEditedBy" : "f2a8b72f-e001-4606-a1c7-b774f81c945f",
        "tags" : [
        ]
      },
      {
        "id" : "0c3f79b1-af63-4702-b9f5-6099679ae83f",
        "parentId" : "1e6592b4-abba-45df-83cb-20823c6e97f5",
        "authorId" : "f0113c11-8798-48e0-953b-241c93aa835d",
        "body" : "This was a decision for https://github.com/bluesky/hklpy/issues/108.  Should we reverse that now?",
        "createdAt" : "2021-06-15T22:56:36Z",
        "updatedAt" : "2021-06-15T22:56:37Z",
        "lastEditedBy" : "f0113c11-8798-48e0-953b-241c93aa835d",
        "tags" : [
        ]
      },
      {
        "id" : "287ea59d-0933-468a-a876-63484d808458",
        "parentId" : "1e6592b4-abba-45df-83cb-20823c6e97f5",
        "authorId" : "f0113c11-8798-48e0-953b-241c93aa835d",
        "body" : "Long-term (maybe a couple years away), the plan is to make the dependency on the *hkl* library optional.",
        "createdAt" : "2021-06-15T22:57:40Z",
        "updatedAt" : "2021-06-15T22:57:41Z",
        "lastEditedBy" : "f0113c11-8798-48e0-953b-241c93aa835d",
        "tags" : [
        ]
      },
      {
        "id" : "ba4700d8-a71b-4075-bce8-328ab9c5ffa8",
        "parentId" : "1e6592b4-abba-45df-83cb-20823c6e97f5",
        "authorId" : "84332f06-62d1-45cd-82fa-6b3228ee8b87",
        "body" : "@dopplershift, thanks for the review and the useful suggestions! I see the reasoning behind your suggestion of using the `noarch` package for hklpy. However, the `hklpy` is a user-facing library, and the approach we took in the https://github.com/nsls-ii-forge feedstocks was to use the architecture-dependent packages for such user-facing libs, so that the dependencies for all intended Python versions are checked on the test step. I had quite a few occurrences when the conversion of noarch -> arch packages was needed due to incompatibility of the dependencies, that was hidden by that single build on Linux for a single Python version. See, e.g. https://github.com/nsls-ii-forge/anyio-feedstock/blob/master/recipe/meta.yaml, that was an attempt to resolve the mess with `dataclasses` and `typing-extensions`.\r\n\r\nOverall, it's a trade-off that we have to decide on: (i) whether to build an arch-dependent package for Python 3.6-3.9 on Linux a few times a year (we don't tag that project too frequently), or (ii) have users complain about incompatible dependencies or the resolution conflicts. I personally choose the former (i).",
        "createdAt" : "2021-06-15T23:32:43Z",
        "updatedAt" : "2021-06-15T23:32:43Z",
        "lastEditedBy" : "84332f06-62d1-45cd-82fa-6b3228ee8b87",
        "tags" : [
        ]
      },
      {
        "id" : "bc05d271-0bd8-4aef-8111-e49552cf7eef",
        "parentId" : "1e6592b4-abba-45df-83cb-20823c6e97f5",
        "authorId" : "f2a8b72f-e001-4606-a1c7-b774f81c945f",
        "body" : "Thanks for the additional context. I'm happy to leave it non-`noarch` then. ",
        "createdAt" : "2021-06-15T23:43:14Z",
        "updatedAt" : "2021-06-15T23:43:14Z",
        "lastEditedBy" : "f2a8b72f-e001-4606-a1c7-b774f81c945f",
        "tags" : [
        ]
      },
      {
        "id" : "6cc146d5-fa3f-4d9c-b07f-147a5f79ee62",
        "parentId" : "1e6592b4-abba-45df-83cb-20823c6e97f5",
        "authorId" : "84332f06-62d1-45cd-82fa-6b3228ee8b87",
        "body" : "Thanks a lot!",
        "createdAt" : "2021-06-15T23:44:11Z",
        "updatedAt" : "2021-06-15T23:44:11Z",
        "lastEditedBy" : "84332f06-62d1-45cd-82fa-6b3228ee8b87",
        "tags" : [
        ]
      }
    ],
    "commit" : "74da6e9f1939691c7b74964b3aee0dc0ab030fcb",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +14,18 @@  number: 0\n  script: {{ PYTHON }} -m pip install . --no-deps -vv\n  skip: true  # [py<36 or win or osx]\n\nrequirements:"
  },
  {
    "id" : "aabad1d5-3b5c-468c-9bc1-0ea254a92984",
    "prId" : 15308,
    "prUrl" : "https://github.com/conda-forge/staged-recipes/pull/15308#pullrequestreview-684606142",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c04fbbaf-3c95-4fe4-a7c6-313c525a678c",
        "parentId" : null,
        "authorId" : "43fc678a-cc3a-4707-8540-4c6397651b46",
        "body" : "This looks like it's pure python and could be `noarch: python`. If the only reason it's not is because the build fails due to `hkl` not being available on Windows/Mac, we can ignore those failures (noarch only builds on Linux). Being noarch drastically reduces the number of builds and makes it easier for the package to appear on future Python versions.",
        "createdAt" : "2021-06-15T22:35:18Z",
        "updatedAt" : "2021-06-15T22:35:18Z",
        "lastEditedBy" : "43fc678a-cc3a-4707-8540-4c6397651b46",
        "tags" : [
        ]
      },
      {
        "id" : "f968736d-63f7-44bd-b140-3db32682114c",
        "parentId" : "c04fbbaf-3c95-4fe4-a7c6-313c525a678c",
        "authorId" : "e76bc266-99fe-4092-b04c-9641add33466",
        "body" : "That would be a mistake as core functionality is provided by that requirement.  Pinning to linux-64 ensures that no user on Mac or Windows or linux-32 will assume it can used.",
        "createdAt" : "2021-06-15T22:39:23Z",
        "updatedAt" : "2021-06-15T22:39:23Z",
        "lastEditedBy" : "e76bc266-99fe-4092-b04c-9641add33466",
        "tags" : [
        ]
      },
      {
        "id" : "c09afc0c-e10b-4952-ae44-259c412ab11b",
        "parentId" : "c04fbbaf-3c95-4fe4-a7c6-313c525a678c",
        "authorId" : "43fc678a-cc3a-4707-8540-4c6397651b46",
        "body" : "But isn't that already gated by the fact that `hkl` itself doesn't exist on those platforms?",
        "createdAt" : "2021-06-15T22:51:55Z",
        "updatedAt" : "2021-06-15T22:51:55Z",
        "lastEditedBy" : "43fc678a-cc3a-4707-8540-4c6397651b46",
        "tags" : [
        ]
      },
      {
        "id" : "cbecb712-a619-45ef-80e7-964afc057dcb",
        "parentId" : "c04fbbaf-3c95-4fe4-a7c6-313c525a678c",
        "authorId" : "e76bc266-99fe-4092-b04c-9641add33466",
        "body" : "This was a decision for https://github.com/bluesky/hklpy/issues/108.  Should we reverse that now?",
        "createdAt" : "2021-06-15T22:56:36Z",
        "updatedAt" : "2021-06-15T22:56:37Z",
        "lastEditedBy" : "e76bc266-99fe-4092-b04c-9641add33466",
        "tags" : [
        ]
      },
      {
        "id" : "7e217a0d-a0a4-41ec-93e0-0df0dca15ca7",
        "parentId" : "c04fbbaf-3c95-4fe4-a7c6-313c525a678c",
        "authorId" : "e76bc266-99fe-4092-b04c-9641add33466",
        "body" : "Long-term (maybe a couple years away), the plan is to make the dependency on the *hkl* library optional.",
        "createdAt" : "2021-06-15T22:57:40Z",
        "updatedAt" : "2021-06-15T22:57:41Z",
        "lastEditedBy" : "e76bc266-99fe-4092-b04c-9641add33466",
        "tags" : [
        ]
      },
      {
        "id" : "764b4fd6-4123-43aa-8cf6-db9013e173fc",
        "parentId" : "c04fbbaf-3c95-4fe4-a7c6-313c525a678c",
        "authorId" : "24afdbcf-7167-43ca-8ff8-36d918c8ee6f",
        "body" : "@dopplershift, thanks for the review and the useful suggestions! I see the reasoning behind your suggestion of using the `noarch` package for hklpy. However, the `hklpy` is a user-facing library, and the approach we took in the https://github.com/nsls-ii-forge feedstocks was to use the architecture-dependent packages for such user-facing libs, so that the dependencies for all intended Python versions are checked on the test step. I had quite a few occurrences when the conversion of noarch -> arch packages was needed due to incompatibility of the dependencies, that was hidden by that single build on Linux for a single Python version. See, e.g. https://github.com/nsls-ii-forge/anyio-feedstock/blob/master/recipe/meta.yaml, that was an attempt to resolve the mess with `dataclasses` and `typing-extensions`.\r\n\r\nOverall, it's a trade-off that we have to decide on: (i) whether to build an arch-dependent package for Python 3.6-3.9 on Linux a few times a year (we don't tag that project too frequently), or (ii) have users complain about incompatible dependencies or the resolution conflicts. I personally choose the former (i).",
        "createdAt" : "2021-06-15T23:32:43Z",
        "updatedAt" : "2021-06-15T23:32:43Z",
        "lastEditedBy" : "24afdbcf-7167-43ca-8ff8-36d918c8ee6f",
        "tags" : [
        ]
      },
      {
        "id" : "1e84009f-144e-461f-b4ba-2e93c040e981",
        "parentId" : "c04fbbaf-3c95-4fe4-a7c6-313c525a678c",
        "authorId" : "43fc678a-cc3a-4707-8540-4c6397651b46",
        "body" : "Thanks for the additional context. I'm happy to leave it non-`noarch` then. ",
        "createdAt" : "2021-06-15T23:43:14Z",
        "updatedAt" : "2021-06-15T23:43:14Z",
        "lastEditedBy" : "43fc678a-cc3a-4707-8540-4c6397651b46",
        "tags" : [
        ]
      },
      {
        "id" : "91caedfa-7c6d-4e52-894e-8b24383d2dae",
        "parentId" : "c04fbbaf-3c95-4fe4-a7c6-313c525a678c",
        "authorId" : "24afdbcf-7167-43ca-8ff8-36d918c8ee6f",
        "body" : "Thanks a lot!",
        "createdAt" : "2021-06-15T23:44:11Z",
        "updatedAt" : "2021-06-15T23:44:11Z",
        "lastEditedBy" : "24afdbcf-7167-43ca-8ff8-36d918c8ee6f",
        "tags" : [
        ]
      }
    ],
    "commit" : "74da6e9f1939691c7b74964b3aee0dc0ab030fcb",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +14,18 @@  number: 0\n  script: {{ PYTHON }} -m pip install . --no-deps -vv\n  skip: true  # [py<36 or win or osx]\n\nrequirements:"
  }
]