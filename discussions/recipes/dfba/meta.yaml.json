[
  {
    "id" : "0881fc0e-d740-4561-8b1c-57adf1202510",
    "prId" : 14028,
    "prUrl" : "https://github.com/conda-forge/staged-recipes/pull/14028#pullrequestreview-628111930",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "00829213-bc99-4de1-a80e-21c49c192e1d",
        "parentId" : null,
        "authorId" : "f2a8b72f-e001-4606-a1c7-b774f81c945f",
        "body" : "I don't think this needs a c++ compiler at *runtime*?",
        "createdAt" : "2021-03-31T00:55:13Z",
        "updatedAt" : "2021-04-05T19:14:27Z",
        "lastEditedBy" : "f2a8b72f-e001-4606-a1c7-b774f81c945f",
        "tags" : [
        ]
      },
      {
        "id" : "94b83c1e-3a22-4310-9d97-fea895d7eb6c",
        "parentId" : "00829213-bc99-4de1-a80e-21c49c192e1d",
        "authorId" : "3935392a-b926-4c3e-ae7b-328939dd9a33",
        "body" : "Hi @dopplershift the software uses a c++ compiler to compile a shared library at runtime (that is then loaded by the main program). I discussed with @Midnighter today whether it would be important to get a runtime test implemented to ensure this works cross-platform with conda-forge (as we have done [here](https://gitlab.com/davidtourigny/dynamic-fba)).   ",
        "createdAt" : "2021-03-31T01:03:51Z",
        "updatedAt" : "2021-04-05T19:14:27Z",
        "lastEditedBy" : "3935392a-b926-4c3e-ae7b-328939dd9a33",
        "tags" : [
        ]
      },
      {
        "id" : "62e70879-3195-4f64-b501-96d21b23e4b4",
        "parentId" : "00829213-bc99-4de1-a80e-21c49c192e1d",
        "authorId" : "f2a8b72f-e001-4606-a1c7-b774f81c945f",
        "body" : "AH, had no idea. Yeah, it would be really good to have a test that makes sure that this compilation part functions correctly.",
        "createdAt" : "2021-03-31T01:32:32Z",
        "updatedAt" : "2021-04-05T19:14:27Z",
        "lastEditedBy" : "f2a8b72f-e001-4606-a1c7-b774f81c945f",
        "tags" : [
        ]
      },
      {
        "id" : "64bec39b-b920-4caf-beb1-f29f5a24fa92",
        "parentId" : "00829213-bc99-4de1-a80e-21c49c192e1d",
        "authorId" : "98788fb9-1559-400c-b3ad-57891d5e6aec",
        "body" : "Hi @dopplershift, maybe you know how to do this best. I've included a `run_test.py` file in the recipe's directory which gets executed automatically so that's working great. However, I have a problem with getting the model file (`iJR904.xml.gz`) to be mounted in the directory where the tests are run. I have tried to do this by listing it in the `source_files` but that leads to the following error. What's the best way to achieve this?\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/conda/staged-recipes-copy/.ci_support/build_all.py\", line 175, in <module>\r\n    build_all(os.path.join(root_dir, \"recipes\"), args.arch)\r\n  File \"/home/conda/staged-recipes-copy/.ci_support/build_all.py\", line 100, in build_all\r\n    build_folders(recipes_dir, folders, arch, channel_urls)\r\n  File \"/home/conda/staged-recipes-copy/.ci_support/build_all.py\", line 156, in build_folders\r\n    conda_build.api.build([recipe], config=get_config(arch, channel_urls))\r\n  File \"/opt/conda/lib/python3.8/site-packages/conda_build/api.py\", line 186, in build\r\n    return build_tree(\r\n  File \"/opt/conda/lib/python3.8/site-packages/conda_build/build.py\", line 3068, in build_tree\r\n    packages_from_this = build(metadata, stats,\r\n  File \"/opt/conda/lib/python3.8/site-packages/conda_build/build.py\", line 2351, in build\r\n    newly_built_packages = bundlers[pkg_type](output_d, m, env, stats)\r\n  File \"/opt/conda/lib/python3.8/site-packages/conda_build/build.py\", line 1657, in bundle_conda\r\n    output['checksums'] = create_info_files(metadata, replacements, files, prefix=metadata.config.host_prefix)\r\n  File \"/opt/conda/lib/python3.8/site-packages/conda_build/build.py\", line 1266, in create_info_files\r\n    copy_test_source_files(m, join(m.config.info_dir, 'test'))\r\n  File \"/opt/conda/lib/python3.8/site-packages/conda_build/build.py\", line 830, in copy_test_source_files\r\n    raise RuntimeError(msg.format(pattern))\r\nRuntimeError: Did not find any source_files for test with pattern iJR904.xml.gz\r\n```",
        "createdAt" : "2021-04-03T21:22:32Z",
        "updatedAt" : "2021-04-05T19:14:27Z",
        "lastEditedBy" : "98788fb9-1559-400c-b3ad-57891d5e6aec",
        "tags" : [
        ]
      },
      {
        "id" : "d2803b26-a55d-4620-aa00-2ecf17791172",
        "parentId" : "00829213-bc99-4de1-a80e-21c49c192e1d",
        "authorId" : "f2a8b72f-e001-4606-a1c7-b774f81c945f",
        "body" : "Use [`files:`](https://docs.conda.io/projects/conda-build/en/latest/resources/define-metadata.html#test-files) rather than `source_files:`. (I had to look this up.)",
        "createdAt" : "2021-04-05T19:09:57Z",
        "updatedAt" : "2021-04-05T19:14:27Z",
        "lastEditedBy" : "f2a8b72f-e001-4606-a1c7-b774f81c945f",
        "tags" : [
        ]
      },
      {
        "id" : "38511431-8d40-42e3-80c7-8d8d4e9ba2aa",
        "parentId" : "00829213-bc99-4de1-a80e-21c49c192e1d",
        "authorId" : "98788fb9-1559-400c-b3ad-57891d5e6aec",
        "body" : "Sweet, that did it thanks!",
        "createdAt" : "2021-04-05T19:51:28Z",
        "updatedAt" : "2021-04-05T19:51:28Z",
        "lastEditedBy" : "98788fb9-1559-400c-b3ad-57891d5e6aec",
        "tags" : [
        ]
      }
    ],
    "commit" : "4302286d43e14e050a407fccbe14b2639cb1ad43",
    "line" : 30,
    "diffHunk" : "@@ -1,1 +28,32 @@    - cobra\n    - depinfo\n    - {{ compiler('cxx') }}\n    - glpk\n    - optlang"
  },
  {
    "id" : "aa2c4556-2982-41f6-b716-b3bfe0597f35",
    "prId" : 14028,
    "prUrl" : "https://github.com/conda-forge/staged-recipes/pull/14028#pullrequestreview-628111930",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "eb6b0ea1-811c-4faf-9a90-217c44934835",
        "parentId" : null,
        "authorId" : "43fc678a-cc3a-4707-8540-4c6397651b46",
        "body" : "I don't think this needs a c++ compiler at *runtime*?",
        "createdAt" : "2021-03-31T00:55:13Z",
        "updatedAt" : "2021-04-05T19:14:27Z",
        "lastEditedBy" : "43fc678a-cc3a-4707-8540-4c6397651b46",
        "tags" : [
        ]
      },
      {
        "id" : "821735dd-177e-426e-a541-cf41c75b1210",
        "parentId" : "eb6b0ea1-811c-4faf-9a90-217c44934835",
        "authorId" : "f0c2b9d9-413c-4076-b9c5-f6c29b0f8b72",
        "body" : "Hi @dopplershift the software uses a c++ compiler to compile a shared library at runtime (that is then loaded by the main program). I discussed with @Midnighter today whether it would be important to get a runtime test implemented to ensure this works cross-platform with conda-forge (as we have done [here](https://gitlab.com/davidtourigny/dynamic-fba)).   ",
        "createdAt" : "2021-03-31T01:03:51Z",
        "updatedAt" : "2021-04-05T19:14:27Z",
        "lastEditedBy" : "f0c2b9d9-413c-4076-b9c5-f6c29b0f8b72",
        "tags" : [
        ]
      },
      {
        "id" : "ead27555-e4ec-4e90-8be5-74557b2dfc28",
        "parentId" : "eb6b0ea1-811c-4faf-9a90-217c44934835",
        "authorId" : "43fc678a-cc3a-4707-8540-4c6397651b46",
        "body" : "AH, had no idea. Yeah, it would be really good to have a test that makes sure that this compilation part functions correctly.",
        "createdAt" : "2021-03-31T01:32:32Z",
        "updatedAt" : "2021-04-05T19:14:27Z",
        "lastEditedBy" : "43fc678a-cc3a-4707-8540-4c6397651b46",
        "tags" : [
        ]
      },
      {
        "id" : "991eb56b-c7a4-47e5-924d-c29cc82535c2",
        "parentId" : "eb6b0ea1-811c-4faf-9a90-217c44934835",
        "authorId" : "78cd53f9-e8c1-4ea8-b936-8ec0724725bd",
        "body" : "Hi @dopplershift, maybe you know how to do this best. I've included a `run_test.py` file in the recipe's directory which gets executed automatically so that's working great. However, I have a problem with getting the model file (`iJR904.xml.gz`) to be mounted in the directory where the tests are run. I have tried to do this by listing it in the `source_files` but that leads to the following error. What's the best way to achieve this?\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/conda/staged-recipes-copy/.ci_support/build_all.py\", line 175, in <module>\r\n    build_all(os.path.join(root_dir, \"recipes\"), args.arch)\r\n  File \"/home/conda/staged-recipes-copy/.ci_support/build_all.py\", line 100, in build_all\r\n    build_folders(recipes_dir, folders, arch, channel_urls)\r\n  File \"/home/conda/staged-recipes-copy/.ci_support/build_all.py\", line 156, in build_folders\r\n    conda_build.api.build([recipe], config=get_config(arch, channel_urls))\r\n  File \"/opt/conda/lib/python3.8/site-packages/conda_build/api.py\", line 186, in build\r\n    return build_tree(\r\n  File \"/opt/conda/lib/python3.8/site-packages/conda_build/build.py\", line 3068, in build_tree\r\n    packages_from_this = build(metadata, stats,\r\n  File \"/opt/conda/lib/python3.8/site-packages/conda_build/build.py\", line 2351, in build\r\n    newly_built_packages = bundlers[pkg_type](output_d, m, env, stats)\r\n  File \"/opt/conda/lib/python3.8/site-packages/conda_build/build.py\", line 1657, in bundle_conda\r\n    output['checksums'] = create_info_files(metadata, replacements, files, prefix=metadata.config.host_prefix)\r\n  File \"/opt/conda/lib/python3.8/site-packages/conda_build/build.py\", line 1266, in create_info_files\r\n    copy_test_source_files(m, join(m.config.info_dir, 'test'))\r\n  File \"/opt/conda/lib/python3.8/site-packages/conda_build/build.py\", line 830, in copy_test_source_files\r\n    raise RuntimeError(msg.format(pattern))\r\nRuntimeError: Did not find any source_files for test with pattern iJR904.xml.gz\r\n```",
        "createdAt" : "2021-04-03T21:22:32Z",
        "updatedAt" : "2021-04-05T19:14:27Z",
        "lastEditedBy" : "78cd53f9-e8c1-4ea8-b936-8ec0724725bd",
        "tags" : [
        ]
      },
      {
        "id" : "2ec8fa78-d806-47af-9fcb-17632bf3ddba",
        "parentId" : "eb6b0ea1-811c-4faf-9a90-217c44934835",
        "authorId" : "43fc678a-cc3a-4707-8540-4c6397651b46",
        "body" : "Use [`files:`](https://docs.conda.io/projects/conda-build/en/latest/resources/define-metadata.html#test-files) rather than `source_files:`. (I had to look this up.)",
        "createdAt" : "2021-04-05T19:09:57Z",
        "updatedAt" : "2021-04-05T19:14:27Z",
        "lastEditedBy" : "43fc678a-cc3a-4707-8540-4c6397651b46",
        "tags" : [
        ]
      },
      {
        "id" : "f0f7a7c8-63ee-443c-8dbc-87e5680efb1b",
        "parentId" : "eb6b0ea1-811c-4faf-9a90-217c44934835",
        "authorId" : "78cd53f9-e8c1-4ea8-b936-8ec0724725bd",
        "body" : "Sweet, that did it thanks!",
        "createdAt" : "2021-04-05T19:51:28Z",
        "updatedAt" : "2021-04-05T19:51:28Z",
        "lastEditedBy" : "78cd53f9-e8c1-4ea8-b936-8ec0724725bd",
        "tags" : [
        ]
      }
    ],
    "commit" : "4302286d43e14e050a407fccbe14b2639cb1ad43",
    "line" : 30,
    "diffHunk" : "@@ -1,1 +28,32 @@    - cobra\n    - depinfo\n    - {{ compiler('cxx') }}\n    - glpk\n    - optlang"
  }
]