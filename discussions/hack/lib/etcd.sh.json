[
  {
    "id" : "4b5ab137-732f-4431-aa23-92f8b6fb66b1",
    "prId" : 88399,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/88399#pullrequestreview-365399873",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7f136d0c-2e69-4030-9e04-fc8c5752ac89",
        "parentId" : null,
        "authorId" : "b7c04289-77b0-4d05-90b7-3bde23e2b0bf",
        "body" : "Instead of this you can use `go env GOHOSTARCH` or `go env GOARCH` that both will report the value `ETCD_UNSUPPORTED_ARCH` wants.\r\n\r\nThis is done for all arches except amd64 (including other arches supported by etcd) when building the docker image.\r\n\r\nhttps://github.com/kubernetes/kubernetes/blob/706cde51c512d8d07e35fc815af4439108a587f9/cluster/images/etcd/Makefile#L138\r\n\r\nI also this you can just place `ETCD_UNSUPPORTED_ARCH=\"$(go env GOHOSTARCH)\"` before each call to etcd, or alternatively add the export to the top of this file.\r\n\r\n```sh\r\nexport ETCD_UNSUPPORTED_ARCH=\"$(go env GOHOSTARCH)\" \r\n```",
        "createdAt" : "2020-02-21T10:07:35Z",
        "updatedAt" : "2020-02-27T04:56:31Z",
        "lastEditedBy" : "b7c04289-77b0-4d05-90b7-3bde23e2b0bf",
        "tags" : [
        ]
      },
      {
        "id" : "d98c20d0-eec0-439d-8060-14442adcc0eb",
        "parentId" : "7f136d0c-2e69-4030-9e04-fc8c5752ac89",
        "authorId" : "1fde46ca-8fae-4b82-9978-f266fdae6ffe",
        "body" : "Good to know, will fix this soon.",
        "createdAt" : "2020-02-24T02:29:16Z",
        "updatedAt" : "2020-02-27T04:56:31Z",
        "lastEditedBy" : "1fde46ca-8fae-4b82-9978-f266fdae6ffe",
        "tags" : [
        ]
      },
      {
        "id" : "a0056ff4-4ea3-4aa2-a4e5-900f345acb2a",
        "parentId" : "7f136d0c-2e69-4030-9e04-fc8c5752ac89",
        "authorId" : "1fde46ca-8fae-4b82-9978-f266fdae6ffe",
        "body" : "Although I agree that your solution is good, but seems like kind's doesn't have go installed, so I will revert it back.\r\n```\r\n/home/prow/go/src/k8s.io/kubernetes/hack/lib/etcd.sh: line 23: go: command not found\r\n!!! [0224 06:19:34] Call tree:\r\n!!! [0224 06:19:34]  1: /home/prow/go/src/k8s.io/kubernetes/hack/lib/init.sh:56 source(...)\r\n!!! [0224 06:19:34]  2: ./hack/ginkgo-e2e.sh:26 source(...)\r\n!!! Error in /home/prow/go/src/k8s.io/kubernetes/hack/lib/etcd.sh:23\r\n  Error in /home/prow/go/src/k8s.io/kubernetes/hack/lib/etcd.sh:23. 'ETCD_UNSUPPORTED_ARCH=\"$(go env GOHOSTARCH)\"' exited with status 127\r\n```",
        "createdAt" : "2020-02-24T06:27:24Z",
        "updatedAt" : "2020-02-27T04:56:31Z",
        "lastEditedBy" : "1fde46ca-8fae-4b82-9978-f266fdae6ffe",
        "tags" : [
        ]
      },
      {
        "id" : "b0b29d2e-fa88-4591-a676-7d665cca929c",
        "parentId" : "7f136d0c-2e69-4030-9e04-fc8c5752ac89",
        "authorId" : "1fde46ca-8fae-4b82-9978-f266fdae6ffe",
        "body" : "cross build failed with the same issue as well, \r\nhttps://prow.k8s.io/view/gcs/kubernetes-jenkins/pr-logs/pull/88399/pull-kubernetes-cross/1231823687401869315/#1:build-log.txt%3A66\r\n\r\nDo you know why?",
        "createdAt" : "2020-02-24T06:36:53Z",
        "updatedAt" : "2020-02-27T04:56:31Z",
        "lastEditedBy" : "1fde46ca-8fae-4b82-9978-f266fdae6ffe",
        "tags" : [
        ]
      },
      {
        "id" : "af97c207-46ad-446b-b8ce-faa181b48bfe",
        "parentId" : "7f136d0c-2e69-4030-9e04-fc8c5752ac89",
        "authorId" : "b7c04289-77b0-4d05-90b7-3bde23e2b0bf",
        "body" : "Ahh, sorry for the confusion.\r\n\r\nLooks like golang is missing from the image used: https://github.com/kubernetes/test-infra/blob/master/images/bootstrap/Dockerfile",
        "createdAt" : "2020-02-24T07:06:43Z",
        "updatedAt" : "2020-02-27T04:56:31Z",
        "lastEditedBy" : "b7c04289-77b0-4d05-90b7-3bde23e2b0bf",
        "tags" : [
        ]
      },
      {
        "id" : "d9acc2e6-dd4e-46cd-879d-96a6edbb1a8d",
        "parentId" : "7f136d0c-2e69-4030-9e04-fc8c5752ac89",
        "authorId" : "1fde46ca-8fae-4b82-9978-f266fdae6ffe",
        "body" : "how about revert this back? ",
        "createdAt" : "2020-02-24T07:54:35Z",
        "updatedAt" : "2020-02-27T04:56:31Z",
        "lastEditedBy" : "1fde46ca-8fae-4b82-9978-f266fdae6ffe",
        "tags" : [
        ]
      },
      {
        "id" : "7aafce55-7a26-4816-8eaf-ed3eb287b96e",
        "parentId" : "7f136d0c-2e69-4030-9e04-fc8c5752ac89",
        "authorId" : "1fde46ca-8fae-4b82-9978-f266fdae6ffe",
        "body" : "let's see if infra team okay with this: https://github.com/kubernetes/test-infra/pull/16447",
        "createdAt" : "2020-02-24T08:19:24Z",
        "updatedAt" : "2020-02-27T04:56:31Z",
        "lastEditedBy" : "1fde46ca-8fae-4b82-9978-f266fdae6ffe",
        "tags" : [
        ]
      },
      {
        "id" : "86d3c7cf-3440-4142-97c1-f9ead2ad359e",
        "parentId" : "7f136d0c-2e69-4030-9e04-fc8c5752ac89",
        "authorId" : "46e1ba13-482b-4bcd-8fb1-be821bac3b04",
        "body" : "I don't think this is the right approach. Unless I'm misremembering we don't require go on the host, we have a dockerized build (and bazel!)\r\n\r\nuname is posix.",
        "createdAt" : "2020-02-27T03:41:43Z",
        "updatedAt" : "2020-02-27T04:56:31Z",
        "lastEditedBy" : "46e1ba13-482b-4bcd-8fb1-be821bac3b04",
        "tags" : [
        ]
      },
      {
        "id" : "f0ff5726-60a9-44ed-8068-859516a888cb",
        "parentId" : "7f136d0c-2e69-4030-9e04-fc8c5752ac89",
        "authorId" : "46e1ba13-482b-4bcd-8fb1-be821bac3b04",
        "body" : "when we cross build we use the dockerized build, we expect go to be in that container, but not on the host.",
        "createdAt" : "2020-02-27T03:52:46Z",
        "updatedAt" : "2020-02-27T04:56:31Z",
        "lastEditedBy" : "46e1ba13-482b-4bcd-8fb1-be821bac3b04",
        "tags" : [
        ]
      }
    ],
    "commit" : "2543598628dcbf116ac5cd421158b39cc5f1116a",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +47,51 @@\n  # need set the env of \"ETCD_UNSUPPORTED_ARCH\" on unstable arch.\n  arch=$(uname -m)\n  if [[ $arch =~ aarch* ]]; then\n\t  export ETCD_UNSUPPORTED_ARCH=arm64"
  },
  {
    "id" : "f9f53e57-3bba-44c9-ac30-d8da8fadfe1a",
    "prId" : 85601,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/85601#pullrequestreview-322248571",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f30642a3-a38e-46de-8df5-80c18b972946",
        "parentId" : null,
        "authorId" : "bd04f755-e62f-45fb-8771-4cc2b5db49d4",
        "body" : "@zhlhahaha `etcd --version | grep Version | cut -d \" \" -f 3` should be enough?",
        "createdAt" : "2019-11-25T12:27:11Z",
        "updatedAt" : "2019-11-25T12:27:11Z",
        "lastEditedBy" : "bd04f755-e62f-45fb-8771-4cc2b5db49d4",
        "tags" : [
        ]
      },
      {
        "id" : "9d0d6201-97e4-4afa-9163-f605f767d799",
        "parentId" : "f30642a3-a38e-46de-8df5-80c18b972946",
        "authorId" : "66bd25ab-dde7-4029-a11d-c9aaaeafa5ed",
        "body" : "No, it shows results as following:\r\n`3.3.10\r\ngo1.10.4`\r\nalternative script can be \r\n`etcd --version | grep \"etcd Version\" | cut -d \" \" -f 3`",
        "createdAt" : "2019-11-25T12:30:19Z",
        "updatedAt" : "2019-11-25T12:30:20Z",
        "lastEditedBy" : "66bd25ab-dde7-4029-a11d-c9aaaeafa5ed",
        "tags" : [
        ]
      },
      {
        "id" : "539dfdab-cffa-45b2-be88-1762bc93112c",
        "parentId" : "f30642a3-a38e-46de-8df5-80c18b972946",
        "authorId" : "66bd25ab-dde7-4029-a11d-c9aaaeafa5ed",
        "body" : "Which one you think better? @dims ",
        "createdAt" : "2019-11-25T12:42:29Z",
        "updatedAt" : "2019-11-25T12:42:29Z",
        "lastEditedBy" : "66bd25ab-dde7-4029-a11d-c9aaaeafa5ed",
        "tags" : [
        ]
      },
      {
        "id" : "cdcef6b5-db55-408c-a781-5e602d3971b3",
        "parentId" : "f30642a3-a38e-46de-8df5-80c18b972946",
        "authorId" : "bd04f755-e62f-45fb-8771-4cc2b5db49d4",
        "body" : "ah never mind then :)",
        "createdAt" : "2019-11-25T12:42:33Z",
        "updatedAt" : "2019-11-25T12:42:33Z",
        "lastEditedBy" : "bd04f755-e62f-45fb-8771-4cc2b5db49d4",
        "tags" : [
        ]
      }
    ],
    "commit" : "09d4d65b1bdd8ece7e781816921419d6426e2e11",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +47,51 @@\n  # validate installed version is at least equal to minimum\n  version=$(etcd --version | grep Version | tail -n +1 | head -n 1 | cut -d \" \" -f 3)\n  if [[ $(kube::etcd::version \"${ETCD_VERSION}\") -gt $(kube::etcd::version \"${version}\") ]]; then\n   export PATH=${KUBE_ROOT}/third_party/etcd:${PATH}"
  },
  {
    "id" : "0fb34a30-525e-460e-8bb2-0b5270e56f25",
    "prId" : 44352,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/44352#pullrequestreview-32277968",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3785d024-07d7-4056-a1a7-c6879f106935",
        "parentId" : null,
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "`V` is a gnu extension to sort :-/\r\n\r\nhttp://pubs.opengroup.org/onlinepubs/9699919799/utilities/sort.html\r\n\r\n```\r\n$ sort -V\r\nsort: invalid option -- V\r\n```",
        "createdAt" : "2017-04-12T04:01:23Z",
        "updatedAt" : "2017-04-12T04:06:31Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      }
    ],
    "commit" : "36d244f0843e83e8c14a2ccd309a94715c93b57c",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +37,41 @@  # validate installed version is at least equal to minimum\n  version=$(etcd --version | tail -n +1 | head -n 1 | cut -d \" \" -f 3)\n  if [[ \"`echo -e \"${version}\\n${ETCD_VERSION}\" | sort -rV | head -n 1`\" != \"$version\" ]]; then\n   export PATH=$KUBE_ROOT/third_party/etcd:$PATH\n   hash etcd"
  },
  {
    "id" : "fc456d17-95cd-406f-b886-80ef0b8dea1c",
    "prId" : 22037,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9bf36c78-8f38-4328-8c99-4f7733eabe59",
        "parentId" : null,
        "authorId" : "b86e7e78-bb07-417f-8470-39407559c779",
        "body" : "Add \" Run hack/install-etcd.sh\"\n",
        "createdAt" : "2016-02-26T18:28:33Z",
        "updatedAt" : "2016-02-26T19:54:54Z",
        "lastEditedBy" : "b86e7e78-bb07-417f-8470-39407559c779",
        "tags" : [
        ]
      },
      {
        "id" : "c996502a-f49f-4485-a102-baf1d4aa5c53",
        "parentId" : "9bf36c78-8f38-4328-8c99-4f7733eabe59",
        "authorId" : "719d0e19-fcef-4b47-afac-404318b9514f",
        "body" : "done\n",
        "createdAt" : "2016-02-26T19:55:23Z",
        "updatedAt" : "2016-02-26T19:55:23Z",
        "lastEditedBy" : "719d0e19-fcef-4b47-afac-404318b9514f",
        "tags" : [
        ]
      }
    ],
    "commit" : "7adaf80cc7e9cf054e384f6e7616e06f91a0d4b7",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +36,40 @@  version=$(etcd -version | cut -d \" \" -f 3)\n  if [[ \"${version}\" < \"${ETCD_VERSION}\" ]]; then\n   kube::log::usage \"etcd version ${ETCD_VERSION} or greater required.\"\n   kube::log::info \"You can use 'hack/install-etcd.sh' to install a copy in third_party/.\"\n   exit 1"
  },
  {
    "id" : "2b981a3a-765c-48ac-9027-5e6a42591290",
    "prId" : 10691,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "439da92e-c80b-4cf9-89e4-6cb5de59268e",
        "parentId" : null,
        "authorId" : "b86e7e78-bb07-417f-8470-39407559c779",
        "body" : "optional: `--fail --silent` is easier to read\n",
        "createdAt" : "2015-07-04T03:44:34Z",
        "updatedAt" : "2015-07-04T03:44:34Z",
        "lastEditedBy" : "b86e7e78-bb07-417f-8470-39407559c779",
        "tags" : [
        ]
      }
    ],
    "commit" : "efa76b72ae4c5d50b1ba416638e0097651fc0bd3",
    "line" : 12,
    "diffHunk" : "@@ -1,1 +47,51 @@  echo \"Waiting for etcd to come up.\"\n  kube::util::wait_for_url \"http://${host}:${port}/v2/machines\" \"etcd: \" 0.25 80\n  curl -fs -X PUT \"http://${host}:${port}/v2/keys/_test\"\n}\n"
  },
  {
    "id" : "098dd9cb-31d4-413c-ad3e-8fae89cf552a",
    "prId" : 4254,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "01d04fa7-1499-4026-a666-df72b4271a66",
        "parentId" : null,
        "authorId" : "6e2b5eda-1533-4798-a56c-432faaf38480",
        "body" : "This was the bug from etcd 0.4.6 -> 2.0.0 - it behaves differently.\n",
        "createdAt" : "2015-02-09T22:26:29Z",
        "updatedAt" : "2015-02-09T22:26:29Z",
        "lastEditedBy" : "6e2b5eda-1533-4798-a56c-432faaf38480",
        "tags" : [
        ]
      }
    ],
    "commit" : "4369e31b9d740ec05b1a8bffc929c1070dff334f",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +41,45 @@  ETCD_DIR=$(mktemp -d -t test-etcd.XXXXXX)\n  kube::log::usage \"etcd -data-dir ${ETCD_DIR} --bind-addr ${host}:${port} >/dev/null 2>/dev/null\"\n  etcd -data-dir ${ETCD_DIR} --bind-addr ${host}:${port} >/dev/null 2>/dev/null &\n  ETCD_PID=$!\n"
  },
  {
    "id" : "57838f2a-3515-4ab2-a382-8a0066b2ddfe",
    "prId" : 4254,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8c2d1a47-a438-4b78-9518-3dff54927148",
        "parentId" : null,
        "authorId" : "6e2b5eda-1533-4798-a56c-432faaf38480",
        "body" : "This was code I put in before I figured out what was wrong with -addr vs -bind-addr\n",
        "createdAt" : "2015-02-09T22:27:19Z",
        "updatedAt" : "2015-02-09T22:27:19Z",
        "lastEditedBy" : "6e2b5eda-1533-4798-a56c-432faaf38480",
        "tags" : [
        ]
      }
    ],
    "commit" : "4369e31b9d740ec05b1a8bffc929c1070dff334f",
    "line" : 11,
    "diffHunk" : "@@ -1,1 +45,49 @@\n  echo \"Waiting for etcd to come up.\"\n  kube::util::wait_for_url \"http://${host}:${port}/v2/machines\" \"etcd: \" 0.25 80\n  curl -X PUT \"http://${host}:${port}/v2/keys/_test\"\n}"
  }
]