[
  {
    "id" : "23fbec6e-d7ab-46a6-92ab-01acfe5f596b",
    "prId" : 93448,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/93448#pullrequestreview-458633656",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "fbd6d181-e9d7-420e-add6-510686f3a9cc",
        "parentId" : null,
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "this will create and clean up a temp dir for you:\r\n```\r\nkube::util::ensure-temp-dir()\r\ngo list -mod=vendor -test -deps -json ./vendor/... > \"${KUBE_TEMP}/deps.json\"\r\n```",
        "createdAt" : "2020-07-30T18:00:08Z",
        "updatedAt" : "2020-08-01T13:11:50Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      }
    ],
    "commit" : "89bfeb5fb40cf1408a3b492ed3600dc1ebdb4876",
    "line" : 11,
    "diffHunk" : "@@ -1,1 +33,37 @@\ncd \"${KUBE_ROOT}\"\n\n# Check for any module that is not main or staging and depends on main or staging\nbad_deps=$(go mod graph | grep -vE \"^k8s.io\\/(kubernetes|${staging_repos_pattern})\" | grep -E \"\\sk8s.io\\/(kubernetes|${staging_repos_pattern})\" || true)"
  },
  {
    "id" : "df8f3adb-17ca-4570-b472-5e74bd754c5b",
    "prId" : 93448,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/93448#pullrequestreview-459319615",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7c192e70-711a-4cd9-982e-233b0ffd32a3",
        "parentId" : null,
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "also suggest dropping `set -x;` it's useful when writing the script, but is basically noise in CI runs",
        "createdAt" : "2020-07-31T16:53:28Z",
        "updatedAt" : "2020-08-01T13:11:50Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      }
    ],
    "commit" : "89bfeb5fb40cf1408a3b492ed3600dc1ebdb4876",
    "line" : 9,
    "diffHunk" : "@@ -1,1 +31,35 @@kube::util::read-array staging_repos < <(kube::util::list_staging_repos)\nstaging_repos_pattern=$(IFS=\"|\"; echo \"${staging_repos[*]}\")\n\ncd \"${KUBE_ROOT}\"\n"
  },
  {
    "id" : "7e64c580-5cb5-4a99-962f-2a890b9839fa",
    "prId" : 49252,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/49252#pullrequestreview-51318726",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "90c3b2a6-c144-4462-9ff0-8c7ef41bb0b2",
        "parentId" : null,
        "authorId" : "b86e7e78-bb07-417f-8470-39407559c779",
        "body" : "Is this going to flag the staging repos themselves? (since they are symlinked into vendor/)",
        "createdAt" : "2017-07-20T20:17:25Z",
        "updatedAt" : "2017-07-20T22:30:16Z",
        "lastEditedBy" : "b86e7e78-bb07-417f-8470-39407559c779",
        "tags" : [
        ]
      },
      {
        "id" : "7888de44-bdb6-44ef-9d64-ef47b8dd7929",
        "parentId" : "90c3b2a6-c144-4462-9ff0-8c7ef41bb0b2",
        "authorId" : "ca7e5a52-cab7-4f09-8ff8-da79f43339d4",
        "body" : "staging repos are not tested, because \"find vendor/ -type d\" doesn't follow symlinks",
        "createdAt" : "2017-07-20T20:20:19Z",
        "updatedAt" : "2017-07-20T22:30:16Z",
        "lastEditedBy" : "ca7e5a52-cab7-4f09-8ff8-da79f43339d4",
        "tags" : [
        ]
      }
    ],
    "commit" : "d6adc37a0a9b8571a0e18473be6f3eeef63fb565",
    "line" : 19,
    "diffHunk" : "@@ -1,1 +32,36 @@    failed=true\n  fi\n  deps_on_staging=$(echo \"${deps}\" | grep \"k8s.io/kubernetes/vendor/k8s.io\" | grep -E ${staging_repos_pattern} || echo \"\")\n  if [ -n \"${deps_on_staging}\" ]; then\n    echo \"Package ${i} has a cyclic dependency on staging repository packages: ${deps_on_staging}\""
  },
  {
    "id" : "461ab0d4-1a6d-4cb5-8fc5-33c2d38da34c",
    "prId" : 45176,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/45176#pullrequestreview-51081260",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "dc3c904c-4d66-48f6-bedc-60ece1ffdb59",
        "parentId" : null,
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "seems like this should also include packages whose authoritative source is still in this repo (like apimachinery, apiserver)? c.f. discussion in https://github.com/kubernetes/kubernetes/pull/45665#issuecomment-301116649",
        "createdAt" : "2017-05-15T18:23:37Z",
        "updatedAt" : "2017-05-15T18:23:37Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "9dc9b0e0-9b55-4e9f-9bea-066b148cbcf1",
        "parentId" : "dc3c904c-4d66-48f6-bedc-60ece1ffdb59",
        "authorId" : "ca7e5a52-cab7-4f09-8ff8-da79f43339d4",
        "body" : "I agree, see https://github.com/kubernetes/kubernetes/pull/45176#discussion_r114174343.",
        "createdAt" : "2017-05-15T19:25:30Z",
        "updatedAt" : "2017-05-15T19:25:30Z",
        "lastEditedBy" : "ca7e5a52-cab7-4f09-8ff8-da79f43339d4",
        "tags" : [
        ]
      },
      {
        "id" : "e6df9b00-8024-4fc2-bc3a-d9ade1f37d85",
        "parentId" : "dc3c904c-4d66-48f6-bedc-60ece1ffdb59",
        "authorId" : "b86e7e78-bb07-417f-8470-39407559c779",
        "body" : "The whole point of this is to break the repo into chunks that people *are* allowed to import?",
        "createdAt" : "2017-05-16T19:44:01Z",
        "updatedAt" : "2017-05-16T19:44:01Z",
        "lastEditedBy" : "b86e7e78-bb07-417f-8470-39407559c779",
        "tags" : [
        ]
      },
      {
        "id" : "00600be4-ddf6-4190-beb8-e7bfd83bce5d",
        "parentId" : "dc3c904c-4d66-48f6-bedc-60ece1ffdb59",
        "authorId" : "ca7e5a52-cab7-4f09-8ff8-da79f43339d4",
        "body" : "Yes, that's the point. But now since we have `staging`, we have the cycle. ",
        "createdAt" : "2017-05-16T19:50:13Z",
        "updatedAt" : "2017-05-16T19:50:13Z",
        "lastEditedBy" : "ca7e5a52-cab7-4f09-8ff8-da79f43339d4",
        "tags" : [
        ]
      },
      {
        "id" : "b39fc092-cda7-4cc2-8195-353757de6c97",
        "parentId" : "dc3c904c-4d66-48f6-bedc-60ece1ffdb59",
        "authorId" : "ca7e5a52-cab7-4f09-8ff8-da79f43339d4",
        "body" : "Sent https://github.com/kubernetes/kubernetes/pull/49252.",
        "createdAt" : "2017-07-20T01:09:15Z",
        "updatedAt" : "2017-07-20T01:09:16Z",
        "lastEditedBy" : "ca7e5a52-cab7-4f09-8ff8-da79f43339d4",
        "tags" : [
        ]
      }
    ],
    "commit" : "4bda915c685a0295319a5cce84a1cc8944f8d208",
    "line" : 38,
    "diffHunk" : "@@ -1,1 +36,40 @@  fi\n\n  deps=$(go list -f '{{range .Deps}}{{.}}{{\"\\n\"}}{{end}}' ./$i 2> /dev/null | grep -v \"k8s.io/kubernetes/vendor/\" | grep \"k8s.io/kubernetes\" || echo \"\")\n    if [ -n \"${deps}\" ]; then\n    echo \"Package ${i} has a cyclic dependency on the main repository.\""
  }
]