[
  {
    "id" : "42019aef-5bf0-45d1-a4dd-d20ee7060c32",
    "prId" : 7238,
    "prUrl" : "https://github.com/apache/kafka/pull/7238#pullrequestreview-287129366",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "408dbc24-7049-4c79-95ea-4226e3f5605b",
        "parentId" : null,
        "authorId" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "body" : "Before we produce new messages, should we verify that the store was migrated correctly and contains `store.get(key), is(equalTo(batch1NumMessages - 1))` ?",
        "createdAt" : "2019-09-06T18:55:36Z",
        "updatedAt" : "2019-09-11T16:35:57Z",
        "lastEditedBy" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "tags" : [
        ]
      },
      {
        "id" : "67c1f668-d395-4ef6-b8a9-149f21da088a",
        "parentId" : "408dbc24-7049-4c79-95ea-4226e3f5605b",
        "authorId" : "12543f19-3885-429e-8f77-e0f748c56d1f",
        "body" : "Yes, we can do that with a time limited loop that queries for that state.",
        "createdAt" : "2019-09-06T19:17:22Z",
        "updatedAt" : "2019-09-11T16:35:57Z",
        "lastEditedBy" : "12543f19-3885-429e-8f77-e0f748c56d1f",
        "tags" : [
        ]
      },
      {
        "id" : "58a7289a-3586-48f2-b838-15b4659036cf",
        "parentId" : "408dbc24-7049-4c79-95ea-4226e3f5605b",
        "authorId" : "12543f19-3885-429e-8f77-e0f748c56d1f",
        "body" : "@mjsax You may have uncovered yet another bug (BUG 6?) in optimized graph failover! I cannot seem to get any value for the key after failover. So, looks like this may involve yet more significant investigation. Thanks for the idea!",
        "createdAt" : "2019-09-06T20:28:57Z",
        "updatedAt" : "2019-09-11T16:35:57Z",
        "lastEditedBy" : "12543f19-3885-429e-8f77-e0f748c56d1f",
        "tags" : [
        ]
      },
      {
        "id" : "c289ef04-e2cf-4381-a148-171d0aa868fe",
        "parentId" : "408dbc24-7049-4c79-95ea-4226e3f5605b",
        "authorId" : "12543f19-3885-429e-8f77-e0f748c56d1f",
        "body" : "This test fails with non-optimized graphs too. I hope I'm doing something wrong...",
        "createdAt" : "2019-09-06T20:38:20Z",
        "updatedAt" : "2019-09-11T16:35:57Z",
        "lastEditedBy" : "12543f19-3885-429e-8f77-e0f748c56d1f",
        "tags" : [
        ]
      },
      {
        "id" : "a2770de8-816c-4a60-96db-42920e93ed7c",
        "parentId" : "408dbc24-7049-4c79-95ea-4226e3f5605b",
        "authorId" : "12543f19-3885-429e-8f77-e0f748c56d1f",
        "body" : "*whew*... Apparently 10 seconds was not long enough to wait for the store to become available after failure. If I wait a bit longer it finally becomes available. Seems long though? This is the case for both non-optimized and optimized...",
        "createdAt" : "2019-09-06T20:58:52Z",
        "updatedAt" : "2019-09-11T16:35:57Z",
        "lastEditedBy" : "12543f19-3885-429e-8f77-e0f748c56d1f",
        "tags" : [
        ]
      },
      {
        "id" : "f8988e6f-f1fa-439b-aded-739a0505387e",
        "parentId" : "408dbc24-7049-4c79-95ea-4226e3f5605b",
        "authorId" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "body" : "If case of failure, we detect the failure only after `session.timeout.ms` (default 10 seconds) hit -- to speed up the test, we could decrease the session timeout via `StreamsConfig`",
        "createdAt" : "2019-09-10T23:15:56Z",
        "updatedAt" : "2019-09-11T16:35:57Z",
        "lastEditedBy" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "tags" : [
        ]
      },
      {
        "id" : "51142edb-b8a8-4c48-8495-8a656fe290c6",
        "parentId" : "408dbc24-7049-4c79-95ea-4226e3f5605b",
        "authorId" : "12543f19-3885-429e-8f77-e0f748c56d1f",
        "body" : "I had the same exact thought. My only reservation was tweaking config too much might start to deviate too much from expected use. In other words, I'm totally for this if have a reasonable value in mind. I was thinking about 1s?",
        "createdAt" : "2019-09-11T15:59:38Z",
        "updatedAt" : "2019-09-11T16:35:57Z",
        "lastEditedBy" : "12543f19-3885-429e-8f77-e0f748c56d1f",
        "tags" : [
        ]
      },
      {
        "id" : "7d7ccbe2-71ac-4381-b3e4-47ac11d363c8",
        "parentId" : "408dbc24-7049-4c79-95ea-4226e3f5605b",
        "authorId" : "12543f19-3885-429e-8f77-e0f748c56d1f",
        "body" : "I'm going to try with 1s. If you have a better value please let me know as soon as you get a chance :)",
        "createdAt" : "2019-09-11T16:23:35Z",
        "updatedAt" : "2019-09-11T16:35:57Z",
        "lastEditedBy" : "12543f19-3885-429e-8f77-e0f748c56d1f",
        "tags" : [
        ]
      },
      {
        "id" : "b02b2455-2447-4950-a98f-acf9313603b2",
        "parentId" : "408dbc24-7049-4c79-95ea-4226e3f5605b",
        "authorId" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "body" : "We can try that -- but we need to reduce `HEARTBEAT_INTERVAL_MS_CONFIG`, too, for this case -- its default is 3 seconds and it must be smaller than session timeout.\r\n\r\nChecking some existing tests, we have some that set them to 500ms / 1sec. Some other test reduce session timeout to 2 or 5 seconds...",
        "createdAt" : "2019-09-11T23:40:35Z",
        "updatedAt" : "2019-09-11T23:40:36Z",
        "lastEditedBy" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "tags" : [
        ]
      }
    ],
    "commit" : "0b14fbdce1f31b17070923325715f68c0238d43d",
    "line" : 199,
    "diffHunk" : "@@ -1,1 +197,201 @@        final int totalNumMessages = batch1NumMessages + batch2NumMessages;\n\n        produceValueRange(key, batch1NumMessages, totalNumMessages);\n\n        // Assert that all messages in the second batch were processed in a timely manner"
  },
  {
    "id" : "4e4e968e-9937-4d9a-9bcc-edd4e18fb446",
    "prId" : 7488,
    "prUrl" : "https://github.com/apache/kafka/pull/7488#pullrequestreview-300342118",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "bb42e8a8-b1f0-46d8-baf6-1209d7e982cb",
        "parentId" : null,
        "authorId" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "body" : "nit: add static import?",
        "createdAt" : "2019-10-10T20:47:30Z",
        "updatedAt" : "2019-10-11T19:52:26Z",
        "lastEditedBy" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "tags" : [
        ]
      }
    ],
    "commit" : "93c5a5b42b4ca8672407c34fbba57c2a184ca97d",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +190,194 @@        final ReadOnlyKeyValueStore<Integer, Integer> newActiveStore =\n            kafkaStreams1WasFirstActive ? store2 : store1;\n        TestUtils.retryOnExceptionWithTimeout(100, 60 * 1000, () -> {\n            // Assert that after failover we have recovered to the last store write\n            assertThat(newActiveStore.get(key), is(equalTo(batch1NumMessages - 1)));"
  },
  {
    "id" : "5c2a09b1-c463-4a11-a19d-855202a56342",
    "prId" : 8568,
    "prUrl" : "https://github.com/apache/kafka/pull/8568#pullrequestreview-401497994",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "45a49f4a-4a74-4b8b-ab4e-9b2913dfdcc9",
        "parentId" : null,
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "This is a minor fix, that we should retry this condition.",
        "createdAt" : "2020-04-28T05:00:29Z",
        "updatedAt" : "2020-04-28T22:02:54Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      }
    ],
    "commit" : "57a2c39bcded8ecbdf0f443520ed7385f4ce0dbf",
    "line" : 28,
    "diffHunk" : "@@ -1,1 +160,164 @@        assertThat(semaphore.tryAcquire(batch2NumMessages, 60, TimeUnit.SECONDS), is(equalTo(true)));\n\n        TestUtils.retryOnExceptionWithTimeout(100, 60 * 1000, () -> {\n            // Assert that the current value in store reflects all messages being processed\n            assertThat(newActiveStore.get(key), is(equalTo(totalNumMessages - 1)));"
  },
  {
    "id" : "1072db26-0fdd-46f9-9a3e-51a19735b86d",
    "prId" : 8568,
    "prUrl" : "https://github.com/apache/kafka/pull/8568#pullrequestreview-401497994",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "652dd850-1a99-4027-98b4-d93321f441ff",
        "parentId" : null,
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "This is a fix to the test itself: with caching the records are delayed sending to the sink topics.",
        "createdAt" : "2020-04-28T05:01:04Z",
        "updatedAt" : "2020-04-28T22:02:54Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      }
    ],
    "commit" : "57a2c39bcded8ecbdf0f443520ed7385f4ce0dbf",
    "line" : 40,
    "diffHunk" : "@@ -1,1 +227,231 @@        config.put(StreamsConfig.NUM_STANDBY_REPLICAS_CONFIG, 1);\n        config.put(StreamsConfig.COMMIT_INTERVAL_MS_CONFIG, 100);\n        config.put(StreamsConfig.CACHE_MAX_BYTES_BUFFERING_CONFIG, 0);\n        config.put(ConsumerConfig.MAX_POLL_RECORDS_CONFIG, 100);\n        config.put(ConsumerConfig.HEARTBEAT_INTERVAL_MS_CONFIG, 200);"
  },
  {
    "id" : "d05fafe3-509f-4b89-b1c1-63ac8828de6a",
    "prId" : 8568,
    "prUrl" : "https://github.com/apache/kafka/pull/8568#pullrequestreview-402075732",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7457930f-40ec-4b2e-997b-501976991d24",
        "parentId" : null,
        "authorId" : "d97f50bf-60f9-45b3-81a0-a24a5f42f740",
        "body" : "`OptimizedKTableIntegrationTest.shouldApplyUpdatesToStandbyStore` still failed on [one of the builds](https://builds.apache.org/job/kafka-pr-jdk14-scala2.13/149/testReport/junit/org.apache.kafka.streams.integration/OptimizedKTableIntegrationTest/shouldApplyUpdatesToStandbyStore/) at this line :/\r\nBut, at least we got farther into the test before it failed so I'd say this is still an improvement ðŸ˜„ ",
        "createdAt" : "2020-04-28T17:52:25Z",
        "updatedAt" : "2020-04-28T22:02:54Z",
        "lastEditedBy" : "d97f50bf-60f9-45b3-81a0-a24a5f42f740",
        "tags" : [
        ]
      }
    ],
    "commit" : "57a2c39bcded8ecbdf0f443520ed7385f4ce0dbf",
    "line" : 24,
    "diffHunk" : "@@ -1,1 +158,162 @@\n        // Assert that all messages in the second batch were processed in a timely manner\n        assertThat(semaphore.tryAcquire(batch2NumMessages, 60, TimeUnit.SECONDS), is(equalTo(true)));\n\n        TestUtils.retryOnExceptionWithTimeout(100, 60 * 1000, () -> {"
  },
  {
    "id" : "d9519306-eb3c-463d-9838-4f88febbf2ff",
    "prId" : 8578,
    "prUrl" : "https://github.com/apache/kafka/pull/8578#pullrequestreview-402972851",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a65a2723-2770-425d-b329-a525812343d4",
        "parentId" : null,
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "Is it safer to encode the appID as part of the dir path to avoid collision?",
        "createdAt" : "2020-04-29T01:11:29Z",
        "updatedAt" : "2020-04-29T19:48:31Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      },
      {
        "id" : "5b7aeca5-0b2d-4570-b889-d1205c8e972a",
        "parentId" : "a65a2723-2770-425d-b329-a525812343d4",
        "authorId" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "body" : "I wavered on this point, but each time you call `tempDirectory`, it should give you a completely new directory:\r\n```\r\n     * Create a temporary relative directory in the default temporary-file directory with the given prefix.\r\n     *\r\n     * @param prefix The prefix of the temporary directory, if null using \"kafka-\" as default prefix\r\n```\r\n\r\nSo the prefix seems to be nice only for documenting which test a directory is for, not for enforcing any kind of test/directory uniqueness. I felt like it added more noise than value, so I just dropped all the prefixes. ",
        "createdAt" : "2020-04-29T02:56:43Z",
        "updatedAt" : "2020-04-29T19:48:31Z",
        "lastEditedBy" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "tags" : [
        ]
      },
      {
        "id" : "c734b8c7-7a4c-4ba1-93a7-0cc2d81fa832",
        "parentId" : "a65a2723-2770-425d-b329-a525812343d4",
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "Yeah I was thinking about debugging purposes as well. If it is more noise the usefulness, I'm fine with dropping it.",
        "createdAt" : "2020-04-29T19:29:06Z",
        "updatedAt" : "2020-04-29T19:48:31Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      }
    ],
    "commit" : "1884686387a8af57d0123deead442c98529239d5",
    "line" : 30,
    "diffHunk" : "@@ -1,1 +223,227 @@        config.put(StreamsConfig.APPLICATION_SERVER_CONFIG, \"localhost:\" + (++port));\n        config.put(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG, cluster.bootstrapServers());\n        config.put(StreamsConfig.STATE_DIR_CONFIG, TestUtils.tempDirectory().getPath());\n        config.put(StreamsConfig.DEFAULT_KEY_SERDE_CLASS_CONFIG, Serdes.Integer().getClass());\n        config.put(StreamsConfig.DEFAULT_VALUE_SERDE_CLASS_CONFIG, Serdes.Integer().getClass());"
  }
]