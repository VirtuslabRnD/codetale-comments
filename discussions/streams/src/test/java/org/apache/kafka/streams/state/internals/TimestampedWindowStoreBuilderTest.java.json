[
  {
    "id" : "0b031476-6ef1-44e0-9939-7eef3ba72ffe",
    "prId" : 6601,
    "prUrl" : "https://github.com/apache/kafka/pull/6601#pullrequestreview-228147302",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "72098765-4fb7-4700-a82e-32716abdb223",
        "parentId" : null,
        "authorId" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "body" : "Adding this test slipped before -- the class existed already -- however, we updated it in this PR to make it backward compatible, and thus discovered the missing test.",
        "createdAt" : "2019-04-18T08:00:26Z",
        "updatedAt" : "2019-04-29T22:01:48Z",
        "lastEditedBy" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "tags" : [
        ]
      }
    ],
    "commit" : "ddf4d0c71c9c70fa0a9c317c49768107b8cf4d9f",
    "line" : 44,
    "diffHunk" : "@@ -1,1 +42,46 @@\n@RunWith(EasyMockRunner.class)\npublic class TimestampedWindowStoreBuilderTest {\n\n    @Mock(type = MockType.NICE)"
  },
  {
    "id" : "2076be48-e6d7-4140-90a4-ad6d5f37d70f",
    "prId" : 6601,
    "prUrl" : "https://github.com/apache/kafka/pull/6601#pullrequestreview-228147749",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "75c490b1-8c62-487c-83a3-85718ce6a99b",
        "parentId" : null,
        "authorId" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "body" : "New test method (all other are just c&p from `WindowStoreBuilderTest`)",
        "createdAt" : "2019-04-18T08:01:33Z",
        "updatedAt" : "2019-04-29T22:01:48Z",
        "lastEditedBy" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "tags" : [
        ]
      }
    ],
    "commit" : "ddf4d0c71c9c70fa0a9c317c49768107b8cf4d9f",
    "line" : 119,
    "diffHunk" : "@@ -1,1 +117,121 @@\n    @Test\n    public void shouldNotWrapTimestampedByteStore() {\n        reset(supplier);\n        expect(supplier.get()).andReturn(new RocksDBTimestampedWindowStore("
  },
  {
    "id" : "d3f05b73-70c1-40de-bfb2-624a38ee8a84",
    "prId" : 6601,
    "prUrl" : "https://github.com/apache/kafka/pull/6601#pullrequestreview-228147781",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "61deaaba-dc34-4ea1-98cb-887232e113b3",
        "parentId" : null,
        "authorId" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "body" : "New test method (all other are just c&p from `WindowStoreBuilderTest`)",
        "createdAt" : "2019-04-18T08:01:38Z",
        "updatedAt" : "2019-04-29T22:01:48Z",
        "lastEditedBy" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "tags" : [
        ]
      }
    ],
    "commit" : "ddf4d0c71c9c70fa0a9c317c49768107b8cf4d9f",
    "line" : 141,
    "diffHunk" : "@@ -1,1 +139,143 @@\n    @Test\n    public void shouldWrapPlainKeyValueStoreAsTimestampStore() {\n        reset(supplier);\n        expect(supplier.get()).andReturn(new RocksDBWindowStore("
  },
  {
    "id" : "c6dfd798-7cae-40ad-b177-78c1da83fa35",
    "prId" : 8130,
    "prUrl" : "https://github.com/apache/kafka/pull/8130#pullrequestreview-393397387",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "df213702-105a-4961-851d-7b2639186d2f",
        "parentId" : null,
        "authorId" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "body" : "Where do we pass a `null` value? Also, where is the `MetricScope` in this test?",
        "createdAt" : "2020-04-04T17:19:45Z",
        "updatedAt" : "2020-10-07T16:02:14Z",
        "lastEditedBy" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "tags" : [
        ]
      },
      {
        "id" : "f06f8791-8e3d-40f2-8072-a6e68801b57d",
        "parentId" : "df213702-105a-4961-851d-7b2639186d2f",
        "authorId" : "462b08c4-4553-46cf-b1cf-8fd3349738fb",
        "body" : "`supplier#metricsScope()` returns `null`, for its `setUp()` configuration. It is same to `[KeyValueStoreBuilderTest, TimestampedKeyValueStoreBuilderTest]#shouldThrowNullPointerIfMetricsScopeIsNull`. `SessionStoreBuilderTest#shouldThrowNullPointerIfMetricsScopeIsNull` does same, but it also validates Exception message. (Wait, is this way more recommended?)",
        "createdAt" : "2020-04-13T17:19:23Z",
        "updatedAt" : "2020-10-07T16:02:14Z",
        "lastEditedBy" : "462b08c4-4553-46cf-b1cf-8fd3349738fb",
        "tags" : [
        ]
      },
      {
        "id" : "a05dfa0c-27e0-4c04-80a9-10d098582a38",
        "parentId" : "df213702-105a-4961-851d-7b2639186d2f",
        "authorId" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "body" : "Thanks for the clarification. However, I am still not sure if I understand this test. The constructor `TimestampedWindowStoreBuilder` does not call `supplier.metricsScope()` -- hence, it am still puzzled why this test would throw a NPE? To test `metricScope()` we would need to call `build()` method. In fact, following the call trace, we would never check if `metricScope()` returns `null` or not. Seems worth to fix... (maybe add a check in `MeteredWindowStore` constructor? -- not sure if the other `MeteredXxxStore` have a similar check. If not, would be good to add one.)\r\n\r\nSeems it comes from `supplier.name()` -- for this case, the test setup is incorrect -- also in the test above actually, that would also fail with `supplier.name()` NPE, but not with the NPE they want to test.\r\n\r\n> does same, but it also validates Exception message. (Wait, is this way more recommended?)\r\n\r\nYes, it's always recommended to verify the exception message to make sure we test the right think. Using `(expected = NullPointerException.class)` annotation is not ideal.\r\n",
        "createdAt" : "2020-04-14T05:37:09Z",
        "updatedAt" : "2020-10-07T16:02:14Z",
        "lastEditedBy" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "tags" : [
        ]
      },
      {
        "id" : "d66c07b9-1e91-4e1b-9421-aa9383cff692",
        "parentId" : "df213702-105a-4961-851d-7b2639186d2f",
        "authorId" : "462b08c4-4553-46cf-b1cf-8fd3349738fb",
        "body" : "@mjsax I reviewed the problem more carefully and concluded that you are right - the `NullPointerException` here is not related to `MetricScope`. We need to rewrite the series of tests.\r\n\r\nLet's review `TimestampedWindowStoreBuilderTest#shouldThrowNullPointerIfMetricsScopeIsNull` as an example. Here, `supplier#name` is `null` so when instantiating `TimestampedWindowStoreBuilder`, it fails in its parent class's constructor, `AbstractStoreBuilder` line 41 - `Objects.requireNonNull(name, \"name cannot be null\");`. It is also why `SessionStoreBuilderTest#shouldThrowNullPointerIfMetricsScopeIsNull` ends with a error message \"name cannot be null\" - obviously, it also has nothing to do with `MetricScope`.\r\n\r\nHere is the debugger status; As you can see, `supplier#name` is `null` here.\r\n\r\n![name-null](https://user-images.githubusercontent.com/2375128/79251817-a75b8b00-7ebb-11ea-9b1e-550d203c82df.png)\r\n\r\nI am now rewriting the tests. Stay tuned! :smile:",
        "createdAt" : "2020-04-14T16:58:22Z",
        "updatedAt" : "2020-10-07T16:02:14Z",
        "lastEditedBy" : "462b08c4-4553-46cf-b1cf-8fd3349738fb",
        "tags" : [
        ]
      },
      {
        "id" : "3f3206a6-3328-44fe-9c09-4c1b699e5ecf",
        "parentId" : "df213702-105a-4961-851d-7b2639186d2f",
        "authorId" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "body" : "Thanks! Highly appreciated!",
        "createdAt" : "2020-04-15T01:20:55Z",
        "updatedAt" : "2020-10-07T16:02:14Z",
        "lastEditedBy" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "tags" : [
        ]
      }
    ],
    "commit" : "9f7a73ff0e1027602e7590cea21e2c5973a76973",
    "line" : 21,
    "diffHunk" : "@@ -1,1 +204,208 @@\n    @Test\n    public void shouldThrowNullPointerIfMetricsScopeIsNull() {\n        reset(supplier);\n        expect(supplier.get()).andReturn(new RocksDBTimestampedWindowStore("
  }
]