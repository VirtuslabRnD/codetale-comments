[
  {
    "id" : "b6921285-1987-491c-afc6-b8c513943980",
    "prId" : 5567,
    "prUrl" : "https://github.com/apache/kafka/pull/5567#pullrequestreview-157752210",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "330182bf-71db-4baa-a763-0d2817a2c349",
        "parentId" : null,
        "authorId" : "4c968502-bb3d-46ee-8719-0c0bdbc6242f",
        "body" : "nit: do you need `cleanStateAfterTest`?   In  `getCleanStartedStreams` you already call `driver.cleanUp` and delete all topics in `cleanStateBeforeTest` ",
        "createdAt" : "2018-09-06T15:34:05Z",
        "updatedAt" : "2018-09-24T14:28:33Z",
        "lastEditedBy" : "4c968502-bb3d-46ee-8719-0c0bdbc6242f",
        "tags" : [
        ]
      },
      {
        "id" : "4c13a2c5-4469-492a-b27f-a37d1491eab4",
        "parentId" : "330182bf-71db-4baa-a763-0d2817a2c349",
        "authorId" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "body" : "It's a belt-and-suspenders thing. We want it at the end so that the tests don't leave garbage around (for example the last test). I also added it at the beginning just in case a prior run got forcibly killed and never had a chance to clean up.",
        "createdAt" : "2018-09-06T15:48:47Z",
        "updatedAt" : "2018-09-24T14:28:33Z",
        "lastEditedBy" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "tags" : [
        ]
      },
      {
        "id" : "57177d18-c48e-4d91-9e9c-3fea90eb279f",
        "parentId" : "330182bf-71db-4baa-a763-0d2817a2c349",
        "authorId" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "body" : "If you don't trust the regular cleanup, the question is why? Also, should we apply this patter to other tests, too?",
        "createdAt" : "2018-09-21T05:04:20Z",
        "updatedAt" : "2018-09-24T14:28:33Z",
        "lastEditedBy" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "tags" : [
        ]
      },
      {
        "id" : "2ef6f86e-561d-4495-bc60-3085f780ddc7",
        "parentId" : "330182bf-71db-4baa-a763-0d2817a2c349",
        "authorId" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "body" : "Specifically, the \"if\" I described above happens to me when I am debugging integration tests. If you set a breakpoint and then hit the \"stop\" button, it doesn't get a chance to run the normal \"after\" cleanup.\r\n\r\nDepending on whether the test uses a randomized state directory or not, this will either give you dirty state for the next run, or it'll just consume more and more disk space in `/tmp` until you run out. I have had both happen to me in the last few months.\r\n\r\nI do think we should use the same pattern for all the integration tests.",
        "createdAt" : "2018-09-21T15:50:06Z",
        "updatedAt" : "2018-09-24T14:28:33Z",
        "lastEditedBy" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "tags" : [
        ]
      }
    ],
    "commit" : "035b26310e76216b502839a6b9f22bf1fc75fee2",
    "line" : 168,
    "diffHunk" : "@@ -1,1 +166,170 @@    }\n\n    private void cleanStateAfterTest(final KafkaStreams driver) throws InterruptedException {\n        driver.cleanUp();\n        CLUSTER.deleteAllTopicsAndWait(30_000L);"
  }
]