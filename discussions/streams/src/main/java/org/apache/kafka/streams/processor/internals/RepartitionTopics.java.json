[
  {
    "id" : "d8a8d822-81f0-4647-a399-ba0489eda47a",
    "prId" : 9848,
    "prUrl" : "https://github.com/apache/kafka/pull/9848#pullrequestreview-569402989",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "217d1047-907a-41bf-ae0f-cedee64567d7",
        "parentId" : null,
        "authorId" : "114424ac-2f76-47ba-b653-f85692b08607",
        "body" : "Is there a reason you renamed this from `computeRepartitionTopicMetadata` to `computeRepartitionTopicConfig`? ",
        "createdAt" : "2021-01-12T14:06:52Z",
        "updatedAt" : "2021-01-22T10:23:23Z",
        "lastEditedBy" : "114424ac-2f76-47ba-b653-f85692b08607",
        "tags" : [
        ]
      },
      {
        "id" : "30c177d1-76d8-44c5-9b4f-12ab5c2a22e4",
        "parentId" : "217d1047-907a-41bf-ae0f-cedee64567d7",
        "authorId" : "b7cbfdaf-f3e2-4130-8254-501ace9562ac",
        "body" : "I thought since the returned value is a bunch of configs `computeRepartitionTopicConfig()` would be more precise.   ",
        "createdAt" : "2021-01-15T16:19:11Z",
        "updatedAt" : "2021-01-22T10:23:23Z",
        "lastEditedBy" : "b7cbfdaf-f3e2-4130-8254-501ace9562ac",
        "tags" : [
        ]
      }
    ],
    "commit" : "f29d690be323c3fed3a9dabd7b29d84a24c4f72b",
    "line" : 93,
    "diffHunk" : "@@ -1,1 +91,95 @@    }\n\n    private Map<String, InternalTopicConfig> computeRepartitionTopicConfig(final Map<Integer, TopicsInfo> topicGroups,\n                                                                           final Cluster clusterMetadata) {\n"
  },
  {
    "id" : "ac1babc5-8831-41ab-9205-c18a91d3d9f9",
    "prId" : 9848,
    "prUrl" : "https://github.com/apache/kafka/pull/9848#pullrequestreview-566663892",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2e86f934-4c86-4f96-a377-c4133ca03f02",
        "parentId" : null,
        "authorId" : "114424ac-2f76-47ba-b653-f85692b08607",
        "body" : "Maybe I'm missing something, but it looks like we want to go through the `do` loop again if we have null partitions, but in this case wouldn't we hit the if statement below and throw an exception, since at this point `partitionCountNeeded == True` and `progressMadeThisIteration == False` ? Or does that just log an exception and continue through the `do` loop?",
        "createdAt" : "2021-01-12T14:16:56Z",
        "updatedAt" : "2021-01-22T10:23:23Z",
        "lastEditedBy" : "114424ac-2f76-47ba-b653-f85692b08607",
        "tags" : [
        ]
      },
      {
        "id" : "c9e70564-aa2b-417e-9a1c-68783c2f35ed",
        "parentId" : "2e86f934-4c86-4f96-a377-c4133ca03f02",
        "authorId" : "d97f50bf-60f9-45b3-81a0-a24a5f42f740",
        "body" : "@lct45 sort of; the point of `progressMadeThisIteration` is to break out of the loop entirely if we detect that we're infinitely looping, as was the case in a recent-ish bug. We want to continue looping only as long as we're actually gaining new information/filling in the partition count of some topic group (subtopology). \r\n\r\nSo yes, if `progressMadeThisIteration = false` after the full loop, but we still don't have all the partition counts (`partitionCountNeeded = true`), then oh well. Something went wrong ðŸ™‚  We should throw",
        "createdAt" : "2021-01-13T03:26:34Z",
        "updatedAt" : "2021-01-22T10:23:23Z",
        "lastEditedBy" : "d97f50bf-60f9-45b3-81a0-a24a5f42f740",
        "tags" : [
        ]
      }
    ],
    "commit" : "f29d690be323c3fed3a9dabd7b29d84a24c4f72b",
    "line" : 154,
    "diffHunk" : "@@ -1,1 +152,156 @@                        if (numPartitions == null) {\n                            partitionCountNeeded = true;\n                            log.trace(\"Unable to determine number of partitions for {}, another iteration is needed\",\n                                repartitionSourceTopic);\n                        } else {"
  },
  {
    "id" : "cb313a11-b3b4-4e4c-a49f-88fbc03c92eb",
    "prId" : 9848,
    "prUrl" : "https://github.com/apache/kafka/pull/9848#pullrequestreview-574128278",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "622da755-d5ee-4360-95dc-53023403c707",
        "parentId" : null,
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "Not related to this PR: when reading the `makeReady` code again, I feel that the way we get the retries config by first constructing a dummy admin client can be simplified. Also, it is debatable that if we only do verify, then do we really need to retry or not since the admin client itself already retries internally.",
        "createdAt" : "2021-01-19T05:12:04Z",
        "updatedAt" : "2021-01-22T10:23:23Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      },
      {
        "id" : "09e30cbd-44c4-4e02-a68a-0a71aa0469ac",
        "parentId" : "622da755-d5ee-4360-95dc-53023403c707",
        "authorId" : "b7cbfdaf-f3e2-4130-8254-501ace9562ac",
        "body" : "I think we should keep this in mind. For this ticket, we need to touch `makeReady()` anyways, because we need to separate verification from creation.",
        "createdAt" : "2021-01-22T10:21:02Z",
        "updatedAt" : "2021-01-22T10:23:23Z",
        "lastEditedBy" : "b7cbfdaf-f3e2-4130-8254-501ace9562ac",
        "tags" : [
        ]
      }
    ],
    "commit" : "f29d690be323c3fed3a9dabd7b29d84a24c4f72b",
    "line" : 72,
    "diffHunk" : "@@ -1,1 +70,74 @@        // make sure the repartition source topics exist with the right number of partitions,\n        // create these topics if necessary\n        internalTopicManager.makeReady(repartitionTopicMetadata);\n\n        // augment the metadata with the newly computed number of partitions for all the"
  }
]