[
  {
    "id" : "90c85c60-9f4c-4be5-a646-f10b0aba9fa5",
    "prId" : 4917,
    "prUrl" : "https://github.com/apache/kafka/pull/4917#pullrequestreview-115230587",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "76b14e5f-81d4-4730-a65b-21d642716987",
        "parentId" : null,
        "authorId" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "body" : "`cacheName` is created in `nameSpaceFromTaskIdAndStore` in L84 by concatenating the `taskID` and the `underlyingStoreName` with a `\"-\"`. So when we take them back apart, we should just split on hyphen *once*. Previously, this would split on *every* hyphen, returning only the part of the store name up to the first hyphen. This is a problem since store names may contain hyphens.\r\n\r\nThe result is that all named caches for stores with the same prefix (like \"agg-store\" and \"agg-STATE_STORE_000000\") will both try to create metrics with a storeName of just \"agg\".\r\n\r\nWe never noticed before because all NamedCaches were actually just creating one sensor, and it's ok to register duplicate metrics on the same sensor. Once I split the sensors up, it threw an exception on the duplicate metrics.",
        "createdAt" : "2018-04-23T22:18:45Z",
        "updatedAt" : "2018-04-26T15:11:24Z",
        "lastEditedBy" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "tags" : [
        ]
      },
      {
        "id" : "8e5e678a-9751-434f-a751-1b227a065158",
        "parentId" : "76b14e5f-81d4-4730-a65b-21d642716987",
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "Great catch, thanks @vvcephei !",
        "createdAt" : "2018-04-24T20:27:38Z",
        "updatedAt" : "2018-04-26T15:11:24Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      },
      {
        "id" : "724f3ad7-ee03-40c8-942e-72d83cc31265",
        "parentId" : "76b14e5f-81d4-4730-a65b-21d642716987",
        "authorId" : "4c968502-bb3d-46ee-8719-0c0bdbc6242f",
        "body" : "seems reasonable to me",
        "createdAt" : "2018-04-25T15:31:52Z",
        "updatedAt" : "2018-04-26T15:11:25Z",
        "lastEditedBy" : "4c968502-bb3d-46ee-8719-0c0bdbc6242f",
        "tags" : [
        ]
      }
    ],
    "commit" : "613a2e2a113646978725340b1500f491115e3d31",
    "line" : 42,
    "diffHunk" : "@@ -1,1 +102,106 @@     */\n    public static String underlyingStoreNamefromCacheName(final String cacheName) {\n        String[] tokens = cacheName.split(\"-\", 2);\n        return tokens[1];\n    }"
  },
  {
    "id" : "88cf8a20-9e48-4817-ad34-d9a5a9d19382",
    "prId" : 4917,
    "prUrl" : "https://github.com/apache/kafka/pull/4917#pullrequestreview-114572875",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8d675c86-cae0-4f58-9c31-1b8be05ee146",
        "parentId" : null,
        "authorId" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "body" : "This isn't actually a problem, but I did it for consistency with the other change.",
        "createdAt" : "2018-04-23T22:19:16Z",
        "updatedAt" : "2018-04-26T15:11:24Z",
        "lastEditedBy" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "tags" : [
        ]
      }
    ],
    "commit" : "613a2e2a113646978725340b1500f491115e3d31",
    "line" : 33,
    "diffHunk" : "@@ -1,1 +92,96 @@     */\n    public static String taskIDfromCacheName(final String cacheName) {\n        String[] tokens = cacheName.split(\"-\", 2);\n        return tokens[0];\n    }"
  },
  {
    "id" : "f4a3c1da-6a2c-4afd-aec7-158553a44315",
    "prId" : 9615,
    "prUrl" : "https://github.com/apache/kafka/pull/9615#pullrequestreview-542209403",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c4ca9998-03f5-4d5f-85bc-e4cf23e5308d",
        "parentId" : null,
        "authorId" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "body" : "Why this check?",
        "createdAt" : "2020-12-01T02:26:12Z",
        "updatedAt" : "2020-12-03T19:19:50Z",
        "lastEditedBy" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "tags" : [
        ]
      },
      {
        "id" : "3611974b-9854-4d85-a7a1-448b73806bae",
        "parentId" : "c4ca9998-03f5-4d5f-85bc-e4cf23e5308d",
        "authorId" : "e4e906b3-d01a-4fe6-ad3e-ccca19a6df5c",
        "body" : "Apparently `CircularIterators` throw an error if they are made on empty lists. And if there are no caches to resize we don't need to bother with the rest of this.",
        "createdAt" : "2020-12-01T17:23:30Z",
        "updatedAt" : "2020-12-03T19:19:50Z",
        "lastEditedBy" : "e4e906b3-d01a-4fe6-ad3e-ccca19a6df5c",
        "tags" : [
        ]
      },
      {
        "id" : "e015dc2c-26dc-4b5e-8280-70b02f48b110",
        "parentId" : "c4ca9998-03f5-4d5f-85bc-e4cf23e5308d",
        "authorId" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "body" : "I see -- so it's a bug fix on the side (not directly related to this RP) -- the original PR that added this method should have added this check.",
        "createdAt" : "2020-12-01T18:31:22Z",
        "updatedAt" : "2020-12-03T19:19:50Z",
        "lastEditedBy" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "tags" : [
        ]
      },
      {
        "id" : "bd22fbfd-efce-4233-bd5d-e8a98723c6cb",
        "parentId" : "c4ca9998-03f5-4d5f-85bc-e4cf23e5308d",
        "authorId" : "e4e906b3-d01a-4fe6-ad3e-ccca19a6df5c",
        "body" : "yeah, I didn't realize this was a problem, but when I added more test coverage it showed up",
        "createdAt" : "2020-12-01T19:13:11Z",
        "updatedAt" : "2020-12-03T19:19:50Z",
        "lastEditedBy" : "e4e906b3-d01a-4fe6-ad3e-ccca19a6df5c",
        "tags" : [
        ]
      }
    ],
    "commit" : "af3e5674f77037796801afcd445e126c1aa7f6b0",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +77,81 @@        maxCacheSizeBytes = newCacheSizeBytes;\n        if (shrink) {\n            if (caches.values().isEmpty()) {\n                return;\n            }"
  }
]