[
  {
    "id" : "22b89f96-d491-4d7a-aa3c-1947ffdc1fcf",
    "prId" : 7238,
    "prUrl" : "https://github.com/apache/kafka/pull/7238#pullrequestreview-286897280",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a002ba66-09e9-475d-8c9e-e972d86acfd1",
        "parentId" : null,
        "authorId" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "body" : "Seems we should add `AssignedStandbyTasksTest.java` to unit test the new `commit()` behavior.",
        "createdAt" : "2019-09-06T19:01:13Z",
        "updatedAt" : "2019-09-11T16:35:57Z",
        "lastEditedBy" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "tags" : [
        ]
      },
      {
        "id" : "fac88b87-07b0-434f-83f4-21cc68c090e6",
        "parentId" : "a002ba66-09e9-475d-8c9e-e972d86acfd1",
        "authorId" : "12543f19-3885-429e-8f77-e0f748c56d1f",
        "body" : "We could add a test here, but it is super implementation specific. This is not really the best home for the code, just the most convenient at the moment. All we would test, I think, is that we called allowUpdateOfOffsetLimit? The integration test covers this in a more comprehensive way and doesn't break when we move this code. What do you think?",
        "createdAt" : "2019-09-06T19:30:35Z",
        "updatedAt" : "2019-09-11T16:35:57Z",
        "lastEditedBy" : "12543f19-3885-429e-8f77-e0f748c56d1f",
        "tags" : [
        ]
      },
      {
        "id" : "15b70d7b-e101-408e-8abe-25a163e088c5",
        "parentId" : "a002ba66-09e9-475d-8c9e-e972d86acfd1",
        "authorId" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "body" : "> All we would test, I think, is that we called allowUpdateOfOffsetLimit?\r\n\r\nYes, the test should be `shouldUpdateOffsetsLimtOnCommit()`.\r\n\r\n> The integration test covers this in a more comprehensive way and doesn't break when we move this code.\r\n\r\n\"and _doesn't_ break\" -- I guess it should break? The main purpose of the unit test is, that is would be hard to debug the integration test and figure out the root cause why it fails.",
        "createdAt" : "2019-09-10T23:18:25Z",
        "updatedAt" : "2019-09-11T16:35:57Z",
        "lastEditedBy" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "tags" : [
        ]
      },
      {
        "id" : "b9a57c72-5d0e-4727-8d4f-4f42e2ba3692",
        "parentId" : "a002ba66-09e9-475d-8c9e-e972d86acfd1",
        "authorId" : "12543f19-3885-429e-8f77-e0f748c56d1f",
        "body" : "I added back the StandbyTask tests that will cover this with a much more narrow test - specifically to cover when to update the offset limit. If this gets moved into StandbyTask that test should not fail, provided it was done right. If it's broken in any way that test will flag it and it should be easy to look at the test failure and the changed code to determine the cause.\r\n\r\nDo you think StandbyTaskTest sufficiently addresses your concern?",
        "createdAt" : "2019-09-11T15:53:45Z",
        "updatedAt" : "2019-09-11T16:35:57Z",
        "lastEditedBy" : "12543f19-3885-429e-8f77-e0f748c56d1f",
        "tags" : [
        ]
      }
    ],
    "commit" : "0b14fbdce1f31b17070923325715f68c0238d43d",
    "line" : 11,
    "diffHunk" : "@@ -1,1 +32,36 @@        // we only call commit if commitNeeded is true, which means that we need a way to indicate\n        // that we are eligible for updating the offset limit outside of commit.\n        running.forEach((id, task) -> task.allowUpdateOfOffsetLimit());\n        return committed;\n    }"
  }
]