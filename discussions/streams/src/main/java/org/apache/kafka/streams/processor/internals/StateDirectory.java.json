[
  {
    "id" : "0dd7e1f8-f0ad-4986-a4a6-20f2baae5da6",
    "prId" : 8246,
    "prUrl" : "https://github.com/apache/kafka/pull/8246#pullrequestreview-375603317",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "12f1b9bb-ea18-4837-a378-f840608e61ec",
        "parentId" : null,
        "authorId" : "b7cbfdaf-f3e2-4130-8254-501ace9562ac",
        "body" : "One last thing: Could you open another PR to add unit tests that check that the array is empty for the two edge cases?  ",
        "createdAt" : "2020-03-15T17:46:04Z",
        "updatedAt" : "2020-03-15T17:46:04Z",
        "lastEditedBy" : "b7cbfdaf-f3e2-4130-8254-501ace9562ac",
        "tags" : [
        ]
      },
      {
        "id" : "09497014-1eb6-4d50-ac37-5de06a2a7f16",
        "parentId" : "12f1b9bb-ea18-4837-a378-f840608e61ec",
        "authorId" : "d97f50bf-60f9-45b3-81a0-a24a5f42f740",
        "body" : "Ack, added the tests to the Pt 2.5 PR",
        "createdAt" : "2020-03-16T18:58:38Z",
        "updatedAt" : "2020-03-16T18:58:38Z",
        "lastEditedBy" : "d97f50bf-60f9-45b3-81a0-a24a5f42f740",
        "tags" : [
        ]
      },
      {
        "id" : "7268f119-1e24-49b1-bf71-5b1a6e486319",
        "parentId" : "12f1b9bb-ea18-4837-a378-f840608e61ec",
        "authorId" : "d97f50bf-60f9-45b3-81a0-a24a5f42f740",
        "body" : "Actually, ended up doing some additional cleanup on the side so I split it out into a  small PR; please give this a quick review.\r\nhttps://github.com/apache/kafka/pull/8304",
        "createdAt" : "2020-03-16T21:44:51Z",
        "updatedAt" : "2020-03-16T21:44:51Z",
        "lastEditedBy" : "d97f50bf-60f9-45b3-81a0-a24a5f42f740",
        "tags" : [
        ]
      }
    ],
    "commit" : "a757918bbbf7c4b27aa29720e540a5603f890b1e",
    "line" : 31,
    "diffHunk" : "@@ -1,1 +349,353 @@     * @return The list of all the existing local directories for stream tasks\n     */\n    File[] listTaskDirectories() {\n        final File[] taskDirectories =\n            stateDir.listFiles(pathname -> pathname.isDirectory() && PATH_NAME.matcher(pathname.getName()).matches());"
  },
  {
    "id" : "2d24e2f9-5948-4cd3-887c-10e285ca9ca0",
    "prId" : 8267,
    "prUrl" : "https://github.com/apache/kafka/pull/8267#pullrequestreview-372383538",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f34ca5bf-4256-4ed1-b3a0-02e55142cfa8",
        "parentId" : null,
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "This is a minor code clean up.",
        "createdAt" : "2020-03-10T23:15:05Z",
        "updatedAt" : "2020-03-14T20:47:01Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      }
    ],
    "commit" : "e76956090f1b8010efb5b1be9dc7a24a7b9884a6",
    "line" : 199,
    "diffHunk" : "@@ -1,1 +333,337 @@                        }\n                    }\n                } catch (final OverlappingFileLockException | IOException e) {\n                    exception = e;\n                } finally {"
  },
  {
    "id" : "2eb7eccb-584f-438c-aeda-1bc23af0030d",
    "prId" : 8267,
    "prUrl" : "https://github.com/apache/kafka/pull/8267#pullrequestreview-374518933",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9ae003a2-bfc8-40f2-be35-dbf9e85e3d3f",
        "parentId" : null,
        "authorId" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "body" : "This comment makes me wonder why we even bother with locking at all for manual calls. If we know thereâ€™s no app running, why not just delete the whole state directory and not bother with locks? ",
        "createdAt" : "2020-03-13T04:16:48Z",
        "updatedAt" : "2020-03-14T20:47:01Z",
        "lastEditedBy" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "tags" : [
        ]
      },
      {
        "id" : "163b80b6-1087-4260-8595-ea0056b9a06c",
        "parentId" : "9ae003a2-bfc8-40f2-be35-dbf9e85e3d3f",
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "I thought about that too, and tried it out, it's just that based on manualUserCall to decide whether `lock / unlock` the block, we ended up with either much more code duplicates or clumsy and finer-grained `if else` condition, neither of which I like. On the other hand, since `streams.cleanUp` is usually a one-time thing compared with the periodic internal clean I think having two delete calls are okay to same some code duplication here.",
        "createdAt" : "2020-03-13T16:44:30Z",
        "updatedAt" : "2020-03-14T20:47:01Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      },
      {
        "id" : "e3b72747-7406-40e5-a505-8222d89c6a53",
        "parentId" : "9ae003a2-bfc8-40f2-be35-dbf9e85e3d3f",
        "authorId" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "body" : "Ok!",
        "createdAt" : "2020-03-13T18:20:30Z",
        "updatedAt" : "2020-03-14T20:47:01Z",
        "lastEditedBy" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "tags" : [
        ]
      }
    ],
    "commit" : "e76956090f1b8010efb5b1be9dc7a24a7b9884a6",
    "line" : 207,
    "diffHunk" : "@@ -1,1 +339,343 @@                        unlock(id);\n\n                        // for manual user call, stream threads are not running so it is safe to delete\n                        // the whole directory\n                        if (manualUserCall) {"
  }
]