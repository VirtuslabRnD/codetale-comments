[
  {
    "id" : "634dbb3f-b404-45aa-ae70-68ffaca2bf32",
    "prId" : 6667,
    "prUrl" : "https://github.com/apache/kafka/pull/6667#pullrequestreview-236371778",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e3db7aba-84ad-45c8-8c57-96a59dc2df6a",
        "parentId" : null,
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "Today we store the timestamp in cache entry and upon flushing we call `entry.entry().context().timestamp()` to set the timestamp. Would that be replaced with the underlying store's timestamp then?",
        "createdAt" : "2019-05-07T22:39:40Z",
        "updatedAt" : "2019-05-11T12:26:17Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      },
      {
        "id" : "82a040ec-5080-4be2-aa3c-e3bdb6844103",
        "parentId" : "e3db7aba-84ad-45c8-8c57-96a59dc2df6a",
        "authorId" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "body" : "Maybe. After the store refactoring, I realized that we might actually be able to revert https://github.com/apache/kafka/pull/6147 -- however, I would prefer to do this as cleanup only after everything else is merged (to make sure it's really safe).",
        "createdAt" : "2019-05-08T12:21:20Z",
        "updatedAt" : "2019-05-11T12:26:17Z",
        "lastEditedBy" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "tags" : [
        ]
      },
      {
        "id" : "1fdec223-bde3-49ad-9b77-30e3f46e4f9c",
        "parentId" : "e3db7aba-84ad-45c8-8c57-96a59dc2df6a",
        "authorId" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "body" : "While working on a follow PR, I figure out the details. The `TimestampedForwardingCacheFlushListener` needs to extract the timestamp from the value, and set it as record timestamp. Similar to `SessionCacheFlushListener` in another PR: https://github.com/apache/kafka/pull/6645/files#diff-4039efe54e3b87d65c20bd7d14c1b149R43",
        "createdAt" : "2019-05-11T10:28:49Z",
        "updatedAt" : "2019-05-11T12:26:17Z",
        "lastEditedBy" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "tags" : [
        ]
      }
    ],
    "commit" : "21e5dee3c8c50f5d8d88ce0f1b78b351e30768ba",
    "line" : 62,
    "diffHunk" : "@@ -1,1 +95,99 @@\n            // update the store with the new value\n            store.put(key, ValueAndTimestamp.make(newAgg, context().timestamp()));\n            tupleForwarder.maybeForward(key, newAgg, sendOldValues ? oldAgg : null);\n        }"
  }
]