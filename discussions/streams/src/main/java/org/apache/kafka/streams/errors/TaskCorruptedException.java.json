[
  {
    "id" : "d93a0ae1-7f00-44c4-85c0-14364ced4070",
    "prId" : 8058,
    "prUrl" : "https://github.com/apache/kafka/pull/8058#pullrequestreview-354871741",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a65dbd74-9e33-4385-ab0a-34142afe3eb4",
        "parentId" : null,
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "This case 1) would be done in another PR, I just added the java-doc here to complete the scope.",
        "createdAt" : "2020-02-07T00:49:48Z",
        "updatedAt" : "2020-02-20T23:04:08Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      }
    ],
    "commit" : "03f4778cba8697bad6e5c5d7ce40df6e59214c02",
    "line" : 28,
    "diffHunk" : "@@ -1,1 +26,30 @@ * Indicates a specific task is corrupted and need to be re-initialized. It can be thrown when\n *\n * 1) Under EOS, if the checkpoint file does not contain offsets for corresponding store's changelogs, meaning\n *    previously it was not close cleanly;\n * 2) Out-of-range exception thrown during restoration, meaning that the changelog has been modified and we re-bootstrap"
  },
  {
    "id" : "ef49256d-7020-4887-98f0-9267ac6772ef",
    "prId" : 8058,
    "prUrl" : "https://github.com/apache/kafka/pull/8058#pullrequestreview-356266451",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "91df1c35-ce70-491e-bc6d-f72af39886b2",
        "parentId" : null,
        "authorId" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "body" : "Just now having this thought... Supposing this happens, is it guaranteed to apply to all the stores in the task? I.e., do we really need to re-bootstrap all the stores, or just the one(s) for which our offset is out of range?",
        "createdAt" : "2020-02-08T04:20:08Z",
        "updatedAt" : "2020-02-20T23:04:08Z",
        "lastEditedBy" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "tags" : [
        ]
      },
      {
        "id" : "0b0c31e4-4747-4021-b497-b63348ab82eb",
        "parentId" : "91df1c35-ce70-491e-bc6d-f72af39886b2",
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "Yes, we can re-bootstrap the state stores only -- this is what we did in the past but that was a lot messier (remember we have to use the optional in fixed-order map? :P). My thoughts are that for non-EOS, the checkpoint file would likely exist so even re-bootstrap the whole task would be okay, for EOS, it is safer to re-bootstrap the whole task.",
        "createdAt" : "2020-02-08T07:12:00Z",
        "updatedAt" : "2020-02-20T23:04:08Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      },
      {
        "id" : "1947101b-581a-418d-ba73-8a5efa9d98f1",
        "parentId" : "91df1c35-ce70-491e-bc6d-f72af39886b2",
        "authorId" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "body" : "It's certainly safer, but the performance hit seems concerning... restoration i/o is already one of the things people complain about most, and this choice could amplify it multiple times over.\r\n\r\nMaybe we can handle it more cleanly by closing all the stores nicely, writing a checkpoint file with the out-of-range stores' checkpoints at 0, and then re-bootstrapping the task, so it only has to restore the broken stores?",
        "createdAt" : "2020-02-10T15:13:25Z",
        "updatedAt" : "2020-02-20T23:04:08Z",
        "lastEditedBy" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "tags" : [
        ]
      },
      {
        "id" : "bbecdcdc-fd88-4069-9a73-cf6344e1eb48",
        "parentId" : "91df1c35-ce70-491e-bc6d-f72af39886b2",
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "That sounds a good idea. Let me try it out.",
        "createdAt" : "2020-02-10T21:12:27Z",
        "updatedAt" : "2020-02-20T23:04:08Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      }
    ],
    "commit" : "03f4778cba8697bad6e5c5d7ce40df6e59214c02",
    "line" : 30,
    "diffHunk" : "@@ -1,1 +28,32 @@ * 1) Under EOS, if the checkpoint file does not contain offsets for corresponding store's changelogs, meaning\n *    previously it was not close cleanly;\n * 2) Out-of-range exception thrown during restoration, meaning that the changelog has been modified and we re-bootstrap\n *    the store.\n */"
  }
]