[
  {
    "id" : "a1487cab-b771-4ba5-88f4-b0e91e3fdc61",
    "prId" : 7954,
    "prUrl" : "https://github.com/redis/redis/pull/7954#pullrequestreview-540344389",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f3ffc8c5-fd69-4db5-91cd-8857b2b19f97",
        "parentId" : null,
        "authorId" : "4c4e22a4-3f0d-4f25-9809-81320210dfb6",
        "body" : "You forgot to change the comment \"we resize doubling the number of buckets\"\r\n\r\n```c\r\n/* If we reached the 1:1 ratio, and we are allowed to resize the hash\r\n     * table (global setting) or we should avoid it but the ratio between\r\n     * elements/buckets is over the \"safe\" threshold, we resize doubling\r\n     * the number of buckets. */\r\n```",
        "createdAt" : "2020-11-26T01:45:44Z",
        "updatedAt" : "2020-12-06T09:33:53Z",
        "lastEditedBy" : "4c4e22a4-3f0d-4f25-9809-81320210dfb6",
        "tags" : [
        ]
      },
      {
        "id" : "8b4da9dd-9d30-4856-84c2-665950e4b8a7",
        "parentId" : "f3ffc8c5-fd69-4db5-91cd-8857b2b19f97",
        "authorId" : "98e31153-705f-4299-a152-78c428055d23",
        "body" : "Hi @sundb Actually, before this commit, resizing dict is not expected, new hash table size may `*4` old table size,  oran has been explained https://github.com/redis/redis/pull/7954#issuecomment-725544359",
        "createdAt" : "2020-11-26T11:38:16Z",
        "updatedAt" : "2020-12-06T09:33:53Z",
        "lastEditedBy" : "98e31153-705f-4299-a152-78c428055d23",
        "tags" : [
        ]
      },
      {
        "id" : "cf555a26-801f-4379-a80f-3be0aa38bfef",
        "parentId" : "f3ffc8c5-fd69-4db5-91cd-8857b2b19f97",
        "authorId" : "4c4e22a4-3f0d-4f25-9809-81320210dfb6",
        "body" : "@ShooterIT You misunderstood, I meant to change comment \"we resize doubling the number of buckets.\" to \"we add 1 to the number of buckets\"",
        "createdAt" : "2020-11-26T12:18:18Z",
        "updatedAt" : "2020-12-06T09:33:53Z",
        "lastEditedBy" : "4c4e22a4-3f0d-4f25-9809-81320210dfb6",
        "tags" : [
        ]
      },
      {
        "id" : "de15251f-df32-41cd-b6d9-fb9a5f4fae0a",
        "parentId" : "f3ffc8c5-fd69-4db5-91cd-8857b2b19f97",
        "authorId" : "98e31153-705f-4299-a152-78c428055d23",
        "body" : "@sundb `used` is not the number of buckets.\r\nSince first check `used >= size` and we will call _dictNextPower(used+1) in `dictExpand`, new table size will be double of the number of buckets in most cases.",
        "createdAt" : "2020-11-27T16:48:23Z",
        "updatedAt" : "2020-12-06T09:33:53Z",
        "lastEditedBy" : "98e31153-705f-4299-a152-78c428055d23",
        "tags" : [
        ]
      },
      {
        "id" : "382713fe-806d-4cb7-8e4f-da5c0c14f7f2",
        "parentId" : "f3ffc8c5-fd69-4db5-91cd-8857b2b19f97",
        "authorId" : "4c4e22a4-3f0d-4f25-9809-81320210dfb6",
        "body" : "@ShooterIT So that's it, thank you.",
        "createdAt" : "2020-11-28T05:33:06Z",
        "updatedAt" : "2020-12-06T09:33:53Z",
        "lastEditedBy" : "4c4e22a4-3f0d-4f25-9809-81320210dfb6",
        "tags" : [
        ]
      }
    ],
    "commit" : "20d8a8e678e802cd8f14a4bd44e8540531bd46f7",
    "line" : 26,
    "diffHunk" : "@@ -1,1 +980,984 @@        dictTypeExpandAllowed(d))\n    {\n        return dictExpand(d, d->ht[0].used + 1);\n    }\n    return DICT_OK;"
  }
]