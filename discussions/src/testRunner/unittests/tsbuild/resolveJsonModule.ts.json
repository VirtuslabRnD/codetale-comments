[
  {
    "id" : "9e9c469c-dd78-4de2-92bd-468033073cb9",
    "prId" : 32372,
    "prUrl" : "https://github.com/microsoft/TypeScript/pull/32372#pullrequestreview-293234727",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c553b2f2-9696-4775-ae96-0e776cb42409",
        "parentId" : null,
        "authorId" : "cb16561c-58c1-4f0a-a738-613be01155c9",
        "body" : "I think for the files where .json file will not be written we should also skip .d.ts write for that file.. Because if its written at same location in most config files `.d.ts` takes preference over `.json` but module resolution picks up `.json` file thus we now get both files?\r\n```\r\nc:\\temp\\test4>dir\r\n Volume in drive C is OSDisk\r\n Volume Serial Number is F41A-DBC9\r\n\r\n Directory of c:\\temp\\test4\r\n\r\n09/25/2019  08:37 AM    <DIR>          .\r\n09/25/2019  08:37 AM    <DIR>          ..\r\n09/25/2019  08:32 AM                43 a.js\r\n09/25/2019  08:31 AM                31 a.ts\r\n09/25/2019  08:31 AM                 0 b.d.ts\r\n09/25/2019  08:30 AM                 2 b.json\r\n09/25/2019  08:32 AM                72 tsconfig.json\r\n               5 File(s)            148 bytes\r\n               2 Dir(s)  798,188,781,568 bytes free\r\n\r\nc:\\temp\\test4>node c:\\TypeScript\\built\\local\\tsc.js --listFiles\r\nc:/TypeScript/built/local/lib.d.ts\r\nc:/TypeScript/built/local/lib.es5.d.ts\r\nc:/TypeScript/built/local/lib.dom.d.ts\r\nc:/TypeScript/built/local/lib.webworker.importscripts.d.ts\r\nc:/TypeScript/built/local/lib.scripthost.d.ts\r\nc:/temp/test4/b.json\r\nc:/temp/test4/a.ts\r\nc:/temp/test4/b.d.ts\r\n```",
        "createdAt" : "2019-09-25T15:37:44Z",
        "updatedAt" : "2019-09-26T21:10:12Z",
        "lastEditedBy" : "cb16561c-58c1-4f0a-a738-613be01155c9",
        "tags" : [
        ]
      },
      {
        "id" : "73352197-035d-4662-a6fd-2114cf9d2013",
        "parentId" : "c553b2f2-9696-4775-ae96-0e776cb42409",
        "authorId" : "f7813195-22a2-4200-9f53-7aadb83a2cc9",
        "body" : "What do you mean by \"we now get both\"? An import is only going to resolve to one of them.",
        "createdAt" : "2019-09-25T16:40:16Z",
        "updatedAt" : "2019-09-26T21:10:12Z",
        "lastEditedBy" : "f7813195-22a2-4200-9f53-7aadb83a2cc9",
        "tags" : [
        ]
      },
      {
        "id" : "6a9bb965-d179-4343-a27f-e41971b83c69",
        "parentId" : "c553b2f2-9696-4775-ae96-0e776cb42409",
        "authorId" : "cb16561c-58c1-4f0a-a738-613be01155c9",
        "body" : "Yes import is going to resolve to `b.json` in this case but b.d.ts which is output of `b.json` will also be part of the project. So my program has more files after I compile for the first time? So question is do we emit `b.json.d.ts` instead of `b.d.ts` or not emit b.d.ts if json file is not going to be emitted?",
        "createdAt" : "2019-09-25T16:47:37Z",
        "updatedAt" : "2019-09-26T21:10:12Z",
        "lastEditedBy" : "cb16561c-58c1-4f0a-a738-613be01155c9",
        "tags" : [
        ]
      },
      {
        "id" : "0cfa8a75-32f1-4a2d-b0b6-cd0556684e5b",
        "parentId" : "c553b2f2-9696-4775-ae96-0e776cb42409",
        "authorId" : "f7813195-22a2-4200-9f53-7aadb83a2cc9",
        "body" : "We definitely emit the declaration and don't issue an error - it'd be super annoying if `require`ing your own `package.json` broke incremental for your project. Still, I'm not getting it - once the declaration file is emitted, the sibling files are going to resolve to either the original json, _or_ the declaration file (not both). So how do both even get included in the project? It's not materially different than emitting a `.d.ts` alongside a `.ts` file, imo.",
        "createdAt" : "2019-09-25T17:14:39Z",
        "updatedAt" : "2019-09-26T21:10:12Z",
        "lastEditedBy" : "f7813195-22a2-4200-9f53-7aadb83a2cc9",
        "tags" : [
        ]
      }
    ],
    "commit" : "007b3d4afe7726f7b72cd617e5453c8943e48ad2",
    "line" : 9,
    "diffHunk" : "@@ -1,1 +57,61 @@                \"/src/tsconfig_withIncludeOfJson.json\",\n                allExpectedOutputs,\n                errorDiagnostic([Diagnostics.Cannot_write_file_0_because_it_would_be_overwritten_by_multiple_input_files, \"/src/dist/src/index.d.ts\"])\n            );\n        });"
  },
  {
    "id" : "a067ce25-6ca9-40a8-b189-46e663b95788",
    "prId" : 32372,
    "prUrl" : "https://github.com/microsoft/TypeScript/pull/32372#pullrequestreview-293342129",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "69a1a2b6-1aaf-4b04-a7c0-2e982bda996c",
        "parentId" : null,
        "authorId" : "cb16561c-58c1-4f0a-a738-613be01155c9",
        "body" : "Can you please enable --declaration in `tests/cases/compiler/requireOfJsonFileType.ts` so we have test for each type of json file's d.ts",
        "createdAt" : "2019-09-25T15:51:25Z",
        "updatedAt" : "2019-09-26T21:10:12Z",
        "lastEditedBy" : "cb16561c-58c1-4f0a-a738-613be01155c9",
        "tags" : [
        ]
      },
      {
        "id" : "70f26b4b-3559-4cd0-9b59-a839d3f01f13",
        "parentId" : "69a1a2b6-1aaf-4b04-a7c0-2e982bda996c",
        "authorId" : "f7813195-22a2-4200-9f53-7aadb83a2cc9",
        "body" : "Done",
        "createdAt" : "2019-09-25T20:25:31Z",
        "updatedAt" : "2019-09-26T21:10:12Z",
        "lastEditedBy" : "f7813195-22a2-4200-9f53-7aadb83a2cc9",
        "tags" : [
        ]
      }
    ],
    "commit" : "007b3d4afe7726f7b72cd617e5453c8943e48ad2",
    "line" : 11,
    "diffHunk" : "@@ -1,1 +59,63 @@                errorDiagnostic([Diagnostics.Cannot_write_file_0_because_it_would_be_overwritten_by_multiple_input_files, \"/src/dist/src/index.d.ts\"])\n            );\n        });\n\n        it(\"with resolveJsonModule and files containing json file\", () => {"
  }
]