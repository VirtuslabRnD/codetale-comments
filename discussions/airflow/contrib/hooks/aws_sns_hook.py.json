[
  {
    "id" : "5f4f74f4-33cd-4ca8-9491-7c2668a393a0",
    "prId" : 5694,
    "prUrl" : "https://github.com/apache/airflow/pull/5694#pullrequestreview-308798179",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e08081d8-e824-4dda-8ed9-ad4ee9b29f95",
        "parentId" : null,
        "authorId" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "body" : "Does this method work without this \"if\"?  For me it should work when the subject is equal to None. Very often, the default method arguments are None.",
        "createdAt" : "2019-09-12T22:47:52Z",
        "updatedAt" : "2019-10-28T17:59:47Z",
        "lastEditedBy" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "tags" : [
        ]
      },
      {
        "id" : "470bd1dc-a487-4596-b8ee-27c6df9db084",
        "parentId" : "e08081d8-e824-4dda-8ed9-ad4ee9b29f95",
        "authorId" : "fbd9a9ff-89d9-4955-bcd3-8725dbba9d21",
        "body" : "yes. it will work. To handle already existing code. I added this None check. if someone is not sending subject while calling method it will work. ",
        "createdAt" : "2019-09-13T09:42:46Z",
        "updatedAt" : "2019-10-28T17:59:47Z",
        "lastEditedBy" : "fbd9a9ff-89d9-4955-bcd3-8725dbba9d21",
        "tags" : [
        ]
      },
      {
        "id" : "e46b3070-3d17-4f51-b2a6-1c9efb86cb93",
        "parentId" : "e08081d8-e824-4dda-8ed9-ad4ee9b29f95",
        "authorId" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "body" : "```python\r\n    def publish_to_target(self, target_arn, message, subject=None):\r\n        \"\"\"\r\n        Publish a message to a topic or an endpoint.\r\n        :param target_arn: either a TopicArn or an EndpointArn\r\n        :type target_arn: str\r\n        :param message: the default message you want to send\r\n        :param message: str\r\n        :param subject: subject of message\r\n        :type subject: str\r\n        \"\"\"\r\n\r\n        conn = self.get_conn()\r\n\r\n        messages = {\r\n            'default': message\r\n        }\r\n\r\n        return conn.publish(\r\n            TargetArn=target_arn,\r\n            Message=json.dumps(messages),\r\n            MessageStructure='json',\r\n            Subject=subject\r\n        )\r\n```\r\nWill this code work properly in all cases?",
        "createdAt" : "2019-10-29T18:32:41Z",
        "updatedAt" : "2019-10-29T18:33:01Z",
        "lastEditedBy" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "tags" : [
        ]
      },
      {
        "id" : "56717510-b127-4425-84c8-3891524b2f65",
        "parentId" : "e08081d8-e824-4dda-8ed9-ad4ee9b29f95",
        "authorId" : "fbd9a9ff-89d9-4955-bcd3-8725dbba9d21",
        "body" : "yes @mik-laj. Am I missing anything?",
        "createdAt" : "2019-10-29T18:45:41Z",
        "updatedAt" : "2019-10-29T18:45:41Z",
        "lastEditedBy" : "fbd9a9ff-89d9-4955-bcd3-8725dbba9d21",
        "tags" : [
        ]
      },
      {
        "id" : "c77dea2a-752a-4f4b-b4db-074bb2fb0d38",
        "parentId" : "e08081d8-e824-4dda-8ed9-ad4ee9b29f95",
        "authorId" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "body" : "So we don't need one additional \"If\" instruction in the code?",
        "createdAt" : "2019-10-29T18:58:04Z",
        "updatedAt" : "2019-10-29T18:58:04Z",
        "lastEditedBy" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "tags" : [
        ]
      },
      {
        "id" : "b87a4d73-92d6-4e2b-ac75-602b9eeb1d6d",
        "parentId" : "e08081d8-e824-4dda-8ed9-ad4ee9b29f95",
        "authorId" : "fbd9a9ff-89d9-4955-bcd3-8725dbba9d21",
        "body" : "let me test one more time @mik-laj ",
        "createdAt" : "2019-10-29T19:01:40Z",
        "updatedAt" : "2019-10-29T19:01:41Z",
        "lastEditedBy" : "fbd9a9ff-89d9-4955-bcd3-8725dbba9d21",
        "tags" : [
        ]
      },
      {
        "id" : "5368afd1-d58f-4f01-8862-8eabef6287f0",
        "parentId" : "e08081d8-e824-4dda-8ed9-ad4ee9b29f95",
        "authorId" : "fbd9a9ff-89d9-4955-bcd3-8725dbba9d21",
        "body" : "@mik-laj  we need if condition because. boto3 is throwing an error when you call publish_to_target method with subject as None. \r\n\r\nError message from boto3:\r\n```\r\nbotocore.exceptions.ParamValidationError: Parameter validation failed:\r\n```\r\n\r\nBecause boto3 expects the subject to be a string. not None.  To handle this case I added if condition. \r\n\r\nUsage: \r\n1. when you want to send SNS notification with the subject \r\n```\r\nAwsSnsHook().publish_to_target(target_arn='arn', message='test', subject='subject')\r\n```\r\n2. when you want to send SNS notification witout subject (AWS will allocate default subject)\r\n```\r\nAwsSnsHook().publish_to_target(target_arn='arn', message='test')\r\n```\r\n\r\nSorry, my understanding was wrong from your comment. \r\n\r\nLet me know if you have any thoughts!",
        "createdAt" : "2019-10-29T19:20:59Z",
        "updatedAt" : "2019-10-29T19:26:26Z",
        "lastEditedBy" : "fbd9a9ff-89d9-4955-bcd3-8725dbba9d21",
        "tags" : [
        ]
      },
      {
        "id" : "096a4452-e376-4591-a2fe-285bcfd35988",
        "parentId" : "e08081d8-e824-4dda-8ed9-ad4ee9b29f95",
        "authorId" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "body" : "Well, then this change looks good. I accept it",
        "createdAt" : "2019-10-29T20:05:31Z",
        "updatedAt" : "2019-10-29T20:05:31Z",
        "lastEditedBy" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "tags" : [
        ]
      }
    ],
    "commit" : "ee57dd8b18c588ca8d98a6bd39262127eed7c088",
    "line" : 22,
    "diffHunk" : "@@ -1,1 +60,64 @@        }\n\n        if subject is None:\n            return conn.publish(\n                TargetArn=target_arn,"
  }
]