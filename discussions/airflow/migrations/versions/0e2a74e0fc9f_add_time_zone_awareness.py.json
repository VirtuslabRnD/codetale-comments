[
  {
    "id" : "4df05dca-ac13-49a4-b938-56366ef9f577",
    "prId" : 2781,
    "prUrl" : "https://github.com/apache/airflow/pull/2781#pullrequestreview-78470395",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ab17d8cb-aab0-4cae-a208-db05226ced33",
        "parentId" : null,
        "authorId" : "ef543b7a-dab1-4240-9ec7-b2e2b40b9846",
        "body" : "Given that (in the dag_run table) run_id = id_prefix + execution_date, I wonder if ideally run_id should also be updated to reflect the new time in utc. Given that run_id is never parsed again, the only potential confusion is that there's a bit of semantic inconsistency with future generated run_ids",
        "createdAt" : "2017-11-21T23:41:04Z",
        "updatedAt" : "2017-11-27T14:54:40Z",
        "lastEditedBy" : "ef543b7a-dab1-4240-9ec7-b2e2b40b9846",
        "tags" : [
        ]
      },
      {
        "id" : "58a341f8-16d2-4c8c-860d-0aeb9d43b00b",
        "parentId" : "ab17d8cb-aab0-4cae-a208-db05226ced33",
        "authorId" : "ef543b7a-dab1-4240-9ec7-b2e2b40b9846",
        "body" : "Checked the schema and this field has a unique constraint, so it may potentially cause collision with new run_ids created after the migration.",
        "createdAt" : "2017-11-21T23:45:55Z",
        "updatedAt" : "2017-11-27T14:54:40Z",
        "lastEditedBy" : "ef543b7a-dab1-4240-9ec7-b2e2b40b9846",
        "tags" : [
        ]
      },
      {
        "id" : "8227db0d-d34c-4cf6-a3cd-5126aa93a670",
        "parentId" : "ab17d8cb-aab0-4cae-a208-db05226ced33",
        "authorId" : "537cec6b-32b7-4f8b-9f76-6932246f79b5",
        "body" : "Run_id will be in UTC by definition as execution_date is by definition time zone aware",
        "createdAt" : "2017-11-22T06:36:12Z",
        "updatedAt" : "2017-11-27T14:54:40Z",
        "lastEditedBy" : "537cec6b-32b7-4f8b-9f76-6932246f79b5",
        "tags" : [
        ]
      },
      {
        "id" : "785422d8-6108-482d-8861-68258fb4366d",
        "parentId" : "ab17d8cb-aab0-4cae-a208-db05226ced33",
        "authorId" : "ef543b7a-dab1-4240-9ec7-b2e2b40b9846",
        "body" : "ah you are right, I was running Airflow locally with system clock (PST) before upgrading db (so the execution_date and run_id didn't match in the same row after the db upgrade).",
        "createdAt" : "2017-11-22T07:11:20Z",
        "updatedAt" : "2017-11-27T14:54:40Z",
        "lastEditedBy" : "ef543b7a-dab1-4240-9ec7-b2e2b40b9846",
        "tags" : [
        ]
      },
      {
        "id" : "11f1cb11-f69a-4faf-8a19-5e5916b056fc",
        "parentId" : "ab17d8cb-aab0-4cae-a208-db05226ced33",
        "authorId" : "537cec6b-32b7-4f8b-9f76-6932246f79b5",
        "body" : "Can you be a bit more clear what happened? Although you were running with PST the upgrade should happen with UTC. ie `2017-01-01 01:00:00` should just become `2017-01-01 01:00:00+00:00`. For run_ids this just means it becomes something like `scheduled__2017-01-01 01:00:00+00:00`.",
        "createdAt" : "2017-11-22T07:20:12Z",
        "updatedAt" : "2017-11-27T14:54:40Z",
        "lastEditedBy" : "537cec6b-32b7-4f8b-9f76-6932246f79b5",
        "tags" : [
        ]
      },
      {
        "id" : "1ccc93ba-39e2-42fe-a0d5-846deda88bc0",
        "parentId" : "ab17d8cb-aab0-4cae-a208-db05226ced33",
        "authorId" : "ef543b7a-dab1-4240-9ec7-b2e2b40b9846",
        "body" : "ah yes, that is the case for any new run_ids that get generated, but not for existing ones since the migration scripts only updates `execution_date`, `start_date`, and `end_date` in the table.",
        "createdAt" : "2017-11-22T07:26:01Z",
        "updatedAt" : "2017-11-27T14:54:40Z",
        "lastEditedBy" : "ef543b7a-dab1-4240-9ec7-b2e2b40b9846",
        "tags" : [
        ]
      },
      {
        "id" : "84c7e61d-4e82-4cac-b6eb-88ffd736191f",
        "parentId" : "ab17d8cb-aab0-4cae-a208-db05226ced33",
        "authorId" : "537cec6b-32b7-4f8b-9f76-6932246f79b5",
        "body" : "Ah, ok. I think we *might* need to update run_ids (I rather not) in the migration script as well as they are sometimes used in look ups. I need to verify if it will be an issue if we don't. I think it might be an issue for backfills, but not sure.",
        "createdAt" : "2017-11-22T07:59:43Z",
        "updatedAt" : "2017-11-27T14:54:40Z",
        "lastEditedBy" : "537cec6b-32b7-4f8b-9f76-6932246f79b5",
        "tags" : [
        ]
      },
      {
        "id" : "ae7a16dc-e0ca-4567-a239-9abb22e18e9d",
        "parentId" : "ab17d8cb-aab0-4cae-a208-db05226ced33",
        "authorId" : "537cec6b-32b7-4f8b-9f76-6932246f79b5",
        "body" : "^^ seems not to be required. We never use the full run_id.",
        "createdAt" : "2017-11-22T14:53:13Z",
        "updatedAt" : "2017-11-27T14:54:40Z",
        "lastEditedBy" : "537cec6b-32b7-4f8b-9f76-6932246f79b5",
        "tags" : [
        ]
      }
    ],
    "commit" : "f1ab56cc6ad3b9419af94aaa333661c105185883",
    "line" : 33,
    "diffHunk" : "@@ -1,1 +31,35 @@\n\ndef upgrade():\n    conn = op.get_bind()\n    if conn.dialect.name == 'mysql':"
  }
]