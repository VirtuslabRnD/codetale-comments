[
  {
    "id" : "b68a7b66-dcb2-4b13-a183-b75c02403f76",
    "prId" : 14840,
    "prUrl" : "https://github.com/apache/airflow/pull/14840#pullrequestreview-617518718",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2a96d680-4358-4fb9-8bc3-960812ac9978",
        "parentId" : null,
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "I don't see a `delete_role` method in https://github.com/dpgaspar/Flask-AppBuilder/blob/302e4abe32d9d2403f2ce52e4abb31beb59bb252/flask_appbuilder/security/manager.py#L1775-L1791\r\n\r\nSo this needs to be `find_role()` and then `session.delete(role)` I think.",
        "createdAt" : "2021-03-22T09:55:58Z",
        "updatedAt" : "2021-04-03T08:29:47Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "1684ac2a-9c91-48ee-a99c-cf20e608934c",
        "parentId" : "2a96d680-4358-4fb9-8bc3-960812ac9978",
        "authorId" : "c7b0cb1c-ff95-4ec9-a0c6-a9f1b5135a52",
        "body" : "Yes, it was added in airflow, see https://github.com/apache/airflow/blob/fa92657490bc188d272fb4d8f3b09933815bcea1/airflow/www/security.py#L194-L207",
        "createdAt" : "2021-03-22T10:15:41Z",
        "updatedAt" : "2021-04-03T08:29:47Z",
        "lastEditedBy" : "c7b0cb1c-ff95-4ec9-a0c6-a9f1b5135a52",
        "tags" : [
        ]
      },
      {
        "id" : "81d70f23-6e53-4ab0-a317-11de065affe9",
        "parentId" : "2a96d680-4358-4fb9-8bc3-960812ac9978",
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "Ah obviously failed in my search -- I thought I checked there first. Obviously not.",
        "createdAt" : "2021-03-22T13:28:00Z",
        "updatedAt" : "2021-04-03T08:29:47Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      }
    ],
    "commit" : "ac1a194cdbd8a4081d0e6bcce17ed86d54b97fd9",
    "line" : 51,
    "diffHunk" : "@@ -1,1 +92,96 @@    if not role:\n        raise NotFound(title=\"Role not found\", detail=f\"The Role with name `{role_name}` was not found\")\n    ab_security_manager.delete_role(role_name=role_name)\n    return NoContent, 204\n"
  },
  {
    "id" : "1d83e3bb-fc3d-415a-99b6-a62e2e6f51b0",
    "prId" : 14840,
    "prUrl" : "https://github.com/apache/airflow/pull/14840#pullrequestreview-617620633",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b028d3d0-47ff-44df-b05b-d257f90f43dd",
        "parentId" : null,
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "```suggestion\r\n@security.requires_access([(permissions.ACTION_CAN_CREATE, permissions.RESOURCE_ROLE_MODEL_VIEW)])\r\n```\r\n\r\nAnd if that is not the permission that is actually used then please ask @jhtimmins how to change it so it is :)",
        "createdAt" : "2021-03-22T10:03:03Z",
        "updatedAt" : "2021-04-03T08:29:47Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "6765a66e-249f-40f1-841b-b33dcddb82b2",
        "parentId" : "b028d3d0-47ff-44df-b05b-d257f90f43dd",
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "Since this is a built-in FAB view, it will likely use CAN_ADD, so we'll need to customize that view (and create a migration) to avoid having two permissions for the same resource)",
        "createdAt" : "2021-03-22T13:29:12Z",
        "updatedAt" : "2021-04-03T08:29:47Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "a83158fc-263a-493e-8a4f-03860625dcdf",
        "parentId" : "b028d3d0-47ff-44df-b05b-d257f90f43dd",
        "authorId" : "c7b0cb1c-ff95-4ec9-a0c6-a9f1b5135a52",
        "body" : "Exactly, I have returned it back. I realized Admin doesn't have can_create on RoleModelView. @jhtimmins PR on using resources will address this",
        "createdAt" : "2021-03-22T14:53:42Z",
        "updatedAt" : "2021-04-03T08:29:47Z",
        "lastEditedBy" : "c7b0cb1c-ff95-4ec9-a0c6-a9f1b5135a52",
        "tags" : [
        ]
      }
    ],
    "commit" : "ac1a194cdbd8a4081d0e6bcce17ed86d54b97fd9",
    "line" : 90,
    "diffHunk" : "@@ -1,1 +131,135 @@\n\n@security.requires_access([(permissions.ACTION_CAN_ADD, permissions.RESOURCE_ROLE_MODEL_VIEW)])\ndef post_role():\n    \"\"\"Create a new role\"\"\""
  }
]