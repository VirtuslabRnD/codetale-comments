[
  {
    "id" : "f2a5f44c-f517-4eb3-978f-72313a329728",
    "prId" : 3596,
    "prUrl" : "https://github.com/apache/airflow/pull/3596#pullrequestreview-156531349",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0974c335-2e45-4c52-9f79-c86f04f6f0e0",
        "parentId" : null,
        "authorId" : "38d80383-47b9-439a-9efe-9282f79f8b2f",
        "body" : "could you add a comment on what is this dependency for?",
        "createdAt" : "2018-09-17T20:33:49Z",
        "updatedAt" : "2018-09-20T06:08:41Z",
        "lastEditedBy" : "38d80383-47b9-439a-9efe-9282f79f8b2f",
        "tags" : [
        ]
      },
      {
        "id" : "0fa3a1dd-61ac-4e7c-870e-ad62e1173382",
        "parentId" : "0974c335-2e45-4c52-9f79-c86f04f6f0e0",
        "authorId" : "44a4606a-9224-404a-87fd-9a2417fd2610",
        "body" : "Done",
        "createdAt" : "2018-09-18T19:29:14Z",
        "updatedAt" : "2018-09-20T06:08:41Z",
        "lastEditedBy" : "44a4606a-9224-404a-87fd-9a2417fd2610",
        "tags" : [
        ]
      }
    ],
    "commit" : "1c0ee701ef8f86e32feb5999e1dff07829c7a46d",
    "line" : 106,
    "diffHunk" : "@@ -1,1 +124,128 @@\n    @property\n    def deps(self):\n        \"\"\"\n        Adds one additional dependency for all sensor operators that"
  },
  {
    "id" : "1ffb28dd-0772-488b-9ec8-ca719558b462",
    "prId" : 3596,
    "prUrl" : "https://github.com/apache/airflow/pull/3596#pullrequestreview-156535694",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ef949351-2518-4472-a6cc-3006cd49226b",
        "parentId" : null,
        "authorId" : "38d80383-47b9-439a-9efe-9282f79f8b2f",
        "body" : "maybe a dump question, but now is it possible to have `(timezone.utcnow() - started_at)` as negative datetime number? will `(timezone.utcnow() - started_at).total_seconds()` throw exception?",
        "createdAt" : "2018-09-17T20:58:17Z",
        "updatedAt" : "2018-09-20T06:08:41Z",
        "lastEditedBy" : "38d80383-47b9-439a-9efe-9282f79f8b2f",
        "tags" : [
        ]
      },
      {
        "id" : "bba07104-2200-4153-be0b-f5d4d804f442",
        "parentId" : "ef949351-2518-4472-a6cc-3006cd49226b",
        "authorId" : "44a4606a-9224-404a-87fd-9a2417fd2610",
        "body" : "Normally that should not be the case because `started_at` is always in the past. Of course clocks are never in sync (except at Google) so it may happen. But also in such a case `datetime.timedelta.total_seconds()` doesn't throw an exception but returns a negative number which is still smaller than the configured timeout (if the user configured a positive timeout, lol)",
        "createdAt" : "2018-09-18T19:40:51Z",
        "updatedAt" : "2018-09-20T06:08:41Z",
        "lastEditedBy" : "44a4606a-9224-404a-87fd-9a2417fd2610",
        "tags" : [
        ]
      }
    ],
    "commit" : "1c0ee701ef8f86e32feb5999e1dff07829c7a46d",
    "line" : 80,
    "diffHunk" : "@@ -1,1 +96,100 @@                started_at = task_reschedules[0].start_date\n        while not self.poke(context):\n            if (timezone.utcnow() - started_at).total_seconds() > self.timeout:\n                # If sensor is in soft fail mode but will be retried then\n                # give it a chance and fail with timeout."
  },
  {
    "id" : "507eab92-2607-4fb7-a0e4-0a0f9f738a84",
    "prId" : 3596,
    "prUrl" : "https://github.com/apache/airflow/pull/3596#pullrequestreview-156530243",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "425c1a39-3c54-4715-890b-678e63c5ca26",
        "parentId" : null,
        "authorId" : "38d80383-47b9-439a-9efe-9282f79f8b2f",
        "body" : "and should it be `reschedule_date = started_at + timedelta( `?",
        "createdAt" : "2018-09-17T20:58:42Z",
        "updatedAt" : "2018-09-20T06:08:41Z",
        "lastEditedBy" : "38d80383-47b9-439a-9efe-9282f79f8b2f",
        "tags" : [
        ]
      },
      {
        "id" : "588912cf-8edf-4e1b-86e7-929c5eccafa7",
        "parentId" : "425c1a39-3c54-4715-890b-678e63c5ca26",
        "authorId" : "44a4606a-9224-404a-87fd-9a2417fd2610",
        "body" : "No. In \"reschedule\" mode `started_at` is always set to the initial schedule time (when the task instance was scheduled the first time). `started_at` is only used to determine if timeout is reached.",
        "createdAt" : "2018-09-18T19:26:20Z",
        "updatedAt" : "2018-09-20T06:08:41Z",
        "lastEditedBy" : "44a4606a-9224-404a-87fd-9a2417fd2610",
        "tags" : [
        ]
      }
    ],
    "commit" : "1c0ee701ef8f86e32feb5999e1dff07829c7a46d",
    "line" : 88,
    "diffHunk" : "@@ -1,1 +106,110 @@                    raise AirflowSensorTimeout('Snap. Time is OUT.')\n            if self.reschedule:\n                reschedule_date = timezone.utcnow() + timedelta(\n                    seconds=self.poke_interval)\n                raise AirflowRescheduleException(reschedule_date)"
  }
]