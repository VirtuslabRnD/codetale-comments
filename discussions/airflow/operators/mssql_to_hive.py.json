[
  {
    "id" : "a788a7de-e8be-4df9-8809-190c79131ed8",
    "prId" : 4405,
    "prUrl" : "https://github.com/apache/airflow/pull/4405#pullrequestreview-203627094",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "859284d9-61d9-49a5-bfc6-62f1092546ab",
        "parentId" : null,
        "authorId" : "8c680a1a-3743-44ea-9ab0-a9f70d8fd124",
        "body" : "I wonder if we should change code style.\r\n* 1st this PR just want to add unit test.\r\n* 2nd many of other transfer operator had code style like \r\n\r\n```python\r\nsrc_hook = XXXHook(conn_id=self.conn_id)\r\ndest_hook = YYYHook(conn_id=self.conn_id)\r\n\r\n...<get data from src_hook>\r\nwith NamedTemporaryFile(\"w\") as f:\r\n    ...\r\n    ...<write data to temp file>...\r\n    ...\r\n    dest_hook.transfer(param)\r\n```\r\nWDYT @feng-tao @Fokko ",
        "createdAt" : "2019-02-13T01:11:53Z",
        "updatedAt" : "2019-02-13T10:56:17Z",
        "lastEditedBy" : "8c680a1a-3743-44ea-9ab0-a9f70d8fd124",
        "tags" : [
        ]
      },
      {
        "id" : "398d71bd-d879-479c-b05b-d2c5352be7fe",
        "parentId" : "859284d9-61d9-49a5-bfc6-62f1092546ab",
        "authorId" : "03e41e23-f438-4a06-9652-8f20638d2c3a",
        "body" : "I don't understand your question here. Can you elaborate?",
        "createdAt" : "2019-02-13T12:37:12Z",
        "updatedAt" : "2019-02-13T12:37:12Z",
        "lastEditedBy" : "03e41e23-f438-4a06-9652-8f20638d2c3a",
        "tags" : [
        ]
      },
      {
        "id" : "0c755312-b4a6-43b1-81b2-8bc74e7753cd",
        "parentId" : "859284d9-61d9-49a5-bfc6-62f1092546ab",
        "authorId" : "8c680a1a-3743-44ea-9ab0-a9f70d8fd124",
        "body" : "The purpose of this PR is add test for `MsSqlToHiveTransfer`, but it change the code, and make the code not same as other transfer.\r\nLike `MySqlToHiveTransfer` create conn and cursor **independent**. I think we should create them in the same way. rather than create conn and cursor in  `with` statement",
        "createdAt" : "2019-02-13T15:08:17Z",
        "updatedAt" : "2019-02-13T15:08:17Z",
        "lastEditedBy" : "8c680a1a-3743-44ea-9ab0-a9f70d8fd124",
        "tags" : [
        ]
      },
      {
        "id" : "cc271890-4d41-40ae-9719-1cdf7bfbc1d2",
        "parentId" : "859284d9-61d9-49a5-bfc6-62f1092546ab",
        "authorId" : "e29ffafb-ac51-434b-b9e0-af262caae1ee",
        "body" : "@zhongjiajie I think I got your point.\r\n* Replacing `conn = mssql.get_conn()` ... `conn.close()` by using the `with` statement isn't a functional change though. You can see the [docs ](http://pymssql.org/en/stable/pymssql_examples.html#using-the-with-statement-context-managers) for more information.\r\n* Moving the instantiation of a hook is indeed a functional change. We can discuss about that :) \r\n\r\nIn my opinion it is better to create the connection when you really need it, because what does it gets you when you instantiate a hook but due to issues in the source hook the destination hook will never gets used.\r\nOn the other side you can argue that if you do it like I did it that you are already pulling data from the source without knowing whether the destination connections is working or not.\r\n\r\nIn the end I like it more to have two blocks in the transfer execute function. One retrieving data from the source and one sending it to the destination.",
        "createdAt" : "2019-02-13T18:06:39Z",
        "updatedAt" : "2019-02-13T18:06:40Z",
        "lastEditedBy" : "e29ffafb-ac51-434b-b9e0-af262caae1ee",
        "tags" : [
        ]
      },
      {
        "id" : "c83165e6-0808-4ec5-9175-edf8ae41c9f8",
        "parentId" : "859284d9-61d9-49a5-bfc6-62f1092546ab",
        "authorId" : "8c680a1a-3743-44ea-9ab0-a9f70d8fd124",
        "body" : "@feluelle  Yes, you are right, not functional change. But using `with` statement code style are different from others that what I confuse. And what you said\r\n> On the other side you can argue that if you do it like I did it that you are already pulling data from the source without knowing whether the destination connections is working or not.\r\n\r\nis other point.",
        "createdAt" : "2019-02-14T01:22:05Z",
        "updatedAt" : "2019-02-14T01:22:17Z",
        "lastEditedBy" : "8c680a1a-3743-44ea-9ab0-a9f70d8fd124",
        "tags" : [
        ]
      },
      {
        "id" : "316a003d-d4d2-47d8-83f2-06d61b63e21f",
        "parentId" : "859284d9-61d9-49a5-bfc6-62f1092546ab",
        "authorId" : "e29ffafb-ac51-434b-b9e0-af262caae1ee",
        "body" : "That's true. It is a different code style. But that is called _Refactoring_ :)\r\n\r\nThe code will change from time to time as the language improves and our code understanding increases.\r\n\r\nI don't think these kind of changes need to be made all at once for all operators.",
        "createdAt" : "2019-02-14T08:48:06Z",
        "updatedAt" : "2019-02-14T08:48:31Z",
        "lastEditedBy" : "e29ffafb-ac51-434b-b9e0-af262caae1ee",
        "tags" : [
        ]
      },
      {
        "id" : "84097bc3-b390-481f-b887-3f00ac6ad770",
        "parentId" : "859284d9-61d9-49a5-bfc6-62f1092546ab",
        "authorId" : "8c680a1a-3743-44ea-9ab0-a9f70d8fd124",
        "body" : "ok, I get it",
        "createdAt" : "2019-02-14T08:57:16Z",
        "updatedAt" : "2019-02-14T08:57:17Z",
        "lastEditedBy" : "8c680a1a-3743-44ea-9ab0-a9f70d8fd124",
        "tags" : [
        ]
      }
    ],
    "commit" : "453ed05e519804e35244cd19e037c4b7b2227fed",
    "line" : 94,
    "diffHunk" : "@@ -1,1 +123,127 @@                    tmp_file.flush()\n\n            hive = HiveCliHook(hive_cli_conn_id=self.hive_cli_conn_id)\n            self.log.info(\"Loading file into Hive\")\n            hive.load_file("
  }
]