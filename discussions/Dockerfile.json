[
  {
    "id" : "3e887c9c-0bb6-4442-a703-b3ef075f4494",
    "prId" : 4483,
    "prUrl" : "https://github.com/apache/airflow/pull/4483#pullrequestreview-191934182",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "806164bf-872c-4d9a-8084-622b174774e9",
        "parentId" : null,
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "Having all of these in the \"official\" image would make it rather heavy weight for most users wouldn't it? What is the size of this image?",
        "createdAt" : "2019-01-11T20:01:19Z",
        "updatedAt" : "2019-01-12T12:13:51Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "c0874324-a5ae-4946-939f-1d301d950802",
        "parentId" : "806164bf-872c-4d9a-8084-622b174774e9",
        "authorId" : "0706c3c0-d32f-4dda-aba2-181cb4e0f0e8",
        "body" : "I did bring it already down to 1 Gb now, before it was 1,6 Gb because of the non slim python image.\r\nI dit this on purpose because I like that the default image does support everything. But I did make it with ARG so that it would be possible to generate multiple images from the same docker file in case a smaller version is also required",
        "createdAt" : "2019-01-12T10:18:58Z",
        "updatedAt" : "2019-01-12T12:13:51Z",
        "lastEditedBy" : "0706c3c0-d32f-4dda-aba2-181cb4e0f0e8",
        "tags" : [
        ]
      },
      {
        "id" : "91d8dd25-cd29-4f03-afd8-19e2e9596ddf",
        "parentId" : "806164bf-872c-4d9a-8084-622b174774e9",
        "authorId" : "0706c3c0-d32f-4dda-aba2-181cb4e0f0e8",
        "body" : "Although, having multiple official images is maybe also confusing. Now a days 1 Gb is not so much anymore.",
        "createdAt" : "2019-01-12T10:22:23Z",
        "updatedAt" : "2019-01-12T12:13:51Z",
        "lastEditedBy" : "0706c3c0-d32f-4dda-aba2-181cb4e0f0e8",
        "tags" : [
        ]
      },
      {
        "id" : "3e8df36f-2b04-4b71-b992-7e27f18c75f4",
        "parentId" : "806164bf-872c-4d9a-8084-622b174774e9",
        "authorId" : "0706c3c0-d32f-4dda-aba2-181cb4e0f0e8",
        "body" : "Oke, after fixing some of the comments it did drop to 877MB now",
        "createdAt" : "2019-01-12T10:37:29Z",
        "updatedAt" : "2019-01-12T12:13:51Z",
        "lastEditedBy" : "0706c3c0-d32f-4dda-aba2-181cb4e0f0e8",
        "tags" : [
        ]
      }
    ],
    "commit" : "f867daaeaf8c7f8ac04f64bd3ce1b6b746a35f63",
    "line" : 25,
    "diffHunk" : "@@ -1,1 +23,27 @@ARG PYTHON_DEPS=\"\"\nARG buildDeps=\"freetds-dev libkrb5-dev libsasl2-dev libssl-dev libffi-dev libpq-dev git\"\nARG APT_DEPS=\"$buildDeps libsasl2-dev freetds-bin build-essential default-libmysqlclient-dev apt-utils curl rsync netcat locales\"\n\nWORKDIR /opt/airflow"
  },
  {
    "id" : "0a401f8b-edbc-461f-94d1-3979def72fa4",
    "prId" : 4724,
    "prUrl" : "https://github.com/apache/airflow/pull/4724#pullrequestreview-204578831",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "09f72ca8-0b54-42d8-a276-41ec6c761f4f",
        "parentId" : null,
        "authorId" : "e29ffafb-ac51-434b-b9e0-af262caae1ee",
        "body" : "Is there a reason the `libsasl2-dev` is listed in both (the `buildDeps` and the `APT_DEPS`) ?\r\n",
        "createdAt" : "2019-02-17T20:13:47Z",
        "updatedAt" : "2019-02-28T08:39:55Z",
        "lastEditedBy" : "e29ffafb-ac51-434b-b9e0-af262caae1ee",
        "tags" : [
        ]
      },
      {
        "id" : "a55e3d86-c6cd-4286-b5f9-14f31e48bdcd",
        "parentId" : "09f72ca8-0b54-42d8-a276-41ec6c761f4f",
        "authorId" : "0706c3c0-d32f-4dda-aba2-181cb4e0f0e8",
        "body" : "no, this is just wrong ;), fixed this",
        "createdAt" : "2019-02-17T20:33:41Z",
        "updatedAt" : "2019-02-28T08:39:55Z",
        "lastEditedBy" : "0706c3c0-d32f-4dda-aba2-181cb4e0f0e8",
        "tags" : [
        ]
      }
    ],
    "commit" : "02d1dea3e8df2398152de097adca79292f1e53bb",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +21,25 @@ARG PYTHON_DEPS=\"\"\nARG BUILD_DEPS=\"freetds-dev libkrb5-dev libssl-dev libffi-dev libpq-dev git\"\nARG APT_DEPS=\"libsasl2-dev freetds-bin build-essential default-libmysqlclient-dev apt-utils curl rsync netcat locales\"\n\nENV PATH=\"$HOME/.npm-packages/bin:$PATH\""
  },
  {
    "id" : "0922386e-6a00-48f3-8e35-50224676acb5",
    "prId" : 4724,
    "prUrl" : "https://github.com/apache/airflow/pull/4724#pullrequestreview-207345866",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b3bb5399-3314-410a-b1b4-1d275556553b",
        "parentId" : null,
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "-1 to doing it this way: Having Node and all of the node_modules in the final image isn't great.\r\n\r\nInstead we should use a [multi-stage docker file](https://docs.docker.com/develop/develop-images/multistage-build/) so this line becomes:\r\n\r\n```\r\nCOPY --from=assert-builder /opt/airflow/airflow/www/static/dist /opt/airflow/airflow/www/static/dist\r\n```\r\n\r\nAnd then earlier in the docker file we have (i.e. right at the start)\r\n\r\n```\r\nFROM node as asset-builder\r\nCOPY ./airflow/www/package*json /opt/airflow/airflow/www/package.json\r\nRUN npm install\r\nCOPY ./airflow/www/static/ /opt/airflow/airflow/www/static/\r\nRUN npm run prod\r\n```",
        "createdAt" : "2019-02-25T11:10:56Z",
        "updatedAt" : "2019-02-28T08:39:55Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "63edde33-74a8-408a-b73d-2128f17c2adf",
        "parentId" : "b3bb5399-3314-410a-b1b4-1d275556553b",
        "authorId" : "8c680a1a-3743-44ea-9ab0-a9f70d8fd124",
        "body" : "Same as @jmcarp said in https://github.com/apache/airflow/pull/4724#issuecomment-464546183",
        "createdAt" : "2019-02-25T11:36:56Z",
        "updatedAt" : "2019-02-28T08:39:55Z",
        "lastEditedBy" : "8c680a1a-3743-44ea-9ab0-a9f70d8fd124",
        "tags" : [
        ]
      }
    ],
    "commit" : "02d1dea3e8df2398152de097adca79292f1e53bb",
    "line" : 32,
    "diffHunk" : "@@ -1,1 +38,42 @@WORKDIR /opt/airflow/airflow/www\nRUN npm install \\\n    && npm run prod\n\nWORKDIR /opt/airflow"
  }
]