[
  {
    "id" : "87846353-c0f4-4141-bb91-89c130509bf2",
    "prId" : 12248,
    "prUrl" : "https://github.com/lampepfl/dotty/pull/12248#pullrequestreview-646948069",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6ed1d7c4-6496-4ce3-bea1-c51c78474bfe",
        "parentId" : null,
        "authorId" : "bc4c7970-6d84-475b-b408-2ed0f22a7bf3",
        "body" : "For the example `'{ val y = $x * $x; ${ powerCode('y, n / 2) } }`, I'm wondering what's the argument to `powerCode` before and after the change.",
        "createdAt" : "2021-04-28T11:12:24Z",
        "updatedAt" : "2021-04-28T11:12:36Z",
        "lastEditedBy" : "bc4c7970-6d84-475b-b408-2ed0f22a7bf3",
        "tags" : [
        ]
      },
      {
        "id" : "dd821220-f9b9-458f-bb01-b8eba5cdc5c7",
        "parentId" : "6ed1d7c4-6496-4ce3-bea1-c51c78474bfe",
        "authorId" : "a7e5fcc8-eade-485d-96d2-94106dd74f83",
        "body" : "That was the test case I used to do this change.\r\n\r\nIt becomes something like\r\n```scala\r\ndef hole0(args: Array[Any]) = x\r\n\r\ndef hole1(args: Array[Any]) = \r\n  val y$1 = args(0).asInstanceOf[Expr[Int]]\r\n  powerCode(y$1, n / 2)\r\n\r\nunpickle('{ val y = [[ 0 | Double ]] * [[ 0 | Double ]]; [[ 1 | Double | y ]]  }, List(hole0, hole1))\r\n```",
        "createdAt" : "2021-04-28T11:23:33Z",
        "updatedAt" : "2021-04-28T11:29:20Z",
        "lastEditedBy" : "a7e5fcc8-eade-485d-96d2-94106dd74f83",
        "tags" : [
        ]
      },
      {
        "id" : "d80a16e9-2cc8-4b50-9fb0-664a6f08c7de",
        "parentId" : "6ed1d7c4-6496-4ce3-bea1-c51c78474bfe",
        "authorId" : "a7e5fcc8-eade-485d-96d2-94106dd74f83",
        "body" : "Before we had\r\n\r\n```scala\r\ndef hole1(args: Array[Any]) = \r\n  val y$1 = args(0).asInstanceOf[Expr[Int]]\r\n  def hole3(args: Array[Any]) = y$1\r\n  powerCode(unpickle('{ [[ 0 | Double ]] }, List(hole3)), n / 2)\r\n```",
        "createdAt" : "2021-04-28T11:31:04Z",
        "updatedAt" : "2021-04-28T11:31:04Z",
        "lastEditedBy" : "a7e5fcc8-eade-485d-96d2-94106dd74f83",
        "tags" : [
        ]
      },
      {
        "id" : "08057336-e10e-4f73-ad17-62a8dc12b935",
        "parentId" : "6ed1d7c4-6496-4ce3-bea1-c51c78474bfe",
        "authorId" : "bc4c7970-6d84-475b-b408-2ed0f22a7bf3",
        "body" : "Thanks for the clarification. Maybe put it in the commit message or doc for future reference.",
        "createdAt" : "2021-04-28T11:34:13Z",
        "updatedAt" : "2021-04-28T11:34:13Z",
        "lastEditedBy" : "bc4c7970-6d84-475b-b408-2ed0f22a7bf3",
        "tags" : [
        ]
      }
    ],
    "commit" : "e32c8b9f6a8e211cec71fedc682a21f28852e4b1",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +491,495 @@            // Optimization: avoid the full conversion when capturing `x` with `x$1: Expr[X]`\n            // in `'{x}` to `'{ ${x$1} }'` and go directly to `x$1`\n            capturers(ref.symbol)(ref).select(nme.apply).appliedTo(quotes)\n          case tree: RefTree if isCaptured(tree.symbol, level) =>\n            val body = capturers(tree.symbol).apply(tree)"
  }
]