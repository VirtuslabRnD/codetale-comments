[
  {
    "id" : "16d3b297-58ca-49d2-a259-0ead5ee30377",
    "prId" : 4044,
    "prUrl" : "https://github.com/mlflow/mlflow/pull/4044#pullrequestreview-581892296",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "edd2457c-a8d8-43e5-b2f6-506fbb3186ed",
        "parentId" : null,
        "authorId" : "3f60ced2-d2f0-4cc5-9898-5aefe16e0be8",
        "body" : "Can we add a small docstring to this module explaining that it provides utilities for performing Azure Blob Storage operations without requiring the heavyweight `azure-storage-blob` library dependency?",
        "createdAt" : "2021-02-03T00:35:54Z",
        "updatedAt" : "2021-02-09T23:02:42Z",
        "lastEditedBy" : "3f60ced2-d2f0-4cc5-9898-5aefe16e0be8",
        "tags" : [
        ]
      }
    ],
    "commit" : "d621584ab30b6ecf30dc1cfabe67ebe996821fb6",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +3,7 @@the heavyweight azure-storage-blob library dependency\n\"\"\"\nfrom copy import deepcopy\nimport urllib\nimport logging"
  },
  {
    "id" : "137e8998-5caa-4ea0-ad0f-9aff6632b2a3",
    "prId" : 4044,
    "prUrl" : "https://github.com/mlflow/mlflow/pull/4044#pullrequestreview-585908590",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "068c3a6c-0a52-47a9-b123-f7c9c360cf81",
        "parentId" : null,
        "authorId" : "3f60ced2-d2f0-4cc5-9898-5aefe16e0be8",
        "body" : "I've introduced some client-side header name validation for the `put_block_list` and `put_block` operations after encountering an issue introduced by a recent Databricks MLflow change where the `x-ms-blob-type` header is returned as part of the SAS URI credentials from the `GetCredentialsForWrite` operation; the current client logic in this PR passes this `x-ms-blob-type` header to `put_block_list` operation (https://github.com/mlflow/mlflow/blob/125747259f3d85ad83ac838db87f1d2b5c715659/mlflow/store/artifact/databricks_artifact_repo.py#L188), but `x-ms-blob-type` isn't supported for Put Block List, which causes the request to fail. As a result, uploads on Azure Databricks throw exceptions when this client is run with the latest MLflow service code.\r\n\r\n@WeichenXu123 can you add some unit tests for `mlflow/azure/client.py` to make sure that unsupported headers are removed prior to invocation of `cloud_storage_http_request`?",
        "createdAt" : "2021-02-08T20:47:46Z",
        "updatedAt" : "2021-02-09T23:02:42Z",
        "lastEditedBy" : "3f60ced2-d2f0-4cc5-9898-5aefe16e0be8",
        "tags" : [
        ]
      }
    ],
    "commit" : "d621584ab30b6ecf30dc1cfabe67ebe996821fb6",
    "line" : 33,
    "diffHunk" : "@@ -1,1 +31,35 @@    request_headers = deepcopy(_PUT_BLOCK_HEADERS)\n    for name, value in headers.items():\n        if _is_valid_put_block_header(name):\n            request_headers[name] = value\n        else:"
  }
]