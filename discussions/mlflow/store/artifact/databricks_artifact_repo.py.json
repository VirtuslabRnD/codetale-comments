[
  {
    "id" : "18dfa7f4-259f-46c0-9e66-51a65382131d",
    "prId" : 4402,
    "prUrl" : "https://github.com/mlflow/mlflow/pull/4402#pullrequestreview-670892874",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "1273bb37-8420-45be-9c70-78be82cbcbf7",
        "parentId" : null,
        "authorId" : "3f60ced2-d2f0-4cc5-9898-5aefe16e0be8",
        "body" : "Tweaked some parameter names to be more descriptive and consistent with proto field naming (e.g. `cloud_credentials -> cloud_credential_info` to indicate a single entry within the `credential_infos` proto response field)",
        "createdAt" : "2021-05-28T03:02:29Z",
        "updatedAt" : "2021-05-28T03:02:29Z",
        "lastEditedBy" : "3f60ced2-d2f0-4cc5-9898-5aefe16e0be8",
        "tags" : [
        ]
      }
    ],
    "commit" : "f09a96cfc07591d5960f1bc239a7e3738e448d69",
    "line" : 115,
    "diffHunk" : "@@ -1,1 +259,263 @@\n    def _upload_to_cloud(\n        self, cloud_credential_info, src_file_path, dst_run_relative_artifact_path\n    ):\n        \"\"\""
  },
  {
    "id" : "2600a748-753c-4ccb-a762-7085388169a7",
    "prId" : 4402,
    "prUrl" : "https://github.com/mlflow/mlflow/pull/4402#pullrequestreview-670892894",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "063272d1-8a09-4c25-9e0c-9953f2d063c6",
        "parentId" : null,
        "authorId" : "3f60ced2-d2f0-4cc5-9898-5aefe16e0be8",
        "body" : "Tweaked some parameter names to be more descriptive and consistent with proto field naming (e.g. `cloud_credentials -> cloud_credential_info` to indicate a single entry within the `credential_infos` proto response field)",
        "createdAt" : "2021-05-28T03:02:33Z",
        "updatedAt" : "2021-05-28T03:02:33Z",
        "lastEditedBy" : "3f60ced2-d2f0-4cc5-9898-5aefe16e0be8",
        "tags" : [
        ]
      }
    ],
    "commit" : "f09a96cfc07591d5960f1bc239a7e3738e448d69",
    "line" : 137,
    "diffHunk" : "@@ -1,1 +279,283 @@            )\n\n    def _download_from_cloud(self, cloud_credential_info, dst_local_file_path):\n        \"\"\"\n        Download a file from the input `cloud_credential_info` and save it to `dst_local_file_path`."
  },
  {
    "id" : "e85454c4-5ffe-4ee9-915b-fdcfdd899bcf",
    "prId" : 4402,
    "prUrl" : "https://github.com/mlflow/mlflow/pull/4402#pullrequestreview-670895408",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "34323cbb-99b2-481f-8067-f7a58b68d779",
        "parentId" : null,
        "authorId" : "3f60ced2-d2f0-4cc5-9898-5aefe16e0be8",
        "body" : "File and directory downloads now rely on this method, which accepts a collection of paths to be downloaded and returns a collection of inflight download objects, each of which specifies the source artifact path, destination local filesystem path, and future.\r\n\r\nDirectory artifact downloads call this for each level in the artifact directory tree, and file artifact downloads call this with a single file input.",
        "createdAt" : "2021-05-28T03:10:58Z",
        "updatedAt" : "2021-05-28T03:11:11Z",
        "lastEditedBy" : "3f60ced2-d2f0-4cc5-9898-5aefe16e0be8",
        "tags" : [
        ]
      }
    ],
    "commit" : "f09a96cfc07591d5960f1bc239a7e3738e448d69",
    "line" : 330,
    "diffHunk" : "@@ -1,1 +464,468 @@        )\n\n        def async_download_file_artifacts_from_paths(src_artifact_paths, dst_local_dir_path):\n            \"\"\"\n            Initiate an asynchronous download of the file artifacts specified by"
  },
  {
    "id" : "8e2de2c2-a3ac-4988-8f40-d9e719e60fca",
    "prId" : 4402,
    "prUrl" : "https://github.com/mlflow/mlflow/pull/4402#pullrequestreview-671640178",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "936f1618-6d10-4871-9ac9-a57f329f6264",
        "parentId" : null,
        "authorId" : "ae7dd827-9f9e-4fb6-b1ba-d051793e929e",
        "body" : "Under what conditions page_token is not empty but len(response.credential_infos) == 0?",
        "createdAt" : "2021-05-28T17:33:21Z",
        "updatedAt" : "2021-05-28T17:52:37Z",
        "lastEditedBy" : "ae7dd827-9f9e-4fb6-b1ba-d051793e929e",
        "tags" : [
        ]
      },
      {
        "id" : "68de2b17-21d2-4a6b-95e3-27dd0fe6d2a6",
        "parentId" : "936f1618-6d10-4871-9ac9-a57f329f6264",
        "authorId" : "3f60ced2-d2f0-4cc5-9898-5aefe16e0be8",
        "body" : "If the backend introduces an error in page token population, this could happen. This just provides some added fault tolerance.",
        "createdAt" : "2021-05-28T19:30:32Z",
        "updatedAt" : "2021-05-28T19:41:19Z",
        "lastEditedBy" : "3f60ced2-d2f0-4cc5-9898-5aefe16e0be8",
        "tags" : [
        ]
      },
      {
        "id" : "ebc1cf4e-1760-489c-bd7f-8a66d2009e03",
        "parentId" : "936f1618-6d10-4871-9ac9-a57f329f6264",
        "authorId" : "ae7dd827-9f9e-4fb6-b1ba-d051793e929e",
        "body" : "Hmm. This could obscure backend issues that should be fixed immediately. I'd prefer to actually expose the issue instead, e.g. assert len(response.credential_infos) somewhere in the while loop.",
        "createdAt" : "2021-05-28T20:38:14Z",
        "updatedAt" : "2021-05-28T20:44:53Z",
        "lastEditedBy" : "ae7dd827-9f9e-4fb6-b1ba-d051793e929e",
        "tags" : [
        ]
      },
      {
        "id" : "f1533510-dcc3-429d-9f32-8684890bf4c0",
        "parentId" : "936f1618-6d10-4871-9ac9-a57f329f6264",
        "authorId" : "3f60ced2-d2f0-4cc5-9898-5aefe16e0be8",
        "body" : "I think we should weigh the tradeoff of expose the backend issue quickly vs. disrupting production workflows. Such an assert has the potential to break all artifact logging on Databricks.",
        "createdAt" : "2021-05-28T21:01:21Z",
        "updatedAt" : "2021-05-28T21:01:21Z",
        "lastEditedBy" : "3f60ced2-d2f0-4cc5-9898-5aefe16e0be8",
        "tags" : [
        ]
      }
    ],
    "commit" : "f09a96cfc07591d5960f1bc239a7e3738e448d69",
    "line" : 53,
    "diffHunk" : "@@ -1,1 +165,169 @@                credential_infos += response.credential_infos\n                page_token = response.next_page_token\n                if not page_token or len(response.credential_infos) == 0:\n                    break\n"
  },
  {
    "id" : "69df64d4-950b-4331-8ab6-02e6a3b4d69f",
    "prId" : 4260,
    "prUrl" : "https://github.com/mlflow/mlflow/pull/4260#pullrequestreview-653627396",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c91ce1ff-813e-41ca-970c-201ca395d154",
        "parentId" : null,
        "authorId" : "ae7dd827-9f9e-4fb6-b1ba-d051793e929e",
        "body" : "What's the typical amount of artifacts being downloaded / uploaded in a single mlflow session? Is max 8 enough to provide the speedup you are looking for?",
        "createdAt" : "2021-04-27T04:51:39Z",
        "updatedAt" : "2021-04-27T05:19:55Z",
        "lastEditedBy" : "ae7dd827-9f9e-4fb6-b1ba-d051793e929e",
        "tags" : [
        ]
      },
      {
        "id" : "6f89c918-d723-408e-ae36-c91eac3c94f1",
        "parentId" : "c91ce1ff-813e-41ca-970c-201ca395d154",
        "authorId" : "9b00f760-3323-47e3-bb69-3add3073befc",
        "body" : "Without being very knowledgeable thread pools and their resource overhead, I feel like 8 is a big improvement purely because we currently have no parallelization. Not sure if there's a good reason to overdo it from the get-go",
        "createdAt" : "2021-05-06T15:48:29Z",
        "updatedAt" : "2021-05-06T15:48:29Z",
        "lastEditedBy" : "9b00f760-3323-47e3-bb69-3add3073befc",
        "tags" : [
        ]
      },
      {
        "id" : "c2fc9ed3-efaf-4f2a-88c5-70fb34f0aea8",
        "parentId" : "c91ce1ff-813e-41ca-970c-201ca395d154",
        "authorId" : "3f60ced2-d2f0-4cc5-9898-5aefe16e0be8",
        "body" : "I took a look at the average number of files per logged model on Databricks, and the p25 - p75 number of files is 3, while the p95 is 4. The p99 is over 2000. `min(8, 2 * cpus)` seems okay given that knowledge.",
        "createdAt" : "2021-05-06T15:59:47Z",
        "updatedAt" : "2021-05-06T16:00:04Z",
        "lastEditedBy" : "3f60ced2-d2f0-4cc5-9898-5aefe16e0be8",
        "tags" : [
        ]
      }
    ],
    "commit" : "f149ebd01bc1a0645062fdc31fc995bf45a62db4",
    "line" : 30,
    "diffHunk" : "@@ -1,1 +111,115 @@        num_cpus = os.cpu_count() or 4\n        num_artifact_workers = min(num_cpus * 2, 8)\n        self.thread_pool = ThreadPoolExecutor(max_workers=num_artifact_workers)\n\n    @staticmethod"
  },
  {
    "id" : "edd73d53-195a-4d82-9753-9f7e4359327c",
    "prId" : 3687,
    "prUrl" : "https://github.com/mlflow/mlflow/pull/3687#pullrequestreview-535825578",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e02476cc-4f7d-4eb2-968d-25e724717f9d",
        "parentId" : null,
        "authorId" : "3f60ced2-d2f0-4cc5-9898-5aefe16e0be8",
        "body" : "The skinny client will eventually need to support `databricks_artifact_repo` for compatibility with Databricks. Leaving this here as a note for myself to remove the dependency on `azure.storage.blob.BlobClient` for this store. We've done this already for a different compatibility purpose on Databricks, so it should be relatively quick to apply this change.",
        "createdAt" : "2020-11-20T23:19:55Z",
        "updatedAt" : "2020-12-23T21:18:56Z",
        "lastEditedBy" : "3f60ced2-d2f0-4cc5-9898-5aefe16e0be8",
        "tags" : [
        ]
      }
    ],
    "commit" : "32fc479c6f228ed59602236386e5c998ca1d35c3",
    "line" : 1,
    "diffHunk" : "@@ -1,1 +3,7 @@import os\nimport posixpath\nimport requests\nimport uuid\n"
  },
  {
    "id" : "b15e1d15-e60e-4513-a0c5-fb7732ba1103",
    "prId" : 2998,
    "prUrl" : "https://github.com/mlflow/mlflow/pull/2998#pullrequestreview-437075424",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "cfd56b8c-5347-4e24-8ced-5da587ab6865",
        "parentId" : null,
        "authorId" : "7dc30493-29f9-4bc4-bf26-00054b8b0b57",
        "body" : "Do we always enclose multiple imports in parenthesis.?",
        "createdAt" : "2020-06-24T23:33:05Z",
        "updatedAt" : "2020-06-24T23:33:05Z",
        "lastEditedBy" : "7dc30493-29f9-4bc4-bf26-00054b8b0b57",
        "tags" : [
        ]
      },
      {
        "id" : "6ca92a85-ab1c-4d3d-ae2c-9af2bd114605",
        "parentId" : "cfd56b8c-5347-4e24-8ced-5da587ab6865",
        "authorId" : "3f60ced2-d2f0-4cc5-9898-5aefe16e0be8",
        "body" : "Good question! We use enclosing parentheses when the set of imports does not fit on one line (max length 100)",
        "createdAt" : "2020-06-24T23:35:10Z",
        "updatedAt" : "2020-06-24T23:35:10Z",
        "lastEditedBy" : "3f60ced2-d2f0-4cc5-9898-5aefe16e0be8",
        "tags" : [
        ]
      }
    ],
    "commit" : "01ec50e94e007b8522cc5a9cf1fa38e51f2b8b38",
    "line" : 15,
    "diffHunk" : "@@ -1,1 +23,27 @@from mlflow.utils.uri import (\n    extract_and_normalize_path, is_databricks_acled_artifacts_uri, get_db_profile_from_uri\n)\n\n_logger = logging.getLogger(__name__)"
  }
]