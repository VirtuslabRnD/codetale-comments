[
  {
    "id" : "d1ba5dd0-1bec-4746-be54-42a6f3f8f2ce",
    "prId" : 18733,
    "prUrl" : "https://github.com/numpy/numpy/pull/18733#pullrequestreview-632290070",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3d76ec2a-8994-4bb8-b05e-34184b14ba00",
        "parentId" : null,
        "authorId" : "34e5fe46-88c1-411b-b781-8d1b8cb470be",
        "body" : "Do you need to clone the repo? It seems that in the runtime stage you are only using the `environment.yaml` file so might be best to remove multi-stage build and copy the yaml file directly with `COPY` especially if building through GitHub actions",
        "createdAt" : "2021-04-09T10:14:12Z",
        "updatedAt" : "2021-04-10T16:05:07Z",
        "lastEditedBy" : "34e5fe46-88c1-411b-b781-8d1b8cb470be",
        "tags" : [
        ]
      },
      {
        "id" : "6dcca169-f937-48c9-bc63-955513327746",
        "parentId" : "3d76ec2a-8994-4bb8-b05e-34184b14ba00",
        "authorId" : "3a7fb80a-899a-4198-9faa-6dc02db98654",
        "body" : "While building the runtime image, numpy is built to populate the cache used by ccache. In principle we should be able to build without a `git` history, but `setup.py` depends on `versioneer.py`, which requires a git history. \r\n\r\nThe multistage stage is used to have a shallow clone, which reduces the size of the final image. \r\n\r\nI updated the PR with detailed comments to help clarify these point.",
        "createdAt" : "2021-04-09T10:57:33Z",
        "updatedAt" : "2021-04-10T16:05:07Z",
        "lastEditedBy" : "3a7fb80a-899a-4198-9faa-6dc02db98654",
        "tags" : [
        ]
      }
    ],
    "commit" : "f3817de0d032004c93bfe3e1fd94f5f39e043d28",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +12,16 @@# dependencies and build numpy to populate the cache used by ccache. Building\n# numpy with setup.py uses versioneer.py which requires a git history.\nRUN git clone --depth 1 file:////tmp/numpy_repo /tmp/numpy\n\nFROM gitpod/workspace-base as build"
  }
]