[
  {
    "id" : "84b1caae-e650-440f-ab73-a5c4b4114613",
    "prId" : 8262,
    "prUrl" : "https://github.com/digital-asset/daml/pull/8262",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d18f8aec-b78b-4f93-8865-c07c914ab898",
        "parentId" : null,
        "authorId" : "8690c022-0eb5-4c0b-9f54-a9e6ad005a86",
        "body" : "Nice solution!",
        "createdAt" : "2020-12-14T17:23:32Z",
        "updatedAt" : "2020-12-14T18:07:58Z",
        "lastEditedBy" : "8690c022-0eb5-4c0b-9f54-a9e6ad005a86",
        "tags" : [
        ]
      },
      {
        "id" : "68f95a04-2612-498a-a76c-8d2acf057a0e",
        "parentId" : "d18f8aec-b78b-4f93-8865-c07c914ab898",
        "authorId" : "181bcece-33df-41af-887d-5d5f51beb543",
        "body" : "More type parameters pushed me in this direction.",
        "createdAt" : "2020-12-14T18:01:52Z",
        "updatedAt" : "2020-12-14T18:07:58Z",
        "lastEditedBy" : "181bcece-33df-41af-887d-5d5f51beb543",
        "tags" : [
        ]
      }
    ],
    "commit" : "f9f4d50df6ac8be01734b9ae15edf4b594a09e92",
    "line" : 30,
    "diffHunk" : "@@ -1,1 +74,78 @@                cacheUpdatePolicy,\n                new LedgerStateOperationsReaderAdapter(ledgerStateOperations)\n                  .mapValues(value => value -> valueToFingerprint(value)),\n                keySerializationStrategy,\n              )"
  },
  {
    "id" : "3f457fa5-ec5a-4df9-b362-43dd4d1c6eaf",
    "prId" : 6793,
    "prUrl" : "https://github.com/digital-asset/daml/pull/6793",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "1f04d5e2-32fc-4550-91ab-0c3e1d030272",
        "parentId" : null,
        "authorId" : "8690c022-0eb5-4c0b-9f54-a9e6ad005a86",
        "body" : "If you are using pre-execution then you should only lock ledger state when committing.",
        "createdAt" : "2020-07-24T16:00:25Z",
        "updatedAt" : "2020-08-05T07:01:01Z",
        "lastEditedBy" : "8690c022-0eb5-4c0b-9f54-a9e6ad005a86",
        "tags" : [
        ]
      },
      {
        "id" : "6243589b-94ab-4ace-9b0e-c65f9f985083",
        "parentId" : "1f04d5e2-32fc-4550-91ab-0c3e1d030272",
        "authorId" : "1d70ec7b-8793-4cc6-95c8-fac6f7816dcc",
        "body" : "(And on every single read as the map is not synchronized) This means enabling concurrent pre-execution that currently does not pass conformance. See [this PR](https://github.com/digital-asset/daml/pull/6862) for concurrent pre-execution.",
        "createdAt" : "2020-07-24T17:05:02Z",
        "updatedAt" : "2020-08-05T07:01:01Z",
        "lastEditedBy" : "1d70ec7b-8793-4cc6-95c8-fac6f7816dcc",
        "tags" : [
        ]
      }
    ],
    "commit" : "b29591138330b767e0e3a5dc19bca73b14d0522c",
    "line" : 59,
    "diffHunk" : "@@ -1,1 +57,61 @@      implicit executionContext: ExecutionContext): Future[SubmissionResult] =\n    // Sequential pre-execution, implemented by enclosing the whole pre-post-exec pipeline is a single transaction.\n    ledgerStateAccess.inTransaction { ledgerStateOperations =>\n      for {\n        preExecutionOutput <- validator"
  },
  {
    "id" : "a10c444c-e1be-4270-9b1c-2c6bd6b343b0",
    "prId" : 6793,
    "prUrl" : "https://github.com/digital-asset/daml/pull/6793",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "17931e2e-d9ae-4aae-b5d8-0dff1a628c4a",
        "parentId" : null,
        "authorId" : "8690c022-0eb5-4c0b-9f54-a9e6ad005a86",
        "body" : "For pre-execution we shouldn't need new instances of `LedgerStateReader` for every request.",
        "createdAt" : "2020-07-24T16:01:47Z",
        "updatedAt" : "2020-08-05T07:01:01Z",
        "lastEditedBy" : "8690c022-0eb5-4c0b-9f54-a9e6ad005a86",
        "tags" : [
        ]
      },
      {
        "id" : "bb566184-2d13-4b56-9800-13fc3dfed10b",
        "parentId" : "17931e2e-d9ae-4aae-b5d8-0dff1a628c4a",
        "authorId" : "1d70ec7b-8793-4cc6-95c8-fac6f7816dcc",
        "body" : "We do, but only because the transaction is opened every time a commit operation is initiated (and only in the context of the transaction we have access to the operations).",
        "createdAt" : "2020-08-03T16:44:24Z",
        "updatedAt" : "2020-08-05T07:01:01Z",
        "lastEditedBy" : "1d70ec7b-8793-4cc6-95c8-fac6f7816dcc",
        "tags" : [
        ]
      }
    ],
    "commit" : "b29591138330b767e0e3a5dc19bca73b14d0522c",
    "line" : 66,
    "diffHunk" : "@@ -1,1 +64,68 @@            correlationId,\n            submittingParticipantId,\n            CachingDamlLedgerStateReaderWithFingerprints(\n              stateValueCache,\n              cacheUpdatePolicy,"
  },
  {
    "id" : "61098102-77d0-4d9b-9442-c5550045494f",
    "prId" : 10450,
    "prUrl" : "https://github.com/digital-asset/daml/pull/10450#pullrequestreview-719843288",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3be1c978-893a-4ac3-847b-7401369f1a92",
        "parentId" : null,
        "authorId" : "2a803e3e-0f8e-44e8-a99a-06dffc638187",
        "body" : "Can we confirm that this is the desired behavior? \r\n\r\n- We finish the submission if it was successfull (this includes the case where a conflict was detected)",
        "createdAt" : "2021-08-02T06:26:26Z",
        "updatedAt" : "2021-08-02T06:27:04Z",
        "lastEditedBy" : "2a803e3e-0f8e-44e8-a99a-06dffc638187",
        "tags" : [
        ]
      },
      {
        "id" : "105053a6-3532-4512-a59c-5097020b2508",
        "parentId" : "3be1c978-893a-4ac3-847b-7401369f1a92",
        "authorId" : "181bcece-33df-41af-887d-5d5f51beb543",
        "body" : "This is aggregating submissions for export, and so should only `finish` when the submission is committed to the ledger. In other words, no, we need to do this earlier (ideally directly after writing).",
        "createdAt" : "2021-08-02T06:44:50Z",
        "updatedAt" : "2021-08-02T06:49:32Z",
        "lastEditedBy" : "181bcece-33df-41af-887d-5d5f51beb543",
        "tags" : [
        ]
      },
      {
        "id" : "7e191a97-b337-4a80-b4cd-62e75a4af081",
        "parentId" : "3be1c978-893a-4ac3-847b-7401369f1a92",
        "authorId" : "1d70ec7b-8793-4cc6-95c8-fac6f7816dcc",
        "body" : "Yes, I think it's correct to avoid exporting it.",
        "createdAt" : "2021-08-02T06:45:52Z",
        "updatedAt" : "2021-08-02T07:28:31Z",
        "lastEditedBy" : "1d70ec7b-8793-4cc6-95c8-fac6f7816dcc",
        "tags" : [
        ]
      }
    ],
    "commit" : "8e30db61751d9d665d011a9b5f1aa279962e98a3",
    "line" : 39,
    "diffHunk" : "@@ -1,1 +90,94 @@          )\n        } yield {\n          submissionAggregator.finish()\n          submissionResult\n        }"
  },
  {
    "id" : "920b6bc8-bc1a-4b8f-b05e-7ef872166c47",
    "prId" : 10450,
    "prUrl" : "https://github.com/digital-asset/daml/pull/10450#pullrequestreview-719844558",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2be8646e-6a2b-4b54-8085-0b5ec03354b8",
        "parentId" : null,
        "authorId" : "181bcece-33df-41af-887d-5d5f51beb543",
        "body" : "Well, I find this much more pleasant to read.",
        "createdAt" : "2021-08-02T06:45:37Z",
        "updatedAt" : "2021-08-02T06:49:32Z",
        "lastEditedBy" : "181bcece-33df-41af-887d-5d5f51beb543",
        "tags" : [
        ]
      }
    ],
    "commit" : "8e30db61751d9d665d011a9b5f1aa279962e98a3",
    "line" : 34,
    "diffHunk" : "@@ -1,1 +79,83 @@            stateReader,\n          )\n          _ <- postExecutionConflictDetector.detectConflicts(preExecutionOutput, stateReader)\n          writeSet = postExecutionWriteSetSelector.selectWriteSet(preExecutionOutput)\n          submissionResult <- postExecutionWriter.write("
  }
]