[
  {
    "id" : "9ec6c268-c2ad-40a9-ad6c-0ac53a65f55e",
    "prId" : 15735,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "794cc67c-e4d7-4fc3-9446-4c0bc06ef6b9",
        "parentId" : null,
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "Should't we log this as well?\n",
        "createdAt" : "2015-10-16T05:40:46Z",
        "updatedAt" : "2015-10-16T14:16:35Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      },
      {
        "id" : "e39f1f88-d4b5-40a1-a752-53572e79c707",
        "parentId" : "794cc67c-e4d7-4fc3-9446-4c0bc06ef6b9",
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "Am a bit surprised that we don't.\n",
        "createdAt" : "2015-10-16T05:40:58Z",
        "updatedAt" : "2015-10-16T14:16:35Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      },
      {
        "id" : "cac68728-cae5-49fb-a71a-025a07fcc8d7",
        "parentId" : "794cc67c-e4d7-4fc3-9446-4c0bc06ef6b9",
        "authorId" : "aefa6d0d-0ad0-4062-966c-ddc56e70652b",
        "body" : "glog pushes everything to stderr. stdout is really only used by the\ndetailed connection-spying stuff in mesos-go (which is why the mgo upgrade\nbroke when stdout blocked and verbosity is jacked up). I'm happy to do\naddress logging this to a file in a separate PR. This PR is simply to stop\nthe breakage.\n\nOn Fri, Oct 16, 2015 at 1:41 AM, Dr. Stefan Schimanski <\nnotifications@github.com> wrote:\n\n> In contrib/mesos/pkg/minion/tasks/task.go\n> https://github.com/kubernetes/kubernetes/pull/15735#discussion_r42210150\n> :\n> \n> > ```\n> >     t.tryError(fmt.Errorf(\"error getting stdout of %v: %v\", t.name, err))\n> >     return taskShouldRestart\n> > }\n> > ```\n> > -   go func() {\n> > -       defer stdout.Close()\n> > -       io.Copy(ioutil.Discard, stdout) // TODO(jdef) we might want to save this at some point\n> \n> Should't we log this as well?\n> \n> â€”\n> Reply to this email directly or view it on GitHub\n> https://github.com/kubernetes/kubernetes/pull/15735/files#r42210150.\n",
        "createdAt" : "2015-10-16T08:10:34Z",
        "updatedAt" : "2015-10-16T14:16:35Z",
        "lastEditedBy" : "aefa6d0d-0ad0-4062-966c-ddc56e70652b",
        "tags" : [
        ]
      },
      {
        "id" : "c8ee57bf-025f-4362-b2c8-5e2e8912c23d",
        "parentId" : "794cc67c-e4d7-4fc3-9446-4c0bc06ef6b9",
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "Sounds reasonable.\n",
        "createdAt" : "2015-10-16T08:37:34Z",
        "updatedAt" : "2015-10-16T14:16:35Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      }
    ],
    "commit" : "cbc6c64157a8c729d4c152b10fc51f814261837e",
    "line" : 20,
    "diffHunk" : "@@ -1,1 +227,231 @@\tgo func() {\n\t\tdefer stdout.Close()\n\t\tio.Copy(ioutil.Discard, stdout) // TODO(jdef) we might want to save this at some point\n\t}()\n\tstderrLogs, err := cmd.StderrPipe()"
  },
  {
    "id" : "9bbde35a-3af7-454d-8151-9e18a61efe28",
    "prId" : 14489,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a3bf8de9-9721-4ca9-9ee2-ce979ab44607",
        "parentId" : null,
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "pretty deep nesting with this for-loop. At least add a comment why we do this twice.\n",
        "createdAt" : "2015-09-24T14:09:34Z",
        "updatedAt" : "2015-09-24T18:54:02Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      }
    ],
    "commit" : "ec2605a7586018f8cea8eadf6e1c6ead667d32b6",
    "line" : null,
    "diffHunk" : "@@ -1,1 +310,314 @@\t// pid namespace isolation should mitigate this.\nwaitLoop:\n\tfor i := 0; i < 2; i++ {\n\t\tlog.Infof(\"killing %s (force=%t) : %s\", t.name, forceKill, t.bin)\n\t\tpid, err := t.killFunc(forceKill)"
  },
  {
    "id" : "c8b19d41-9a96-45c1-bfd3-37a488f84e74",
    "prId" : 14489,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6cef5de3-f4f6-4b6c-8914-b3eff86c94b4",
        "parentId" : null,
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : ":+1: \n",
        "createdAt" : "2015-09-24T17:19:32Z",
        "updatedAt" : "2015-09-24T18:54:02Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      }
    ],
    "commit" : "ec2605a7586018f8cea8eadf6e1c6ead667d32b6",
    "line" : 159,
    "diffHunk" : "@@ -1,1 +308,312 @@\t// does exist a slim chance that the underlying wait4() syscall won't complete before\n\t// this process dies, in which case a zombie will rise. Starting the mesos slave with\n\t// pid namespace isolation should mitigate this.\nwaitLoop:\n\tfor i := 0; i < 2; i++ {"
  },
  {
    "id" : "48aa82e8-f911-4b6e-9ea5-65c0cc0edfee",
    "prId" : 14489,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e17429ca-0afa-4341-82fa-114413543ede",
        "parentId" : null,
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "Yeah, much much simpler now!\n",
        "createdAt" : "2015-09-24T18:13:20Z",
        "updatedAt" : "2015-09-24T18:54:02Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      }
    ],
    "commit" : "ec2605a7586018f8cea8eadf6e1c6ead667d32b6",
    "line" : 161,
    "diffHunk" : "@@ -1,1 +310,314 @@\t// pid namespace isolation should mitigate this.\nwaitLoop:\n\tfor i := 0; i < 2; i++ {\n\t\tlog.Infof(\"killing %s (force=%t) : %s\", t.name, forceKill, t.bin)\n\t\tpid, err := t.killFunc(forceKill)"
  },
  {
    "id" : "6d3a1ac6-21f9-4bc8-89a3-556aad9a7168",
    "prId" : 14489,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "fd3e6784-1960-442e-8411-66a7ebb2afdc",
        "parentId" : null,
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "Nit: I would have moved this into its own taskStateFn.\n",
        "createdAt" : "2015-09-24T18:14:19Z",
        "updatedAt" : "2015-09-24T18:54:02Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      },
      {
        "id" : "18eaaae8-e8b0-45d3-b0e0-041a2ada8f27",
        "parentId" : "fd3e6784-1960-442e-8411-66a7ebb2afdc",
        "authorId" : "aefa6d0d-0ad0-4062-966c-ddc56e70652b",
        "body" : "sigh... i could have. It'd be a two liner. IMO not worth it.\n",
        "createdAt" : "2015-09-24T18:20:01Z",
        "updatedAt" : "2015-09-24T18:54:02Z",
        "lastEditedBy" : "aefa6d0d-0ad0-4062-966c-ddc56e70652b",
        "tags" : [
        ]
      },
      {
        "id" : "5f3d10b3-5d05-486e-a787-820b66d85cc2",
        "parentId" : "fd3e6784-1960-442e-8411-66a7ebb2afdc",
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "How you like. It's also fine as it is.\n",
        "createdAt" : "2015-09-24T18:21:48Z",
        "updatedAt" : "2015-09-24T18:54:02Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      }
    ],
    "commit" : "ec2605a7586018f8cea8eadf6e1c6ead667d32b6",
    "line" : 131,
    "diffHunk" : "@@ -1,1 +282,286 @@\tselect {\n\tcase <-t.shouldQuit:\n\t\tt.tryComplete(t.awaitDeath(defaultKillGracePeriod, waitCh))\n\tcase wr := <-waitCh:\n\t\tt.tryComplete(wr)"
  },
  {
    "id" : "bad58463-7908-45c2-ac27-ec4fb7d7fa2b",
    "prId" : 14489,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "33e44824-ed59-402e-8612-f3635b24b526",
        "parentId" : null,
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : ":+1: \n",
        "createdAt" : "2015-09-24T18:14:34Z",
        "updatedAt" : "2015-09-24T18:54:02Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      }
    ],
    "commit" : "ec2605a7586018f8cea8eadf6e1c6ead667d32b6",
    "line" : 175,
    "diffHunk" : "@@ -1,1 +324,328 @@\t\tcase <-time.After(gracePeriod):\n\t\t\t// want a timeout, but a shorter one than we used initially.\n\t\t\t// using /= 2 is deterministic and yields the desirable effect.\n\t\t\tgracePeriod /= 2\n\t\t\tforceKill = true"
  },
  {
    "id" : "5414ec00-a736-49a8-a9ac-d2ef762bb6fa",
    "prId" : 13295,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "18603906-2920-45eb-8ee8-8620b8f97555",
        "parentId" : null,
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "doc.go is missing for the new module\n",
        "createdAt" : "2015-09-02T08:04:46Z",
        "updatedAt" : "2015-09-03T22:47:23Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      },
      {
        "id" : "b56df138-48e4-41de-9714-29bd615935a1",
        "parentId" : "18603906-2920-45eb-8ee8-8620b8f97555",
        "authorId" : "aefa6d0d-0ad0-4062-966c-ddc56e70652b",
        "body" : "fixed\n",
        "createdAt" : "2015-09-03T01:15:44Z",
        "updatedAt" : "2015-09-03T22:47:23Z",
        "lastEditedBy" : "aefa6d0d-0ad0-4062-966c-ddc56e70652b",
        "tags" : [
        ]
      }
    ],
    "commit" : "124929e373b638721d80c6f29e81c4e16adb07c7",
    "line" : 17,
    "diffHunk" : "@@ -1,1 +15,19 @@*/\n\npackage tasks\n\nimport ("
  },
  {
    "id" : "fd91fafb-4093-45c2-9e8f-25fb584bcb3a",
    "prId" : 13295,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5422f364-748a-4bdb-828d-b9de808c0d0c",
        "parentId" : null,
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "Should we reduce verbosity for those messages?\n",
        "createdAt" : "2015-09-02T08:15:43Z",
        "updatedAt" : "2015-09-03T22:47:23Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      },
      {
        "id" : "8f933c97-a0c0-42fb-a5dd-863cfeed5519",
        "parentId" : "5422f364-748a-4bdb-828d-b9de808c0d0c",
        "authorId" : "aefa6d0d-0ad0-4062-966c-ddc56e70652b",
        "body" : "I'm fine with this level of logging. I don't expect that tasks will restart very often. If it does happen, then I want it to be obvious in the logs.\n",
        "createdAt" : "2015-09-02T19:09:34Z",
        "updatedAt" : "2015-09-03T22:47:23Z",
        "lastEditedBy" : "aefa6d0d-0ad0-4062-966c-ddc56e70652b",
        "tags" : [
        ]
      }
    ],
    "commit" : "124929e373b638721d80c6f29e81c4e16adb07c7",
    "line" : 234,
    "diffHunk" : "@@ -1,1 +232,236 @@\t\treturn taskShouldRestart\n\t}\n\tlog.Infoln(\"task started\", t.name)\n\tt.cmd = &cmdProcess{delegate: cmd}\n\treturn taskRunning"
  },
  {
    "id" : "0e716466-4e42-42d1-bcb1-de902cfaaa48",
    "prId" : 13295,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "57f92fd2-0210-4798-9177-ca2e6d9b630a",
        "parentId" : null,
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "Simpler: create a TaskCompletion event here with the err. Then get rid of the extra waitResult struct type above.\n",
        "createdAt" : "2015-09-02T08:22:09Z",
        "updatedAt" : "2015-09-03T22:47:23Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      }
    ],
    "commit" : "124929e373b638721d80c6f29e81c4e16adb07c7",
    "line" : null,
    "diffHunk" : "@@ -1,1 +272,276 @@\t\t\t\t}\n\t\t\t}\n\t\t\twr.err = fmt.Errorf(\"task wait ended strangely for %q: %v\", t.bin, err)\n\t\t} else {\n\t\t\twr.name = t.name"
  },
  {
    "id" : "c26382d0-a55c-4737-a9c8-e755c40728df",
    "prId" : 13295,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "969c0e54-de4d-4677-b1fc-c46e80bca5c8",
        "parentId" : null,
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "This two-liner function is only used once. Might make sense to inline.\n",
        "createdAt" : "2015-09-02T08:23:54Z",
        "updatedAt" : "2015-09-03T22:47:23Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      },
      {
        "id" : "e6e55980-1a7c-419a-8be0-7011c78c5ee2",
        "parentId" : "969c0e54-de4d-4677-b1fc-c46e80bca5c8",
        "authorId" : "aefa6d0d-0ad0-4062-966c-ddc56e70652b",
        "body" : "I'd rather keep as-is: it changes task state and in this case I'd rather do that in a func that has a task receiver vs. a package-level func.\n",
        "createdAt" : "2015-09-03T01:02:58Z",
        "updatedAt" : "2015-09-03T22:47:23Z",
        "lastEditedBy" : "aefa6d0d-0ad0-4062-966c-ddc56e70652b",
        "tags" : [
        ]
      }
    ],
    "commit" : "124929e373b638721d80c6f29e81c4e16adb07c7",
    "line" : 304,
    "diffHunk" : "@@ -1,1 +302,306 @@}\n\n// forwardUntil forwards task process completion status and errors to the given output\n// chans until either the task terminates or abort is closed.\nfunc (t *Task) forwardUntil(tch chan<- *Completion, abort <-chan struct{}) {"
  },
  {
    "id" : "15b19ed6-ff61-49cc-9b00-c73ac5d49cb5",
    "prId" : 13295,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d1786ffb-6d12-4d3e-8226-f0042eeff483",
        "parentId" : null,
        "authorId" : "727fc82d-d969-41a4-a614-7fefce94f9a6",
        "body" : "This fails for me.\n\n```\n$ go version\ngo version go1.4.2 darwin/amd64\n\n$ hack/test-go.sh contrib/mesos/cmd/km\nRunning tests for APIVersion: v1 with etcdPrefix: registry\n+++ [0904 11:11:13] Running tests without code coverage\n# k8s.io/kubernetes/contrib/mesos/pkg/minion/tasks\n_output/local/go/src/k8s.io/kubernetes/contrib/mesos/pkg/minion/tasks/task.go:219: unknown syscall.SysProcAttr field 'Pdeathsig' in struct literal\nFAIL    k8s.io/kubernetes/contrib/mesos/cmd/km [build failed]\n!!! Error in hack/test-go.sh:292\n  'return ${rc}' exited with status 2\nCall stack:\n  1: hack/test-go.sh:292 main(...)\nExiting with status 1\n```\n",
        "createdAt" : "2015-09-04T15:11:57Z",
        "updatedAt" : "2015-09-04T15:11:57Z",
        "lastEditedBy" : "727fc82d-d969-41a4-a614-7fefce94f9a6",
        "tags" : [
        ]
      },
      {
        "id" : "a0f2b6c3-1226-4a87-a4a6-44ac0c0f339a",
        "parentId" : "d1786ffb-6d12-4d3e-8226-f0042eeff483",
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "`Pdeathsig` is linux specific. I did a fix already for Mac.\n",
        "createdAt" : "2015-09-04T15:14:03Z",
        "updatedAt" : "2015-09-04T15:14:03Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      },
      {
        "id" : "ec09fa9f-82a0-4f0d-8d9b-406a95ceccf7",
        "parentId" : "d1786ffb-6d12-4d3e-8226-f0042eeff483",
        "authorId" : "727fc82d-d969-41a4-a614-7fefce94f9a6",
        "body" : "In my version of Go:\n\n```\ntype SysProcAttr struct {\n    Chroot     string      // Chroot.\n    Credential *Credential // Credential.\n    Ptrace     bool        // Enable tracing.\n    Setsid     bool        // Create session.\n    Setpgid    bool        // Set process group ID to new pid (SYSV setpgrp)\n    Setctty    bool        // Set controlling terminal to fd 0\n    Noctty     bool        // Detach fd 0 from controlling terminal\n}\n```\n",
        "createdAt" : "2015-09-04T15:16:57Z",
        "updatedAt" : "2015-09-04T15:16:57Z",
        "lastEditedBy" : "727fc82d-d969-41a4-a614-7fefce94f9a6",
        "tags" : [
        ]
      },
      {
        "id" : "38b0b0a2-ade1-4317-a5fd-c91a5c8b8b70",
        "parentId" : "d1786ffb-6d12-4d3e-8226-f0042eeff483",
        "authorId" : "727fc82d-d969-41a4-a614-7fefce94f9a6",
        "body" : "@sttts link to the PR so I can cherry pick it?  I've rebased, so I assume it's not merged.\n",
        "createdAt" : "2015-09-04T15:19:20Z",
        "updatedAt" : "2015-09-04T15:19:20Z",
        "lastEditedBy" : "727fc82d-d969-41a4-a614-7fefce94f9a6",
        "tags" : [
        ]
      },
      {
        "id" : "fb24cbc1-fe06-4126-9801-2866a7f1029a",
        "parentId" : "d1786ffb-6d12-4d3e-8226-f0042eeff483",
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "Still have to push it. It's only on our release branch right now. Will post it here in a few minutes.\n",
        "createdAt" : "2015-09-04T15:21:48Z",
        "updatedAt" : "2015-09-04T15:21:48Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      },
      {
        "id" : "ff9ea7b5-b7a1-43f4-8751-66b5f20c7492",
        "parentId" : "d1786ffb-6d12-4d3e-8226-f0042eeff483",
        "authorId" : "727fc82d-d969-41a4-a614-7fefce94f9a6",
        "body" : "Thanks.  I made an issue for this before I saw you started replying.  I can delete it if you've already got one.\n\nhttps://github.com/kubernetes/kubernetes/issues/13592\n",
        "createdAt" : "2015-09-04T15:25:37Z",
        "updatedAt" : "2015-09-04T15:25:37Z",
        "lastEditedBy" : "727fc82d-d969-41a4-a614-7fefce94f9a6",
        "tags" : [
        ]
      },
      {
        "id" : "98bb9900-2c6c-40d2-814b-6e49b55f75c7",
        "parentId" : "d1786ffb-6d12-4d3e-8226-f0042eeff483",
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "Here is the patch: https://github.com/kubernetes/kubernetes/pull/13596\n",
        "createdAt" : "2015-09-04T15:47:16Z",
        "updatedAt" : "2015-09-04T15:47:16Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      }
    ],
    "commit" : "124929e373b638721d80c6f29e81c4e16adb07c7",
    "line" : 219,
    "diffHunk" : "@@ -1,1 +217,221 @@\tcmd.SysProcAttr = &syscall.SysProcAttr{\n\t\tSetpgid:   true,\n\t\tPdeathsig: syscall.SIGKILL, // see cmdProcess.Kill\n\t}\n"
  }
]