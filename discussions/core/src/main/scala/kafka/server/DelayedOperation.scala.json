[
  {
    "id" : "c79064ac-c4f1-4ee9-aaf5-bece15e34800",
    "prId" : 8657,
    "prUrl" : "https://github.com/apache/kafka/pull/8657#pullrequestreview-483687990",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "66c64abf-1001-4bc1-a3a6-1dc8633d1893",
        "parentId" : null,
        "authorId" : "442b5138-0781-4001-8ac5-0593f2136d1c",
        "body" : "This approach is fine but leaks operation.lock beyond tests. Another way to package this is to add a new method in DelayedOperation like tryCompleteAndMaybeWatch(). If that's not very clean, we can keep the current approach. ",
        "createdAt" : "2020-09-06T16:59:20Z",
        "updatedAt" : "2020-09-08T16:18:13Z",
        "lastEditedBy" : "442b5138-0781-4001-8ac5-0593f2136d1c",
        "tags" : [
        ]
      },
      {
        "id" : "1a11d30b-abfc-4cc0-aa8a-727dd6fe8dc7",
        "parentId" : "66c64abf-1001-4bc1-a3a6-1dc8633d1893",
        "authorId" : "0f776378-bb23-4193-9bb0-1db5973f3781",
        "body" : "There is an new test for this new behavior. In the DelayedOperationTest.",
        "createdAt" : "2020-09-06T17:57:55Z",
        "updatedAt" : "2020-09-08T16:18:13Z",
        "lastEditedBy" : "0f776378-bb23-4193-9bb0-1db5973f3781",
        "tags" : [
        ]
      },
      {
        "id" : "f892bb28-1895-4cf6-ad2e-c5db3ca8e1db",
        "parentId" : "66c64abf-1001-4bc1-a3a6-1dc8633d1893",
        "authorId" : "442b5138-0781-4001-8ac5-0593f2136d1c",
        "body" : "Yes, it's just that if all non-testing usage of DelayedOperation.lock is within DelayedOperation itself, it makes it a bit easier to trace down all usage of lock.\r\n",
        "createdAt" : "2020-09-06T18:43:34Z",
        "updatedAt" : "2020-09-08T16:18:13Z",
        "lastEditedBy" : "442b5138-0781-4001-8ac5-0593f2136d1c",
        "tags" : [
        ]
      },
      {
        "id" : "e7b84c6d-c589-4373-9f9b-35759db9ecff",
        "parentId" : "66c64abf-1001-4bc1-a3a6-1dc8633d1893",
        "authorId" : "0f776378-bb23-4193-9bb0-1db5973f3781",
        "body" : "Will copy that ",
        "createdAt" : "2020-09-07T18:44:50Z",
        "updatedAt" : "2020-09-08T16:18:13Z",
        "lastEditedBy" : "0f776378-bb23-4193-9bb0-1db5973f3781",
        "tags" : [
        ]
      }
    ],
    "commit" : "fbd46565aa5e03f4fd9c857a184b7c2371ca5932",
    "line" : 142,
    "diffHunk" : "@@ -1,1 +235,239 @@      watchKeys.foreach(key => watchForOperation(key, operation))\n      if (watchKeys.nonEmpty) estimatedTotalOperations.incrementAndGet()\n    }) return true\n\n    // if it cannot be completed by now and hence is watched, add to the expire queue also"
  }
]