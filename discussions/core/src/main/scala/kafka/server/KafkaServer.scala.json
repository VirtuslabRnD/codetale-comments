[
  {
    "id" : "8d3fae70-c80e-4e65-9ccd-f00290cda860",
    "prId" : 4351,
    "prUrl" : "https://github.com/apache/kafka/pull/4351#pullrequestreview-85275179",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ae83b4c0-be07-4cdd-970b-829576a7f1c5",
        "parentId" : null,
        "authorId" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "body" : "Should we ignore the missing controller and retry (like we ignore the missing broker info)?",
        "createdAt" : "2017-12-22T09:51:50Z",
        "updatedAt" : "2017-12-22T10:27:00Z",
        "lastEditedBy" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "tags" : [
        ]
      }
    ],
    "commit" : "d10b7657e7d5ebc621fbbf1c9ed6402af7cc63a1",
    "line" : 123,
    "diffHunk" : "@@ -1,1 +440,444 @@          // Get the current controller info. This is to ensure we use the most recent info to issue the\n          // controlled shutdown request\n          val controllerId = zkClient.getControllerId.getOrElse(throw new KafkaException(\"Controller doesn't exist\"))\n          //If this method returns None ignore and try again\n          zkClient.getBroker(controllerId).foreach { broker =>"
  },
  {
    "id" : "0ea31657-3019-4f1d-a7e0-54a9d8aa3a00",
    "prId" : 4867,
    "prUrl" : "https://github.com/apache/kafka/pull/4867#pullrequestreview-112405340",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a193d5e0-9694-4af4-a198-9b28fb13f5d8",
        "parentId" : null,
        "authorId" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "body" : "We should document the new parameter in the scaladoc for `startup` and the reason why it's needed (i.e. people shouldn't have to read the comments in a particular usage to understand it). We should also include the actual behaviour impact (e.g. what happens to the requests that arrive while the processors are not started). ",
        "createdAt" : "2018-04-16T13:19:46Z",
        "updatedAt" : "2018-04-16T13:58:03Z",
        "lastEditedBy" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "tags" : [
        ]
      }
    ],
    "commit" : "d881674db8abb655be89fd0d126c34c99cf8d2fd",
    "line" : 9,
    "diffHunk" : "@@ -1,1 +248,252 @@        // that credentials have been loaded before processing authentications.\n        socketServer = new SocketServer(config, metrics, time, credentialProvider)\n        socketServer.startup(startupProcessors = false)\n\n        /* start replica manager */"
  },
  {
    "id" : "01a3da55-39bf-48ed-9f40-e873d4e2aae2",
    "prId" : 7189,
    "prUrl" : "https://github.com/apache/kafka/pull/7189#pullrequestreview-273920597",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a317ae6f-1d51-4c0c-8f13-4e5c441b304e",
        "parentId" : null,
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "It might be helpful in this case to include the inconsistent metadata in the exception message (ideally with log dir information).",
        "createdAt" : "2019-08-12T16:33:10Z",
        "updatedAt" : "2019-08-13T23:10:27Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      },
      {
        "id" : "64dff859-fbae-46af-b916-9ef4adbcc5c0",
        "parentId" : "a317ae6f-1d51-4c0c-8f13-4e5c441b304e",
        "authorId" : "59ca7821-b29c-4f24-a9d5-cbd394145686",
        "body" : "Done.",
        "createdAt" : "2019-08-12T20:07:17Z",
        "updatedAt" : "2019-08-13T23:10:27Z",
        "lastEditedBy" : "59ca7821-b29c-4f24-a9d5-cbd394145686",
        "tags" : [
        ]
      }
    ],
    "commit" : "a4ad2e5b579e011c7e7f1435f9bef0d9ba279bf3",
    "line" : 106,
    "diffHunk" : "@@ -1,1 +716,720 @@\n      throw new InconsistentBrokerMetadataException(\n        s\"BrokerMetadata is not consistent across log.dirs. This could happen if multiple brokers shared a log directory (log.dirs) \" +\n        s\"or partial data was manually copied from another broker. Found:\\n${builder.toString()}\"\n      )"
  },
  {
    "id" : "a0b574a7-b0b8-4a0a-81d2-d715498aa184",
    "prId" : 7189,
    "prUrl" : "https://github.com/apache/kafka/pull/7189#pullrequestreview-274601848",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "cbf70996-0312-450a-8a37-b5b774202ea9",
        "parentId" : null,
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "How much effort would it be to add a test covering this case?",
        "createdAt" : "2019-08-13T20:56:46Z",
        "updatedAt" : "2019-08-13T23:10:27Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      },
      {
        "id" : "2d6d64ae-0f1b-4c1b-96e9-ebb83c3aff2c",
        "parentId" : "cbf70996-0312-450a-8a37-b5b774202ea9",
        "authorId" : "59ca7821-b29c-4f24-a9d5-cbd394145686",
        "body" : "I have added a test to cover this.",
        "createdAt" : "2019-08-13T23:11:08Z",
        "updatedAt" : "2019-08-13T23:11:08Z",
        "lastEditedBy" : "59ca7821-b29c-4f24-a9d5-cbd394145686",
        "tags" : [
        ]
      }
    ],
    "commit" : "a4ad2e5b579e011c7e7f1435f9bef0d9ba279bf3",
    "line" : 105,
    "diffHunk" : "@@ -1,1 +715,719 @@        builder ++= s\"- $logDir -> $brokerMetadata\\n\"\n\n      throw new InconsistentBrokerMetadataException(\n        s\"BrokerMetadata is not consistent across log.dirs. This could happen if multiple brokers shared a log directory (log.dirs) \" +\n        s\"or partial data was manually copied from another broker. Found:\\n${builder.toString()}\""
  },
  {
    "id" : "e00efdb9-3f1d-4615-af22-0c35236cd8bb",
    "prId" : 8691,
    "prUrl" : "https://github.com/apache/kafka/pull/8691#pullrequestreview-418671708",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d5b2ed43-4a24-45f7-aa37-64ff38b6aae1",
        "parentId" : null,
        "authorId" : "083f2f03-ca7e-48a1-9781-482564dfdf53",
        "body" : "Should we rename jmxPrefix to metricsPrefix?",
        "createdAt" : "2020-05-22T19:44:30Z",
        "updatedAt" : "2020-05-27T17:48:24Z",
        "lastEditedBy" : "083f2f03-ca7e-48a1-9781-482564dfdf53",
        "tags" : [
        ]
      },
      {
        "id" : "959a074b-9420-4ed5-802e-93e3117c911b",
        "parentId" : "d5b2ed43-4a24-45f7-aa37-64ff38b6aae1",
        "authorId" : "bc2371dd-0e94-4f44-86df-23f6bf4c71c4",
        "body" : "jmxPrefix is from existing codebase: https://github.com/apache/kafka/blob/ec205171e5fddbae2ebc1784adf73a6732889a49/core/src/main/scala/kafka/server/KafkaServer.scala#L132\r\n\r\nWe can move the comments beneath it so it is not confusing",
        "createdAt" : "2020-05-22T20:44:55Z",
        "updatedAt" : "2020-05-27T17:48:24Z",
        "lastEditedBy" : "bc2371dd-0e94-4f44-86df-23f6bf4c71c4",
        "tags" : [
        ]
      },
      {
        "id" : "fa168340-29f3-4e3f-8fb5-79a831302ecd",
        "parentId" : "d5b2ed43-4a24-45f7-aa37-64ff38b6aae1",
        "authorId" : "bc2371dd-0e94-4f44-86df-23f6bf4c71c4",
        "body" : "Moved these definition of kafka.cluster.id and kafka.broker.id to KafkaConfig",
        "createdAt" : "2020-05-23T00:24:34Z",
        "updatedAt" : "2020-05-27T17:48:24Z",
        "lastEditedBy" : "bc2371dd-0e94-4f44-86df-23f6bf4c71c4",
        "tags" : [
        ]
      },
      {
        "id" : "e6278e55-04ad-4d1d-9178-d348d07a5cc0",
        "parentId" : "d5b2ed43-4a24-45f7-aa37-64ff38b6aae1",
        "authorId" : "73896ffa-873a-4115-b79b-370ca722bd60",
        "body" : "any reason you moved some but not jmxPrefix? I think it would make sense to keep all the metrics context constants in one place. I didn't see any comment from @mumrah suggesting to move them.",
        "createdAt" : "2020-05-23T01:45:37Z",
        "updatedAt" : "2020-05-27T17:48:24Z",
        "lastEditedBy" : "73896ffa-873a-4115-b79b-370ca722bd60",
        "tags" : [
        ]
      },
      {
        "id" : "b862004b-3b38-4b27-8fb4-a1567a3de909",
        "parentId" : "d5b2ed43-4a24-45f7-aa37-64ff38b6aae1",
        "authorId" : "bc2371dd-0e94-4f44-86df-23f6bf4c71c4",
        "body" : "From his comments: \"I think the ability to include \"metrics.context.*\" values as config is generally useful. Is it worth doing this for the broker as well?\"\r\nLooks like I misunderstood what he meant. Just talked to him on slack. I'll revert that change.",
        "createdAt" : "2020-05-23T03:47:23Z",
        "updatedAt" : "2020-05-27T17:48:24Z",
        "lastEditedBy" : "bc2371dd-0e94-4f44-86df-23f6bf4c71c4",
        "tags" : [
        ]
      },
      {
        "id" : "66c70adf-4580-4af5-ba8f-d01b83b78cb1",
        "parentId" : "d5b2ed43-4a24-45f7-aa37-64ff38b6aae1",
        "authorId" : "083f2f03-ca7e-48a1-9781-482564dfdf53",
        "body" : "This comment was just about the `jmxPrefix` variable. I realize it's pre-existing code, but now that it's not specific to JMX, I suggested renaming it. ",
        "createdAt" : "2020-05-26T15:04:05Z",
        "updatedAt" : "2020-05-27T17:48:24Z",
        "lastEditedBy" : "083f2f03-ca7e-48a1-9781-482564dfdf53",
        "tags" : [
        ]
      },
      {
        "id" : "f1283ff5-ed17-4fc2-9ab2-8355c72bc21b",
        "parentId" : "d5b2ed43-4a24-45f7-aa37-64ff38b6aae1",
        "authorId" : "73896ffa-873a-4115-b79b-370ca722bd60",
        "body" : "@xiaodongdu what @mumrah was saying is that we could add the properties to the kafka broker configuration and pass those values into the context, similar to what we do for client. We can update the KIP and add that.",
        "createdAt" : "2020-05-26T17:30:28Z",
        "updatedAt" : "2020-05-27T17:48:24Z",
        "lastEditedBy" : "73896ffa-873a-4115-b79b-370ca722bd60",
        "tags" : [
        ]
      },
      {
        "id" : "cf67bf60-509f-4838-9806-4c1fefafa5bf",
        "parentId" : "d5b2ed43-4a24-45f7-aa37-64ff38b6aae1",
        "authorId" : "bc2371dd-0e94-4f44-86df-23f6bf4c71c4",
        "body" : "@xvrl  Do you mean add this logic back to KafkaServer.scala:\r\nmetadata.putAll(config.originalsWithPrefix(CommonClientConfigs.METRICS_CONTEXT_PREFIX, false));\r\n",
        "createdAt" : "2020-05-26T17:39:15Z",
        "updatedAt" : "2020-05-27T17:48:24Z",
        "lastEditedBy" : "bc2371dd-0e94-4f44-86df-23f6bf4c71c4",
        "tags" : [
        ]
      },
      {
        "id" : "903f0621-d877-404b-ab36-ff45c0514ed5",
        "parentId" : "d5b2ed43-4a24-45f7-aa37-64ff38b6aae1",
        "authorId" : "73896ffa-873a-4115-b79b-370ca722bd60",
        "body" : "yes, I believe that's what @mumrah meant. If we decide to do this, I'll update the KIP and send a follow-up email with some of the other tweaks we discussed in this PR. ",
        "createdAt" : "2020-05-26T17:44:43Z",
        "updatedAt" : "2020-05-27T17:48:24Z",
        "lastEditedBy" : "73896ffa-873a-4115-b79b-370ca722bd60",
        "tags" : [
        ]
      },
      {
        "id" : "2fc3a15c-f725-4f93-b84e-585fd8079567",
        "parentId" : "d5b2ed43-4a24-45f7-aa37-64ff38b6aae1",
        "authorId" : "bc2371dd-0e94-4f44-86df-23f6bf4c71c4",
        "body" : "renamed jmxPrefix to metricsPrefix and add broker MetricsContext properties",
        "createdAt" : "2020-05-26T20:54:34Z",
        "updatedAt" : "2020-05-27T17:48:24Z",
        "lastEditedBy" : "bc2371dd-0e94-4f44-86df-23f6bf4c71c4",
        "tags" : [
        ]
      }
    ],
    "commit" : "319f5c556715d6733e82b41d7289ab71513ae27b",
    "line" : 18,
    "diffHunk" : "@@ -1,1 +130,134 @@  private var shutdownLatch = new CountDownLatch(1)\n\n  //properties for MetricsContext\n  private val metricsPrefix: String = \"kafka.server\"\n  private val KAFKA_CLUSTER_ID: String = \"kafka.cluster.id\""
  },
  {
    "id" : "da4172f8-e951-429b-b9ff-e5085aeb88cb",
    "prId" : 9012,
    "prUrl" : "https://github.com/apache/kafka/pull/9012#pullrequestreview-457020234",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d3acfac2-dbd3-4c5b-81bf-1cfdddf32eec",
        "parentId" : null,
        "authorId" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "body" : "How about \"ControllerUplinkManager\" ?",
        "createdAt" : "2020-07-13T19:34:52Z",
        "updatedAt" : "2020-07-29T16:09:53Z",
        "lastEditedBy" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "tags" : [
        ]
      },
      {
        "id" : "7e61dee9-0c0a-41a0-b980-967e16d25e7c",
        "parentId" : "d3acfac2-dbd3-4c5b-81bf-1cfdddf32eec",
        "authorId" : "3dfe0270-df82-43af-827f-0681ce1c6ad9",
        "body" : "Not sure it would be more self-explanatory than the current name.",
        "createdAt" : "2020-07-13T19:56:31Z",
        "updatedAt" : "2020-07-29T16:09:53Z",
        "lastEditedBy" : "3dfe0270-df82-43af-827f-0681ce1c6ad9",
        "tags" : [
        ]
      },
      {
        "id" : "e820043f-3f0c-4981-85c6-477ae95f45fd",
        "parentId" : "d3acfac2-dbd3-4c5b-81bf-1cfdddf32eec",
        "authorId" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "body" : "ok.",
        "createdAt" : "2020-07-28T21:18:08Z",
        "updatedAt" : "2020-07-29T16:09:53Z",
        "lastEditedBy" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "tags" : [
        ]
      }
    ],
    "commit" : "66a3d65dc84f0b98379fc5955201922ce4f01112",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +169,173 @@  var kafkaController: KafkaController = null\n\n  var brokerToControllerChannelManager: BrokerToControllerChannelManager = null\n\n  var kafkaScheduler: KafkaScheduler = null"
  }
]