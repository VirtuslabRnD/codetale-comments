[
  {
    "id" : "eef36774-8e23-49ec-a589-cd2c60ca0938",
    "prId" : 5962,
    "prUrl" : "https://github.com/apache/kafka/pull/5962#pullrequestreview-183050232",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ec3547c2-2438-4703-86de-ba56a8ebaa7e",
        "parentId" : null,
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "Hmm.. in `GroupCoordinator` code after we've triggered the callback, we actually did not set it to null. Maybe this does not affect the correctness of the logic but I'm a bit concerned it is vulnerable to bugs in the future, maybe we can just remove the callback after triggers it above (see my other comment)?",
        "createdAt" : "2018-12-10T07:07:11Z",
        "updatedAt" : "2018-12-10T18:22:26Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      }
    ],
    "commit" : "259f70653f00eaeec3377abc30580ca801974b78",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +81,85 @@\n  def shouldKeepAlive(deadlineMs: Long): Boolean = {\n    if (awaitingJoinCallback != null)\n      !isNew || latestHeartbeat + GroupCoordinator.NewMemberJoinTimeoutMs > deadlineMs\n    else awaitingSyncCallback != null ||"
  },
  {
    "id" : "9e71b67b-f2a4-4fb7-8047-e5df596260f1",
    "prId" : 8339,
    "prUrl" : "https://github.com/apache/kafka/pull/8339#pullrequestreview-380749755",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2c582973-4744-4377-b2e5-4947b54503b7",
        "parentId" : null,
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "Hmm, do we still need to rely on `isNew` here? Could the condition just be `heartbeatSatisfied || isAwaitingJoin || isAwaitingSync`?",
        "createdAt" : "2020-03-24T18:53:42Z",
        "updatedAt" : "2020-03-24T22:36:10Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      },
      {
        "id" : "d84af2a4-bbb3-484b-9161-e45a2f0d210e",
        "parentId" : "2c582973-4744-4377-b2e5-4947b54503b7",
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "The awkward thing about the `isNew` case is that we want the member to fail while `isAwaitingJoin` is true. This is attempting to handle the case for old versions of the protocol where a client sends JoinGroup with empty memberId and then times out. I was debating how important this logic is, but I seem to recall a case in the past where the group grew very large because new members kept timing out and retrying.",
        "createdAt" : "2020-03-24T19:32:42Z",
        "updatedAt" : "2020-03-24T22:36:10Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      },
      {
        "id" : "aa53c7cf-aed2-47e5-be2e-3c341f1f8e6d",
        "parentId" : "2c582973-4744-4377-b2e5-4947b54503b7",
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "Fair enough; originally I thought we can now just remove this `isNew` flag now but I think I buy your arguments now.",
        "createdAt" : "2020-03-24T22:45:50Z",
        "updatedAt" : "2020-03-24T22:45:50Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      }
    ],
    "commit" : "b64ad18e2413bcc0ae18fa134403bc2a594427ea",
    "line" : 28,
    "diffHunk" : "@@ -1,1 +94,98 @@  def hasSatisfiedHeartbeat: Boolean = {\n    if (isNew) {\n      // New members can be expired while awaiting join, so we have to check this first\n      heartbeatSatisfied\n    } else if (isAwaitingJoin || isAwaitingSync) {"
  }
]