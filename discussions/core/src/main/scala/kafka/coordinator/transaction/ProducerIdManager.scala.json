[
  {
    "id" : "2ad2f7e6-9491-4227-a05b-b397e2868871",
    "prId" : 4351,
    "prUrl" : "https://github.com/apache/kafka/pull/4351#pullrequestreview-85251105",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "437fd20b-8a93-493b-a015-ee07a562c2e0",
        "parentId" : null,
        "authorId" : "915b2f67-05e6-4824-939a-398e7be58870",
        "body" : "unused ZKUtils import",
        "createdAt" : "2017-12-22T07:07:44Z",
        "updatedAt" : "2017-12-22T08:37:57Z",
        "lastEditedBy" : "915b2f67-05e6-4824-939a-398e7be58870",
        "tags" : [
        ]
      }
    ],
    "commit" : "d10b7657e7d5ebc621fbbf1c9ed6402af7cc63a1",
    "line" : 3,
    "diffHunk" : "@@ -1,1 +20,24 @@\nimport kafka.common.KafkaException\nimport kafka.utils.{Json, Logging, ZkUtils}\nimport kafka.zk.{KafkaZkClient, ProducerIdBlockZNode}\n"
  },
  {
    "id" : "6de3e2f3-e820-4313-9b4b-c9999c0b5453",
    "prId" : 10504,
    "prUrl" : "https://github.com/apache/kafka/pull/10504#pullrequestreview-665833490",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2b70f80b-9fec-4b06-9fa0-18f133c5638a",
        "parentId" : null,
        "authorId" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "body" : "It would be better to use a condition variable rather than a blocking queue here. Consider the situation where the latest RPC call got an error. In that case, you want to deliver the error to all waiters, not just to one of them. You could do that with `notifyAll()`. You can't really do it with a blocking queue because there's 1 consumer and 1 producer.\r\n\r\nRemoving the blocking queue also avoids using extra locks and so on. We only really need one lock and one condition variable here, I think. (wait / notify should be fine here, no need for ReentrantLock since we don't need multiple cvars).",
        "createdAt" : "2021-05-19T21:02:44Z",
        "updatedAt" : "2021-05-19T21:02:44Z",
        "lastEditedBy" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "tags" : [
        ]
      },
      {
        "id" : "44151517-d845-4041-9d49-8515ed4dbd47",
        "parentId" : "2b70f80b-9fec-4b06-9fa0-18f133c5638a",
        "authorId" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "body" : "To enlarge on the previous comment a bit: I guess the reason why I consider a condition variable to be simpler is that it involves fewer locks. A blocking queue has its own lock separate from the the lock in the manager, which can be awkward.\r\n\r\nWhat kind of behavior do you want on error? Do you want to deliver a given error to all waiters, or just to a single waiter? It seems like you might need to deliver it to all of them, to prevent huge pile-ups in cases where there are such errors.",
        "createdAt" : "2021-05-19T21:55:02Z",
        "updatedAt" : "2021-05-19T21:55:02Z",
        "lastEditedBy" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "tags" : [
        ]
      },
      {
        "id" : "39474f28-5f94-444e-9d5e-a9443d224dc6",
        "parentId" : "2b70f80b-9fec-4b06-9fa0-18f133c5638a",
        "authorId" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "body" : "Let's do this in a follow-on",
        "createdAt" : "2021-05-21T19:46:20Z",
        "updatedAt" : "2021-05-21T19:46:20Z",
        "lastEditedBy" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "tags" : [
        ]
      }
    ],
    "commit" : "3262171fa02df1f847ae5afc874133dd2582aafd",
    "line" : 220,
    "diffHunk" : "@@ -1,1 +149,153 @@  private var nextProducerId: Long = -1L\n\n  override def generateProducerId(): Long = {\n    this synchronized {\n      if (nextProducerId == -1L) {"
  }
]