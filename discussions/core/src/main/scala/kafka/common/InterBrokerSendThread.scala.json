[
  {
    "id" : "44e0c2e7-84a7-4514-b5e2-51cc11f2fe74",
    "prId" : 4705,
    "prUrl" : "https://github.com/apache/kafka/pull/4705#pullrequestreview-104383484",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3c8266d2-be5d-4621-9c75-0b0095f1e14a",
        "parentId" : null,
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "Would be nice to have a test case which covers this path.",
        "createdAt" : "2018-03-15T06:02:00Z",
        "updatedAt" : "2018-03-24T18:14:29Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      },
      {
        "id" : "ab3f0f6b-a391-4b82-a6d2-3413cfed646a",
        "parentId" : "3c8266d2-be5d-4621-9c75-0b0095f1e14a",
        "authorId" : "2a5e5a4d-e0e2-4e26-b139-0930dd63f949",
        "body" : "I've added a unit test for this. Hopefully, that'll do.",
        "createdAt" : "2018-03-16T00:19:05Z",
        "updatedAt" : "2018-03-24T18:14:29Z",
        "lastEditedBy" : "2a5e5a4d-e0e2-4e26-b139-0930dd63f949",
        "tags" : [
        ]
      }
    ],
    "commit" : "8bdd76d63a043157b6ec731df15d2baa9dee03b9",
    "line" : 120,
    "diffHunk" : "@@ -1,1 +115,119 @@  }\n\n  private def failExpiredRequests(now: Long): Unit = {\n    // clear all expired unsent requests\n    val expiredRequests = unsentRequests.removeExpiredRequests(now, unsentExpiryMs)"
  },
  {
    "id" : "f9928501-ab91-4b68-ac4d-4556bc7e061b",
    "prId" : 4705,
    "prUrl" : "https://github.com/apache/kafka/pull/4705#pullrequestreview-106692121",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "866c3c0c-3b3e-4789-a13e-31044ba26fdb",
        "parentId" : null,
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "Would be good to have a test case which hits this path. I noticed that `InterBrokerSendThread` depends on `NettworkClient` directly. Maybe we could change that to use `KafkaClient` instead so that we can use `MockClient` for easier testing?",
        "createdAt" : "2018-03-23T20:21:44Z",
        "updatedAt" : "2018-03-24T18:14:29Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      },
      {
        "id" : "b116635c-9c5e-4e2b-819a-49066d48c786",
        "parentId" : "866c3c0c-3b3e-4789-a13e-31044ba26fdb",
        "authorId" : "2a5e5a4d-e0e2-4e26-b139-0930dd63f949",
        "body" : "@hachikuji Looking at this more closely, wouldn't the existing test `shouldCallCompletionHandlerWithDisconnectedResponseWhenNodeNotReady` cover this? In the latest commit I made a minor change to verify completion with disconnect. Would that be a proper test for this path? If so, should I still look into switching to `MockClient`? Thanks.",
        "createdAt" : "2018-03-24T07:29:50Z",
        "updatedAt" : "2018-03-24T18:14:29Z",
        "lastEditedBy" : "2a5e5a4d-e0e2-4e26-b139-0930dd63f949",
        "tags" : [
        ]
      }
    ],
    "commit" : "8bdd76d63a043157b6ec731df15d2baa9dee03b9",
    "line" : 100,
    "diffHunk" : "@@ -1,1 +95,99 @@  }\n\n  private def checkDisconnects(now: Long): Unit = {\n    // any disconnects affecting requests that have already been transmitted will be handled\n    // by NetworkClient, so we just need to check whether connections for any of the unsent"
  },
  {
    "id" : "6f3447c5-d6e3-4838-8d4b-ddd78f0a3ee7",
    "prId" : 9732,
    "prUrl" : "https://github.com/apache/kafka/pull/9732#pullrequestreview-550622107",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2c6b2dbe-22b1-406a-80e3-05e2db5b11c4",
        "parentId" : null,
        "authorId" : "083f2f03-ca7e-48a1-9781-482564dfdf53",
        "body" : "Previously, all the requests we gathered from `generateRequests` would have the same timestamp which was also passed to the subsequent call to NetworkClient#ready and send (via `sendRequests`). \r\n\r\nWhat's the reason for recomputing the timestamp for each request we create? \r\n\r\nShould we get a newer timestamp for the call to NetworkClient? \r\n\r\nSeems a little weird to create requests at t1, t2, etc and then call NetworkClient.send with t0. I wonder if this would have weird throttling side effects. ",
        "createdAt" : "2020-12-11T19:11:10Z",
        "updatedAt" : "2020-12-21T20:43:48Z",
        "lastEditedBy" : "083f2f03-ca7e-48a1-9781-482564dfdf53",
        "tags" : [
        ]
      },
      {
        "id" : "da4ce510-74ca-4211-996b-a725b874a5b5",
        "parentId" : "2c6b2dbe-22b1-406a-80e3-05e2db5b11c4",
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "That's fair. It's probably fine to compute it just once for `sendRequests`.",
        "createdAt" : "2020-12-11T19:52:44Z",
        "updatedAt" : "2020-12-21T20:43:48Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      },
      {
        "id" : "08a6664d-c855-4c74-8de2-a7cf12c144bf",
        "parentId" : "2c6b2dbe-22b1-406a-80e3-05e2db5b11c4",
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "I ended up moving creation time to RequestAndCompletionHandler.",
        "createdAt" : "2020-12-11T22:35:04Z",
        "updatedAt" : "2020-12-21T20:43:49Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      }
    ],
    "commit" : "c31ba33f2ffb1144e0acbe975ddf45cc5d4065bc",
    "line" : 66,
    "diffHunk" : "@@ -1,1 +71,75 @@    try {\n      drainGeneratedRequests()\n      var now = time.milliseconds()\n      val timeout = sendRequests(now, maxTimeoutMs)\n      networkClient.poll(timeout, now)"
  },
  {
    "id" : "65c76466-e28a-45e5-b595-9c25ff6511b5",
    "prId" : 9732,
    "prUrl" : "https://github.com/apache/kafka/pull/9732#pullrequestreview-552686477",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "045e981f-e4e3-4c04-a6fe-984f495c92a2",
        "parentId" : null,
        "authorId" : "083f2f03-ca7e-48a1-9781-482564dfdf53",
        "body" : "Is it worth adding a `size` or `isEmpty` to `UnsentRequests`? ",
        "createdAt" : "2020-12-15T17:23:19Z",
        "updatedAt" : "2020-12-21T20:43:49Z",
        "lastEditedBy" : "083f2f03-ca7e-48a1-9781-482564dfdf53",
        "tags" : [
        ]
      }
    ],
    "commit" : "c31ba33f2ffb1144e0acbe975ddf45cc5d4065bc",
    "line" : 34,
    "diffHunk" : "@@ -1,1 +45,49 @@  def generateRequests(): Iterable[RequestAndCompletionHandler]\n\n  def hasUnsentRequests: Boolean = unsentRequests.iterator().hasNext\n\n  override def shutdown(): Unit = {"
  }
]