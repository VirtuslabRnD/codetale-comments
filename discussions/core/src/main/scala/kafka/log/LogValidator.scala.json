[
  {
    "id" : "d379f64f-0835-41f3-afe8-1566461deb46",
    "prId" : 6785,
    "prUrl" : "https://github.com/apache/kafka/pull/6785#pullrequestreview-247340535",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0c239631-105a-4e80-a393-9862f186f09a",
        "parentId" : null,
        "authorId" : "3dfe0270-df82-43af-827f-0681ce1c6ad9",
        "body" : "Could be simplified as \r\n```\r\nif (batchIterator.hasNext && \r\n!(batch.magic < RecordBatch.MAGIC_VALUE_V2 && sourceCodec == NoCompressionCodec)) {\r\n  throw new InvalidRecordException(\"Compressed outer record has more than one batch\")\r\n} else {\r\n  batch\r\n}\r\n```\r\n",
        "createdAt" : "2019-06-04T18:20:39Z",
        "updatedAt" : "2019-06-21T01:39:59Z",
        "lastEditedBy" : "3dfe0270-df82-43af-827f-0681ce1c6ad9",
        "tags" : [
        ]
      },
      {
        "id" : "573441ec-db48-429a-b10c-c0dbf87785e3",
        "parentId" : "0c239631-105a-4e80-a393-9862f186f09a",
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "I feel it is easier to read in this way, though a bit verbose.",
        "createdAt" : "2019-06-07T23:37:21Z",
        "updatedAt" : "2019-06-21T01:39:59Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      }
    ],
    "commit" : "b2877059086b62a6a36170174e0d2c924a1a6503",
    "line" : 28,
    "diffHunk" : "@@ -1,1 +85,89 @@\n    // if the format is v2 and beyond, or if the messages are compressed, we should check there's only one batch.\n    if (batch.magic() >= RecordBatch.MAGIC_VALUE_V2 || sourceCodec != NoCompressionCodec) {\n      if (batchIterator.hasNext) {\n        throw new InvalidRecordException(\"Compressed outer record has more than one batch\")"
  }
]