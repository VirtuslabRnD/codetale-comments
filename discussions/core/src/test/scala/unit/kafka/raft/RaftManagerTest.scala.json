[
  {
    "id" : "eae84216-7e43-4104-8cd3-b14d5fbde190",
    "prId" : 11179,
    "prUrl" : "https://github.com/apache/kafka/pull/11179#pullrequestreview-724616617",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f6d04f0c-b3b7-47ea-aa3e-b2fb7c661443",
        "parentId" : null,
        "authorId" : "4a7c311c-0954-4671-a0d2-266cb67437ad",
        "body" : "The issue is that after every test you need to delete the directory created. This is where raft creates the directory\r\nhttps://github.com/apache/kafka/blob/9bc45d4e031bef63772b3d8d7c5828c0733a27b0/core/src/main/scala/kafka/raft/RaftManager.scala#L212-L215\r\n\r\nSo you need to override that with a temp dir from https://github.com/apache/kafka/blob/9bc45d4e031bef63772b3d8d7c5828c0733a27b0/core/src/test/scala/unit/kafka/utils/TestUtils.scala#L117\r\nand delete it after every test.",
        "createdAt" : "2021-08-06T00:01:21Z",
        "updatedAt" : "2021-08-06T00:09:02Z",
        "lastEditedBy" : "4a7c311c-0954-4671-a0d2-266cb67437ad",
        "tags" : [
        ]
      },
      {
        "id" : "bae72e22-b522-4d0b-910b-350574c9b290",
        "parentId" : "f6d04f0c-b3b7-47ea-aa3e-b2fb7c661443",
        "authorId" : "2723fe44-8348-4bf5-9734-8695ba3d4700",
        "body" : "I did this using \r\n\r\n`scala.reflect.io.Directory.deleteRecursively`\r\n\r\nas you were reviewing.",
        "createdAt" : "2021-08-06T01:13:54Z",
        "updatedAt" : "2021-08-06T01:13:55Z",
        "lastEditedBy" : "2723fe44-8348-4bf5-9734-8695ba3d4700",
        "tags" : [
        ]
      },
      {
        "id" : "b027b8ea-1346-43af-b0ee-78e7685eef3d",
        "parentId" : "f6d04f0c-b3b7-47ea-aa3e-b2fb7c661443",
        "authorId" : "2723fe44-8348-4bf5-9734-8695ba3d4700",
        "body" : "I'll switch it to use `tempDir` shortly.",
        "createdAt" : "2021-08-06T01:15:35Z",
        "updatedAt" : "2021-08-06T01:15:35Z",
        "lastEditedBy" : "2723fe44-8348-4bf5-9734-8695ba3d4700",
        "tags" : [
        ]
      },
      {
        "id" : "e9b50e6c-d777-448c-bcf5-7ccc7c1397a6",
        "parentId" : "f6d04f0c-b3b7-47ea-aa3e-b2fb7c661443",
        "authorId" : "2723fe44-8348-4bf5-9734-8695ba3d4700",
        "body" : "Would this class need to extend KafkaRaftManager to override the directory field in that class with tempDir?",
        "createdAt" : "2021-08-06T18:33:16Z",
        "updatedAt" : "2021-08-06T18:33:16Z",
        "lastEditedBy" : "2723fe44-8348-4bf5-9734-8695ba3d4700",
        "tags" : [
        ]
      }
    ],
    "commit" : "decdf59aa14935cb19ff1de42876afca861812a2",
    "line" : 15,
    "diffHunk" : "@@ -1,1 +38,42 @@class RaftManagerTest {\n\n  private def instantiateRaftManagerWithConfigs(topicPartition: TopicPartition, processRoles: String, nodeId: String) = {\n    def configWithProcessRolesAndNodeId(processRoles: String, nodeId: String, logDir: File): KafkaConfig = {\n      val props = new Properties"
  },
  {
    "id" : "b316aeaa-8d22-4c3d-9b49-696f4f179a77",
    "prId" : 11179,
    "prUrl" : "https://github.com/apache/kafka/pull/11179#pullrequestreview-725858365",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "15ced924-f0fa-4989-81da-ca0fa9437e27",
        "parentId" : null,
        "authorId" : "4a7c311c-0954-4671-a0d2-266cb67437ad",
        "body" : "Should we remove these directories after every test? I think this doesn't delete the directory until all of the tests in `core` have finished and the JVM terminates.",
        "createdAt" : "2021-08-09T18:04:53Z",
        "updatedAt" : "2021-08-09T18:04:58Z",
        "lastEditedBy" : "4a7c311c-0954-4671-a0d2-266cb67437ad",
        "tags" : [
        ]
      },
      {
        "id" : "ccc21e70-09e6-4830-917e-b0c51bb26d9a",
        "parentId" : "15ced924-f0fa-4989-81da-ca0fa9437e27",
        "authorId" : "083f2f03-ca7e-48a1-9781-482564dfdf53",
        "body" : "Yea probably a good idea. Looks like other tests using tempDirectory are cleaning up with `o.a.k.common.utils.Utils#delete`",
        "createdAt" : "2021-08-09T18:10:32Z",
        "updatedAt" : "2021-08-09T18:10:42Z",
        "lastEditedBy" : "083f2f03-ca7e-48a1-9781-482564dfdf53",
        "tags" : [
        ]
      },
      {
        "id" : "31340d17-3cdf-4d3f-974b-b732d8cf3dd3",
        "parentId" : "15ced924-f0fa-4989-81da-ca0fa9437e27",
        "authorId" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "body" : "@jsancio , @mumrah : Can you file a follow-up JIRA for this? We can also include the other raft integration / unit tests",
        "createdAt" : "2021-08-09T19:58:32Z",
        "updatedAt" : "2021-08-09T19:58:33Z",
        "lastEditedBy" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "tags" : [
        ]
      },
      {
        "id" : "a73e6b1c-efab-4af0-a1bc-eaf868febff1",
        "parentId" : "15ced924-f0fa-4989-81da-ca0fa9437e27",
        "authorId" : "2723fe44-8348-4bf5-9734-8695ba3d4700",
        "body" : "thanks guys",
        "createdAt" : "2021-08-09T21:44:47Z",
        "updatedAt" : "2021-08-09T21:44:47Z",
        "lastEditedBy" : "2723fe44-8348-4bf5-9734-8695ba3d4700",
        "tags" : [
        ]
      },
      {
        "id" : "4b8e481c-2730-4032-8cb2-2746e9d5d2bc",
        "parentId" : "15ced924-f0fa-4989-81da-ca0fa9437e27",
        "authorId" : "2723fe44-8348-4bf5-9734-8695ba3d4700",
        "body" : "https://github.com/apache/kafka/pull/11193",
        "createdAt" : "2021-08-09T22:22:13Z",
        "updatedAt" : "2021-08-09T22:22:14Z",
        "lastEditedBy" : "2723fe44-8348-4bf5-9734-8695ba3d4700",
        "tags" : [
        ]
      }
    ],
    "commit" : "decdf59aa14935cb19ff1de42876afca861812a2",
    "line" : 42,
    "diffHunk" : "@@ -1,1 +62,66 @@    }\n\n    val logDir = TestUtils.tempDirectory()\n    val config = configWithProcessRolesAndNodeId(processRoles, nodeId, logDir)\n    val topicId = new Uuid(0L, 2L)"
  }
]