[
  {
    "id" : "af323ca7-7e6a-4a9b-b0c1-f2cc8c39a606",
    "prId" : 7542,
    "prUrl" : "https://github.com/apache/kafka/pull/7542#pullrequestreview-303743155",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "28e78b93-6a1b-4e26-8ada-1c3fcce3c1a4",
        "parentId" : null,
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "Can you clarify how this fixes the problem?",
        "createdAt" : "2019-10-17T15:33:42Z",
        "updatedAt" : "2019-10-18T08:41:36Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      },
      {
        "id" : "7c8ce33f-bf96-436c-901a-5f7d3ef20611",
        "parentId" : "28e78b93-6a1b-4e26-8ada-1c3fcce3c1a4",
        "authorId" : "cb6f8432-d515-4113-87f8-14e555ab8ed1",
        "body" : "I've seen on the JIRA description that the test failed on the assertion of the metric so I thought the cleanup process can be incorrect, therefore I changed it to clean it up properly after each test.\r\nIf you think this isn't a reasonable basis for this test failure I can dig deeper as soon as I find another occurrence in one of the currently running Jenkins builds, maybe that contains more information (since the ones on the jira were already deleted).",
        "createdAt" : "2019-10-17T16:45:58Z",
        "updatedAt" : "2019-10-18T08:41:36Z",
        "lastEditedBy" : "cb6f8432-d515-4113-87f8-14e555ab8ed1",
        "tags" : [
        ]
      },
      {
        "id" : "68f2bbc7-ad45-4672-8fac-68f3196347fd",
        "parentId" : "28e78b93-6a1b-4e26-8ada-1c3fcce3c1a4",
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "I think the cleanup logic was indeed broken because it assumed that the metric already existed, but this would cause a deterministic failure. I thought another possibility is that we were finding the fetcher DeadThreadCount metric. I think we could make this more resilient if we use `getGauge(name, scope)` to make sure we are finding the right metric.",
        "createdAt" : "2019-10-17T17:34:25Z",
        "updatedAt" : "2019-10-18T08:41:36Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      },
      {
        "id" : "d47f49ab-c812-42d1-88ee-9fff55df272f",
        "parentId" : "28e78b93-6a1b-4e26-8ada-1c3fcce3c1a4",
        "authorId" : "cb6f8432-d515-4113-87f8-14e555ab8ed1",
        "body" : "True. I added filtering for scope too but with the twist that I check for null scope instead as the LogCleaner one doesn't have any :)",
        "createdAt" : "2019-10-18T08:42:58Z",
        "updatedAt" : "2019-10-18T08:42:59Z",
        "lastEditedBy" : "cb6f8432-d515-4113-87f8-14e555ab8ed1",
        "tags" : [
        ]
      }
    ],
    "commit" : "e7610c8a61b7145afd9c9761f8236d642a849402",
    "line" : 15,
    "diffHunk" : "@@ -1,1 +45,49 @@  @After\n  def cleanup(): Unit = {\n    TestUtils.clearYammerMetrics()\n  }\n"
  }
]