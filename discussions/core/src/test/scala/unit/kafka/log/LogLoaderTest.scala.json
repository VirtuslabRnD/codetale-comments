[
  {
    "id" : "674e4a10-a83a-4f92-8402-016d441d3bdf",
    "prId" : 10896,
    "prUrl" : "https://github.com/apache/kafka/pull/10896#pullrequestreview-687170435",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3442ca2b-3a48-44df-afaf-451750a86010",
        "parentId" : null,
        "authorId" : "b4f52e78-c19e-46b4-b486-6da86e32e687",
        "body" : "Just above this, could we also assert that the snapshots that should have been removed were actually removed?\r\n\r\n```\r\nval offsetsWithSnapshotFiles = ListBuffer[Long]()\r\nfor (offset <- 1 until 5) {\r\n  val snapshotFile = SnapshotFile(Log.producerSnapshotFile(logDir, offset))\r\n   if (snapshotFile.file.exists) {\r\n       offsetsWithSnapshotFiles.append(offset)\r\n    }\r\n}\r\nassertTrue(offsetsWithSnapshotFiles.isEmpty, s\"Found offsets with producer state snapshot files: $offsetsWithSnapshotFiles, while none was expected.\")\r\n```",
        "createdAt" : "2021-06-18T08:39:02Z",
        "updatedAt" : "2021-06-18T08:49:29Z",
        "lastEditedBy" : "b4f52e78-c19e-46b4-b486-6da86e32e687",
        "tags" : [
        ]
      }
    ],
    "commit" : "6e2df3c068936a039468540723a07f141213ff88",
    "line" : 123,
    "diffHunk" : "@@ -1,1 +1646,1650 @@    assertEquals(newLogStartOffset, log.logStartOffset)\n    assertEquals(9, log.logEndOffset)\n    val offsetsWithMissingSnapshotFiles = ListBuffer[Long]()\n    for (offset <- 5 until 10) {\n      val snapshotFile = log.producerStateManager.snapshotFileForOffset(offset)"
  },
  {
    "id" : "a8c25475-0b7d-472f-90dd-869525b68192",
    "prId" : 10896,
    "prUrl" : "https://github.com/apache/kafka/pull/10896#pullrequestreview-689754052",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "df685571-07d1-44ae-a990-ad54fdab133b",
        "parentId" : null,
        "authorId" : "b4f52e78-c19e-46b4-b486-6da86e32e687",
        "body" : "Does it make sense to check that there are no `.deleted` files in the log dir at the end of this test?",
        "createdAt" : "2021-06-22T16:40:52Z",
        "updatedAt" : "2021-06-22T21:10:08Z",
        "lastEditedBy" : "b4f52e78-c19e-46b4-b486-6da86e32e687",
        "tags" : [
        ]
      }
    ],
    "commit" : "6e2df3c068936a039468540723a07f141213ff88",
    "line" : 131,
    "diffHunk" : "@@ -1,1 +1654,1658 @@    }\n    assertTrue(offsetsWithMissingSnapshotFiles.isEmpty,\n      s\"Found offsets with missing producer state snapshot files: $offsetsWithMissingSnapshotFiles\")\n    assertFalse(logDir.list().exists(_.endsWith(Log.DeletedFileSuffix)), \"Expected no files to be present with the deleted file suffix\")\n  }"
  }
]