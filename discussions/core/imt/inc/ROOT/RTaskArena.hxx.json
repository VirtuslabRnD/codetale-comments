[
  {
    "id" : "001d141d-0aee-4939-930e-ce9c505ce33b",
    "prId" : 5582,
    "prUrl" : "https://github.com/root-project/root/pull/5582#pullrequestreview-424224544",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "387c4005-a85c-4908-b922-e4889ea40f4f",
        "parentId" : null,
        "authorId" : "596ff907-142e-43f7-ad3e-4108c6faf08d",
        "body" : "Assuming interface7 is an inline namespace in some TBB headers: this is not a good forward declearation since it will bind you to the interface7 version of TBB and makes you dependent on TBB internals.",
        "createdAt" : "2020-06-04T07:46:54Z",
        "updatedAt" : "2020-06-11T07:52:57Z",
        "lastEditedBy" : "596ff907-142e-43f7-ad3e-4108c6faf08d",
        "tags" : [
        ]
      },
      {
        "id" : "93575e0c-dc66-4927-97c7-b0ab9a7c504a",
        "parentId" : "387c4005-a85c-4908-b922-e4889ea40f4f",
        "authorId" : "eb1cc629-c047-424e-bc0f-ae19ac8ba815",
        "body" : "Yes, that was discussed in the previous PPP, it's in the commit message, and I tried to solve it in two different PRs unsuccessfully. Didn't find a way to keep at least a forward declaration of tbb::task_arena out of the headers because we need tbb::task_arena::execute() in TThreadExecutor.cxx, which implies the definition of the method.\r\n\r\nOn the other hand, tbb::task_arena is an alias to tbb::interface7::task_arena and  you cannot forward declare aliases https://stackoverflow.com/questions/18834645/c-forward-declaration-and-alias-with-using-or-typedef",
        "createdAt" : "2020-06-04T08:21:15Z",
        "updatedAt" : "2020-06-11T07:52:57Z",
        "lastEditedBy" : "eb1cc629-c047-424e-bc0f-ae19ac8ba815",
        "tags" : [
        ]
      },
      {
        "id" : "0d177bc7-a5fd-4ec2-a05a-f0faef35943c",
        "parentId" : "387c4005-a85c-4908-b922-e4889ea40f4f",
        "authorId" : "596ff907-142e-43f7-ad3e-4108c6faf08d",
        "body" : "I would just #include the corresponding TBB header and have a smoother TBB upgrade next time or allowing people to use different versions of TBB with ROOT. But as you said, it was discussed in the PPP meeting.",
        "createdAt" : "2020-06-04T08:31:12Z",
        "updatedAt" : "2020-06-11T07:52:57Z",
        "lastEditedBy" : "596ff907-142e-43f7-ad3e-4108c6faf08d",
        "tags" : [
        ]
      },
      {
        "id" : "0401343c-0246-466a-9549-bbb612afdf33",
        "parentId" : "387c4005-a85c-4908-b922-e4889ea40f4f",
        "authorId" : "eb1cc629-c047-424e-bc0f-ae19ac8ba815",
        "body" : "I understand, but  the requirement here was keeping TBB out of ROOT headers",
        "createdAt" : "2020-06-04T08:38:19Z",
        "updatedAt" : "2020-06-11T07:52:57Z",
        "lastEditedBy" : "eb1cc629-c047-424e-bc0f-ae19ac8ba815",
        "tags" : [
        ]
      }
    ],
    "commit" : "ab9afb47d003564f5b4ff503af1173567d0d2f01",
    "line" : 42,
    "diffHunk" : "@@ -1,1 +40,44 @@namespace interface7{class task_arena;}\nusing task_arena = interface7::task_arena;\n}\n\nnamespace ROOT {"
  },
  {
    "id" : "d9537b7a-70c9-437b-a572-0fb417462fee",
    "prId" : 5582,
    "prUrl" : "https://github.com/root-project/root/pull/5582#pullrequestreview-428656187",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "94f480a3-7a7f-4f82-8e44-a1df732b4e7e",
        "parentId" : null,
        "authorId" : "596ff907-142e-43f7-ad3e-4108c6faf08d",
        "body" : "Any reason this is not defined just in the cpp file?\r\n\r\nOtherwise: I would add a TODO, that this should become an inline variable in C++17.",
        "createdAt" : "2020-06-04T07:56:45Z",
        "updatedAt" : "2020-06-11T07:52:57Z",
        "lastEditedBy" : "596ff907-142e-43f7-ad3e-4108c6faf08d",
        "tags" : [
        ]
      },
      {
        "id" : "270d86fb-fd6b-427c-beea-0747bc0899c2",
        "parentId" : "94f480a3-7a7f-4f82-8e44-a1df732b4e7e",
        "authorId" : "eb1cc629-c047-424e-bc0f-ae19ac8ba815",
        "body" : "I see it conceptually as a member of the class. ",
        "createdAt" : "2020-06-04T13:25:40Z",
        "updatedAt" : "2020-06-11T07:52:57Z",
        "lastEditedBy" : "eb1cc629-c047-424e-bc0f-ae19ac8ba815",
        "tags" : [
        ]
      },
      {
        "id" : "20e904a2-865a-4fae-bc34-3d7f9f518d6b",
        "parentId" : "94f480a3-7a7f-4f82-8e44-a1df732b4e7e",
        "authorId" : "f2c15ca6-f995-45d3-a26d-40d002e52d07",
        "body" : "`static` implies you can have multiple `RTaskArenaWrapper` objects but they must have the same `fNWorkers`. But by design you can't have multiple `RTaskArenaWrapper`s, so I would argue that `static` is actually misleading.\r\n\r\ncan `fNWorkers` and `TaskArenaSize` be normal class members?",
        "createdAt" : "2020-06-09T09:20:23Z",
        "updatedAt" : "2020-06-11T07:52:57Z",
        "lastEditedBy" : "f2c15ca6-f995-45d3-a26d-40d002e52d07",
        "tags" : [
        ]
      },
      {
        "id" : "33f3595d-f020-4eee-9c2e-2f96b855b05b",
        "parentId" : "94f480a3-7a7f-4f82-8e44-a1df732b4e7e",
        "authorId" : "f2c15ca6-f995-45d3-a26d-40d002e52d07",
        "body" : "more discussion on this topic at https://github.com/root-project/root/pull/5582/files#r437373495",
        "createdAt" : "2020-06-09T12:56:02Z",
        "updatedAt" : "2020-06-11T07:52:57Z",
        "lastEditedBy" : "f2c15ca6-f995-45d3-a26d-40d002e52d07",
        "tags" : [
        ]
      },
      {
        "id" : "f210d43c-e886-4764-b2de-b10177937fcb",
        "parentId" : "94f480a3-7a7f-4f82-8e44-a1df732b4e7e",
        "authorId" : "f2c15ca6-f995-45d3-a26d-40d002e52d07",
        "body" : "I think we can mark this as resolved, we will accept patches with more elegant solutions if they come along",
        "createdAt" : "2020-06-11T07:25:49Z",
        "updatedAt" : "2020-06-11T07:52:57Z",
        "lastEditedBy" : "f2c15ca6-f995-45d3-a26d-40d002e52d07",
        "tags" : [
        ]
      }
    ],
    "commit" : "ab9afb47d003564f5b4ff503af1173567d0d2f01",
    "line" : 73,
    "diffHunk" : "@@ -1,1 +71,75 @@   friend std::shared_ptr<ROOT::Internal::RTaskArenaWrapper> GetGlobalTaskArena(unsigned maxConcurrency);\n   std::unique_ptr<tbb::task_arena> fTBBArena;\n   static unsigned fNWorkers;\n};\n"
  },
  {
    "id" : "c6bbefa8-0704-4ac7-838b-fcc9b4b70b40",
    "prId" : 5582,
    "prUrl" : "https://github.com/root-project/root/pull/5582#pullrequestreview-428642591",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "1cc7f62e-0ba2-4e41-ab40-6bff1eeaa38a",
        "parentId" : null,
        "authorId" : "ec1903c5-44e7-4fb1-bee9-25de61836fba",
        "body" : "Does this line do anything or is it auto-generated by your editor?",
        "createdAt" : "2020-06-09T08:32:13Z",
        "updatedAt" : "2020-06-11T07:52:57Z",
        "lastEditedBy" : "ec1903c5-44e7-4fb1-bee9-25de61836fba",
        "tags" : [
        ]
      },
      {
        "id" : "35af89c7-feb2-4913-83c0-74303207d058",
        "parentId" : "1cc7f62e-0ba2-4e41-ab40-6bff1eeaa38a",
        "authorId" : "eb1cc629-c047-424e-bc0f-ae19ac8ba815",
        "body" : "This is in all the other imt headers, I just copied the copyright statement adapting the author and the date. Not really sure of what it does or if It's necessary ü§∑‚Äç‚ôÇÔ∏è ",
        "createdAt" : "2020-06-09T08:40:42Z",
        "updatedAt" : "2020-06-11T07:52:57Z",
        "lastEditedBy" : "eb1cc629-c047-424e-bc0f-ae19ac8ba815",
        "tags" : [
        ]
      },
      {
        "id" : "cb2c14d4-fed9-479d-a0ad-a7ccd7d87ee6",
        "parentId" : "1cc7f62e-0ba2-4e41-ab40-6bff1eeaa38a",
        "authorId" : "f2c15ca6-f995-45d3-a26d-40d002e52d07",
        "body" : "you can ask Axel, I think it was used by the old homegrown reference guide generator. I don't think it's a doxygen thing, and it could be removed",
        "createdAt" : "2020-06-09T08:43:10Z",
        "updatedAt" : "2020-06-11T07:52:57Z",
        "lastEditedBy" : "f2c15ca6-f995-45d3-a26d-40d002e52d07",
        "tags" : [
        ]
      },
      {
        "id" : "f049aa1b-a8ab-409b-af7e-837d448a6642",
        "parentId" : "1cc7f62e-0ba2-4e41-ab40-6bff1eeaa38a",
        "authorId" : "eb1cc629-c047-424e-bc0f-ae19ac8ba815",
        "body" : "@Axel-Naumann Is this still needed?",
        "createdAt" : "2020-06-09T12:28:55Z",
        "updatedAt" : "2020-06-11T07:52:57Z",
        "lastEditedBy" : "eb1cc629-c047-424e-bc0f-ae19ac8ba815",
        "tags" : [
        ]
      },
      {
        "id" : "2af9b076-571e-4603-a226-0a9413435d69",
        "parentId" : "1cc7f62e-0ba2-4e41-ab40-6bff1eeaa38a",
        "authorId" : "eb1cc629-c047-424e-bc0f-ae19ac8ba815",
        "body" : "\"It is not needed anymore. It's nice to keep it, to signal which module a file (esp a header, think include/) is in.\"",
        "createdAt" : "2020-06-11T07:03:17Z",
        "updatedAt" : "2020-06-11T07:52:57Z",
        "lastEditedBy" : "eb1cc629-c047-424e-bc0f-ae19ac8ba815",
        "tags" : [
        ]
      }
    ],
    "commit" : "ab9afb47d003564f5b4ff503af1173567d0d2f01",
    "line" : 1,
    "diffHunk" : "@@ -1,1 +-1,3 @@// @(#)root/thread:$Id$\n// // Author: Xavier Valls Pla   08/05/20\n//"
  },
  {
    "id" : "d0c296ff-f01b-4685-a26d-d68cdef181ee",
    "prId" : 5582,
    "prUrl" : "https://github.com/root-project/root/pull/5582#pullrequestreview-427272095",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "af8436f4-719b-4c78-a64c-5d44b2a3159d",
        "parentId" : null,
        "authorId" : "ec1903c5-44e7-4fb1-bee9-25de61836fba",
        "body" : "So should it be a singleton, then? I know that the singleton is out of fashion, so maybe not mention \"Singleton\" here and say how to instantiate one?\r\nI guess it shouldn't be a singleton. Maybe people want to have their second task arena for their framework, and probably that would work.",
        "createdAt" : "2020-06-09T08:39:08Z",
        "updatedAt" : "2020-06-11T07:52:57Z",
        "lastEditedBy" : "ec1903c5-44e7-4fb1-bee9-25de61836fba",
        "tags" : [
        ]
      },
      {
        "id" : "cfe297e3-7ef3-4a4c-afa6-9cb885bdc9fd",
        "parentId" : "af8436f4-719b-4c78-a64c-5d44b2a3159d",
        "authorId" : "eb1cc629-c047-424e-bc0f-ae19ac8ba815",
        "body" : "The idea was to have a single task arena. If someone wants a second task arena, they can manipulate tbb directly.",
        "createdAt" : "2020-06-09T12:41:31Z",
        "updatedAt" : "2020-06-11T07:52:57Z",
        "lastEditedBy" : "eb1cc629-c047-424e-bc0f-ae19ac8ba815",
        "tags" : [
        ]
      },
      {
        "id" : "15aef6ce-13a9-4ccd-9b70-4ff62266c952",
        "parentId" : "af8436f4-719b-4c78-a64c-5d44b2a3159d",
        "authorId" : "f2c15ca6-f995-45d3-a26d-40d002e52d07",
        "body" : "@hageboeck `RTaskArenaWrapper` is a singleton, not `tbb::task_arena`.\r\n\r\nbtw about actually making this a singleton see my comment about changing RTaskArenaWrapper's constructor to private",
        "createdAt" : "2020-06-09T12:46:46Z",
        "updatedAt" : "2020-06-11T07:52:57Z",
        "lastEditedBy" : "f2c15ca6-f995-45d3-a26d-40d002e52d07",
        "tags" : [
        ]
      },
      {
        "id" : "233847af-0e0b-4b07-9ad7-ac20b7b4d17d",
        "parentId" : "af8436f4-719b-4c78-a64c-5d44b2a3159d",
        "authorId" : "ec1903c5-44e7-4fb1-bee9-25de61836fba",
        "body" : "That was my point. It's not a singleton, yet, but it could be. I'm not sure if it *need* be, though.",
        "createdAt" : "2020-06-09T15:14:49Z",
        "updatedAt" : "2020-06-11T07:52:57Z",
        "lastEditedBy" : "ec1903c5-44e7-4fb1-bee9-25de61836fba",
        "tags" : [
        ]
      },
      {
        "id" : "d11401d5-eaca-4044-998f-7f466c52e7d2",
        "parentId" : "af8436f4-719b-4c78-a64c-5d44b2a3159d",
        "authorId" : "f2c15ca6-f995-45d3-a26d-40d002e52d07",
        "body" : "yes, the whole design revolves around ROOT only ever having zero or one RTaskArenaWrappers in flight",
        "createdAt" : "2020-06-09T15:18:37Z",
        "updatedAt" : "2020-06-11T07:52:57Z",
        "lastEditedBy" : "f2c15ca6-f995-45d3-a26d-40d002e52d07",
        "tags" : [
        ]
      }
    ],
    "commit" : "ab9afb47d003564f5b4ff503af1173567d0d2f01",
    "line" : 62,
    "diffHunk" : "@@ -1,1 +60,64 @@///\n/// Necessary in order to keep tbb away from ROOT headers.\n/// This class is thought out to be used as a singleton.\n////////////////////////////////////////////////////////////////////////////////\nclass RTaskArenaWrapper {"
  }
]