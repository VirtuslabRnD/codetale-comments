[
  {
    "id" : "0224dbc5-db3e-42d1-ab44-712a5c19dbd4",
    "prId" : 70875,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/70875#pullrequestreview-174600097",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e3257cf6-3984-4daf-b529-effed250d1d8",
        "parentId" : null,
        "authorId" : "6e2b5eda-1533-4798-a56c-432faaf38480",
        "body" : "I don't think this is backwards compatible.  Anyone using `kubectl create -f DIR` will see something different happen after this change lands, which means existing CLI workflows could break.",
        "createdAt" : "2018-11-10T23:53:45Z",
        "updatedAt" : "2018-12-17T23:31:25Z",
        "lastEditedBy" : "6e2b5eda-1533-4798-a56c-432faaf38480",
        "tags" : [
        ]
      },
      {
        "id" : "0e36c783-6466-41b8-bb67-7a2d62077076",
        "parentId" : "e3257cf6-3984-4daf-b529-effed250d1d8",
        "authorId" : "8fc8f958-3c0e-47dd-a0fb-b8cc483b4efb",
        "body" : "I just tested the behaviour.  `kubectl create` and `kubectl apply` both fail with a kustomization.yaml present:\r\n\r\n```\r\nerror: error validating \".../k8s.io/examples/guestbook-go/kustomization.yaml\": error validating data: [apiVersion not set, kind not set]; if you choose to ignore these errors, turn validation off with --validate=false\r\n```\r\n\r\nIt looks like we have a separate issue, which is that we don't validate all files before starting to apply, which is contrary to what I would have expected.\r\n\r\nBut I don't think users can be using `kubectl create -f DIR` or `kubectl apply -f DIR` today with a dir containing kustomization.yaml.",
        "createdAt" : "2018-11-11T00:38:59Z",
        "updatedAt" : "2018-12-17T23:31:25Z",
        "lastEditedBy" : "8fc8f958-3c0e-47dd-a0fb-b8cc483b4efb",
        "tags" : [
        ]
      },
      {
        "id" : "4ead984d-5115-466b-94b3-4921beef5333",
        "parentId" : "e3257cf6-3984-4daf-b529-effed250d1d8",
        "authorId" : "02186dc1-661d-4676-abc0-1cb761b7a64e",
        "body" : "@smarterclayton The existing kubectl doesn't work with directories with a kustomization.yaml as @justinsb explained. With this PR, kubectl will be able to recognize a directory with a kustomization.yaml. For any directories without kustomization.yaml, there is no change in kubectl's behavior.",
        "createdAt" : "2018-11-12T17:35:25Z",
        "updatedAt" : "2018-12-17T23:31:25Z",
        "lastEditedBy" : "02186dc1-661d-4676-abc0-1cb761b7a64e",
        "tags" : [
        ]
      },
      {
        "id" : "6ffb2b86-0f9d-4ff2-ab1e-9233b1926763",
        "parentId" : "e3257cf6-3984-4daf-b529-effed250d1d8",
        "authorId" : "6e2b5eda-1533-4798-a56c-432faaf38480",
        "body" : "If someone has validate=false off, what happens?  If it also fails, then my primary concern is addressed.",
        "createdAt" : "2018-11-13T21:22:14Z",
        "updatedAt" : "2018-12-17T23:31:25Z",
        "lastEditedBy" : "6e2b5eda-1533-4798-a56c-432faaf38480",
        "tags" : [
        ]
      },
      {
        "id" : "db46cccb-36b7-430c-936a-27a67b061d6d",
        "parentId" : "e3257cf6-3984-4daf-b529-effed250d1d8",
        "authorId" : "02186dc1-661d-4676-abc0-1cb761b7a64e",
        "body" : "With validate=false, it fails with similar error\r\n```\r\nerror: unable to decode \"kustomization.yaml\": Object 'Kind' is missing in `<truncated>`\r\n```\r\n",
        "createdAt" : "2018-11-13T21:40:35Z",
        "updatedAt" : "2018-12-17T23:31:25Z",
        "lastEditedBy" : "02186dc1-661d-4676-abc0-1cb761b7a64e",
        "tags" : [
        ]
      }
    ],
    "commit" : "ac209ccdc02a28d5111f09b13dc84d3654555d5f",
    "line" : 24,
    "diffHunk" : "@@ -1,1 +458,462 @@\t\t\treturn err\n\t\t}\n\t\tif isKustomizationDir(path) {\n\t\t\tvisitors = append(visitors, NewKustomizationVisitor(mapper, path, schema))\n\t\t\treturn filepath.SkipDir"
  },
  {
    "id" : "7ed72cd3-2738-401b-a7ba-ab868a9cdc3d",
    "prId" : 70875,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/70875#pullrequestreview-186314685",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9097c783-d067-4588-80b5-f0855ec5e994",
        "parentId" : null,
        "authorId" : "47ec15eb-72b4-4618-9e01-e3b37b6bac00",
        "body" : "This will be changed to check the GVK of the kustomization file in an immediate follow up.",
        "createdAt" : "2018-12-18T22:34:32Z",
        "updatedAt" : "2018-12-18T22:34:33Z",
        "lastEditedBy" : "47ec15eb-72b4-4618-9e01-e3b37b6bac00",
        "tags" : [
        ]
      }
    ],
    "commit" : "ac209ccdc02a28d5111f09b13dc84d3654555d5f",
    "line" : 36,
    "diffHunk" : "@@ -1,1 +472,476 @@\t\t\treturn nil\n\t\t}\n\t\tif filepath.Base(path) == constants.KustomizationFileName {\n\t\t\tvisitors = append(visitors, NewKustomizationVisitor(mapper, filepath.Dir(path), schema))\n\t\t\treturn nil"
  },
  {
    "id" : "698556a6-58eb-400a-9da8-6cc451d8dc13",
    "prId" : 70875,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/70875#pullrequestreview-186315331",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9f24aabf-511e-4381-9771-e9fc019d5e4a",
        "parentId" : null,
        "authorId" : "47ec15eb-72b4-4618-9e01-e3b37b6bac00",
        "body" : "In an immediate follow up this should be a library that takes options.",
        "createdAt" : "2018-12-18T22:36:31Z",
        "updatedAt" : "2018-12-18T22:36:31Z",
        "lastEditedBy" : "47ec15eb-72b4-4618-9e01-e3b37b6bac00",
        "tags" : [
        ]
      }
    ],
    "commit" : "ac209ccdc02a28d5111f09b13dc84d3654555d5f",
    "line" : 72,
    "diffHunk" : "@@ -1,1 +537,541 @@\tf := k8sdeps.NewFactory()\n\tvar out bytes.Buffer\n\tcmd := build.NewCmdBuild(&out, fSys, f.ResmapF, f.TransformerF)\n\tcmd.SetArgs([]string{v.Path})\n\t// we want to silence usage, error output, and any future output from cobra"
  }
]