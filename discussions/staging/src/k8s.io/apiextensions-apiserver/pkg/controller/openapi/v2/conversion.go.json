[
  {
    "id" : "e542b324-c9ab-4543-85ec-142baf24afc3",
    "prId" : 96369,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/96369#pullrequestreview-528959495",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e7ed07a0-2f67-4200-ad24-83eaaa7d25cd",
        "parentId" : null,
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "`&& additionalProperties is not set`, right?",
        "createdAt" : "2020-11-12T09:52:09Z",
        "updatedAt" : "2020-11-12T09:52:10Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      },
      {
        "id" : "dddeb7af-4b82-4b46-b7bd-1ce35066623d",
        "parentId" : "e7ed07a0-2f67-4200-ad24-83eaaa7d25cd",
        "authorId" : "c2278ebd-0a0e-477b-ac0d-ba37f37d30b1",
        "body" : "The bug is still present if `additionalProperties` is set I think.\r\n\r\n- You can reproduce it with `additionalProperties` sets to `true`:\r\n\r\n```yaml\r\napiVersion: apiextensions.k8s.io/v1\r\nkind: CustomResourceDefinition\r\nmetadata:\r\n  name: foos.k8s.test\r\nspec:\r\n  group: k8s.test\r\n  versions:\r\n    - name: v1\r\n      served: true\r\n      storage: true\r\n      schema:\r\n        openAPIV3Schema:\r\n          type: object\r\n          properties:\r\n            field:\r\n              type: object\r\n              x-kubernetes-preserve-unknown-fields: true\r\n              additionalProperties: true\r\n  scope: Namespaced\r\n  names:\r\n    plural: foos\r\n    singular: foo\r\n    kind: Foo\r\n```\r\n\r\n```yaml\r\napiVersion: k8s.test/v1\r\nkind: Foo\r\nmetadata:\r\n  name: foo\r\nfield:\r\n  foo: null\r\n```\r\n\r\n- You can reproduce it with `additionalProperties` including `nullable: true`:\r\n\r\n```yaml\r\napiVersion: apiextensions.k8s.io/v1\r\nkind: CustomResourceDefinition\r\nmetadata:\r\n  name: foos.k8s.test\r\nspec:\r\n  group: k8s.test\r\n  versions:\r\n    - name: v1\r\n      served: true\r\n      storage: true\r\n      schema:\r\n        openAPIV3Schema:\r\n          type: object\r\n          properties:\r\n            field:\r\n              type: object\r\n              x-kubernetes-preserve-unknown-fields: true\r\n              additionalProperties:\r\n                type: object\r\n                nullable: true\r\n  scope: Namespaced\r\n  names:\r\n    plural: foos\r\n    singular: foo\r\n    kind: Foo\r\n```\r\n\r\n```yaml\r\napiVersion: k8s.test/v1\r\nkind: Foo\r\nmetadata:\r\n  name: foo\r\nfield:\r\n  foo: null\r\n```",
        "createdAt" : "2020-11-12T10:07:01Z",
        "updatedAt" : "2020-11-12T10:07:02Z",
        "lastEditedBy" : "c2278ebd-0a0e-477b-ac0d-ba37f37d30b1",
        "tags" : [
        ]
      },
      {
        "id" : "4e452a35-e9fc-48d8-b0cb-4f19cc7610a9",
        "parentId" : "e7ed07a0-2f67-4200-ad24-83eaaa7d25cd",
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "ack",
        "createdAt" : "2020-11-12T10:41:44Z",
        "updatedAt" : "2020-11-12T10:41:45Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      }
    ],
    "commit" : "eed1047c6fba428b8e620d55aba7b4fcbaffe42b",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +82,86 @@\t\t\t}\n\n\t\t\tif s.XPreserveUnknownFields && s.Type == \"object\" {\n\t\t\t\t// similar as above, kubectl doesn't properly handle object fields with `x-kubernetes-preserve-unknown-fields: true`\n\t\t\t\ts.Type = \"\""
  }
]