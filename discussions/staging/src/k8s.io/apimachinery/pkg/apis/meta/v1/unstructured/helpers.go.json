[
  {
    "id" : "063fb23d-4e6b-41ee-bced-bb7f5c1b91b9",
    "prId" : 71272,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/71272#pullrequestreview-176871208",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3c5d80d8-e6c0-42bf-b33f-12e16b88770c",
        "parentId" : null,
        "authorId" : "fa530650-5886-4415-a42f-0dee2e0e9ae3",
        "body" : "Should we give a descriptive error here so that it's clear why the returned object is nil?",
        "createdAt" : "2018-11-20T16:49:20Z",
        "updatedAt" : "2018-11-20T16:49:20Z",
        "lastEditedBy" : "fa530650-5886-4415-a42f-0dee2e0e9ae3",
        "tags" : [
        ]
      },
      {
        "id" : "341553b3-bcc9-406e-8062-5b6eccbc0c8c",
        "parentId" : "3c5d80d8-e6c0-42bf-b33f-12e16b88770c",
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "this is the same case as line 56, where path to the object could not be traversed. we return `false` to indicate the value is not found, not a type error",
        "createdAt" : "2018-11-20T16:53:57Z",
        "updatedAt" : "2018-11-20T16:53:57Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "c260a9cf-f7f7-4677-b545-192ff375b06d",
        "parentId" : "3c5d80d8-e6c0-42bf-b33f-12e16b88770c",
        "authorId" : "fa530650-5886-4415-a42f-0dee2e0e9ae3",
        "body" : "Makes sense. :+1:\r\n\r\n/retest",
        "createdAt" : "2018-11-20T16:54:58Z",
        "updatedAt" : "2018-11-20T16:54:58Z",
        "lastEditedBy" : "fa530650-5886-4415-a42f-0dee2e0e9ae3",
        "tags" : [
        ]
      }
    ],
    "commit" : "52b1718a638ecaf03610c5dfdb3ed78e532354a2",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +49,53 @@\tfor i, field := range fields {\n\t\tif val == nil {\n\t\t\treturn nil, false, nil\n\t\t}\n\t\tif m, ok := val.(map[string]interface{}); ok {"
  },
  {
    "id" : "2f4636a6-52d9-4349-8f7f-edf3ad07fd27",
    "prId" : 60201,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/60201#pullrequestreview-110008091",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "212506fc-ed92-4afe-a37a-90c6e03ad69d",
        "parentId" : null,
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "@liggitt @deads2k ptal where I use this to wrap the (now more strict) versioning codec.",
        "createdAt" : "2018-04-06T09:58:58Z",
        "updatedAt" : "2018-04-06T09:58:58Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      }
    ],
    "commit" : "0fdd3d04d2251343b9998bb691e459dc3ca89111",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +434,438 @@}\n\ntype JSONFallbackEncoder struct {\n\truntime.Encoder\n}"
  },
  {
    "id" : "0af03a77-fc91-4a1c-b120-6c0819f0e931",
    "prId" : 60201,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/60201#pullrequestreview-110632410",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f91bc461-a218-48ae-bdf3-956c85580c4e",
        "parentId" : null,
        "authorId" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "body" : "Ah, this switch/case makes it acceptable.  Can you add doc on the type explaining that you only fallback for unstructured types?",
        "createdAt" : "2018-04-09T22:00:05Z",
        "updatedAt" : "2018-04-09T22:00:06Z",
        "lastEditedBy" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "tags" : [
        ]
      }
    ],
    "commit" : "0fdd3d04d2251343b9998bb691e459dc3ca89111",
    "line" : 12,
    "diffHunk" : "@@ -1,1 +442,446 @@\tif runtime.IsNotRegisteredError(err) {\n\t\tswitch obj.(type) {\n\t\tcase *Unstructured, *UnstructuredList:\n\t\t\treturn UnstructuredJSONScheme.Encode(obj, w)\n\t\t}"
  },
  {
    "id" : "f85001e2-6e37-4595-a3de-5a57320c4ea6",
    "prId" : 51940,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/51940#pullrequestreview-65066766",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "01d9053f-b63b-4aa8-9310-dde28d1f8778",
        "parentId" : null,
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "are these change pure copies?",
        "createdAt" : "2017-09-25T12:21:30Z",
        "updatedAt" : "2017-11-01T10:04:45Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      },
      {
        "id" : "684d19c9-4eeb-404f-8ffc-13236c4c6b24",
        "parentId" : "01d9053f-b63b-4aa8-9310-dde28d1f8778",
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "if not, two separate commits would help.",
        "createdAt" : "2017-09-25T12:21:46Z",
        "updatedAt" : "2017-11-01T10:04:45Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      },
      {
        "id" : "036a46dc-c9e2-4b13-801b-2280e56f5846",
        "parentId" : "01d9053f-b63b-4aa8-9310-dde28d1f8778",
        "authorId" : "06a18a1b-6ca5-44b8-9cdc-5bb944ae4e29",
        "body" : "There are two commits, first splits file into multiple without modifications, second one makes changes. Yes, these \"changes\" are not changes, just copying.",
        "createdAt" : "2017-09-25T23:36:58Z",
        "updatedAt" : "2017-11-01T10:04:45Z",
        "lastEditedBy" : "06a18a1b-6ca5-44b8-9cdc-5bb944ae4e29",
        "tags" : [
        ]
      }
    ],
    "commit" : "7c10cbc642b47a8f11a74d5178ebbe76a9588cb6",
    "line" : 468,
    "diffHunk" : "@@ -1,1 +466,470 @@}\n\nfunc (UnstructuredObjectConverter) ConvertFieldLabel(version, kind, label, value string) (string, string, error) {\n\treturn \"\", \"\", errors.New(\"unstructured cannot convert field labels\")\n}"
  },
  {
    "id" : "48a3eb02-1d5a-4ef2-ada0-c74152f845ed",
    "prId" : 51940,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/51940#pullrequestreview-71002297",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "37e9767d-d85e-4c42-b052-dfab9ec9a122",
        "parentId" : null,
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "why are we deep copying here? need to double check this doesn't impact the uses by patch. cc @wojtek-t ",
        "createdAt" : "2017-10-09T20:35:06Z",
        "updatedAt" : "2017-11-01T10:04:45Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "0296fc08-a51c-4b7c-8ddf-4af776759790",
        "parentId" : "37e9767d-d85e-4c42-b052-dfab9ec9a122",
        "authorId" : "24302707-9254-48df-89a5-cbcc349462b8",
        "body" : "I think it probably will impact.\r\n\r\nBefore proceeding with this change (in general with this PR), I would like to see the impact of those changes to this benchmark:\r\nhttps://github.com/kubernetes/kubernetes/blob/master/pkg/api/unstructured_test.go#L134",
        "createdAt" : "2017-10-10T06:36:31Z",
        "updatedAt" : "2017-11-01T10:04:45Z",
        "lastEditedBy" : "24302707-9254-48df-89a5-cbcc349462b8",
        "tags" : [
        ]
      },
      {
        "id" : "eafe3495-8568-4b75-98dc-1361c18640db",
        "parentId" : "37e9767d-d85e-4c42-b052-dfab9ec9a122",
        "authorId" : "06a18a1b-6ca5-44b8-9cdc-5bb944ae4e29",
        "body" : "Deep copying only matters (and is done in this PR) for slices and maps. Both `getNestedSlice()` and `getNestedMap()` in `master` currently make a copy: \r\nhttps://github.com/kubernetes/kubernetes/blob/51e653dc68e47584ab571fc214a7aa5950918831/staging/src/k8s.io/apimachinery/pkg/apis/meta/v1/unstructured/unstructured.go#L209-L233\r\nAnother place where shallow copying is done currently is `getOwnerReferences()` - a helper function used by corresponding methods on Unstructured(List):\r\nhttps://github.com/kubernetes/kubernetes/blob/51e653dc68e47584ab571fc214a7aa5950918831/staging/src/k8s.io/apimachinery/pkg/apis/meta/v1/unstructured/unstructured.go#L333-L356\r\nThis is actually unnecessary because `GetOwnerReferences()` method converts data into structs using `extractOwnerReference ()`:\r\nhttps://github.com/kubernetes/kubernetes/blob/51e653dc68e47584ab571fc214a7aa5950918831/staging/src/k8s.io/apimachinery/pkg/apis/meta/v1/unstructured/unstructured.go#L358-L369\r\nhttps://github.com/kubernetes/kubernetes/blob/51e653dc68e47584ab571fc214a7aa5950918831/staging/src/k8s.io/apimachinery/pkg/apis/meta/v1/unstructured/unstructured.go#L285-L313\r\n\r\nI have removed this copying.\r\nRegarding the benchmark - looks like there is no difference (probably because there is not much extra copying happening):\r\n```\r\non master\r\n/usr/local/Cellar/go/1.9.1/libexec/bin/go test -c -i -o /private/var/folders/wk/_45zctx51y57kvc6sytpfmm40000gn/T/___BenchmarkToFromUnstructured_in_unstructured_test_go k8s.io/kubernetes/pkg/api/testing\r\n/private/var/folders/wk/_45zctx51y57kvc6sytpfmm40000gn/T/___BenchmarkToFromUnstructured_in_unstructured_test_go -test.v -test.bench ^BenchmarkToFromUnstructured$ -test.run ^$\r\ngoos: darwin\r\ngoarch: amd64\r\npkg: k8s.io/kubernetes/pkg/api/testing\r\n20000\t     79458 ns/op\r\nPASS\r\n\r\nProcess finished with exit code 0\r\n```\r\n```\r\nthis PR:\r\n/usr/local/Cellar/go/1.9.1/libexec/bin/go test -c -i -o /private/var/folders/wk/_45zctx51y57kvc6sytpfmm40000gn/T/___BenchmarkToFromUnstructured_in_unstructured_test_go k8s.io/kubernetes/pkg/api/testing\r\n/private/var/folders/wk/_45zctx51y57kvc6sytpfmm40000gn/T/___BenchmarkToFromUnstructured_in_unstructured_test_go -test.v -test.bench ^BenchmarkToFromUnstructured$ -test.run ^$\r\ngoos: darwin\r\ngoarch: amd64\r\npkg: k8s.io/kubernetes/pkg/api/testing\r\n20000\t     79527 ns/op\r\nPASS\r\n\r\nProcess finished with exit code 0\r\n```\r\nActually, I have reviewed usages of this method and replaced two places where it was used with unexported `nestedFieldNoCopy()`. So this change should have 0 impact.",
        "createdAt" : "2017-10-21T08:28:17Z",
        "updatedAt" : "2017-11-01T10:04:45Z",
        "lastEditedBy" : "06a18a1b-6ca5-44b8-9cdc-5bb944ae4e29",
        "tags" : [
        ]
      }
    ],
    "commit" : "7c10cbc642b47a8f11a74d5178ebbe76a9588cb6",
    "line" : 42,
    "diffHunk" : "@@ -1,1 +40,44 @@\t\treturn nil, false\n\t}\n\treturn unstructured.DeepCopyJSONValue(val), true\n}\n"
  },
  {
    "id" : "e2d159d9-532e-44b4-bf2c-ad8d7d9d4cde",
    "prId" : 51940,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/51940#pullrequestreview-73431002",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "42655a00-02c9-40c6-b900-240cf9bbc7a8",
        "parentId" : null,
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "nit: nestedStringOrDefault with `default string` arg?",
        "createdAt" : "2017-11-01T09:36:15Z",
        "updatedAt" : "2017-11-01T10:04:45Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      },
      {
        "id" : "9d636203-6d5f-401c-9836-f9674b3119cd",
        "parentId" : "42655a00-02c9-40c6-b900-240cf9bbc7a8",
        "authorId" : "06a18a1b-6ca5-44b8-9cdc-5bb944ae4e29",
        "body" : "`getNestedString()` is used in lots of places and default is an empty string everywhere. That is why I kept it as it is. Also I didn't want to touch the name because it would've increased the PR size even further. I can send a follow-up PR with rename if needed.",
        "createdAt" : "2017-11-01T09:54:55Z",
        "updatedAt" : "2017-11-01T10:04:45Z",
        "lastEditedBy" : "06a18a1b-6ca5-44b8-9cdc-5bb944ae4e29",
        "tags" : [
        ]
      },
      {
        "id" : "a6227f34-656a-41f9-b4f9-ad289314cc41",
        "parentId" : "42655a00-02c9-40c6-b900-240cf9bbc7a8",
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "Makes sense.",
        "createdAt" : "2017-11-01T10:13:31Z",
        "updatedAt" : "2017-11-01T10:13:31Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      }
    ],
    "commit" : "7c10cbc642b47a8f11a74d5178ebbe76a9588cb6",
    "line" : 243,
    "diffHunk" : "@@ -1,1 +241,245 @@}\n\nfunc getNestedString(obj map[string]interface{}, fields ...string) string {\n\tval, ok := NestedString(obj, fields...)\n\tif !ok {"
  },
  {
    "id" : "591fa786-9586-49d1-aaee-27b1646d1261",
    "prId" : 51940,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/51940#pullrequestreview-73645995",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3d2bd053-18ce-47c7-b27c-5e3f57762be9",
        "parentId" : null,
        "authorId" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "body" : "Straight move?  I'd expect unstructured objects to always have a `gvk.Version` too.",
        "createdAt" : "2017-11-01T19:44:54Z",
        "updatedAt" : "2017-11-01T19:44:54Z",
        "lastEditedBy" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "tags" : [
        ]
      },
      {
        "id" : "fda3b4c7-55c8-4250-93b9-d05d71bb2660",
        "parentId" : "3d2bd053-18ce-47c7-b27c-5e3f57762be9",
        "authorId" : "06a18a1b-6ca5-44b8-9cdc-5bb944ae4e29",
        "body" : "Yes, I haven't touched this code. See https://github.com/kubernetes/kubernetes/pull/51940/commits/7aeaedd721604714adae4b9fb947dacd53821088#diff-31522f2d01b79a28cf7d5adaa03d5b26L685",
        "createdAt" : "2017-11-01T23:04:03Z",
        "updatedAt" : "2017-11-01T23:04:03Z",
        "lastEditedBy" : "06a18a1b-6ca5-44b8-9cdc-5bb944ae4e29",
        "tags" : [
        ]
      }
    ],
    "commit" : "7c10cbc642b47a8f11a74d5178ebbe76a9588cb6",
    "line" : 313,
    "diffHunk" : "@@ -1,1 +311,315 @@\n\tgvk := obj.GetObjectKind().GroupVersionKind()\n\tif len(gvk.Kind) == 0 {\n\t\treturn nil, &gvk, runtime.NewMissingKindErr(string(data))\n\t}"
  }
]