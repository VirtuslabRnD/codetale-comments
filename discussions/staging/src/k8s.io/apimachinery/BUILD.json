[
  {
    "id" : "eff0f90b-cd98-4667-83e5-1cabe9f56688",
    "prId" : 74153,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/74153#pullrequestreview-210370074",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0500c7ed-0c6f-4dae-9320-521a8a2bfd56",
        "parentId" : null,
        "authorId" : "a139439a-9f9e-4518-b4f3-9c602d956c57",
        "body" : "Does this mean that sub-directory hierarchy changes will required top-level apimachinery approval from now on? :-/",
        "createdAt" : "2019-03-04T20:36:39Z",
        "updatedAt" : "2019-03-04T20:36:39Z",
        "lastEditedBy" : "a139439a-9f9e-4518-b4f3-9c602d956c57",
        "tags" : [
        ]
      },
      {
        "id" : "e4e9f3f3-a693-425c-9a59-02b88bf82b52",
        "parentId" : "0500c7ed-0c6f-4dae-9320-521a8a2bfd56",
        "authorId" : "a139439a-9f9e-4518-b4f3-9c602d956c57",
        "body" : "Well, looking at the diff above, it was even worse before.",
        "createdAt" : "2019-03-04T20:37:53Z",
        "updatedAt" : "2019-03-04T20:37:53Z",
        "lastEditedBy" : "a139439a-9f9e-4518-b4f3-9c602d956c57",
        "tags" : [
        ]
      },
      {
        "id" : "bcd1e563-1443-4519-b0ab-2ff47c7b2413",
        "parentId" : "0500c7ed-0c6f-4dae-9320-521a8a2bfd56",
        "authorId" : "719d0e19-fcef-4b47-afac-404318b9514f",
        "body" : "That's correct. The easiest way to fix it is to ensure there's a `BUILD` file at appropriate ownership levels, since the `all-srcs` rules fold up to the next `all-srcs` rule.\r\n\r\nFor example, the `pkg/apis/OWNERS` file here has\r\n```yaml\r\noptions:\r\n  no_parent_owners: true\r\napprovers:\r\n- api-approvers\r\nreviewers:\r\n- api-reviewers\r\nlabels:\r\n- kind/api-change\r\n```\r\n\r\nand since there are no `BUILD` files until well into the tree, the directory structure is encoded here in this top-level `BUILD` file:\r\n```python\r\n        \"//staging/src/k8s.io/apimachinery/pkg/apis/meta/fuzzer:all-srcs\",\r\n        \"//staging/src/k8s.io/apimachinery/pkg/apis/meta/internalversion:all-srcs\",\r\n        \"//staging/src/k8s.io/apimachinery/pkg/apis/meta/v1:all-srcs\",\r\n        \"//staging/src/k8s.io/apimachinery/pkg/apis/meta/v1beta1:all-srcs\",\r\n        \"//staging/src/k8s.io/apimachinery/pkg/apis/testapigroup:all-srcs\",\r\n```\r\n\r\nIf we were to create a `pkg/apis/BUILD` file, these lines would be replaced with\r\n```python\r\n        \"//staging/src/k8s.io/apimachinery/pkg/apis:all-srcs\",\r\n```\r\n\r\nand then any subsequent changes would be isolated from this top-level BUILD file.",
        "createdAt" : "2019-03-04T20:51:34Z",
        "updatedAt" : "2019-03-04T20:51:34Z",
        "lastEditedBy" : "719d0e19-fcef-4b47-afac-404318b9514f",
        "tags" : [
        ]
      },
      {
        "id" : "55a696b0-6394-4e96-8489-a82c6a08c1f0",
        "parentId" : "0500c7ed-0c6f-4dae-9320-521a8a2bfd56",
        "authorId" : "719d0e19-fcef-4b47-afac-404318b9514f",
        "body" : "Note that I did something similar for the top-level `BUILD` file in kubernetes/kubernetes; each top-level directory has a `BUILD` file, so the `all-srcs` rule at top-level is simple and isolated from changes:\r\nhttps://github.com/kubernetes/kubernetes/blob/d0c3b708026f681f7467d36dcf9696f89ccfcfab/build/root/BUILD.root#L78-L97",
        "createdAt" : "2019-03-04T20:52:59Z",
        "updatedAt" : "2019-03-04T20:52:59Z",
        "lastEditedBy" : "719d0e19-fcef-4b47-afac-404318b9514f",
        "tags" : [
        ]
      },
      {
        "id" : "5fca9d5e-a9fb-4d4c-bfda-03a571c7130e",
        "parentId" : "0500c7ed-0c6f-4dae-9320-521a8a2bfd56",
        "authorId" : "a139439a-9f9e-4518-b4f3-9c602d956c57",
        "body" : "Thank you Jeff!",
        "createdAt" : "2019-03-04T21:14:38Z",
        "updatedAt" : "2019-03-04T21:14:38Z",
        "lastEditedBy" : "a139439a-9f9e-4518-b4f3-9c602d956c57",
        "tags" : [
        ]
      }
    ],
    "commit" : "392ad719ebb1803855c7daff5dfc590a138329a1",
    "line" : 12,
    "diffHunk" : "@@ -1,1 +10,14 @@    srcs = [\n        \":package-srcs\",\n        \"//staging/src/k8s.io/apimachinery/pkg/api/apitesting:all-srcs\",\n        \"//staging/src/k8s.io/apimachinery/pkg/api/equality:all-srcs\",\n        \"//staging/src/k8s.io/apimachinery/pkg/api/errors:all-srcs\","
  }
]