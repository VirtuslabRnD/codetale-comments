[
  {
    "id" : "49b1cf1b-4b29-419e-ba46-cfeaee61b791",
    "prId" : 70515,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/70515#pullrequestreview-174049214",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "15cdb239-2f74-4e4b-a959-86ca187df520",
        "parentId" : null,
        "authorId" : "209ee091-cf29-4efa-8a1b-a98334ea3f9a",
        "body" : "I don't think this is going to work.  CSINodeInfo is under an alpha feature gate which means they won't be created by default.  I think you might need two feature gates, one for controller and one for nodes, then move the node feature gate to beta first.\r\n\r\nOr ADC should fallback to intree if migration is on but CSINodeInfo doesn't exist",
        "createdAt" : "2018-11-11T14:10:21Z",
        "updatedAt" : "2018-11-11T14:13:03Z",
        "lastEditedBy" : "209ee091-cf29-4efa-8a1b-a98334ea3f9a",
        "tags" : [
        ]
      },
      {
        "id" : "ec031521-88e7-4027-ac9c-50dc307a7957",
        "parentId" : "15cdb239-2f74-4e4b-a959-86ca187df520",
        "authorId" : "209ee091-cf29-4efa-8a1b-a98334ea3f9a",
        "body" : "Nm I think I got it now.  The CSIMigration feature gate cannot move to beta until 2 releases after CSINodeInfo is beta. It might be good to explicitly detail this here.",
        "createdAt" : "2018-11-11T15:06:34Z",
        "updatedAt" : "2018-11-11T15:06:34Z",
        "lastEditedBy" : "209ee091-cf29-4efa-8a1b-a98334ea3f9a",
        "tags" : [
        ]
      },
      {
        "id" : "1341a3e1-141e-4244-af94-ffdae9a91122",
        "parentId" : "15cdb239-2f74-4e4b-a959-86ca187df520",
        "authorId" : "209ee091-cf29-4efa-8a1b-a98334ea3f9a",
        "body" : "Actually no I'm confused again. The logic that auto creates CSINodeInfo objects for migrated drivers will be under the specific plugin's CSIMigration feature gate?",
        "createdAt" : "2018-11-11T15:11:03Z",
        "updatedAt" : "2018-11-11T15:11:03Z",
        "lastEditedBy" : "209ee091-cf29-4efa-8a1b-a98334ea3f9a",
        "tags" : [
        ]
      },
      {
        "id" : "af9f0435-2180-43c8-8ecc-cd4d89846aa9",
        "parentId" : "15cdb239-2f74-4e4b-a959-86ca187df520",
        "authorId" : "542e5d2f-2ff9-4674-ab44-78f31768e7a1",
        "body" : "https://github.com/kubernetes/kubernetes/pull/70909\r\n\r\nThe plan is that CSINodeInfo objects are auto created iff CSINodeInfo feature gate is on.\r\nThen the gates for each CSIMigration plugin can only go Beta (default) 2 releases after the CSINodeInfos have been added.",
        "createdAt" : "2018-11-12T18:15:11Z",
        "updatedAt" : "2018-11-12T18:15:11Z",
        "lastEditedBy" : "542e5d2f-2ff9-4674-ab44-78f31768e7a1",
        "tags" : [
        ]
      },
      {
        "id" : "639da3ea-4db5-48c5-a2bc-74254f98120e",
        "parentId" : "15cdb239-2f74-4e4b-a959-86ca187df520",
        "authorId" : "542e5d2f-2ff9-4674-ab44-78f31768e7a1",
        "body" : "would be happy to discuss in-person",
        "createdAt" : "2018-11-12T19:03:35Z",
        "updatedAt" : "2018-11-12T19:03:35Z",
        "lastEditedBy" : "542e5d2f-2ff9-4674-ab44-78f31768e7a1",
        "tags" : [
        ]
      }
    ],
    "commit" : "06f3b26012e09318935c248e62864e9349da6cd8",
    "line" : 50,
    "diffHunk" : "@@ -1,1 +48,52 @@Kubelet and ADC at a version where the CSINodeInfo's are being created on\nKubelet startup. We will not promote the feature to Beta (on by default) until\nthe CSINodeInfo's are being created on Kubelet startup for a 2 version skew to\nprevent the case where the CSINodeInfo does not exist when the ADC depends on\nit. This prevents the race described above becoming a permanent bad state."
  }
]