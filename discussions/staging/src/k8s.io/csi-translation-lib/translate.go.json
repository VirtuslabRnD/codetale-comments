[
  {
    "id" : "5df8ecd1-11ef-499c-949f-b8e5652d2986",
    "prId" : 83098,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/83098#pullrequestreview-310202340",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "09c50123-be30-49cf-b19a-fa30ca93fc6b",
        "parentId" : null,
        "authorId" : "542e5d2f-2ff9-4674-ab44-78f31768e7a1",
        "body" : "Does this cause issues in its current state? Could you pull this change out into it's own PR and link it here - seems like an unrelated bug-fix that we could probably get in earlier",
        "createdAt" : "2019-10-28T20:45:48Z",
        "updatedAt" : "2019-11-15T01:28:24Z",
        "lastEditedBy" : "542e5d2f-2ff9-4674-ab44-78f31768e7a1",
        "tags" : [
        ]
      },
      {
        "id" : "c442b745-1b50-4d10-b8f5-38ca19342f8f",
        "parentId" : "09c50123-be30-49cf-b19a-fa30ca93fc6b",
        "authorId" : "98986d5f-c846-4478-8363-8a016e3d6b89",
        "body" : "Very good point - this specific change used to be necessary due to changes introduced in the current PR: The kubelet DSOW populator [used](https://github.com/kubernetes/kubernetes/pull/84048/files#diff-94e527d26427ceb4f990f05f76952656L510) to invoke `GetVolumeMode` on a volume and this failed when migration is enabled (because for inline volumes, the default PV populator that sets FS volume mode does not get invoked). However [this recent change](https://github.com/kubernetes/kubernetes/pull/84048/files#diff-94e527d26427ceb4f990f05f76952656L510) introduced a workaround that relaxed things a bit but I kept this around for now to be safe (so that things don't break when the [TODO](https://github.com/kubernetes/kubernetes/pull/84048/files#diff-94e527d26427ceb4f990f05f76952656R508) is addressed and migration tests are not immediately run). I will run a test without the above change and if tests still pass for inline with migration enabled, I will separate it out from this PR.",
        "createdAt" : "2019-10-28T23:57:20Z",
        "updatedAt" : "2019-11-15T01:28:24Z",
        "lastEditedBy" : "98986d5f-c846-4478-8363-8a016e3d6b89",
        "tags" : [
        ]
      },
      {
        "id" : "b9345e09-dcc3-43ed-a3ad-3d249b9a4860",
        "parentId" : "09c50123-be30-49cf-b19a-fa30ca93fc6b",
        "authorId" : "98986d5f-c846-4478-8363-8a016e3d6b89",
        "body" : "We will still need the change to handle [CheckVolumeFileSystem](https://github.com/kubernetes/kubernetes/blob/14e5adfc85119b0fca6bed1dabfca8bc94d9f923/pkg/volume/util/operationexecutor/operation_executor.go#L757) calls which call into `GetVolumeMode`. Otherwise migrated inline scenarios fail with `cannot get volumeMode for volume`",
        "createdAt" : "2019-10-31T21:50:56Z",
        "updatedAt" : "2019-11-15T01:28:24Z",
        "lastEditedBy" : "98986d5f-c846-4478-8363-8a016e3d6b89",
        "tags" : [
        ]
      }
    ],
    "commit" : "129f15328bfc159e759260408fedbb9ea1ab2b61",
    "line" : 9,
    "diffHunk" : "@@ -1,1 +72,76 @@\t\t\t\treturn nil, err\n\t\t\t}\n\t\t\t// Inline volumes only support PersistentVolumeFilesystem (and not block).\n\t\t\t// If VolumeMode has not been set explicitly by plugin-specific\n\t\t\t// translator, set it to Filesystem here."
  }
]