[
  {
    "id" : "e07123b0-42ff-46c5-ade8-5b8869e94519",
    "prId" : 83249,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/83249#pullrequestreview-294623460",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "144a2b6a-ff1b-4d55-be68-ab19c31cc606",
        "parentId" : null,
        "authorId" : "98986d5f-c846-4478-8363-8a016e3d6b89",
        "body" : "Slightly unrelated to the specific nil checks (which looks lgtm), Q for @andyzhangx: why do we need FSType passed twice - as a field in CSI source as well as a volume attribute. If not needed, can one of them be removed?",
        "createdAt" : "2019-09-27T21:06:21Z",
        "updatedAt" : "2019-09-27T21:06:37Z",
        "lastEditedBy" : "98986d5f-c846-4478-8363-8a016e3d6b89",
        "tags" : [
        ]
      },
      {
        "id" : "c8053159-5cd3-4faf-9d30-ca1d45f61157",
        "parentId" : "144a2b6a-ff1b-4d55-be68-ab19c31cc606",
        "authorId" : "e0218e0a-9e55-43f5-8929-04673eea9015",
        "body" : "@ddebroy we support fstype in both CSI and driver parameter settings, this PR lgtm, thanks.",
        "createdAt" : "2019-09-28T06:07:52Z",
        "updatedAt" : "2019-09-28T06:08:26Z",
        "lastEditedBy" : "e0218e0a-9e55-43f5-8929-04673eea9015",
        "tags" : [
        ]
      }
    ],
    "commit" : "55583be725dcde2bac9ab82096f5dd146770eb48",
    "line" : 22,
    "diffHunk" : "@@ -1,1 +93,97 @@\t}\n\tif azureSource.FSType != nil {\n\t\tpv.Spec.PersistentVolumeSource.CSI.FSType = *azureSource.FSType\n\t\tpv.Spec.PersistentVolumeSource.CSI.VolumeAttributes[azureDiskFSType] = *azureSource.FSType\n\t}"
  },
  {
    "id" : "6e099323-d77a-4a32-a69f-2c29018f11b2",
    "prId" : 81633,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/81633#pullrequestreview-276946171",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "12368a06-c360-4b9e-ba46-0d9def326b41",
        "parentId" : null,
        "authorId" : "0df1da34-610c-4ce5-b0cf-bbda668bf9c1",
        "body" : "also check for empty string here? Is there any default value if it is empty string?",
        "createdAt" : "2019-08-20T06:04:37Z",
        "updatedAt" : "2019-08-20T06:04:37Z",
        "lastEditedBy" : "0df1da34-610c-4ce5-b0cf-bbda668bf9c1",
        "tags" : [
        ]
      },
      {
        "id" : "fdb75340-2495-4342-ae4c-6f13236f38a6",
        "parentId" : "12368a06-c360-4b9e-ba46-0d9def326b41",
        "authorId" : "0df1da34-610c-4ce5-b0cf-bbda668bf9c1",
        "body" : "Oh, I see it's already checked below.",
        "createdAt" : "2019-08-20T06:05:05Z",
        "updatedAt" : "2019-08-20T06:05:06Z",
        "lastEditedBy" : "0df1da34-610c-4ce5-b0cf-bbda668bf9c1",
        "tags" : [
        ]
      }
    ],
    "commit" : "979075839443eb47c1558f6761f38c5d2ed852f0",
    "line" : 41,
    "diffHunk" : "@@ -1,1 +123,127 @@\t}\n\n\tif azureSource.FSType != nil {\n\t\tcsiSource.VolumeAttributes[azureDiskFSType] = *azureSource.FSType\n\t}"
  },
  {
    "id" : "c01c3861-e067-4596-8aee-bc8b0eaf8bce",
    "prId" : 81633,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/81633#pullrequestreview-277435524",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5a81f104-64d2-41b6-930c-32657d7a71d5",
        "parentId" : null,
        "authorId" : "542e5d2f-2ff9-4674-ab44-78f31768e7a1",
        "body" : "could you write a quick unit test?",
        "createdAt" : "2019-08-20T20:56:45Z",
        "updatedAt" : "2019-08-20T20:56:45Z",
        "lastEditedBy" : "542e5d2f-2ff9-4674-ab44-78f31768e7a1",
        "tags" : [
        ]
      }
    ],
    "commit" : "979075839443eb47c1558f6761f38c5d2ed852f0",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +81,85 @@\t\t\t\t\tReadOnly:         *azureSource.ReadOnly,\n\t\t\t\t\tFSType:           *azureSource.FSType,\n\t\t\t\t\tVolumeAttributes: map[string]string{azureDiskKind: \"Managed\"},\n\t\t\t\t},\n\t\t\t},"
  },
  {
    "id" : "546b2af5-920b-4728-a890-7de1eb239bfd",
    "prId" : 77703,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/77703#pullrequestreview-243843305",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "09c47229-7d2d-4a15-be19-bd1fae05a54b",
        "parentId" : null,
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "should this be `if azureSource.CachingMode != nil && *azureSource.CachingMode {`?",
        "createdAt" : "2019-05-30T13:34:37Z",
        "updatedAt" : "2019-05-30T13:34:50Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "01cb0812-1c29-4047-84ea-d1f4e00e1ee0",
        "parentId" : "09c47229-7d2d-4a15-be19-bd1fae05a54b",
        "authorId" : "98986d5f-c846-4478-8363-8a016e3d6b89",
        "body" : "good catch! I think we should just check for `if azureSource.CachingMode != nil` rather than something along the lines of `if azureSource.CachingMode != nil && *azureSource.CachingMode != \"\"` So:\r\n\r\n```\r\n        if azureSource.CachingMode != nil {\r\n                pv.Spec.PersistentVolumeSource.CSI.VolumeAttributes[azureDiskCachingMode] = string(*azureSource.CachingMode)\r\n        }\r\n```\r\n\r\nSeems like this is something applicable to the above code as well for the regular `TranslateInTreePVToCSI` already there for AzureDisk at https://github.com/kubernetes/kubernetes/blob/master/staging/src/k8s.io/csi-translation-lib/plugins/azure_disk.go#L79. \r\n\r\nhttps://github.com/kubernetes/kubernetes/issues/78524 to fix it it both places.",
        "createdAt" : "2019-05-30T14:56:02Z",
        "updatedAt" : "2019-05-30T15:02:24Z",
        "lastEditedBy" : "98986d5f-c846-4478-8363-8a016e3d6b89",
        "tags" : [
        ]
      }
    ],
    "commit" : "de7be9d6133bb985d9f1d0fa029e03166f6cd0f4",
    "line" : 27,
    "diffHunk" : "@@ -1,1 +82,86 @@\t}\n\n\tif *azureSource.CachingMode != \"\" {\n\t\tpv.Spec.PersistentVolumeSource.CSI.VolumeAttributes[azureDiskCachingMode] = string(*azureSource.CachingMode)\n\t}"
  },
  {
    "id" : "369414da-1281-4434-8ffe-6c236139ab7c",
    "prId" : 77703,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/77703#pullrequestreview-243844778",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8ad5939c-c09f-42b4-ab39-ccaa963cd07c",
        "parentId" : null,
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "should this be `if azureSource.FSType != nil && *azureSource.FSType {`?",
        "createdAt" : "2019-05-30T13:35:01Z",
        "updatedAt" : "2019-05-30T13:35:01Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "10afa2ad-99e2-4a4f-bb7a-e7ea90a08b61",
        "parentId" : "8ad5939c-c09f-42b4-ab39-ccaa963cd07c",
        "authorId" : "98986d5f-c846-4478-8363-8a016e3d6b89",
        "body" : "Thinking of changing this block to:\r\n```\r\n        if azureSource.FSType != nil {\r\n                pv.Spec.PersistentVolumeSource.CSI.FSType = *azureSource.FSType\r\n                pv.Spec.PersistentVolumeSource.CSI.VolumeAttributes[azureDiskFSType] = *azureSource.FSType\r\n        }\r\n```\r\nApplies to both inline portion in this PR as well as https://github.com/kubernetes/kubernetes/blob/master/staging/src/k8s.io/csi-translation-lib/plugins/azure_disk.go#L83 . \r\n\r\nhttps://github.com/kubernetes/kubernetes/issues/78524 to fix it in both places.\r\n\r\nNot quite sure @andyzhangx why the FSType needs to be passed as a VolumeAttribute parameter on top of the field?",
        "createdAt" : "2019-05-30T14:58:22Z",
        "updatedAt" : "2019-05-30T15:02:42Z",
        "lastEditedBy" : "98986d5f-c846-4478-8363-8a016e3d6b89",
        "tags" : [
        ]
      }
    ],
    "commit" : "de7be9d6133bb985d9f1d0fa029e03166f6cd0f4",
    "line" : 30,
    "diffHunk" : "@@ -1,1 +85,89 @@\t\tpv.Spec.PersistentVolumeSource.CSI.VolumeAttributes[azureDiskCachingMode] = string(*azureSource.CachingMode)\n\t}\n\tif *azureSource.FSType != \"\" {\n\t\tpv.Spec.PersistentVolumeSource.CSI.VolumeAttributes[azureDiskFSType] = *azureSource.FSType\n\t}"
  },
  {
    "id" : "1bbc1b8c-9073-439b-8ea5-3f8fa5e1ea3e",
    "prId" : 77703,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/77703#pullrequestreview-243847580",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b5e94db8-498d-48fc-9fb9-dac1a280f4ce",
        "parentId" : null,
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "similar comments about nil checks on these fields before dereferencing them",
        "createdAt" : "2019-05-30T13:35:32Z",
        "updatedAt" : "2019-05-30T13:35:32Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "36ba722a-0b0b-44a9-b68e-474ef74d0e33",
        "parentId" : "b5e94db8-498d-48fc-9fb9-dac1a280f4ce",
        "authorId" : "98986d5f-c846-4478-8363-8a016e3d6b89",
        "body" : "https://github.com/kubernetes/kubernetes/issues/78524 to fix this both above and in `TranslateInTreePVToCSI`",
        "createdAt" : "2019-05-30T15:03:12Z",
        "updatedAt" : "2019-05-30T15:03:12Z",
        "lastEditedBy" : "98986d5f-c846-4478-8363-8a016e3d6b89",
        "tags" : [
        ]
      }
    ],
    "commit" : "de7be9d6133bb985d9f1d0fa029e03166f6cd0f4",
    "line" : 19,
    "diffHunk" : "@@ -1,1 +74,78 @@\t\t\t\t\tVolumeHandle:     azureSource.DataDiskURI,\n\t\t\t\t\tReadOnly:         *azureSource.ReadOnly,\n\t\t\t\t\tFSType:           *azureSource.FSType,\n\t\t\t\t\tVolumeAttributes: map[string]string{},\n\t\t\t\t},"
  }
]