[
  {
    "id" : "31e3fe6f-c84b-404d-89bf-88607665f42f",
    "prId" : 96901,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/96901#pullrequestreview-571344626",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "269c6234-a4a6-400c-a15e-c38aa1022ec7",
        "parentId" : null,
        "authorId" : "3e6e337f-0beb-4609-abc3-11b8e8cf5688",
        "body" : "use case A: user specifies a malformed timeout value in the request url,\r\n\r\nbefore: the request is failed with `400` and it is not audited.\r\nnow:  the request is failed with `400` and it is audited.\r\n\r\n@liggitt i have addressed your concern, now the failed request is audited.",
        "createdAt" : "2021-01-15T19:06:03Z",
        "updatedAt" : "2021-01-28T19:15:25Z",
        "lastEditedBy" : "3e6e337f-0beb-4609-abc3-11b8e8cf5688",
        "tags" : [
        ]
      },
      {
        "id" : "1b84b90a-bf26-4ef1-9399-6bb4e4d2fa75",
        "parentId" : "269c6234-a4a6-400c-a15e-c38aa1022ec7",
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "I'll defer review to @sttts as long as the issues with the original PR are fixed and tested",
        "createdAt" : "2021-01-19T15:14:00Z",
        "updatedAt" : "2021-01-28T19:15:25Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      }
    ],
    "commit" : "df7a890d94d95e19e066833cb99d3ca656b8dc54",
    "line" : 78,
    "diffHunk" : "@@ -1,1 +76,80 @@\t\t\tfailed := failedErrorHandler(negotiatedSerializer, statusErr)\n\t\t\tfailWithAudit := withFailedRequestAudit(failed, statusErr, sink, policy)\n\t\t\tfailWithAudit.ServeHTTP(w, req)\n\t\t\treturn\n\t\t}"
  },
  {
    "id" : "3fde784b-6528-43c7-ad44-3a8af5b3a3f9",
    "prId" : 96901,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/96901#pullrequestreview-569543713",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "28d355c9-da80-4729-8d0c-4fd90c12aefb",
        "parentId" : null,
        "authorId" : "3e6e337f-0beb-4609-abc3-11b8e8cf5688",
        "body" : "use case B: user specifies a timeout duration that is longer than the maximum deadline allowed by the apiserver.\r\n\r\nbefore:  the request is failed with `400` and it is not audited.\r\nnow: the request is not failed any longer, the timeout is set to the maximum timeout allowed by the apiserver.\r\n\r\n@liggitt i have addressed your concern, we allow a request with longer timeout to proceed.\r\n",
        "createdAt" : "2021-01-15T19:06:09Z",
        "updatedAt" : "2021-01-28T19:15:25Z",
        "lastEditedBy" : "3e6e337f-0beb-4609-abc3-11b8e8cf5688",
        "tags" : [
        ]
      }
    ],
    "commit" : "df7a890d94d95e19e066833cb99d3ca656b8dc54",
    "line" : 90,
    "diffHunk" : "@@ -1,1 +88,92 @@\t\t\t\ttimeout = userSpecifiedTimeout\n\t\t\t}\n\t\t}\n\n\t\tstarted := clock.Now()"
  },
  {
    "id" : "eebd6ade-ad79-40c8-95fc-2377c32afa61",
    "prId" : 96061,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/96061#pullrequestreview-534930170",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0f8141fb-a639-41d0-8917-57cffd7c6e7a",
        "parentId" : null,
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "this is a breaking change... clients that previously worked will now get a 400 response",
        "createdAt" : "2020-11-19T23:05:10Z",
        "updatedAt" : "2020-11-19T23:05:11Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      }
    ],
    "commit" : "83f869ee1350da1b65d508725749fb70d0f535f2",
    "line" : 35,
    "diffHunk" : "@@ -1,1 +33,37 @@\n\t// The timeout specified in the request URL exceeds the global maximum timeout allowed by the apiserver.\n\terrTimeoutExceedsMaximumAllowed = errors.New(\"timeout specified in the request URL exceeds the maximum timeout allowed by the server\")\n)\n"
  },
  {
    "id" : "e9b69173-15b7-4bc5-ae3b-f992bac6da38",
    "prId" : 96061,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/96061#pullrequestreview-535071849",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0144ce2c-61d6-4056-9429-cf61849c7e18",
        "parentId" : null,
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "Since the timeout filter comes before the audit filter, requests receiving this error did not appear in the audit log, and since the client I found that hit this did not have trace logging enabled, this was super hard to track down. If we're going to make this filter start returning errors, it needs to be done in a way that surfaces in audit",
        "createdAt" : "2020-11-20T04:30:21Z",
        "updatedAt" : "2020-11-20T04:30:21Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      }
    ],
    "commit" : "83f869ee1350da1b65d508725749fb70d0f535f2",
    "line" : 68,
    "diffHunk" : "@@ -1,1 +66,70 @@\t\tif ok {\n\t\t\tif userSpecifiedTimeout > requestTimeoutMaximum {\n\t\t\t\thandleError(w, req, http.StatusBadRequest, errTimeoutExceedsMaximumAllowed)\n\t\t\t\treturn\n\t\t\t}"
  }
]