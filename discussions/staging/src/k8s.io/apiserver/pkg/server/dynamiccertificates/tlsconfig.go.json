[
  {
    "id" : "a86a9489-fc2a-4239-b9ab-0401e68279f8",
    "prId" : 83580,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/83580#pullrequestreview-302688573",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "af7b2d20-361f-4156-960a-7033154c7a8c",
        "parentId" : null,
        "authorId" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "body" : "dont' allow loading empty.",
        "createdAt" : "2019-10-16T15:53:07Z",
        "updatedAt" : "2019-10-17T13:37:32Z",
        "lastEditedBy" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "tags" : [
        ]
      }
    ],
    "commit" : "6f89f1027488aeba4af0786988c2fd2ace9a6f1d",
    "line" : 46,
    "diffHunk" : "@@ -1,1 +110,114 @@\t\t\treturn nil, fmt.Errorf(\"not loading an empty serving certificate from %q\", c.servingCert.Name())\n\t\t}\n\n\t\tnewContent.servingCert = certKeyContent{cert: currServingCert, key: currServingKey}\n\t}"
  },
  {
    "id" : "9e1606cb-c662-49de-91b9-41ab6218dc14",
    "prId" : 83555,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/83555#pullrequestreview-298315475",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "98d56a7b-d927-4e22-9b4b-89fda7b0b32a",
        "parentId" : null,
        "authorId" : "c8bfafed-d184-4111-b0f7-47520a7dc6f5",
        "body" : "CI checks want this function commented",
        "createdAt" : "2019-10-07T18:16:00Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "c8bfafed-d184-4111-b0f7-47520a7dc6f5",
        "tags" : [
        ]
      }
    ],
    "commit" : "abddbd87cdcf69053e9fc6e752ade7d92c6b9fd7",
    "line" : 60,
    "diffHunk" : "@@ -1,1 +58,62 @@\n// NewDynamicServingCertificateController returns a controller that can be used to keep a TLSConfig up to date.\nfunc NewDynamicServingCertificateController(\n\tbaseTLSConfig tls.Config,\n\tclientCA CAContentProvider,"
  },
  {
    "id" : "5f1873f3-5041-45fb-b54a-a373ab7ce49e",
    "prId" : 83555,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/83555#pullrequestreview-298426722",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "cebf339e-8fa9-4bd2-8c31-23c9ca1aa33c",
        "parentId" : null,
        "authorId" : "c8bfafed-d184-4111-b0f7-47520a7dc6f5",
        "body" : "As mentioned above, is this being nil/empty meant to denote an error? Why not an explicit error return value?",
        "createdAt" : "2019-10-07T18:16:30Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "c8bfafed-d184-4111-b0f7-47520a7dc6f5",
        "tags" : [
        ]
      },
      {
        "id" : "da21ab64-fce1-4fe7-868d-214f860a986d",
        "parentId" : "cebf339e-8fa9-4bd2-8c31-23c9ca1aa33c",
        "authorId" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "body" : "> As mentioned above, is this being nil/empty meant to denote an error? Why not an explicit error return value?\r\n\r\nI think the error comes at a different layer.  See https://github.com/kubernetes/kubernetes/pull/83579 . Building the TLSConfig must not fail or should have a super high bar for failure.  Remember, we're unioning multiple values here.",
        "createdAt" : "2019-10-07T21:38:11Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "tags" : [
        ]
      }
    ],
    "commit" : "abddbd87cdcf69053e9fc6e752ade7d92c6b9fd7",
    "line" : 97,
    "diffHunk" : "@@ -1,1 +95,99 @@\t// don't remove all content.  The value was configured at one time, so continue using that.\n\t// Errors reading content can be reported by lower level controllers.\n\tif len(currClientCABundle) == 0 {\n\t\treturn nil, fmt.Errorf(\"not loading an empty client ca bundle from %q\", c.clientCA.Name())\n\t}"
  },
  {
    "id" : "54b714f4-662e-4260-98d4-7c61716ef8f9",
    "prId" : 83555,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/83555#pullrequestreview-298748431",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ef3e9aa9-f6f7-453b-96bc-ff40b3ef0a3f",
        "parentId" : null,
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "controller.go",
        "createdAt" : "2019-10-08T06:54:04Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      },
      {
        "id" : "19e0dafe-b9fa-4bdf-8bd9-fd2061bf2435",
        "parentId" : "ef3e9aa9-f6f7-453b-96bc-ff40b3ef0a3f",
        "authorId" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "body" : "needs to be more specific as we add more controllers",
        "createdAt" : "2019-10-08T13:08:44Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "tags" : [
        ]
      }
    ],
    "commit" : "abddbd87cdcf69053e9fc6e752ade7d92c6b9fd7",
    "line" : 1,
    "diffHunk" : "@@ -1,1 +-1,3 @@/*\nCopyright 2019 The Kubernetes Authors.\n"
  },
  {
    "id" : "0741bb71-69f0-43f9-b795-fce3ae6a4057",
    "prId" : 83555,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/83555#pullrequestreview-298723241",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "fe921168-7572-4739-950a-7d3729d5bc01",
        "parentId" : null,
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "redundant `DynamicServingCertificate` in this package",
        "createdAt" : "2019-10-08T06:54:38Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      },
      {
        "id" : "3e1265d7-a594-47b0-bc41-ce2216de44a1",
        "parentId" : "fe921168-7572-4739-950a-7d3729d5bc01",
        "authorId" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "body" : "> redundant `DynamicServingCertificate` in this package\r\n\r\nGolangs advice is really bad and we're adding more controllers in here for watching the content.",
        "createdAt" : "2019-10-08T12:26:15Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "tags" : [
        ]
      }
    ],
    "commit" : "abddbd87cdcf69053e9fc6e752ade7d92c6b9fd7",
    "line" : 40,
    "diffHunk" : "@@ -1,1 +38,42 @@\n// DynamicServingCertificateController dynamically loads certificates and provides a golang tls compatible dynamic GetCertificate func.\ntype DynamicServingCertificateController struct {\n\t// baseTLSConfig is the static portion of the tlsConfig for serving to clients.  It is copied and the copy is mutated\n\t// based on the dynamic cert state."
  },
  {
    "id" : "c1f2c4f1-7b3c-494f-98df-01a783c0d227",
    "prId" : 83555,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/83555#pullrequestreview-298723464",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a7f02f40-9bcc-4c3c-ade6-7e96fcffed2e",
        "parentId" : null,
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "for 7 CAs in the bundle you get 7 events and 7 log lines. Intentional?",
        "createdAt" : "2019-10-08T06:58:24Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      },
      {
        "id" : "d7e643e9-0d80-47ef-af55-77e029244568",
        "parentId" : "a7f02f40-9bcc-4c3c-ade6-7e96fcffed2e",
        "authorId" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "body" : "> for 7 CAs in the bundle you get 7 events and 7 log lines. Intentional?\r\n\r\nYeah.  You don't update often and multiline log messages break stuff.",
        "createdAt" : "2019-10-08T12:26:42Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "tags" : [
        ]
      }
    ],
    "commit" : "abddbd87cdcf69053e9fc6e752ade7d92c6b9fd7",
    "line" : 126,
    "diffHunk" : "@@ -1,1 +124,128 @@\t\t}\n\t\tfor i, cert := range newClientCAs {\n\t\t\tklog.V(2).Infof(\"loaded client CA [%d/%q]: %s\", i, c.clientCA.Name(), GetHumanCertDetail(cert))\n\t\t\tif c.eventRecorder != nil {\n\t\t\t\tc.eventRecorder.Eventf(nil, nil, v1.EventTypeWarning, \"TLSConfigChanged\", \"CACertificateReload\", \"loaded client CA [%d/%q]: %s\", i, c.clientCA.Name(), GetHumanCertDetail(cert))"
  },
  {
    "id" : "5ca8fab0-7008-4479-94da-830809a7895a",
    "prId" : 83555,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/83555#pullrequestreview-298723622",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "cc6b25c1-cc1f-443b-acf1-e96268a83a16",
        "parentId" : null,
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "s/clientCA/provider/",
        "createdAt" : "2019-10-08T07:00:07Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      },
      {
        "id" : "2531becd-0b9c-44c9-a2e4-a2ef177f8f86",
        "parentId" : "cc6b25c1-cc1f-443b-acf1-e96268a83a16",
        "authorId" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "body" : "> s/clientCA/provider/\r\n\r\nthere will be providers for serving certs",
        "createdAt" : "2019-10-08T12:26:59Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "tags" : [
        ]
      }
    ],
    "commit" : "abddbd87cdcf69053e9fc6e752ade7d92c6b9fd7",
    "line" : 46,
    "diffHunk" : "@@ -1,1 +44,48 @@\n\t// clientCA provides the very latest content of the ca bundle\n\tclientCA CAContentProvider\n\n\t// currentlyServedContent holds the original bytes that we are serving. This is used to decide if we need to set a"
  },
  {
    "id" : "d161078a-e1a9-4053-aeb2-4dcf560023d4",
    "prId" : 83555,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/83555#pullrequestreview-298724444",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3ffeb7cf-93be-44e4-8fc0-894f867e0620",
        "parentId" : null,
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "this polls the provider once a minute. This needs to be in the go doc.",
        "createdAt" : "2019-10-08T07:01:18Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      },
      {
        "id" : "3bf2f2df-0f4b-460f-8b50-1b2b0a7c153f",
        "parentId" : "3ffeb7cf-93be-44e4-8fc0-894f867e0620",
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "Don't we want a watch based variant for secrets? The providers cannot expose this now.",
        "createdAt" : "2019-10-08T07:02:13Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      },
      {
        "id" : "f861b960-17c4-4bbb-8ed9-dc528efb256d",
        "parentId" : "3ffeb7cf-93be-44e4-8fc0-894f867e0620",
        "authorId" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "body" : "> Don't we want a watch based variant for secrets? The providers cannot expose this now.\r\n\r\nseparate controllers with notifications.",
        "createdAt" : "2019-10-08T12:28:35Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "tags" : [
        ]
      }
    ],
    "commit" : "abddbd87cdcf69053e9fc6e752ade7d92c6b9fd7",
    "line" : 39,
    "diffHunk" : "@@ -1,1 +37,41 @@const workItemKey = \"key\"\n\n// DynamicServingCertificateController dynamically loads certificates and provides a golang tls compatible dynamic GetCertificate func.\ntype DynamicServingCertificateController struct {\n\t// baseTLSConfig is the static portion of the tlsConfig for serving to clients.  It is copied and the copy is mutated"
  },
  {
    "id" : "c0c55c24-7c21-4a9a-ae70-237a5d857c13",
    "prId" : 83555,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/83555#pullrequestreview-300269162",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b3bf74b6-3ee1-4610-ac82-c3a773d892e0",
        "parentId" : null,
        "authorId" : "392f7c7a-6820-4848-94e2-2b8e009fec9d",
        "body" : "Why do you need this?",
        "createdAt" : "2019-10-09T03:44:41Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "392f7c7a-6820-4848-94e2-2b8e009fec9d",
        "tags" : [
        ]
      },
      {
        "id" : "d260faa5-5fae-4e57-aa6c-ac74f14b463e",
        "parentId" : "b3bf74b6-3ee1-4610-ac82-c3a773d892e0",
        "authorId" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "body" : "> Why do you need this?\r\n\r\nit prevents panics from crashing the process.",
        "createdAt" : "2019-10-10T18:30:41Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "tags" : [
        ]
      }
    ],
    "commit" : "abddbd87cdcf69053e9fc6e752ade7d92c6b9fd7",
    "line" : 153,
    "diffHunk" : "@@ -1,1 +151,155 @@// Run starts the kube-apiserver and blocks until stopCh is closed.\nfunc (c *DynamicServingCertificateController) Run(workers int, stopCh <-chan struct{}) {\n\tdefer utilruntime.HandleCrash()\n\tdefer c.queue.ShutDown()\n"
  },
  {
    "id" : "87b54432-8be8-4436-b972-ca0594fd82c5",
    "prId" : 83555,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/83555#pullrequestreview-302363530",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "06f4d31e-0ff4-4068-bf74-f4015a9e2c84",
        "parentId" : null,
        "authorId" : "392f7c7a-6820-4848-94e2-2b8e009fec9d",
        "body" : "It looks like stopCh is guaranteed to be closed here. Remove?",
        "createdAt" : "2019-10-09T03:47:29Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "392f7c7a-6820-4848-94e2-2b8e009fec9d",
        "tags" : [
        ]
      },
      {
        "id" : "6bc8ca1f-93ce-4a5a-8fae-b83e2c01511a",
        "parentId" : "06f4d31e-0ff4-4068-bf74-f4015a9e2c84",
        "authorId" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "body" : "everything above runs in go routines. We have to wait here.",
        "createdAt" : "2019-10-16T07:15:55Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "f0985d19-4073-49b4-832a-0b89b15a1431",
        "tags" : [
        ]
      }
    ],
    "commit" : "abddbd87cdcf69053e9fc6e752ade7d92c6b9fd7",
    "line" : 170,
    "diffHunk" : "@@ -1,1 +168,172 @@\t}, 1*time.Minute, stopCh)\n\n\t<-stopCh\n}\n"
  },
  {
    "id" : "df349a8c-2f96-4a02-8e6d-129bf9689cc3",
    "prId" : 83555,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/83555#pullrequestreview-300758246",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6e129d57-467d-4f64-a7d9-85d1d3dc6044",
        "parentId" : null,
        "authorId" : "392f7c7a-6820-4848-94e2-2b8e009fec9d",
        "body" : "Can you reverse this and scope the err to the if?\r\n\r\n```\r\nif err := c.syncCerts(); err != nil {\r\n  utilruntime.HandleError(fmt.Errorf(\"%v failed with : %v\", dsKey, err))\r\n  c.queue.AddRateLimited(dsKey)\r\n  return true\r\n}\r\n```\r\n\r\nhttps://github.com/golang/go/wiki/CodeReviewComments#indent-error-flow",
        "createdAt" : "2019-10-09T03:49:43Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "392f7c7a-6820-4848-94e2-2b8e009fec9d",
        "tags" : [
        ]
      },
      {
        "id" : "420a609b-b6f8-4a7e-a05d-490489bddcca",
        "parentId" : "6e129d57-467d-4f64-a7d9-85d1d3dc6044",
        "authorId" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "body" : "This is the canonical controller structure: https://github.com/kubernetes/community/blob/master/contributors/devel/sig-api-machinery/controllers.md#rough-structure\r\n\r\nI'd prefer to be consistent with all other controllers.",
        "createdAt" : "2019-10-11T15:20:30Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "tags" : [
        ]
      }
    ],
    "commit" : "abddbd87cdcf69053e9fc6e752ade7d92c6b9fd7",
    "line" : 186,
    "diffHunk" : "@@ -1,1 +184,188 @@\n\terr := c.syncCerts()\n\tif err == nil {\n\t\tc.queue.Forget(dsKey)\n\t\treturn true"
  },
  {
    "id" : "d3cf8bb6-4565-4c48-9704-33e7eb2777e9",
    "prId" : 83555,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/83555#pullrequestreview-300269881",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "af8bf503-497c-4e29-b0f5-c3ce8ef38b68",
        "parentId" : null,
        "authorId" : "392f7c7a-6820-4848-94e2-2b8e009fec9d",
        "body" : "The use of the rate limiting queue makes what's going on here non-obvious. Can you just retry + backoff?",
        "createdAt" : "2019-10-09T03:56:02Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "392f7c7a-6820-4848-94e2-2b8e009fec9d",
        "tags" : [
        ]
      },
      {
        "id" : "39ace43e-a199-442f-b7ce-6971b26fe2f6",
        "parentId" : "af8bf503-497c-4e29-b0f5-c3ce8ef38b68",
        "authorId" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "body" : "> The use of the rate limiting queue makes what's going on here non-obvious. Can you just retry + backoff?\r\n\r\nThe overall arc is going to involve multiple actors doing the queuing on content change: https://github.com/kubernetes/kubernetes/pull/83579",
        "createdAt" : "2019-10-10T18:31:55Z",
        "updatedAt" : "2019-10-16T17:43:39Z",
        "lastEditedBy" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "tags" : [
        ]
      }
    ],
    "commit" : "abddbd87cdcf69053e9fc6e752ade7d92c6b9fd7",
    "line" : 37,
    "diffHunk" : "@@ -1,1 +35,39 @@)\n\nconst workItemKey = \"key\"\n\n// DynamicServingCertificateController dynamically loads certificates and provides a golang tls compatible dynamic GetCertificate func."
  }
]