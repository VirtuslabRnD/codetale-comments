[
  {
    "id" : "cd57cb28-9d23-44b9-b8cf-8a6f86e5bb5a",
    "prId" : 9468,
    "prUrl" : "https://github.com/apache/airflow/pull/9468#pullrequestreview-440364059",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e9d6ca29-4140-4498-a017-94639d59aa68",
        "parentId" : null,
        "authorId" : "3743a72b-fdd8-43b7-9592-037bac8942e2",
        "body" : "why do we need `ClusterRoleBinding` ? we would usually only need the  Role and RoleBinding  to apply to the namespace where airflow is being installed. `ClusterRoleBinding` will create issues in managed multitenant kubernetes  clusters which only provide namespace level access(and not cluster wide)\r\n\r\nIs there a test which doesn't work with `Role` and `RoleBinding`",
        "createdAt" : "2020-06-28T08:31:59Z",
        "updatedAt" : "2020-07-01T10:53:59Z",
        "lastEditedBy" : "3743a72b-fdd8-43b7-9592-037bac8942e2",
        "tags" : [
        ]
      },
      {
        "id" : "c1f554bf-fd48-42c2-a76c-21f039719d07",
        "parentId" : "e9d6ca29-4140-4498-a017-94639d59aa68",
        "authorId" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "body" : "I think this is a good question - to @dimberman -> was it needed or was it just a remnant of some experimentation?",
        "createdAt" : "2020-06-28T15:52:25Z",
        "updatedAt" : "2020-07-01T10:53:59Z",
        "lastEditedBy" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "tags" : [
        ]
      },
      {
        "id" : "4771210d-5dca-4324-a733-513856bb420a",
        "parentId" : "e9d6ca29-4140-4498-a017-94639d59aa68",
        "authorId" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "body" : "The astronomer dropped support for deployment in one namespace. \r\nYou can read more about it in this PR.\r\nhttps://github.com/astronomer/docs/pull/216/files\r\nI do not know more details.",
        "createdAt" : "2020-06-28T16:19:57Z",
        "updatedAt" : "2020-07-01T10:53:59Z",
        "lastEditedBy" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "tags" : [
        ]
      },
      {
        "id" : "6767cfe3-0e37-4a7a-bfe1-dafa359dd4b5",
        "parentId" : "e9d6ca29-4140-4498-a017-94639d59aa68",
        "authorId" : "b28ed531-4583-40c6-81ef-a719b768e1d4",
        "body" : "Hey guys the original PR of the chart does have `RoleBinding` since this role is attached to the scheduler and workers so that they can launch `KubernetesExecutor` pods and `KubernetesPodOperator` pods.\r\n\r\nIn the Astronomer world, these components only launch pods into _their own_ namespace and not across other namespaces, which is why this was originally a `RoleBinding`.\r\n\r\nThis PR seems to be changing that `RoleBinding` to a `ClusterRoleBinding`. I assume its so that we can launch pods into a different namespace than where the scheduler (and/or workers) are running. @potiuk is that what you ran into here?",
        "createdAt" : "2020-06-30T18:13:32Z",
        "updatedAt" : "2020-07-01T10:53:59Z",
        "lastEditedBy" : "b28ed531-4583-40c6-81ef-a719b768e1d4",
        "tags" : [
        ]
      },
      {
        "id" : "7a9f7fe8-c5bc-47a8-b16c-63c9c7141dec",
        "parentId" : "e9d6ca29-4140-4498-a017-94639d59aa68",
        "authorId" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "body" : "Correct @schnie . I have not written the tests myself but we have indeed \"airflow\" runnig in airflow namespace but all the pods run by it are executed in the \"default\" namespace.",
        "createdAt" : "2020-06-30T20:24:42Z",
        "updatedAt" : "2020-07-01T10:53:59Z",
        "lastEditedBy" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "tags" : [
        ]
      },
      {
        "id" : "1bf9abf0-3cde-4d6a-abcb-68eb80cc19fd",
        "parentId" : "e9d6ca29-4140-4498-a017-94639d59aa68",
        "authorId" : "b8b84983-5876-4ccf-886c-2449d94ca22f",
        "body" : "@potiuk really? When I ran it locally it seemed like all the k8sexecutor pods were run in the airflow namespace, and it was just the k8soperator pods in default (we can change those to airflow if we want)",
        "createdAt" : "2020-06-30T20:32:13Z",
        "updatedAt" : "2020-07-01T10:53:59Z",
        "lastEditedBy" : "b8b84983-5876-4ccf-886c-2449d94ca22f",
        "tags" : [
        ]
      },
      {
        "id" : "577b255e-fa8e-4d22-a4b0-d0b3efb2fec3",
        "parentId" : "e9d6ca29-4140-4498-a017-94639d59aa68",
        "authorId" : "b8b84983-5876-4ccf-886c-2449d94ca22f",
        "body" : "That said, I think we can still merge this and decide this after. I want to get this into v1-10-test ASAP so I can start running integration tests.",
        "createdAt" : "2020-06-30T20:32:44Z",
        "updatedAt" : "2020-07-01T10:53:59Z",
        "lastEditedBy" : "b8b84983-5876-4ccf-886c-2449d94ca22f",
        "tags" : [
        ]
      }
    ],
    "commit" : "962865ba22ff18935002a94140a92927d6791cea",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +22,26 @@{{- $grantScheduler := or (eq .Values.executor \"LocalExecutor\") (eq .Values.executor \"SequentialExecutor\") (eq .Values.executor \"KubernetesExecutor\") }}\n{{- $grantWorker := or (eq .Values.executor \"CeleryExecutor\") (eq .Values.executor \"KubernetesExecutor\") }}\nkind: ClusterRoleBinding\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:"
  }
]