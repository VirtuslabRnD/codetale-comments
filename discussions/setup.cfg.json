[
  {
    "id" : "d96ee613-965c-4fc3-99ab-9d6e99415101",
    "prId" : 12683,
    "prUrl" : "https://github.com/apache/airflow/pull/12683#pullrequestreview-540369552",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0711ca86-a30e-4218-9478-85e65064aa84",
        "parentId" : null,
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "We still should have the python version constraint - this is in the standard library from py3.8",
        "createdAt" : "2020-11-28T10:39:30Z",
        "updatedAt" : "2020-11-28T10:39:40Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "af121d8c-3974-434a-85c5-540dd9fb4ea6",
        "parentId" : "0711ca86-a30e-4218-9478-85e65064aa84",
        "authorId" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "body" : "This is not why PyPI description of importlib_resources says. If I read the documentation correctly, we should only constraint it once we add 3.9 support:\r\n\r\nFrom: https://pypi.org/project/importlib-resources/\r\n```\r\nimportlib_resources is a backport of Python standard library importlib.resources module for Python 2.7, and 3.4 \r\nthrough 3.8. Users of Python 3.9 and beyond should use the standard library module, since for these versions,\r\n importlib_resources just delegates to that module.\r\n```\r\n\r\nI believe importlib.resources is available as of 3.7 (not as of 3.8), but it is not yet a fully-featured replacement for importlib_resources until 3.9 and we should install it in all: 3.6, 3.7, 3.8. \r\n\r\nI think even in 3.9 we should install it but without the limitation to get the \"delegation\" working for anyone who used importlib_resources still.\r\n\r\nWhere do you get this <3.8 limitation from? \r\n",
        "createdAt" : "2020-11-28T11:08:44Z",
        "updatedAt" : "2020-11-28T11:10:18Z",
        "lastEditedBy" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "tags" : [
        ]
      },
      {
        "id" : "0da61f23-1d40-43aa-9a78-88906d2ad9ae",
        "parentId" : "0711ca86-a30e-4218-9478-85e65064aa84",
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "From memory - on mobile while having coffee so wasn't easy for me to look up exact detail.\n\nCool 👍🏻",
        "createdAt" : "2020-11-28T11:32:55Z",
        "updatedAt" : "2020-11-28T11:32:55Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      }
    ],
    "commit" : "d17220f60bd432c8db4885068e178de7759d0bac",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +101,105 @@    graphviz>=0.12\n    gunicorn>=19.5.0, <20.0\n    importlib_resources~=1.4\n    iso8601>=0.1.12\n    itsdangerous>=1.1.0"
  },
  {
    "id" : "712f1313-41a8-469a-a1a4-26dc49c83900",
    "prId" : 12694,
    "prUrl" : "https://github.com/apache/airflow/pull/12694#pullrequestreview-540485805",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a299b017-873a-4484-872c-7bf03afdeabf",
        "parentId" : null,
        "authorId" : "d3cb8bb5-cff2-4a3d-9608-a158861d1d07",
        "body" : "Did you meant `argcomplete` perhaps? I note that `argcomplete` has been [updated to support `importlib_metadata` 3.x](https://github.com/kislyuk/argcomplete/blob/develop/Changes.rst) (and otherwise only has bugfixes, looks like a desireable upgrade).\r\n\r\nAnd if 3.1 works, please widen the pin to `>=1.7,<4`; the `argcomplete~=1.10` pin above *already lets you use `importlib_metadata` 3.1* if you have the newer `argcomplete` installed.\r\n\r\nAlso, Python 3.8 doesn't need `importlib_metadata` anymore, and `argcomplete` correctly won't depend on it in 3.8 and up. Please do so here too:\r\n\r\n```\r\n     importlib_metadata>=1.7,<4;python_version<=\"3.7\"\r\n```\r\n\r\nand make the imports conditional:\r\n\r\n```python\r\ntry:\r\n    # 3.8 and up\r\n    from importlib import metadata as importlib_metadata\r\nexcept ImportError:\r\n    # use the backport\r\n    import importlib_metadata\r\n```\r\n\r\nIf you update the `argcomplete` dependency too, then you'd not even have to set the `>=1.7` lower bound, `~=3.1` would do.",
        "createdAt" : "2020-11-29T11:40:12Z",
        "updatedAt" : "2020-11-29T11:42:01Z",
        "lastEditedBy" : "d3cb8bb5-cff2-4a3d-9608-a158861d1d07",
        "tags" : [
        ]
      },
      {
        "id" : "0eade239-e43a-496b-99d0-5f662111e8e8",
        "parentId" : "a299b017-873a-4484-872c-7bf03afdeabf",
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "Whops, yes I did mean argcomplete. Though I also found virtualenv (dep of pylint) was also pinning this, so it may not help us yet.\r\n\r\nThis line in the readme https://github.com/python/importlib_metadata/ :\r\n\r\n> As of Python 3.8, this functionality has been added to the Python standard library. This package supplies backports of that functionality including improvements added to subsequent Python versions\r\n\r\nMakes me wonder if/when we should continue to use it anyway on Py 3.8?",
        "createdAt" : "2020-11-29T11:50:44Z",
        "updatedAt" : "2020-11-29T11:50:44Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "423eb051-f8cb-42ea-bb24-7d3358f52499",
        "parentId" : "a299b017-873a-4484-872c-7bf03afdeabf",
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "> Whops, yes I did mean argcomplete. Though I also found virtualenv (dep of pylint) was also pinning this, so it may not help us yet.\r\n\r\nAh though virtualenv has been updated too.",
        "createdAt" : "2020-11-29T11:55:45Z",
        "updatedAt" : "2020-11-29T11:55:46Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "922449c1-0ff9-4d39-bd6b-9327d7a0e455",
        "parentId" : "a299b017-873a-4484-872c-7bf03afdeabf",
        "authorId" : "d3cb8bb5-cff2-4a3d-9608-a158861d1d07",
        "body" : "> Makes me wonder if/when we should continue to use it anyway on Py 3.8?\r\n\r\nYour not using the 3.9 / importlib_metadata 1.6 feature: `Added module and attr attributes to EntryPoint`; everything else is bug fixing or perf improvements, which all have been backported to 3.8.\r\n\r\nEven if you _were_ using those extra attributes, using `python_version<=\"3.8\"` (and inverting the import guard) would be a good idea to keep the dependencies flexible and avoid limiting what packages people can use with Airflow.\r\n\r\nI don't see where `virtualenv` depends on importlib_metadata? Nor does pylint depend on virtualenv. Might be in older versions. `pre-commit` depends on virtualenv though. And jsonlint depends on `importlib_metadata` but sets no pin.",
        "createdAt" : "2020-11-29T13:59:11Z",
        "updatedAt" : "2020-11-29T13:59:11Z",
        "lastEditedBy" : "d3cb8bb5-cff2-4a3d-9608-a158861d1d07",
        "tags" : [
        ]
      },
      {
        "id" : "cc8f9571-9d76-4df9-b2d9-633a8abf06a1",
        "parentId" : "a299b017-873a-4484-872c-7bf03afdeabf",
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "God in getting my dist names all in a mix today. I did mean pre-commit -> virtualenv. I'll have to check what version of virtualenv pre-commit specifies.\n\nI'll open a new PR to add the guard as you suggest.",
        "createdAt" : "2020-11-29T14:23:03Z",
        "updatedAt" : "2020-11-29T14:23:03Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "f79280b7-6a11-4a1b-a083-834f496b934c",
        "parentId" : "a299b017-873a-4484-872c-7bf03afdeabf",
        "authorId" : "d3cb8bb5-cff2-4a3d-9608-a158861d1d07",
        "body" : "I've already opened a PR :-) See #12703 ",
        "createdAt" : "2020-11-29T14:36:01Z",
        "updatedAt" : "2020-11-29T14:36:02Z",
        "lastEditedBy" : "d3cb8bb5-cff2-4a3d-9608-a158861d1d07",
        "tags" : [
        ]
      }
    ],
    "commit" : "c1360677359f637030e013bbfe062d1248df5deb",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +101,105 @@    graphviz>=0.12\n    gunicorn>=19.5.0, <20.0\n    importlib_metadata~=1.7 # We could work with 3.1, but argparse needs <2\n    importlib_resources~=1.4\n    iso8601>=0.1.12"
  },
  {
    "id" : "922727fc-2c4a-4a00-9996-9cd867dd46e3",
    "prId" : 13409,
    "prUrl" : "https://github.com/apache/airflow/pull/13409#pullrequestreview-560587974",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "fac84da9-80d2-4ab8-a9e6-f78abac44b5d",
        "parentId" : null,
        "authorId" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "body" : "pyjwt should remain here because of flask-jwt and few other providers.",
        "createdAt" : "2021-01-01T13:45:59Z",
        "updatedAt" : "2021-01-08T12:46:41Z",
        "lastEditedBy" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "tags" : [
        ]
      }
    ],
    "commit" : "1c0c58e5c8692255e320cd2ea5f46e8adde289c8",
    "line" : 19,
    "diffHunk" : "@@ -1,1 +116,120 @@    pygments>=2.0.1, <3.0\n    # Required for flask-jwt-extended and msal\n    pyjwt<2\n    # python daemon crashes with 'socket operation on non-socket' for python 3.8+ in version < 2.2.4\n    # https://pagure.io/python-daemon/issue/34"
  }
]