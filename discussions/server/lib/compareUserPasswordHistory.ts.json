[
  {
    "id" : "27ffd428-9d98-4e14-9cf8-b588f668b041",
    "prId" : 21607,
    "prUrl" : "https://github.com/RocketChat/Rocket.Chat/pull/21607#pullrequestreview-639273881",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d18ad43a-d01b-44f9-b1fa-0f243084869b",
        "parentId" : null,
        "authorId" : "34fde88b-e8d3-4125-af3a-0d4cc8bd83a8",
        "body" : "Why this returns false if there's no error?",
        "createdAt" : "2021-04-19T14:34:09Z",
        "updatedAt" : "2021-04-19T18:58:04Z",
        "lastEditedBy" : "34fde88b-e8d3-4125-af3a-0d4cc8bd83a8",
        "tags" : [
        ]
      },
      {
        "id" : "8a3f4609-7668-4790-8da6-ec03da21f473",
        "parentId" : "d18ad43a-d01b-44f9-b1fa-0f243084869b",
        "authorId" : "300e6b86-7e45-416a-b277-55c605417b9b",
        "body" : "The idea here is to return true if the new password can be used, or false otherwise.\r\nIf any comparison between the new password and a password in the history doesn't return an error, it means that they're equal -- that's why false is returned in this case, in order to prevent users from reusing passwords that equals some password in the history.",
        "createdAt" : "2021-04-19T15:40:13Z",
        "updatedAt" : "2021-04-19T18:58:04Z",
        "lastEditedBy" : "300e6b86-7e45-416a-b277-55c605417b9b",
        "tags" : [
        ]
      },
      {
        "id" : "6dd4693c-0bef-4d97-b7f5-c6f0eded10ad",
        "parentId" : "d18ad43a-d01b-44f9-b1fa-0f243084869b",
        "authorId" : "34fde88b-e8d3-4125-af3a-0d4cc8bd83a8",
        "body" : "Ok, that sounds good! Thanks for the clarification ",
        "createdAt" : "2021-04-19T20:21:57Z",
        "updatedAt" : "2021-04-19T20:21:58Z",
        "lastEditedBy" : "34fde88b-e8d3-4125-af3a-0d4cc8bd83a8",
        "tags" : [
        ]
      }
    ],
    "commit" : "faf296b5ba74b94e1068afe258d94b4d515edbc7",
    "line" : 40,
    "diffHunk" : "@@ -1,1 +38,42 @@\t\tif (!passCheck.error) {\n\t\t\tuser.services.password.bcrypt = currentPassword;\n\t\t\treturn false;\n\t\t}\n\t}"
  },
  {
    "id" : "1576d030-4403-4aa6-a0d5-db6211285ce9",
    "prId" : 21607,
    "prUrl" : "https://github.com/RocketChat/Rocket.Chat/pull/21607#pullrequestreview-639277713",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8fecc2c0-b658-4f67-925a-be5f00636c87",
        "parentId" : null,
        "authorId" : "34fde88b-e8d3-4125-af3a-0d4cc8bd83a8",
        "body" : "What is this line for? I noticed you used it 3 times in here ðŸ‘€ ",
        "createdAt" : "2021-04-19T14:34:48Z",
        "updatedAt" : "2021-04-19T18:58:04Z",
        "lastEditedBy" : "34fde88b-e8d3-4125-af3a-0d4cc8bd83a8",
        "tags" : [
        ]
      },
      {
        "id" : "ca5c372b-e1b1-495f-ba2d-1372bdf02141",
        "parentId" : "8fecc2c0-b658-4f67-925a-be5f00636c87",
        "authorId" : "300e6b86-7e45-416a-b277-55c605417b9b",
        "body" : "In this function, I use the `_checkPassword` method (which requires a `Meteor.User` object) for every entry of the password history -- in order to compare the passwords in the history with the new password. Instead of creating an empty `Meteor.User` object for each password in the history, I decided to use the `user` object that is received by this function, and temporarily assign each password in the history to it.\r\n\r\nSo, before returning the value, I must assign the original password back to the `user` (so that this object is not changed in the caller function too).\r\n\r\nI first intended to create a local `IUser` object, but it hasn't worked with the `_checkPassword` method. That's why I used the `user` param. Do you think that's ok or do you have any suggestions?",
        "createdAt" : "2021-04-19T18:33:19Z",
        "updatedAt" : "2021-04-19T18:58:04Z",
        "lastEditedBy" : "300e6b86-7e45-416a-b277-55c605417b9b",
        "tags" : [
        ]
      },
      {
        "id" : "60ecb359-a3d2-47c5-ac55-5567b6354c30",
        "parentId" : "8fecc2c0-b658-4f67-925a-be5f00636c87",
        "authorId" : "34fde88b-e8d3-4125-af3a-0d4cc8bd83a8",
        "body" : "If that's the case, I'd have preffered separating the code that performed the actual password check on `checkPassword` to its own function, so you can call it with 2 passwords instead of modifying the object each time you wanted to do a comparison ðŸ‘€ what do you think?",
        "createdAt" : "2021-04-19T20:23:24Z",
        "updatedAt" : "2021-04-19T20:23:25Z",
        "lastEditedBy" : "34fde88b-e8d3-4125-af3a-0d4cc8bd83a8",
        "tags" : [
        ]
      },
      {
        "id" : "b9b8bff8-0491-46b8-9c07-eef94853187c",
        "parentId" : "8fecc2c0-b658-4f67-925a-be5f00636c87",
        "authorId" : "34fde88b-e8d3-4125-af3a-0d4cc8bd83a8",
        "body" : "Ah, realizing it may not be possible right? `_checkPassword` is hidden in meteor magic so :rip:. Ignore my recommendation haha",
        "createdAt" : "2021-04-19T20:26:50Z",
        "updatedAt" : "2021-04-19T20:26:50Z",
        "lastEditedBy" : "34fde88b-e8d3-4125-af3a-0d4cc8bd83a8",
        "tags" : [
        ]
      }
    ],
    "commit" : "faf296b5ba74b94e1068afe258d94b4d515edbc7",
    "line" : 44,
    "diffHunk" : "@@ -1,1 +42,46 @@\t}\n\n\tuser.services.password.bcrypt = currentPassword;\n\treturn true;\n}"
  }
]