[
  {
    "id" : "c387b04f-efac-402c-961b-5dd0ad2fbcdd",
    "prId" : 102133,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/102133#pullrequestreview-665277940",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "52231741-209d-44ee-9daf-33ec512e9405",
        "parentId" : null,
        "authorId" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "body" : "i think one related question here is should we remove the above ^ detection for docker.\r\nmy vote is +1, with hopes that users have already learned that they should be explicit about the value:\r\nhttps://github.com/kubernetes/kubeadm/issues/874\r\n\r\ni have a separate PR for it.\r\n\r\n\r\n",
        "createdAt" : "2021-05-19T16:21:08Z",
        "updatedAt" : "2021-05-19T16:21:09Z",
        "lastEditedBy" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "tags" : [
        ]
      },
      {
        "id" : "446ebc37-0e9a-4df7-b644-aeec87ce4746",
        "parentId" : "52231741-209d-44ee-9daf-33ec512e9405",
        "authorId" : "5e225159-999d-430a-8b58-d5220dc1429d",
        "body" : "#99647 need to be updated.\r\n\r\nNeed I cherry-pick it to this PR and make the test pass? \r\n+1 to remove it in a separate PR. (So I will keep the autodetect here.)",
        "createdAt" : "2021-05-20T03:11:07Z",
        "updatedAt" : "2021-05-20T03:31:17Z",
        "lastEditedBy" : "5e225159-999d-430a-8b58-d5220dc1429d",
        "tags" : [
        ]
      },
      {
        "id" : "6268d475-d55e-43ff-b573-b3377d2b6212",
        "parentId" : "52231741-209d-44ee-9daf-33ec512e9405",
        "authorId" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "body" : "i can update https://github.com/kubernetes/kubernetes/pull/99647\r\nbut we can leave it for later in the cycle.\r\n\r\nit has a few implications and needs \"ACTION REQUIRED\":\r\n- it may break our kubeadm/kinder e2e test (i need to check).\r\n- it will probably break uses that are not setting their explicit cgroup group driver.\r\n\r\nactually let's add ACTION REQUIRED prefix to this PR's release note as well:\r\n> ACTION REQUIRED: kubeadm: during \"kubeadm init/join/upgrade\", always default the \"cgroupDriver\" value in the KubeletConfiguration to \"systemd\", unless the user was explicit about the value. See https://kubernetes.io/docs/tasks/administer-cluster/kubeadm/configure-cgroup-driver/ for more details.\r\n",
        "createdAt" : "2021-05-20T17:55:17Z",
        "updatedAt" : "2021-05-20T17:55:17Z",
        "lastEditedBy" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "tags" : [
        ]
      },
      {
        "id" : "924aa3d6-99a1-44c6-88db-d7f36f4afbaf",
        "parentId" : "52231741-209d-44ee-9daf-33ec512e9405",
        "authorId" : "5e225159-999d-430a-8b58-d5220dc1429d",
        "body" : "Got it.",
        "createdAt" : "2021-05-21T09:37:35Z",
        "updatedAt" : "2021-05-21T09:37:35Z",
        "lastEditedBy" : "5e225159-999d-430a-8b58-d5220dc1429d",
        "tags" : [
        ]
      }
    ],
    "commit" : "2fdbfd8a270535786dedabeabc89b0aaed5168c4",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +215,219 @@\t\t\tkc.config.CgroupDriver = driver\n\t\t}\n\t}\n\tif len(kc.config.CgroupDriver) == 0 {\n\t\tklog.V(1).Infof(\"the value of KubeletConfiguration.cgroupDriver is empty; setting it to %q\", constants.CgroupDriverSystemd)"
  },
  {
    "id" : "d53a2801-d79f-4d03-9502-7b4696c98650",
    "prId" : 100935,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/100935#pullrequestreview-631990150",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "12c36766-ea2b-49f2-9467-6339ae19be2e",
        "parentId" : null,
        "authorId" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "body" : "i don't see keeping these comparisons with the constants / defaults as a problem.\r\nis this something a static check tool reports as a problem?\r\n\r\n[1]",
        "createdAt" : "2021-04-09T01:30:22Z",
        "updatedAt" : "2021-04-09T05:52:57Z",
        "lastEditedBy" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "tags" : [
        ]
      },
      {
        "id" : "547d179d-9844-4bb2-8948-e90ecbf3d142",
        "parentId" : "12c36766-ea2b-49f2-9467-6339ae19be2e",
        "authorId" : "2abc56da-8a2e-4195-8608-d35a22991eea",
        "body" : "yes, static check tool  thinks should omit comparison with boolean constant, and it reports this as a problem.\r\nhttps://staticcheck.io/docs/checks#S1002\r\n",
        "createdAt" : "2021-04-09T01:48:43Z",
        "updatedAt" : "2021-04-09T05:52:57Z",
        "lastEditedBy" : "2abc56da-8a2e-4195-8608-d35a22991eea",
        "tags" : [
        ]
      },
      {
        "id" : "122f37f6-cd7f-487c-b890-34900400b646",
        "parentId" : "12c36766-ea2b-49f2-9467-6339ae19be2e",
        "authorId" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "body" : "ok, this cleanup seems fine for the sake of not having follow up PRs that do the same cleanup.",
        "createdAt" : "2021-04-09T02:40:47Z",
        "updatedAt" : "2021-04-09T05:52:57Z",
        "lastEditedBy" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "tags" : [
        ]
      }
    ],
    "commit" : "a1452b911590d29763e86bee3fab0aa0288a26a2",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +164,168 @@\tif kc.config.Authentication.Anonymous.Enabled == nil {\n\t\tkc.config.Authentication.Anonymous.Enabled = utilpointer.BoolPtr(kubeletAuthenticationAnonymousEnabled)\n\t} else if *kc.config.Authentication.Anonymous.Enabled {\n\t\twarnDefaultComponentConfigValue(kind, \"authentication.anonymous.enabled\", kubeletAuthenticationAnonymousEnabled, *kc.config.Authentication.Anonymous.Enabled)\n\t}"
  },
  {
    "id" : "ad8c71e3-eb1e-400a-ac14-edf09830d7e3",
    "prId" : 100935,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/100935#pullrequestreview-631967857",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "441fbecf-18bf-4200-a91a-450badec4f34",
        "parentId" : null,
        "authorId" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "body" : "[1]",
        "createdAt" : "2021-04-09T01:30:38Z",
        "updatedAt" : "2021-04-09T05:52:57Z",
        "lastEditedBy" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "tags" : [
        ]
      }
    ],
    "commit" : "a1452b911590d29763e86bee3fab0aa0288a26a2",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +179,183 @@\tif kc.config.Authentication.Webhook.Enabled == nil {\n\t\tkc.config.Authentication.Webhook.Enabled = utilpointer.BoolPtr(kubeletAuthenticationWebhookEnabled)\n\t} else if !*kc.config.Authentication.Webhook.Enabled {\n\t\twarnDefaultComponentConfigValue(kind, \"authentication.webhook.enabled\", kubeletAuthenticationWebhookEnabled, *kc.config.Authentication.Webhook.Enabled)\n\t}"
  },
  {
    "id" : "8530ba1a-68c5-4c6f-b91c-c291fa573043",
    "prId" : 100935,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/100935#pullrequestreview-632887701",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "11ff117d-7384-4c94-bcf4-fef4ceb56284",
        "parentId" : null,
        "authorId" : "8a27151d-3530-4221-90e8-48b3a85cba37",
        "body" : "Should this be if `*kc.config.Authentication.Webhook.Enabled` ?",
        "createdAt" : "2021-04-09T14:27:12Z",
        "updatedAt" : "2021-04-09T14:27:42Z",
        "lastEditedBy" : "8a27151d-3530-4221-90e8-48b3a85cba37",
        "tags" : [
        ]
      },
      {
        "id" : "ac707e4f-10aa-4e28-a2ca-c86285b513a0",
        "parentId" : "11ff117d-7384-4c94-bcf4-fef4ceb56284",
        "authorId" : "2abc56da-8a2e-4195-8608-d35a22991eea",
        "body" : "```\t\r\n// kubeletAuthenticationWebhookEnabled set the default value to enable authentication webhook\r\n\tkubeletAuthenticationWebhookEnabled = true\r\n        if *kc.config.Authentication.Webhook.Enabled != kubeletAuthenticationWebhookEnabled\r\n==   if *kc.config.Authentication.Webhook.Enabled != true\r\n==   if !*kc.config.Authentication.Webhook.Enabled\r\n```",
        "createdAt" : "2021-04-10T04:19:32Z",
        "updatedAt" : "2021-04-10T04:19:47Z",
        "lastEditedBy" : "2abc56da-8a2e-4195-8608-d35a22991eea",
        "tags" : [
        ]
      }
    ],
    "commit" : "a1452b911590d29763e86bee3fab0aa0288a26a2",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +179,183 @@\tif kc.config.Authentication.Webhook.Enabled == nil {\n\t\tkc.config.Authentication.Webhook.Enabled = utilpointer.BoolPtr(kubeletAuthenticationWebhookEnabled)\n\t} else if !*kc.config.Authentication.Webhook.Enabled {\n\t\twarnDefaultComponentConfigValue(kind, \"authentication.webhook.enabled\", kubeletAuthenticationWebhookEnabled, *kc.config.Authentication.Webhook.Enabled)\n\t}"
  },
  {
    "id" : "8e354fef-c4a5-4b85-93d8-e860a4abee8b",
    "prId" : 99471,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/99471#pullrequestreview-602029401",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "611e9ab6-cf28-4796-909f-54f286674fd0",
        "parentId" : null,
        "authorId" : "8a27151d-3530-4221-90e8-48b3a85cba37",
        "body" : "Do we plan to move this back to default in next releases or do we think that a different upgrade path will be always required given that we are seeing users upgrading very old clusters?\r\nAlso, for sake of future memory, what about adding a note on Default about this field being defaulted out of band?",
        "createdAt" : "2021-03-01T10:16:28Z",
        "updatedAt" : "2021-03-02T16:39:49Z",
        "lastEditedBy" : "8a27151d-3530-4221-90e8-48b3a85cba37",
        "tags" : [
        ]
      },
      {
        "id" : "a12f1eb2-db2a-4ed7-8776-af90607a1926",
        "parentId" : "611e9ab6-cf28-4796-909f-54f286674fd0",
        "authorId" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "body" : "as i've mentioned, the defaulting being the same for all commands is problematic.\r\nwe have a similar case for the \"docker cgroup driver detection\" code, that i like to move to dockershim.\r\n\r\nsince i really don't like keeping `MutateCgroupDriver()` forever i wonder what is best here...\r\n\r\ni don't wish to do add this change in Default() for this release because it would break upgrading users in just one release, but we could say that in 1 more release kubeadm will start doing that in all of its commands, which means we are going to merge the code in Default() and users have 1 release to adapt their nodes / CRs (move to the systemd driver).\r\n\r\ni like this approach better, because this code separation is not ideal.\r\n\r\nif you agree to that i can add a comment over Default() about MutateCgroupDriver().\r\n..and update the release note too.\r\n",
        "createdAt" : "2021-03-01T17:02:34Z",
        "updatedAt" : "2021-03-02T16:39:49Z",
        "lastEditedBy" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "tags" : [
        ]
      },
      {
        "id" : "3d23891d-9b2b-4fa6-95d3-f9735a4d258f",
        "parentId" : "611e9ab6-cf28-4796-909f-54f286674fd0",
        "authorId" : "8a27151d-3530-4221-90e8-48b3a85cba37",
        "body" : "Given that this could be potentially disruptive, I think we should:\r\n- advertise the change through usual channels\r\n- have a warning in upgrade plan for at least one cycle (you are running with two cgroup drivers, see the doc to migrate)\r\n- (finally) make this our default",
        "createdAt" : "2021-03-02T09:31:42Z",
        "updatedAt" : "2021-03-02T16:39:49Z",
        "lastEditedBy" : "8a27151d-3530-4221-90e8-48b3a85cba37",
        "tags" : [
        ]
      },
      {
        "id" : "6971fad9-6983-4b5a-b0a7-d0863c128f03",
        "parentId" : "611e9ab6-cf28-4796-909f-54f286674fd0",
        "authorId" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "body" : "> advertise the change through usual channels\r\n\r\ni can send a notification to k-dev and #kubeadm\r\n\r\n> have a warning in upgrade plan for at least one cycle (you are running with two cgroup drivers, see the doc to migrate)\r\n\r\ni can see where in `upgrade plan` this can be added for this PR.\r\nthe migration docs are waiting for review and i will like to them from the release note too.\r\nhttps://github.com/kubernetes/website/pull/26786",
        "createdAt" : "2021-03-02T13:46:10Z",
        "updatedAt" : "2021-03-02T16:39:49Z",
        "lastEditedBy" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "tags" : [
        ]
      },
      {
        "id" : "c4bb824d-0f7d-4c11-8db6-da9c16d8b7d9",
        "parentId" : "611e9ab6-cf28-4796-909f-54f286674fd0",
        "authorId" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "body" : "@fabriziopandini added a warning during \"plan\".",
        "createdAt" : "2021-03-02T16:39:59Z",
        "updatedAt" : "2021-03-02T16:40:00Z",
        "lastEditedBy" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "tags" : [
        ]
      }
    ],
    "commit" : "b6ff320507a6504352c2d670a9b6f8ae114e1847",
    "line" : 36,
    "diffHunk" : "@@ -1,1 +248,252 @@// MutateCgroupDriver can be called to set the KubeletConfiguration cgroup driver to systemd.\n// Currently this cannot be as part of Default() because the function is called for\n// upgrades too, which can break existing nodes after a kubelet restart.\n// TODO: https://github.com/kubernetes/kubeadm/issues/2376\nfunc MutateCgroupDriver(cfg *kubeadmapi.ClusterConfiguration) {"
  }
]