[
  {
    "id" : "6f604115-b2df-4c1d-a372-8dcdc79b0fd5",
    "prId" : 36462,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/36462#pullrequestreview-10538698",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7a500aa0-916d-4902-9273-c700865cf6ad",
        "parentId" : null,
        "authorId" : "4815d47d-9abd-4b5d-8074-030539047224",
        "body" : "I will have some merge conflicts to deal with here on the token cli PR but we should probably merge this one first, and then I will update on my end. ",
        "createdAt" : "2016-11-29T14:02:40Z",
        "updatedAt" : "2016-12-15T21:57:21Z",
        "lastEditedBy" : "4815d47d-9abd-4b5d-8074-030539047224",
        "tags" : [
        ]
      }
    ],
    "commit" : "7945c437e59e3211c94a432e803d173282a677cd",
    "line" : null,
    "diffHunk" : "@@ -1,1 +42,46 @@\t}\n\tif err := kubeadmutil.GenerateToken(d); err != nil {\n\t\treturn err\n\t}\n\tfmt.Printf(\"[tokens] Generated token: %q\\n\", kubeadmutil.BearerToken(d))"
  },
  {
    "id" : "5b836a11-223c-4a1b-b396-d8c97d20db2c",
    "prId" : 33262,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/33262#pullrequestreview-1434583",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b67d5f66-2e1e-401c-8f99-f43bb8f09406",
        "parentId" : null,
        "authorId" : "ad0a3561-db60-47a9-b82f-ac613199f968",
        "body" : "I know it won't happen with the way it is currently implemented, but this doesn't handle case where `ok` is true and `err` is non-nil.\n",
        "createdAt" : "2016-09-23T22:03:42Z",
        "updatedAt" : "2016-09-26T08:13:51Z",
        "lastEditedBy" : "ad0a3561-db60-47a9-b82f-ac613199f968",
        "tags" : [
        ]
      },
      {
        "id" : "5f2fb0d9-7c07-4c05-8cb3-c4a0015dfcdd",
        "parentId" : "b67d5f66-2e1e-401c-8f99-f43bb8f09406",
        "authorId" : "d37d9758-bdf5-4c23-a40e-a85099689a0c",
        "body" : "Will add a comment, I didn't know this.\n",
        "createdAt" : "2016-09-24T12:56:30Z",
        "updatedAt" : "2016-09-26T08:13:51Z",
        "lastEditedBy" : "d37d9758-bdf5-4c23-a40e-a85099689a0c",
        "tags" : [
        ]
      }
    ],
    "commit" : "3a4613d3b25dd1944a7f26b6d2037c9e82fcde7e",
    "line" : 32,
    "diffHunk" : "@@ -1,1 +30,34 @@\nfunc generateTokenIfNeeded(s *kubeadmapi.KubeadmConfig) error {\n\tok, err := kubeadmutil.UseGivenTokenIfValid(s)\n\t// TODO(phase1+) @krousey: I know it won't happen with the way it is currently implemented, but this doesn't handle case where ok is true and err is non-nil.\n\tif !ok {"
  },
  {
    "id" : "511ff73b-1b8d-462b-a11e-86bd9efe800c",
    "prId" : 33262,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/33262#pullrequestreview-1434577",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a27c76a5-024c-41a3-8d62-4cfd3b229cb9",
        "parentId" : null,
        "authorId" : "ad0a3561-db60-47a9-b82f-ac613199f968",
        "body" : "Perhaps a better overall flow would be\n\n``` go\nfunc CreateTokenAuthFile(s *kubeadmapi.KubeadmConfig) error {\n    if s.Secrets.GivenToken == \"\" {\n        s.Secrets = kubeadmutil.GenerateToken()\n    } else {\n        s.Secrets = kubeadmutil.ParseToken(s.Secrets.GivenToken)\n    }\n    // the rest of the file handling\n}\n```\n\n(error handling omitted)\n\nThen you wouldn't need `generateTokenIfNeeded`.\n",
        "createdAt" : "2016-09-23T22:15:35Z",
        "updatedAt" : "2016-09-26T08:13:51Z",
        "lastEditedBy" : "ad0a3561-db60-47a9-b82f-ac613199f968",
        "tags" : [
        ]
      },
      {
        "id" : "60936bd9-6778-4378-a43c-c575823da891",
        "parentId" : "a27c76a5-024c-41a3-8d62-4cfd3b229cb9",
        "authorId" : "e19009d8-ed5c-45bb-b5ce-4f8d956c6c45",
        "body" : "Also, document public function.\n",
        "createdAt" : "2016-09-24T00:08:52Z",
        "updatedAt" : "2016-09-26T08:13:51Z",
        "lastEditedBy" : "e19009d8-ed5c-45bb-b5ce-4f8d956c6c45",
        "tags" : [
        ]
      },
      {
        "id" : "2a613460-7483-43f1-ac62-e2a5826722ea",
        "parentId" : "a27c76a5-024c-41a3-8d62-4cfd3b229cb9",
        "authorId" : "d37d9758-bdf5-4c23-a40e-a85099689a0c",
        "body" : "May be, but I wouldn't risk this in the last moment. I'll add a doc string, although docs are missing in many other places, so I'm not quite sure it helps us to spend time on this right now.\n",
        "createdAt" : "2016-09-24T12:56:05Z",
        "updatedAt" : "2016-09-26T08:13:51Z",
        "lastEditedBy" : "d37d9758-bdf5-4c23-a40e-a85099689a0c",
        "tags" : [
        ]
      }
    ],
    "commit" : "3a4613d3b25dd1944a7f26b6d2037c9e82fcde7e",
    "line" : 50,
    "diffHunk" : "@@ -1,1 +48,52 @@}\n\nfunc CreateTokenAuthFile(s *kubeadmapi.KubeadmConfig) error {\n\ttokenAuthFilePath := path.Join(s.EnvParams[\"host_pki_path\"], \"tokens.csv\")\n\tif err := generateTokenIfNeeded(s); err != nil {"
  },
  {
    "id" : "4bacd962-bf12-45de-b715-c71e7784bf63",
    "prId" : 33262,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/33262#pullrequestreview-1434554",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "19cef945-5ea1-496a-aef6-172a75e7c49a",
        "parentId" : null,
        "authorId" : "e19009d8-ed5c-45bb-b5ce-4f8d956c6c45",
        "body" : "Might be worth commenting that `DumpReaderToFile` will open the file as `0600`.  (And that function should probably have that in the name or take a parameter or at least document the behavior)\n",
        "createdAt" : "2016-09-24T00:11:42Z",
        "updatedAt" : "2016-09-26T08:13:51Z",
        "lastEditedBy" : "e19009d8-ed5c-45bb-b5ce-4f8d956c6c45",
        "tags" : [
        ]
      },
      {
        "id" : "f3585bf5-f5ee-4139-82fa-41d5b1ad657e",
        "parentId" : "19cef945-5ea1-496a-aef6-172a75e7c49a",
        "authorId" : "d37d9758-bdf5-4c23-a40e-a85099689a0c",
        "body" : "Thanks, good point.\n",
        "createdAt" : "2016-09-24T12:54:00Z",
        "updatedAt" : "2016-09-26T08:13:51Z",
        "lastEditedBy" : "d37d9758-bdf5-4c23-a40e-a85099689a0c",
        "tags" : [
        ]
      }
    ],
    "commit" : "3a4613d3b25dd1944a7f26b6d2037c9e82fcde7e",
    "line" : null,
    "diffHunk" : "@@ -1,1 +58,62 @@\tserialized := []byte(fmt.Sprintf(\"%s,kubeadm-node-csr,%s,system:kubelet-bootstrap\\n\", s.Secrets.BearerToken, uuid.NewUUID()))\n\t// DumpReaderToFile create a file with mode 0600\n\tif err := cmdutil.DumpReaderToFile(bytes.NewReader(serialized), tokenAuthFilePath); err != nil {\n\t\treturn fmt.Errorf(\"<master/tokens> failed to save token auth file (%q) [%v]\", tokenAuthFilePath, err)\n\t}"
  }
]