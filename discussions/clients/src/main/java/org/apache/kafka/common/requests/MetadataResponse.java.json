[
  {
    "id" : "e3501d12-7f62-42bd-865e-9bcd5e583a26",
    "prId" : 4639,
    "prUrl" : "https://github.com/apache/kafka/pull/4639#pullrequestreview-101679667",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3cb4e94f-f68a-4be1-ae32-d369afc5ad41",
        "parentId" : null,
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "This is also intentional: during trouble shooting I found that because toString is not overwritten TopicMetadata does not print correctly on log4j.",
        "createdAt" : "2018-03-06T19:19:06Z",
        "updatedAt" : "2018-03-06T19:19:06Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      }
    ],
    "commit" : "79df7d4931824096d9157bd72e4b4a6e69b33f49",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +432,436 @@        }\n\n        @Override\n        public String toString() {\n            return \"(type=TopicMetadata\" +"
  },
  {
    "id" : "c611eb84-88e4-4ecd-a63a-989152f5a933",
    "prId" : 7192,
    "prUrl" : "https://github.com/apache/kafka/pull/7192#pullrequestreview-274872850",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "771ce0cf-3b22-4b20-ad60-946436fba347",
        "parentId" : null,
        "authorId" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "body" : "If we're going to go down the route of wrapping everything, then we should hide the `MetadataResponseData` field so that it can't be modified to be different than the wrapped fields.  So we shouldn't have `data` as a public method (it should be private, or absent)",
        "createdAt" : "2019-08-12T17:40:21Z",
        "updatedAt" : "2019-08-14T13:25:15Z",
        "lastEditedBy" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "tags" : [
        ]
      },
      {
        "id" : "1ad7f57b-3b27-4171-b65a-66dc4855a8eb",
        "parentId" : "771ce0cf-3b22-4b20-ad60-946436fba347",
        "authorId" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "body" : "This is used in a couple of places in `KafkaAdminClient` currently.",
        "createdAt" : "2019-08-13T05:07:01Z",
        "updatedAt" : "2019-08-14T13:25:15Z",
        "lastEditedBy" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "tags" : [
        ]
      },
      {
        "id" : "b167a81d-2115-42f4-b623-927b4fd26413",
        "parentId" : "771ce0cf-3b22-4b20-ad60-946436fba347",
        "authorId" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "body" : "I replaced this with two methods that return an int so that callers cannot mutate `data`.",
        "createdAt" : "2019-08-14T13:08:46Z",
        "updatedAt" : "2019-08-14T13:25:15Z",
        "lastEditedBy" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "tags" : [
        ]
      }
    ],
    "commit" : "0a01cb353557fcf370a7bc947ae7393d08fc93ff",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +59,63 @@    public static final int AUTHORIZED_OPERATIONS_OMITTED = Integer.MIN_VALUE;\n\n    private final MetadataResponseData data;\n    private volatile Holder holder;\n"
  },
  {
    "id" : "3c32b980-198d-4913-8c00-1e784b1cabe8",
    "prId" : 7770,
    "prUrl" : "https://github.com/apache/kafka/pull/7770#pullrequestreview-348915138",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "151db8d5-152e-41b9-a147-4e8196ce0fb3",
        "parentId" : null,
        "authorId" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "body" : "Why did we replace the partition id with the topic partition here?",
        "createdAt" : "2020-01-23T22:46:53Z",
        "updatedAt" : "2020-02-05T00:33:47Z",
        "lastEditedBy" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "tags" : [
        ]
      },
      {
        "id" : "c30f5fe8-7169-4210-b92f-a9b41cd97fcb",
        "parentId" : "151db8d5-152e-41b9-a147-4e8196ce0fb3",
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "For simplicity I guess. It makes the `PartitionMetadata` object usable outside the context a `TopicMetadata`. It saved a little bit of conversion work here and there.",
        "createdAt" : "2020-01-27T19:25:16Z",
        "updatedAt" : "2020-02-05T00:33:47Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      }
    ],
    "commit" : "fb5a99fe09a3a7caca8a71256d2810115bfe47e1",
    "line" : 113,
    "diffHunk" : "@@ -1,1 +327,331 @@    // This is used to describe per-partition state in the MetadataResponse\n    public static class PartitionMetadata {\n        public final TopicPartition topicPartition;\n        public final Errors error;\n        public final Optional<Integer> leaderId;"
  },
  {
    "id" : "3915824d-9db4-4f85-ba51-dd05aeafdcd9",
    "prId" : 8486,
    "prUrl" : "https://github.com/apache/kafka/pull/8486#pullrequestreview-397808937",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e112aeec-c3c9-4e88-bd33-dbce649495f6",
        "parentId" : null,
        "authorId" : "3dfe0270-df82-43af-827f-0681ce1c6ad9",
        "body" : "Change the function signature to be able to pass in response version.",
        "createdAt" : "2020-04-22T02:58:58Z",
        "updatedAt" : "2020-06-05T01:54:11Z",
        "lastEditedBy" : "3dfe0270-df82-43af-827f-0681ce1c6ad9",
        "tags" : [
        ]
      }
    ],
    "commit" : "87ca234c395d1d0b0566269c4cd299da936d2cb3",
    "line" : 24,
    "diffHunk" : "@@ -1,1 +466,470 @@            responseData.topics().add(metadataResponseTopic);\n        });\n        return new MetadataResponse(responseData.toStruct(responseVersion), responseVersion);\n    }\n"
  },
  {
    "id" : "6d21ac55-c4f2-4276-9a3f-96f93567ea1a",
    "prId" : 9433,
    "prUrl" : "https://github.com/apache/kafka/pull/9433#pullrequestreview-714360962",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e513ed65-2281-4f28-8a40-1f0865a3422f",
        "parentId" : null,
        "authorId" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "body" : "Why did we change this?",
        "createdAt" : "2021-07-24T22:43:17Z",
        "updatedAt" : "2021-07-24T22:43:17Z",
        "lastEditedBy" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "tags" : [
        ]
      },
      {
        "id" : "1b8c8e17-8e04-41f8-8f72-8bc8f78c2705",
        "parentId" : "e513ed65-2281-4f28-8a40-1f0865a3422f",
        "authorId" : "0f776378-bb23-4193-9bb0-1db5973f3781",
        "body" : "It includes the partition-level error. It seems to me it follows the docs.\r\n`\r\nThe number of each type of error in the response, including {@link Errors#NONE} and top-level errors as well as more specifically scoped errors (such as topic or partition-level errors).\r\n`",
        "createdAt" : "2021-07-25T03:43:14Z",
        "updatedAt" : "2021-07-25T03:43:15Z",
        "lastEditedBy" : "0f776378-bb23-4193-9bb0-1db5973f3781",
        "tags" : [
        ]
      },
      {
        "id" : "41b03e8a-d514-4c2b-b55e-eebb984c3968",
        "parentId" : "e513ed65-2281-4f28-8a40-1f0865a3422f",
        "authorId" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "body" : "A metadata request has topics as the \"scoped error\" (one cannot request a metadata request for a given partition). So, it looks to me that we introduced a regression here. We should check if there are similar cases for other requests.",
        "createdAt" : "2021-07-25T04:52:41Z",
        "updatedAt" : "2021-07-25T04:53:05Z",
        "lastEditedBy" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "tags" : [
        ]
      },
      {
        "id" : "c1bab854-9cba-48c8-9175-6cee38aba9ff",
        "parentId" : "e513ed65-2281-4f28-8a40-1f0865a3422f",
        "authorId" : "0f776378-bb23-4193-9bb0-1db5973f3781",
        "body" : "> A metadata request has topics as the \"scoped error\" (one cannot request a metadata request for a given partition).\r\n\r\nI check the server-side code. You are right. This change should be reverted. I will file a PR to fix it ASAP. This behavior can be broken inadvertently (server-side/client-side add/remove specifically scoped error). not sure whether we can prevent it effectively (maybe add more tests)",
        "createdAt" : "2021-07-25T22:42:30Z",
        "updatedAt" : "2021-07-25T22:42:30Z",
        "lastEditedBy" : "0f776378-bb23-4193-9bb0-1db5973f3781",
        "tags" : [
        ]
      },
      {
        "id" : "ba5601f3-5cbd-462a-9e01-fa6b8a968bfb",
        "parentId" : "e513ed65-2281-4f28-8a40-1f0865a3422f",
        "authorId" : "0f776378-bb23-4193-9bb0-1db5973f3781",
        "body" : "https://github.com/apache/kafka/pull/11127",
        "createdAt" : "2021-07-25T23:29:07Z",
        "updatedAt" : "2021-07-25T23:29:07Z",
        "lastEditedBy" : "0f776378-bb23-4193-9bb0-1db5973f3781",
        "tags" : [
        ]
      }
    ],
    "commit" : "468d16f26c0f2ec32fb10f1e1bb003bcc62612d4",
    "line" : 7,
    "diffHunk" : "@@ -1,1 +111,115 @@        Map<Errors, Integer> errorCounts = new HashMap<>();\n        data.topics().forEach(metadata -> {\n            metadata.partitions().forEach(p -> updateErrorCounts(errorCounts, Errors.forCode(p.errorCode())));\n            updateErrorCounts(errorCounts, Errors.forCode(metadata.errorCode()));\n        });"
  }
]