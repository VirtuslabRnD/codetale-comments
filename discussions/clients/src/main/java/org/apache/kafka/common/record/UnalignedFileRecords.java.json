[
  {
    "id" : "a44a114d-b466-4695-9c79-5720a71e777d",
    "prId" : 9819,
    "prUrl" : "https://github.com/apache/kafka/pull/9819#pullrequestreview-575993082",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "dbe62b75-9392-48e6-a37b-417fd95b7f9d",
        "parentId" : null,
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "Do we have test coverage for this?",
        "createdAt" : "2021-01-25T06:52:15Z",
        "updatedAt" : "2021-01-26T08:26:00Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      },
      {
        "id" : "1499dd2b-0e52-4002-8afd-f35da942917c",
        "parentId" : "dbe62b75-9392-48e6-a37b-417fd95b7f9d",
        "authorId" : "12f98c82-b9ef-4668-aa6f-5a62bf3439bb",
        "body" : "Add UnalignedFileRecordsTest",
        "createdAt" : "2021-01-25T10:30:54Z",
        "updatedAt" : "2021-01-26T08:26:00Z",
        "lastEditedBy" : "12f98c82-b9ef-4668-aa6f-5a62bf3439bb",
        "tags" : [
        ]
      },
      {
        "id" : "b63051bf-11a2-4a74-ae87-fc7e558f052d",
        "parentId" : "dbe62b75-9392-48e6-a37b-417fd95b7f9d",
        "authorId" : "4a7c311c-0954-4671-a0d2-266cb67437ad",
        "body" : "Hmm. The semantic between the in-memory implementation vs the file channel implementation is slightly different. The in-memory version throws an exception if there are not enough bytes to send `length`. While the file channel version just sends less bytes if there is not enough to send `remaining`.\r\n\r\nI suspect that we want to throw in both cases else the calling code won't know why `writeTo` sent less bytes. It could loop forever if it is attempting to send up to `remaining` bytes.",
        "createdAt" : "2021-01-25T23:49:35Z",
        "updatedAt" : "2021-01-26T08:26:00Z",
        "lastEditedBy" : "4a7c311c-0954-4671-a0d2-266cb67437ad",
        "tags" : [
        ]
      },
      {
        "id" : "fc29da04-5317-4f0f-a082-0021e4f7eb13",
        "parentId" : "dbe62b75-9392-48e6-a37b-417fd95b7f9d",
        "authorId" : "12f98c82-b9ef-4668-aa6f-5a62bf3439bb",
        "body" : "@jsancio , I think you are right, I also find that the implementation of `MemoryRecords` and `FileRecords` is also different, I will spend some time checking this.",
        "createdAt" : "2021-01-26T04:01:58Z",
        "updatedAt" : "2021-01-26T08:26:00Z",
        "lastEditedBy" : "12f98c82-b9ef-4668-aa6f-5a62bf3439bb",
        "tags" : [
        ]
      }
    ],
    "commit" : "d75d65b77e2a8ea36e0a236e46a8b11c3316ba20",
    "line" : 45,
    "diffHunk" : "@@ -1,1 +43,47 @@\n    @Override\n    public long writeTo(TransferableChannel destChannel, long previouslyWritten, int remaining) throws IOException {\n        long position = this.position + previouslyWritten;\n        long count = Math.min(remaining, sizeInBytes() - previouslyWritten);"
  }
]