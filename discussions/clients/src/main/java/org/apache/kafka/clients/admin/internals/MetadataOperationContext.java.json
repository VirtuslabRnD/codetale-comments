[
  {
    "id" : "8451bcdf-035e-417c-9abf-a9b199dde29d",
    "prId" : 7296,
    "prUrl" : "https://github.com/apache/kafka/pull/7296#pullrequestreview-297748873",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a9f2b168-0444-4159-8afa-df80e83cff57",
        "parentId" : null,
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "Not something we have to do here, but one way we could improve this in the future is by taking into account leader epoch information from individual partitions. We can ensure that epochs increase monotonically in order to prevent using stale information during retry. \r\n\r\nAnother thing we could do is reduce the topics we are fetching metadata for as the ListOffsets requests complete. Ideally we'd only be refetching metadata for topics with metadata errors.",
        "createdAt" : "2019-10-04T21:41:32Z",
        "updatedAt" : "2019-10-19T14:50:21Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      },
      {
        "id" : "8c0693f9-4cad-4e5c-8cde-57c3b2f401ff",
        "parentId" : "a9f2b168-0444-4159-8afa-df80e83cff57",
        "authorId" : "d31db46e-de6d-4fea-8dc5-6f7b17b636be",
        "body" : "Yes these improvements would be nice. At the moment, I've kept it very simple and just make it retry the full metadata request every time.",
        "createdAt" : "2019-10-04T22:47:58Z",
        "updatedAt" : "2019-10-19T14:50:21Z",
        "lastEditedBy" : "d31db46e-de6d-4fea-8dc5-6f7b17b636be",
        "tags" : [
        ]
      }
    ],
    "commit" : "adb3377352be6336d1586a4a160eedbcd5a9a021",
    "line" : 41,
    "diffHunk" : "@@ -1,1 +39,43 @@ * @param <O> The type of configuration option.\n */\npublic final class MetadataOperationContext<T, O extends AbstractOptions<O>> {\n    final private Collection<String> topics;\n    final private O options;"
  },
  {
    "id" : "3b0d8b5d-28af-49dc-bf13-9244b940560b",
    "prId" : 10152,
    "prUrl" : "https://github.com/apache/kafka/pull/10152#pullrequestreview-594589815",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6cc32b1a-8f76-4fa0-ac69-e2133a1a24b6",
        "parentId" : null,
        "authorId" : "e77724e7-3db9-47d6-b4d8-a865b1d06edc",
        "body" : "nit: a stylistic observation is that this call is exactly the same as the call below. Yet it's written differently. \r\n\r\nStyles differ, usually not too much, from module to module. I think it's good to keep existing styles to help with readability when the changes don't require a greater change. \r\n \r\n```suggestion\r\n            if (shouldRefreshMetadata(tm.error())) {\r\n                throw tm.error().exception();\r\n            }\r\n```",
        "createdAt" : "2021-02-19T21:27:53Z",
        "updatedAt" : "2021-02-19T21:31:47Z",
        "lastEditedBy" : "e77724e7-3db9-47d6-b4d8-a865b1d06edc",
        "tags" : [
        ]
      }
    ],
    "commit" : "b23e0981a3c1e1c45c20ebd6ac1c02229f46bdd5",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +83,87 @@    public static void handleMetadataErrors(MetadataResponse response) {\n        for (TopicMetadata tm : response.topicMetadata()) {\n            if (shouldRefreshMetadata(tm.error())) throw tm.error().exception();\n            for (PartitionMetadata pm : tm.partitionMetadata()) {\n                if (shouldRefreshMetadata(pm.error)) {"
  }
]