[
  {
    "id" : "b694b4b4-9e2b-4f63-83b6-c84c3efc9ace",
    "prId" : 5514,
    "prUrl" : "https://github.com/apache/kafka/pull/5514#pullrequestreview-146650690",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ea250dc5-799f-49f7-8c66-72260baebf53",
        "parentId" : null,
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "Is this ever possible? `result` indicate retries needed while `pendingTxnOffsetCommits.isEmpty()`?",
        "createdAt" : "2018-08-15T22:42:45Z",
        "updatedAt" : "2018-08-15T23:54:48Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      },
      {
        "id" : "2a3b78b1-2039-4132-9980-541a5ab61a2d",
        "parentId" : "ea250dc5-799f-49f7-8c66-72260baebf53",
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "This is where we complete the result if there are no errors.",
        "createdAt" : "2018-08-15T23:01:21Z",
        "updatedAt" : "2018-08-15T23:54:48Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      }
    ],
    "commit" : "f67ecb3f6218a07a6a22448140c09c6c89695ffb",
    "line" : 53,
    "diffHunk" : "@@ -1,1 +1310,1314 @@            if (result.isCompleted()) {\n                pendingTxnOffsetCommits.clear();\n            } else if (pendingTxnOffsetCommits.isEmpty()) {\n                result.done();\n            } else {"
  },
  {
    "id" : "b51a7888-7dac-4324-b1fd-52418edd3ffc",
    "prId" : 5514,
    "prUrl" : "https://github.com/apache/kafka/pull/5514#pullrequestreview-147170576",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6aefb5ad-0605-46d3-b0c8-7bc6dc50eb1f",
        "parentId" : null,
        "authorId" : "cb6f8432-d515-4113-87f8-14e555ab8ed1",
        "body" : "Do you think it would make sense to put an `if (!errors.isEmpty())` check around this log line for the cases when there are no errors? If I see it correctly it'd print `Received TxnOffsetCommit response for consumer group my-consumer-group:` which is I think is a bit misleading, and also I suppose it would be empty most of the times.",
        "createdAt" : "2018-08-16T14:12:52Z",
        "updatedAt" : "2018-08-16T14:13:06Z",
        "lastEditedBy" : "cb6f8432-d515-4113-87f8-14e555ab8ed1",
        "tags" : [
        ]
      },
      {
        "id" : "5682fb86-f449-4c01-8a6e-171c595c9fe0",
        "parentId" : "6aefb5ad-0605-46d3-b0c8-7bc6dc50eb1f",
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "The `errors()` method name is a little misleading. The map contains both the successful partitions as well as those that failed. Most of the time, we would just see `Errors.NONE`.",
        "createdAt" : "2018-08-16T15:22:35Z",
        "updatedAt" : "2018-08-16T15:23:26Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      },
      {
        "id" : "7040d5b0-4f54-4aff-a416-49671f563ffa",
        "parentId" : "6aefb5ad-0605-46d3-b0c8-7bc6dc50eb1f",
        "authorId" : "cb6f8432-d515-4113-87f8-14e555ab8ed1",
        "body" : "Ok, I think I see now, thanks for the explanation.",
        "createdAt" : "2018-08-17T10:14:01Z",
        "updatedAt" : "2018-08-17T10:14:02Z",
        "lastEditedBy" : "cb6f8432-d515-4113-87f8-14e555ab8ed1",
        "tags" : [
        ]
      }
    ],
    "commit" : "f67ecb3f6218a07a6a22448140c09c6c89695ffb",
    "line" : 8,
    "diffHunk" : "@@ -1,1 +1276,1280 @@\n            log.debug(\"Received TxnOffsetCommit response for consumer group {}: {}\", builder.consumerGroupId(),\n                    errors);\n\n            for (Map.Entry<TopicPartition, Errors> entry : errors.entrySet()) {"
  },
  {
    "id" : "9034f493-ea2b-457b-88db-40e147e8e861",
    "prId" : 5971,
    "prUrl" : "https://github.com/apache/kafka/pull/5971#pullrequestreview-212830025",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "de233cc6-b144-4f6d-860b-076ef92b8740",
        "parentId" : null,
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "What I was trying to point out in the initial comment is that a user could be blocking on the latch in one of these pending requests. When we force close, I would expect the producer to fail any waiters. So should we have a `close()` API in `TransactionManager` which iterates through all of the pending requests and forcefully finishes the `TransactionalRequestResult`?",
        "createdAt" : "2019-03-07T21:54:03Z",
        "updatedAt" : "2019-04-15T13:56:56Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      },
      {
        "id" : "7a07941a-55b5-404a-956f-92b64f62afce",
        "parentId" : "de233cc6-b144-4f6d-860b-076ef92b8740",
        "authorId" : "cb6f8432-d515-4113-87f8-14e555ab8ed1",
        "body" : "Yep, I think that'd be a good idea. I'll create one.",
        "createdAt" : "2019-03-11T13:24:02Z",
        "updatedAt" : "2019-04-15T13:56:56Z",
        "lastEditedBy" : "cb6f8432-d515-4113-87f8-14e555ab8ed1",
        "tags" : [
        ]
      }
    ],
    "commit" : "9e9e027171422c2f5af6d9602429702a58939036",
    "line" : 30,
    "diffHunk" : "@@ -1,1 +739,743 @@    }\n\n    synchronized boolean hasPendingRequests() {\n        return !pendingRequests.isEmpty();\n    }"
  },
  {
    "id" : "d25f313e-cdc0-4c4d-93af-68b20735cb96",
    "prId" : 5971,
    "prUrl" : "https://github.com/apache/kafka/pull/5971#pullrequestreview-226515787",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "99d90996-5bfd-40dd-ba0e-e874991c88bc",
        "parentId" : null,
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "Just a nit, but the name of the api suggests that this could be called in other scenarios than closing. Perhaps we should rename the method to something like `abortPendingRequestsOnForceClose`. Or maybe just `close()`? ðŸ˜‰ ",
        "createdAt" : "2019-04-04T22:22:48Z",
        "updatedAt" : "2019-04-15T13:56:56Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      },
      {
        "id" : "4b9c0a5e-2701-48bd-93d1-4cfe925c43f1",
        "parentId" : "99d90996-5bfd-40dd-ba0e-e874991c88bc",
        "authorId" : "cb6f8432-d515-4113-87f8-14e555ab8ed1",
        "body" : "Renamed it :D",
        "createdAt" : "2019-04-15T08:39:19Z",
        "updatedAt" : "2019-04-15T13:56:56Z",
        "lastEditedBy" : "cb6f8432-d515-4113-87f8-14e555ab8ed1",
        "tags" : [
        ]
      }
    ],
    "commit" : "9e9e027171422c2f5af6d9602429702a58939036",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +683,687 @@\n    synchronized void close() {\n        KafkaException shutdownException = new KafkaException(\"The producer closed forcefully\");\n        pendingRequests.forEach(handler ->\n                handler.fatalError(shutdownException));"
  }
]