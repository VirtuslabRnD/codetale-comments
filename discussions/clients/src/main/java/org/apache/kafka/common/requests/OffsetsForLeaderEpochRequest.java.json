[
  {
    "id" : "c9bc5635-8d65-4d22-bbf0-1c120de651f2",
    "prId" : 4882,
    "prUrl" : "https://github.com/apache/kafka/pull/4882#pullrequestreview-116721046",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "4a1ad5e7-92a5-4fd7-865e-2de4be2e620d",
        "parentId" : null,
        "authorId" : "442b5138-0781-4001-8ac5-0593f2136d1c",
        "body" : "Since this affects inter broker protocol, we need to (1) document this api change for \"2.0-IV0\" in ApiVersion.scala, (2) update the upgrade section in the doc, (3) only use the new protocol if the inter broker protocol is 2.0-IV0 or above.",
        "createdAt" : "2018-04-30T23:50:18Z",
        "updatedAt" : "2018-05-09T21:46:13Z",
        "lastEditedBy" : "442b5138-0781-4001-8ac5-0593f2136d1c",
        "tags" : [
        ]
      },
      {
        "id" : "dcb9b9f1-a2d5-4788-baa4-c1bcc2d6a285",
        "parentId" : "4a1ad5e7-92a5-4fd7-865e-2de4be2e620d",
        "authorId" : "e235ea82-83a9-41e5-8e3a-15b2e1b6f350",
        "body" : "Done all three.",
        "createdAt" : "2018-05-01T22:11:53Z",
        "updatedAt" : "2018-05-09T21:46:13Z",
        "lastEditedBy" : "e235ea82-83a9-41e5-8e3a-15b2e1b6f350",
        "tags" : [
        ]
      },
      {
        "id" : "525e37d4-d9a3-4d71-806d-8214c54d47d3",
        "parentId" : "4a1ad5e7-92a5-4fd7-865e-2de4be2e620d",
        "authorId" : "e235ea82-83a9-41e5-8e3a-15b2e1b6f350",
        "body" : "Regarding (3), the fetcher falls back to KIP-101 logic if inter-broker protocol version < KAFKA_2_0_IV0 (ignores leader epoch returned in the response and uses end offset). ",
        "createdAt" : "2018-05-01T22:20:05Z",
        "updatedAt" : "2018-05-09T21:46:13Z",
        "lastEditedBy" : "e235ea82-83a9-41e5-8e3a-15b2e1b6f350",
        "tags" : [
        ]
      }
    ],
    "commit" : "544f4fdf83ce6f540124668d95a58d2cdebc1ea8",
    "line" : 9,
    "diffHunk" : "@@ -1,1 +55,59 @@\n    public static Schema[] schemaVersions() {\n        return new Schema[]{OFFSET_FOR_LEADER_EPOCH_REQUEST_V0, OFFSET_FOR_LEADER_EPOCH_REQUEST_V1};\n    }\n"
  },
  {
    "id" : "b49d08e0-71da-4796-ab30-d8b9f8188e60",
    "prId" : 6731,
    "prUrl" : "https://github.com/apache/kafka/pull/6731#pullrequestreview-238082298",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5d17547d-9a88-48ee-bd69-1acbddae235c",
        "parentId" : null,
        "authorId" : "3dfe0270-df82-43af-827f-0681ce1c6ad9",
        "body" : "Same for this class upgrade.",
        "createdAt" : "2019-05-15T21:32:43Z",
        "updatedAt" : "2019-05-17T21:55:02Z",
        "lastEditedBy" : "3dfe0270-df82-43af-827f-0681ce1c6ad9",
        "tags" : [
        ]
      }
    ],
    "commit" : "3c7c0bdc761dc4bb68e0ec59c113abb4a834901d",
    "line" : 3,
    "diffHunk" : "@@ -1,1 +36,40 @@import static org.apache.kafka.common.protocol.CommonFields.TOPIC_NAME;\n\npublic class OffsetsForLeaderEpochRequest extends AbstractRequest {\n    private static final Field.Int32 REPLICA_ID = new Field.Int32(\"replica_id\",\n            \"Broker id of the follower. For normal consumers, use -1.\");"
  },
  {
    "id" : "89ed26c6-a58a-44d1-bac9-9ed799545c06",
    "prId" : 6731,
    "prUrl" : "https://github.com/apache/kafka/pull/6731#pullrequestreview-239144201",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9fbd4c9b-fad6-4b2e-8ef0-400cbb18d353",
        "parentId" : null,
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "We'll need to fix this in a follow-up so that followers send the right replicaId.",
        "createdAt" : "2019-05-17T20:46:51Z",
        "updatedAt" : "2019-05-17T21:55:02Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      },
      {
        "id" : "86f3b871-5b47-43bf-9c5f-686d340997e4",
        "parentId" : "9fbd4c9b-fad6-4b2e-8ef0-400cbb18d353",
        "authorId" : "083f2f03-ca7e-48a1-9781-482564dfdf53",
        "body" : "Yes, that's the idea. We'll add a new method for ReplicaFetcherThread to use",
        "createdAt" : "2019-05-17T21:34:17Z",
        "updatedAt" : "2019-05-17T21:55:02Z",
        "lastEditedBy" : "083f2f03-ca7e-48a1-9781-482564dfdf53",
        "tags" : [
        ]
      }
    ],
    "commit" : "3c7c0bdc761dc4bb68e0ec59c113abb4a834901d",
    "line" : 50,
    "diffHunk" : "@@ -1,1 +105,109 @@            super(ApiKeys.OFFSET_FOR_LEADER_EPOCH, version);\n            this.epochsByPartition = epochsByPartition;\n            this.replicaId = CONSUMER_REPLICA_ID;\n        }\n"
  },
  {
    "id" : "3a32b832-d496-4633-92f4-32e5aa7fca0c",
    "prId" : 6806,
    "prUrl" : "https://github.com/apache/kafka/pull/6806#pullrequestreview-241818534",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "36595f4d-219f-473a-bd2e-85ab74c960c5",
        "parentId" : null,
        "authorId" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "body" : "This was a separate bug, I guess? Might be worth mentioning in the PR description.",
        "createdAt" : "2019-05-24T14:07:08Z",
        "updatedAt" : "2019-05-24T15:51:12Z",
        "lastEditedBy" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "tags" : [
        ]
      },
      {
        "id" : "9a0244a0-14c6-498e-8116-3d7758c93710",
        "parentId" : "36595f4d-219f-473a-bd2e-85ab74c960c5",
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "Yeah, we missed this. When the follower has to use an old version of the protocol without the replicaId field, we need a sentinel value which allows reading to the log end. I chose this one for consistency with other APIs (such as ListOffsets). I will mention this in the description.",
        "createdAt" : "2019-05-24T15:50:16Z",
        "updatedAt" : "2019-05-24T15:51:12Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      }
    ],
    "commit" : "67c1062aabd0ac7e4671c9b8e729c72118ae4ad1",
    "line" : 61,
    "diffHunk" : "@@ -1,1 +156,160 @@    public OffsetsForLeaderEpochRequest(Struct struct, short version) {\n        super(ApiKeys.OFFSET_FOR_LEADER_EPOCH, version);\n        replicaId = struct.getOrElse(REPLICA_ID, DEBUGGING_REPLICA_ID);\n        epochsByPartition = new HashMap<>();\n        for (Object topicAndEpochsObj : struct.get(TOPICS)) {"
  }
]