[
  {
    "id" : "7263001d-ded4-496c-a4a6-326ef860e56b",
    "prId" : 7409,
    "prUrl" : "https://github.com/apache/kafka/pull/7409#pullrequestreview-545096263",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "477b4308-c79b-4d26-8390-b4ec232f58fa",
        "parentId" : null,
        "authorId" : "0f776378-bb23-4193-9bb0-1db5973f3781",
        "body" : "Should it subtract ```messageSize.zeroCopySize()```?",
        "createdAt" : "2020-12-04T15:32:50Z",
        "updatedAt" : "2020-12-04T15:46:21Z",
        "lastEditedBy" : "0f776378-bb23-4193-9bb0-1db5973f3781",
        "tags" : [
        ]
      },
      {
        "id" : "b000316f-8795-4d63-b6e9-28442aaf1959",
        "parentId" : "477b4308-c79b-4d26-8390-b4ec232f58fa",
        "authorId" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "body" : "Yeah, good point. I don't think it affects its current non test usage, but could result in a bug as the code changes. Will fix.",
        "createdAt" : "2020-12-04T16:06:00Z",
        "updatedAt" : "2020-12-04T16:06:00Z",
        "lastEditedBy" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "tags" : [
        ]
      },
      {
        "id" : "eece039c-85d2-414e-b993-84c3ee9bfb3f",
        "parentId" : "477b4308-c79b-4d26-8390-b4ec232f58fa",
        "authorId" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "body" : "Actually, I need to think about this more. Because `SendBuilder` is not being used, we actually need to copy all the bytes to the returned buffer. I need to check what happens for a message contains records.",
        "createdAt" : "2020-12-04T16:08:25Z",
        "updatedAt" : "2020-12-04T16:08:25Z",
        "lastEditedBy" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "tags" : [
        ]
      },
      {
        "id" : "8006677f-85da-4914-b928-3ddb4eabdef4",
        "parentId" : "477b4308-c79b-4d26-8390-b4ec232f58fa",
        "authorId" : "0f776378-bb23-4193-9bb0-1db5973f3781",
        "body" : "oh, you are right. It uses ```ByteBufferAccessor``` rather than ```SendBuilder```.  There is no zero copy.",
        "createdAt" : "2020-12-04T16:12:02Z",
        "updatedAt" : "2020-12-04T16:12:02Z",
        "lastEditedBy" : "0f776378-bb23-4193-9bb0-1db5973f3781",
        "tags" : [
        ]
      }
    ],
    "commit" : "ad0e0d534090ffe2bec563592f556f4e2c7ed06a",
    "line" : 79,
    "diffHunk" : "@@ -1,1 +100,104 @@        MessageSizeAccumulator messageSize = RequestUtils.size(serializationCache, header, headerVersion, apiMessage, apiVersion);\n\n        ByteBuffer buffer = ByteBuffer.allocate(messageSize.totalSize());\n        ByteBufferAccessor bufferWritable = new ByteBufferAccessor(buffer);\n        if (header != null)"
  }
]