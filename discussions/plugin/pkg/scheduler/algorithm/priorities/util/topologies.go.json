[
  {
    "id" : "72c1b781-f011-46ad-a889-c2974d8c6e09",
    "prId" : 34543,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/34543#pullrequestreview-17981660",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "235a5baa-13eb-432b-9748-02f8d6431a7f",
        "parentId" : null,
        "authorId" : "24302707-9254-48df-89a5-cbcc349462b8",
        "body" : "@davidopp \r\n\r\nI'm probably fine with this change, but this is a semantic change in my opinion. Before this PR, a predicate/priority without speified topology key was correct. With this PR in, this is no longer the case.\r\nDo we really want it? @davidopp for feedback",
        "createdAt" : "2017-01-23T07:08:24Z",
        "updatedAt" : "2017-01-23T07:08:24Z",
        "lastEditedBy" : "24302707-9254-48df-89a5-cbcc349462b8",
        "tags" : [
        ]
      },
      {
        "id" : "091da0d4-a31a-4dc9-a0ee-ac11cb24e8b2",
        "parentId" : "235a5baa-13eb-432b-9748-02f8d6431a7f",
        "authorId" : "82da2b23-9f40-4abd-8af5-56ba07c1fc0a",
        "body" : "The [comment](https://github.com/kubernetes/kubernetes/blob/master/pkg/api/v1/types.go) for TopologyKey says\r\n\r\n```\r\nFor PreferredDuringScheduling pod anti-affinity, empty topologyKey is interpreted\r\nas \"all topologies (\"all topologies\" here means all the topologyKeys indicated by\r\nscheduler command-line argument --failure-domains)\r\n```\r\n\r\nI think we want to continue to support this behavior.\r\n",
        "createdAt" : "2017-01-23T17:03:17Z",
        "updatedAt" : "2017-01-23T17:03:17Z",
        "lastEditedBy" : "82da2b23-9f40-4abd-8af5-56ba07c1fc0a",
        "tags" : [
        ]
      },
      {
        "id" : "2ed2cecd-3919-4d53-95f1-9dc2bf9880d0",
        "parentId" : "235a5baa-13eb-432b-9748-02f8d6431a7f",
        "authorId" : "bfb32501-a689-4c4c-941b-d6dcf433bb91",
        "body" : "There's actually [this method](https://github.com/kubernetes/kubernetes/blob/55bee3ad21f025b1416a4e1f10de753f484b66d3/plugin/pkg/scheduler/algorithm/priorities/util/topologies.go#L63) of Topologies struct which is also named `NodesHaveSameTopologyKey` and which takes `failureDomains` into account (`failureDomains` there being the contents of `Topologies` struct `DefaultKeys` field, [see here](https://github.com/kubernetes/kubernetes/blob/082ce00ecaa2532f4395bc916c6f0eb482253cdc/plugin/pkg/scheduler/algorithm/priorities/interpod_affinity.go#L52) and note it's about priorities and not predicates!). The new function you mention is only used by pod affinity predicate which means we're dealing with `RequiredDuringScheduling`, not `PreferredDuringScheduling` and `--failure-domains` are not used, that's the current behaviour and I didn't change it. So this may not be immediately clear but my modifications don't change the behavior in any way. As of the new exported function, maybe I should change its name somehow to make it clear it should only be used when dealing with  `RequiredDuringScheduling` case?",
        "createdAt" : "2017-01-23T17:42:27Z",
        "updatedAt" : "2017-01-23T17:47:03Z",
        "lastEditedBy" : "bfb32501-a689-4c4c-941b-d6dcf433bb91",
        "tags" : [
        ]
      },
      {
        "id" : "bd0ad1b2-1390-4b78-ac0a-3222f300fe6f",
        "parentId" : "235a5baa-13eb-432b-9748-02f8d6431a7f",
        "authorId" : "bfb32501-a689-4c4c-941b-d6dcf433bb91",
        "body" : "To reiterate: I only change the predicate to remove the need for a setting **it doesn't use anyway**. `PreferredDuringScheduling` affinity is not used by predicates.",
        "createdAt" : "2017-01-23T17:44:42Z",
        "updatedAt" : "2017-01-23T17:44:56Z",
        "lastEditedBy" : "bfb32501-a689-4c4c-941b-d6dcf433bb91",
        "tags" : [
        ]
      }
    ],
    "commit" : "d40a8f3279feb1d3aeec731225fd33f15cad68fc",
    "line" : 9,
    "diffHunk" : "@@ -1,1 +56,60 @@// Returns false if topologyKey is empty.\nfunc NodesHaveSameTopologyKey(nodeA, nodeB *v1.Node, topologyKey string) bool {\n\tif len(topologyKey) == 0 {\n\t\treturn false\n\t}"
  },
  {
    "id" : "7bf92f19-0cf6-4ef7-a503-9d8ccab8e2bc",
    "prId" : 28952,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e4fcc0c8-c8a1-49f6-856f-b3c3c133667c",
        "parentId" : null,
        "authorId" : "24302707-9254-48df-89a5-cbcc349462b8",
        "body" : "@davidopp - I splitted non_zero.go file into two parts - this is mostly copy of that with some small changes.\n",
        "createdAt" : "2016-07-14T12:27:13Z",
        "updatedAt" : "2016-07-15T08:06:48Z",
        "lastEditedBy" : "24302707-9254-48df-89a5-cbcc349462b8",
        "tags" : [
        ]
      }
    ],
    "commit" : "a538045d7b16b1d3c0d8d578cba3af5eb6ebf0d2",
    "line" : 1,
    "diffHunk" : "@@ -1,1 +-1,3 @@/*\nCopyright 2016 The Kubernetes Authors.\n"
  }
]