[
  {
    "id" : "b0529e06-697f-4947-819f-e4d6b25d8bf4",
    "prId" : 56480,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/56480#pullrequestreview-80422696",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "4f22a1ad-a656-4b16-b553-bd4bed6c42c5",
        "parentId" : null,
        "authorId" : "15fb535e-c5be-47ce-a304-1cb5da5aca90",
        "body" : "If you want to change the test to ensure that `Pop()` is always executed before `Add()`, you should place `wg.Wait()` before `q.Add(...)`.",
        "createdAt" : "2017-11-30T22:37:07Z",
        "updatedAt" : "2017-11-30T22:37:07Z",
        "lastEditedBy" : "15fb535e-c5be-47ce-a304-1cb5da5aca90",
        "tags" : [
        ]
      },
      {
        "id" : "b48a6435-ac61-4c5f-b4b2-3dfa7c47cb3c",
        "parentId" : "4f22a1ad-a656-4b16-b553-bd4bed6c42c5",
        "authorId" : "b41ac763-2378-4c8a-a9bf-7a3dd4082826",
        "body" : "If `wg.Wait()` is put before `q.Add(...)`, it will cause dead lock.\r\nThis change makes sure that `q.Pop()` is `runned` and `finished` successfully.",
        "createdAt" : "2017-12-01T01:33:51Z",
        "updatedAt" : "2017-12-01T01:33:51Z",
        "lastEditedBy" : "b41ac763-2378-4c8a-a9bf-7a3dd4082826",
        "tags" : [
        ]
      },
      {
        "id" : "e6cdd9ad-2e82-4106-bbfe-444b773b9e6e",
        "parentId" : "4f22a1ad-a656-4b16-b553-bd4bed6c42c5",
        "authorId" : "15fb535e-c5be-47ce-a304-1cb5da5aca90",
        "body" : "Ah, right. Since Pop() is tested in other tests, my intention for writing this test was to ensure that when Pop() is executed before Add(), it waits and returns what Add() adds to the queue. Your change won't ensure that, but it is still useful and ensures that Pop() is executed.",
        "createdAt" : "2017-12-01T07:42:35Z",
        "updatedAt" : "2017-12-01T07:42:35Z",
        "lastEditedBy" : "15fb535e-c5be-47ce-a304-1cb5da5aca90",
        "tags" : [
        ]
      }
    ],
    "commit" : "33f6625a843af4c9cfa53a7add8aa44c838f370f",
    "line" : 21,
    "diffHunk" : "@@ -1,1 +98,102 @@\t}()\n\tq.Add(&highPriorityPod)\n\twg.Wait()\n}\n"
  },
  {
    "id" : "2d8a3db0-d2c9-4e99-bfa1-8c99c726eb22",
    "prId" : 56480,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/56480#pullrequestreview-80385473",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3e03dde4-7e69-435a-89a9-d61437bcd06a",
        "parentId" : null,
        "authorId" : "b41ac763-2378-4c8a-a9bf-7a3dd4082826",
        "body" : "This goroutine may not get chance to run.\r\nWhen `q.Add(...)` returns, this test is done, it may exit before q.Pop() finishes.",
        "createdAt" : "2017-12-01T01:36:47Z",
        "updatedAt" : "2017-12-01T01:36:47Z",
        "lastEditedBy" : "b41ac763-2378-4c8a-a9bf-7a3dd4082826",
        "tags" : [
        ]
      }
    ],
    "commit" : "33f6625a843af4c9cfa53a7add8aa44c838f370f",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +91,95 @@\twg := sync.WaitGroup{}\n\twg.Add(1)\n\tgo func() {\n\t\tdefer wg.Done()\n\t\tif p, err := q.Pop(); err != nil || p != &highPriorityPod {"
  },
  {
    "id" : "3276c7b4-b2d0-4394-be71-afc1c03a4160",
    "prId" : 55109,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/55109#pullrequestreview-74578737",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e79f54cb-02ff-430a-81a4-e48bd661a064",
        "parentId" : null,
        "authorId" : "f81960f6-a033-4403-bebf-c8ebb484e444",
        "body" : "I can't tell what this test does that isn't covered by the previous test. ",
        "createdAt" : "2017-11-06T21:04:50Z",
        "updatedAt" : "2017-11-19T19:32:37Z",
        "lastEditedBy" : "f81960f6-a033-4403-bebf-c8ebb484e444",
        "tags" : [
        ]
      },
      {
        "id" : "95ddbaab-5ca7-4271-9ab4-fe3bfc5740db",
        "parentId" : "e79f54cb-02ff-430a-81a4-e48bd661a064",
        "authorId" : "15fb535e-c5be-47ce-a304-1cb5da5aca90",
        "body" : "The unit-tests with an underscore in their names test the same function in the code. This one tests PriorityQueue.Pop(). Pop() is sort of tested in other tests, but this one in particular tests that if Pop() is called before Add() (with some probability), pop blocks until the next item is added and returns it.",
        "createdAt" : "2017-11-06T22:05:57Z",
        "updatedAt" : "2017-11-19T19:32:37Z",
        "lastEditedBy" : "15fb535e-c5be-47ce-a304-1cb5da5aca90",
        "tags" : [
        ]
      }
    ],
    "commit" : "79ac37d8b30a77929f9cc8b5aa346bbeb1ca7ca7",
    "line" : 88,
    "diffHunk" : "@@ -1,1 +86,90 @@}\n\nfunc TestPriorityQueue_Pop(t *testing.T) {\n\tq := NewPriorityQueue()\n\tgo func() {"
  },
  {
    "id" : "6ac6dd1c-375d-416c-a088-583c8d2c5c53",
    "prId" : 55109,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/55109#pullrequestreview-74578963",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "04cb3f96-c476-42a4-8701-c72b63f94ea2",
        "parentId" : null,
        "authorId" : "f81960f6-a033-4403-bebf-c8ebb484e444",
        "body" : "Could also add a pop at the end to verify that only the unschedulablePod exists. ",
        "createdAt" : "2017-11-06T21:07:41Z",
        "updatedAt" : "2017-11-19T19:32:37Z",
        "lastEditedBy" : "f81960f6-a033-4403-bebf-c8ebb484e444",
        "tags" : [
        ]
      },
      {
        "id" : "5c4900b9-5f1e-4419-8132-2985b66a382d",
        "parentId" : "04cb3f96-c476-42a4-8701-c72b63f94ea2",
        "authorId" : "15fb535e-c5be-47ce-a304-1cb5da5aca90",
        "body" : "This is testing Delete(). So, I wanted to focus on Delete() only in this test.",
        "createdAt" : "2017-11-06T22:06:48Z",
        "updatedAt" : "2017-11-19T19:32:37Z",
        "lastEditedBy" : "15fb535e-c5be-47ce-a304-1cb5da5aca90",
        "tags" : [
        ]
      }
    ],
    "commit" : "79ac37d8b30a77929f9cc8b5aa346bbeb1ca7ca7",
    "line" : 138,
    "diffHunk" : "@@ -1,1 +136,140 @@\tif _, exists, _ := q.activeQ.Get(&highPriorityPod); exists {\n\t\tt.Errorf(\"Didn't expect %v to be in activeQ.\", highPriorityPod.Name)\n\t}\n}\n"
  }
]