[
  {
    "id" : "2592989b-8508-4d3e-af85-e91ad517a738",
    "prId" : 86933,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/86933#pullrequestreview-365756497",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6380b932-980e-4a98-a0e6-a0f956cd9686",
        "parentId" : null,
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "ooo... this is spiffy... the spec of the object sent to the approval subresource is irrelevant (and might be modified by the sender!) and is stomped with the existing object's spec by the server\r\n\r\nwe want to base our decision on the `spec.signerName` of the *old* CSR (the currently persisted one), available via `a.GetOldObject()`. same goes for the signing admission plugin.\r\n\r\nadd a unit test that makes sure the old object's signerName is the one used to authorize",
        "createdAt" : "2020-02-27T14:58:40Z",
        "updatedAt" : "2020-02-27T15:50:26Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "537de851-f2c4-4519-b825-154be12dc413",
        "parentId" : "6380b932-980e-4a98-a0e6-a0f956cd9686",
        "authorId" : "c5a78ad1-2727-48a6-8217-285a102b94de",
        "body" : "well caught! ðŸ˜… I'll be sure to add a unit test trying to 'exploit' this ðŸ™ƒ ",
        "createdAt" : "2020-02-27T15:26:43Z",
        "updatedAt" : "2020-02-27T15:50:26Z",
        "lastEditedBy" : "c5a78ad1-2727-48a6-8217-285a102b94de",
        "tags" : [
        ]
      }
    ],
    "commit" : "d7e10f98697644367f689be79189583b9163dcab",
    "line" : 93,
    "diffHunk" : "@@ -1,1 +91,95 @@\t}\n\n\tif !certificates.IsAuthorizedForSignerName(ctx, p.authz, a.GetUserInfo(), \"approve\", csr.Spec.SignerName) {\n\t\tklog.V(4).Infof(\"user not permitted to approve CertificateSigningRequest %q with signerName %q\", csr.Name, csr.Spec.SignerName)\n\t\treturn admission.NewForbidden(a, fmt.Errorf(\"user not permitted to approve requests with signerName %q\", csr.Spec.SignerName))"
  }
]