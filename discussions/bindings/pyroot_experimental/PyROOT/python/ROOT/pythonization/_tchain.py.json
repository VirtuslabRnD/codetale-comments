[
  {
    "id" : "5d76a798-8db2-4f93-b862-385e97a3a44f",
    "prId" : 2656,
    "prUrl" : "https://github.com/root-project/root/pull/2656#pullrequestreview-158034470",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9d40c5ab-8862-46d7-8480-58e4e332e5c3",
        "parentId" : null,
        "authorId" : "a66b5f61-1206-4ddd-b280-befb0005276f",
        "body" : "Does this check mean that this function may be called with a different class in `name` than `TChain`?",
        "createdAt" : "2018-09-23T17:44:26Z",
        "updatedAt" : "2018-09-24T09:28:44Z",
        "lastEditedBy" : "a66b5f61-1206-4ddd-b280-befb0005276f",
        "tags" : [
        ]
      },
      {
        "id" : "8eac5b28-de7e-4e8f-9172-e14abf7bd59a",
        "parentId" : "9d40c5ab-8862-46d7-8480-58e4e332e5c3",
        "authorId" : "4c541c6e-f658-422b-9f5a-7ae0b2a9a1f5",
        "body" : "Yes, every pythonizor function that is registered in Cppyy will be called when a new class is used from the application. Therefore a check is needed to make sure you are pythonizing what you want to pythonize.",
        "createdAt" : "2018-09-24T07:21:57Z",
        "updatedAt" : "2018-09-24T09:28:44Z",
        "lastEditedBy" : "4c541c6e-f658-422b-9f5a-7ae0b2a9a1f5",
        "tags" : [
        ]
      },
      {
        "id" : "cd1b84f0-ba34-4bd3-87d5-49d44c6ad794",
        "parentId" : "9d40c5ab-8862-46d7-8480-58e4e332e5c3",
        "authorId" : "a66b5f61-1206-4ddd-b280-befb0005276f",
        "body" : "I don't understand. If there are 100 classes with pythonizations (i.e. each with a function like the above), when a class is used all 100 functions will be called?",
        "createdAt" : "2018-09-24T08:16:55Z",
        "updatedAt" : "2018-09-24T09:28:44Z",
        "lastEditedBy" : "a66b5f61-1206-4ddd-b280-befb0005276f",
        "tags" : [
        ]
      },
      {
        "id" : "97130004-2ca9-46c8-a8a2-7d49fecc84fa",
        "parentId" : "9d40c5ab-8862-46d7-8480-58e4e332e5c3",
        "authorId" : "4c541c6e-f658-422b-9f5a-7ae0b2a9a1f5",
        "body" : "That is correct. [This loop](https://github.com/root-project/root/blob/master/bindings/pyroot_experimental/cppyy/CPyCppyy/src/Pythonize.cxx#L825) on the pythonizors gets executed every time a new class is referenced from the application **for the first time**.",
        "createdAt" : "2018-09-24T08:58:07Z",
        "updatedAt" : "2018-09-24T09:28:44Z",
        "lastEditedBy" : "4c541c6e-f658-422b-9f5a-7ae0b2a9a1f5",
        "tags" : [
        ]
      },
      {
        "id" : "5044a422-0ec6-4fe6-ae91-a8817e3b9e16",
        "parentId" : "9d40c5ab-8862-46d7-8480-58e4e332e5c3",
        "authorId" : "28bf1eea-b1ed-4971-b001-9f6e3a5ec44f",
        "body" : "For every new class, Pythonisations are brushed. This is a good point: maybe we can decide to \"discard\" a pythonisation once it applied?",
        "createdAt" : "2018-09-24T08:58:59Z",
        "updatedAt" : "2018-09-24T09:28:44Z",
        "lastEditedBy" : "28bf1eea-b1ed-4971-b001-9f6e3a5ec44f",
        "tags" : [
        ]
      },
      {
        "id" : "9adca68b-af24-4104-8c55-ebcc74fc8a9f",
        "parentId" : "9d40c5ab-8862-46d7-8480-58e4e332e5c3",
        "authorId" : "4c541c6e-f658-422b-9f5a-7ae0b2a9a1f5",
        "body" : "There is actually a method in cppyy API called [remove_pythonization](https://github.com/root-project/root/blob/master/bindings/pyroot_experimental/cppyy/cppyy/python/cppyy/_pythonization.py#L22), so I guess the pythonizor method can unsubscribe itself if all the conditions it checks (e.g. class name) have applied once.",
        "createdAt" : "2018-09-24T09:12:16Z",
        "updatedAt" : "2018-09-24T09:28:44Z",
        "lastEditedBy" : "4c541c6e-f658-422b-9f5a-7ae0b2a9a1f5",
        "tags" : [
        ]
      },
      {
        "id" : "4387936f-a63f-4e8e-9f49-73d90850242d",
        "parentId" : "9d40c5ab-8862-46d7-8480-58e4e332e5c3",
        "authorId" : "a66b5f61-1206-4ddd-b280-befb0005276f",
        "body" : "That seems wasteful. Why not have a map so that only one function needs to be run instead of looping over all pythonizor functions each time?",
        "createdAt" : "2018-09-24T09:45:40Z",
        "updatedAt" : "2018-09-24T09:45:40Z",
        "lastEditedBy" : "a66b5f61-1206-4ddd-b280-befb0005276f",
        "tags" : [
        ]
      },
      {
        "id" : "39af8a33-4ee1-4467-b93f-4d928cab41ff",
        "parentId" : "9d40c5ab-8862-46d7-8480-58e4e332e5c3",
        "authorId" : "4c541c6e-f658-422b-9f5a-7ae0b2a9a1f5",
        "body" : "I believe the rational followed by Wim to implement it that way is that the condition to check when deciding whether to apply a pythonization can be more complex than just looking at the name of the class. But I agree with your comment and we could have a hybrid solution with per-class pythonizations addressed by a map plus a list of some pythonizations with more complex conditions.",
        "createdAt" : "2018-09-24T09:52:43Z",
        "updatedAt" : "2018-09-24T09:52:43Z",
        "lastEditedBy" : "4c541c6e-f658-422b-9f5a-7ae0b2a9a1f5",
        "tags" : [
        ]
      }
    ],
    "commit" : "9bd71896bca2622fa479f50cc6558a8ccbe24f87",
    "line" : 12,
    "diffHunk" : "@@ -1,1 +10,14 @@    # name: string containing the name of the class\n\n    if name == 'TChain':\n        # SetBranchAddress\n        # TChain overrides TTree's SetBranchAddress, so set it again (the Python method only forwards"
  }
]