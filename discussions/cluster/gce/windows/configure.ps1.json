[
  {
    "id" : "6d157b95-34d8-40d0-9f91-2561f9506f49",
    "prId" : 91835,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/91835#pullrequestreview-439386876",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "fa3a061d-f804-4faa-9521-dfe0ad6eb816",
        "parentId" : null,
        "authorId" : "1bd2d65a-7c93-4c22-b408-c7794d037dc5",
        "body" : "Why starting the CSI proxy here? Is the ordering intentional? If so, could you please add a comment describing why this is the case?",
        "createdAt" : "2020-06-26T16:59:21Z",
        "updatedAt" : "2020-07-01T22:08:47Z",
        "lastEditedBy" : "1bd2d65a-7c93-4c22-b408-c7794d037dc5",
        "tags" : [
        ]
      },
      {
        "id" : "e47c2b4f-f2d1-43f5-aa8a-a85bb24dcc5b",
        "parentId" : "fa3a061d-f804-4faa-9521-dfe0ad6eb816",
        "authorId" : "44594ff0-8fbc-44a7-84f9-654ffd54270f",
        "body" : "csi-proxy can be started independently from other kubelet services. So the ordering should not matter.Do you think it is better to move it to Start-WorkerServices? ",
        "createdAt" : "2020-06-26T17:13:43Z",
        "updatedAt" : "2020-07-01T22:08:47Z",
        "lastEditedBy" : "44594ff0-8fbc-44a7-84f9-654ffd54270f",
        "tags" : [
        ]
      },
      {
        "id" : "ac607abc-f97a-4d17-99ad-4e5c3b786da4",
        "parentId" : "fa3a061d-f804-4faa-9521-dfe0ad6eb816",
        "authorId" : "1bd2d65a-7c93-4c22-b408-c7794d037dc5",
        "body" : "Nope. I think it's better that it starts before kubelet. Just making sure there's no other dependency.",
        "createdAt" : "2020-06-27T00:38:53Z",
        "updatedAt" : "2020-07-01T22:08:47Z",
        "lastEditedBy" : "1bd2d65a-7c93-4c22-b408-c7794d037dc5",
        "tags" : [
        ]
      },
      {
        "id" : "d2919c9e-0031-4cf0-9f15-4c6f6a16dfe0",
        "parentId" : "fa3a061d-f804-4faa-9521-dfe0ad6eb816",
        "authorId" : "44594ff0-8fbc-44a7-84f9-654ffd54270f",
        "body" : "sure",
        "createdAt" : "2020-06-29T18:13:42Z",
        "updatedAt" : "2020-07-01T22:08:47Z",
        "lastEditedBy" : "44594ff0-8fbc-44a7-84f9-654ffd54270f",
        "tags" : [
        ]
      }
    ],
    "commit" : "57d0dc540d16a4e72076e10fdf8e0bcaebb9f335",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +138,142 @@  DownloadAndInstall-KubernetesBinaries\n  DownloadAndInstall-CSIProxyBinaries\n  Start-CSIProxy\n  Create-NodePki\n  Create-KubeletKubeconfig"
  },
  {
    "id" : "bac747e9-e26a-4cbb-83f0-2fb09a36b955",
    "prId" : 84538,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/84538#pullrequestreview-330872945",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "81fc2110-0bc4-4d1c-9a16-baa717c73851",
        "parentId" : null,
        "authorId" : "84643be2-004e-4f49-9ab2-b32a1995bad6",
        "body" : "What's the reason for this change?\r\n\r\nOn one hand I suppose this should let the node join the cluster more quickly. On the other hand there could be some delay if a user tries to run a Windows pod immediately after the node is Ready but the pause container hasn't finished pulling yet.",
        "createdAt" : "2019-10-30T17:04:50Z",
        "updatedAt" : "2019-10-30T17:04:50Z",
        "lastEditedBy" : "84643be2-004e-4f49-9ab2-b32a1995bad6",
        "tags" : [
        ]
      },
      {
        "id" : "179f0da7-3501-49ab-8dc4-c15b0bc8c893",
        "parentId" : "81fc2110-0bc4-4d1c-9a16-baa717c73851",
        "authorId" : "093f4806-3f92-4191-a80b-4e6cf3d6ffc0",
        "body" : "it is not needed for kubelet/node to register with the master/control plane. Pull-InfraContainer is a best-effort optimization, so that when a user start a pod, the 'pause' image is likely already present on the node. Moving it to the last would 1) shorten the delay for the node to join the cluster, [so user can submit deployment/pod earlier, user does not need to wait for the node to be ready to submit deployment/pod in theory, but in practice, user may wait/check for node to be ready before deploying anything] 2) no worse than current situation (should be better) in terms of user-perceived node startup time. [we may explore moving it to the first step when making it async/pulling in the background]",
        "createdAt" : "2019-10-30T17:34:02Z",
        "updatedAt" : "2019-10-30T17:34:02Z",
        "lastEditedBy" : "093f4806-3f92-4191-a80b-4e6cf3d6ffc0",
        "tags" : [
        ]
      },
      {
        "id" : "18bd53ad-4e1b-4662-b6c7-50e6e867ea80",
        "parentId" : "81fc2110-0bc4-4d1c-9a16-baa717c73851",
        "authorId" : "84643be2-004e-4f49-9ab2-b32a1995bad6",
        "body" : "Makes sense, thanks for clarifying.",
        "createdAt" : "2019-10-30T17:42:30Z",
        "updatedAt" : "2019-10-30T17:42:30Z",
        "lastEditedBy" : "84643be2-004e-4f49-9ab2-b32a1995bad6",
        "tags" : [
        ]
      },
      {
        "id" : "5bdb4009-4728-44cc-a900-25d58e7bac8f",
        "parentId" : "81fc2110-0bc4-4d1c-9a16-baa717c73851",
        "authorId" : "4e418bc8-21fb-4523-80c1-9c751c193126",
        "body" : "It doesn't seem safe to move this.\r\n\r\nWindows image pull is slow, for docker pulling the pause image can takes >4min, for containerd it is even longer...\r\n\r\nIf the pause image is not prepulled before the node is ready, it is possible that a user will never be able to create a pod.\r\n\r\nThe reason is that in kubelet we set a 4min timeout for pod sandbox start (including pulling the pause image) https://github.com/kubernetes/kubernetes/blob/master/pkg/kubelet/remote/remote_runtime.go#L97.\r\n\r\nIf the pause image is not prepulled, `RunPodSandbox` may timeout every time, abort the ongoing pulling, and try pulling again. If for any reason the pause image pull is longer than 4min, the image pull may be always aborted, thus the pod can't start any more.\r\n\r\nFor Docker, I believe this may happen, and for containerd, because of the slow image pull this breaks the test.",
        "createdAt" : "2019-12-11T05:18:40Z",
        "updatedAt" : "2019-12-11T05:20:14Z",
        "lastEditedBy" : "4e418bc8-21fb-4523-80c1-9c751c193126",
        "tags" : [
        ]
      },
      {
        "id" : "a0b977c2-d517-44f8-bd4a-4d125bed2beb",
        "parentId" : "81fc2110-0bc4-4d1c-9a16-baa717c73851",
        "authorId" : "84643be2-004e-4f49-9ab2-b32a1995bad6",
        "body" : "> If the pause image is not prepulled, RunPodSandbox may timeout every time, abort the ongoing pulling, and try pulling again.\r\n\r\nThis doesn't sound like the right thing to do on Windows. Can/should we change that behavior?",
        "createdAt" : "2019-12-11T21:47:58Z",
        "updatedAt" : "2019-12-11T21:47:58Z",
        "lastEditedBy" : "84643be2-004e-4f49-9ab2-b32a1995bad6",
        "tags" : [
        ]
      },
      {
        "id" : "b9176cd2-f823-4383-8e52-3e2dde753198",
        "parentId" : "81fc2110-0bc4-4d1c-9a16-baa717c73851",
        "authorId" : "093f4806-3f92-4191-a80b-4e6cf3d6ffc0",
        "body" : "chatted offline about it.",
        "createdAt" : "2019-12-11T22:01:39Z",
        "updatedAt" : "2019-12-11T22:01:39Z",
        "lastEditedBy" : "093f4806-3f92-4191-a80b-4e6cf3d6ffc0",
        "tags" : [
        ]
      }
    ],
    "commit" : "6ca8bd41033547bb7f225c7d39343dde885ffe86",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +160,164 @@  Schedule-LogRotation -Pattern '.*\\.log$' -Path ${env:LOGS_DIR} -RepetitionInterval $(New-Timespan -Hour 1) -Config $config\n\n  Pull-InfraContainer\n}\ncatch {"
  },
  {
    "id" : "463909d6-23bf-4576-af35-1c3c13aa7680",
    "prId" : 81300,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/81300#pullrequestreview-274026533",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "394b2912-7f41-431a-ada5-ba2bea42e29f",
        "parentId" : null,
        "authorId" : "84643be2-004e-4f49-9ab2-b32a1995bad6",
        "body" : "I see that this currently looks like https://github.com/kubernetes/kubernetes/blob/master/cluster/gce/windows/common.psm1#L532, but can this just be?:\r\n\r\n```\r\n  return ($KubeEnv.Contains('ENABLE_NODE_LOGGING') -and `\r\n      ($KubeEnv['ENABLE_NODE_LOGGING'] -eq 'true'))\r\n```\r\n\r\nMostly just curious, if you don't want to bother trying it that's fine.",
        "createdAt" : "2019-08-13T01:36:03Z",
        "updatedAt" : "2019-09-04T22:32:43Z",
        "lastEditedBy" : "84643be2-004e-4f49-9ab2-b32a1995bad6",
        "tags" : [
        ]
      }
    ],
    "commit" : "1d2724296727fb4a456d74f7d1a54787030d8416",
    "line" : 18,
    "diffHunk" : "@@ -1,1 +99,103 @@  } elseif ($KubeEnv.Contains('ENABLE_NODE_LOGGING') -and `\n      ($KubeEnv['ENABLE_NODE_LOGGING'] -eq 'true')) {\n    return $true\n  }\n  return $false"
  },
  {
    "id" : "b7d05352-e98d-4f1e-a042-8752b50bf05c",
    "prId" : 81300,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/81300#pullrequestreview-283229495",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "edae2c37-15ac-493d-bb90-44dcd3edc5af",
        "parentId" : null,
        "authorId" : "84643be2-004e-4f49-9ab2-b32a1995bad6",
        "body" : "Could this just be?:\r\n\r\n```\r\n  return ($KubeEnv.Contains('ENABLE_NODE_LOGGING') -and `\r\n     ($KubeEnv['ENABLE_NODE_LOGGING'] -eq 'true'))\r\n```\r\n\r\nI see this is imitating code that we already have; I'm mostly just curious, if you don't want to bother trying this that's fine.",
        "createdAt" : "2019-08-13T01:42:48Z",
        "updatedAt" : "2019-09-04T22:32:43Z",
        "lastEditedBy" : "84643be2-004e-4f49-9ab2-b32a1995bad6",
        "tags" : [
        ]
      },
      {
        "id" : "a806036c-c30a-4012-b4fd-884ca1fd1d81",
        "parentId" : "edae2c37-15ac-493d-bb90-44dcd3edc5af",
        "authorId" : "f56f41d2-ac28-43a4-9ab4-461bf2d2c7ec",
        "body" : "Yeah this is imitating the existing code and thanks for the suggestion! I've added a new kube_env `ENABLE_STACKDRIVER_WINDOWS` as the `ENABLE_NODE_LOGGING` will be deprecated soon. And I just kept them in the if-elseif.",
        "createdAt" : "2019-09-03T20:03:24Z",
        "updatedAt" : "2019-09-04T22:32:43Z",
        "lastEditedBy" : "f56f41d2-ac28-43a4-9ab4-461bf2d2c7ec",
        "tags" : [
        ]
      }
    ],
    "commit" : "1d2724296727fb4a456d74f7d1a54787030d8416",
    "line" : 18,
    "diffHunk" : "@@ -1,1 +99,103 @@  } elseif ($KubeEnv.Contains('ENABLE_NODE_LOGGING') -and `\n      ($KubeEnv['ENABLE_NODE_LOGGING'] -eq 'true')) {\n    return $true\n  }\n  return $false"
  }
]