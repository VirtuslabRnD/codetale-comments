[
  {
    "id" : "983bcf7f-d1f5-4325-9c15-8b5a87d42b51",
    "prId" : 79284,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/79284#pullrequestreview-253140152",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d2a494fa-a976-4716-9ede-80a6e8d6545f",
        "parentId" : null,
        "authorId" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "body" : "if we temp. enable this by default we can even test it  with a presubmit e2e:\r\n`pull-kubernetes-conformance-image-test`\r\n?",
        "createdAt" : "2019-06-22T21:44:19Z",
        "updatedAt" : "2019-07-01T21:26:31Z",
        "lastEditedBy" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "tags" : [
        ]
      },
      {
        "id" : "078f4679-a589-47f8-98b0-2ff321b1322c",
        "parentId" : "d2a494fa-a976-4716-9ede-80a6e8d6545f",
        "authorId" : "73cba353-2317-4305-8981-830b29b34769",
        "body" : "I'm not exactly sure I understand the question; if I push a commit where it is the default (just for testing) it should run fine; the log and junit output is the same.  The problem I'm having right now it seems though is build related; maybe you can help.\r\n\r\nIt seems like `pull-kubernetes-conformance-image-test` is calling into the `test-infra` repo which doesn't build `go-runner` properly so it messes things up I think. I must be missing some part of how to integrate this into the build. The error is below but the test infra code is here (https://github.com/kubernetes/test-infra/blob/master/experiment/kind-conformance-e2e.sh#L26)\r\n\r\n```\r\nW0622 14:50:22.002] cp: cannot stat '/go/src/k8s.io/kubernetes/cluster/images/conformance/../../../_output/dockerized/bin/linux/amd64/go-runner': No such file or directory\r\n...\r\nW0622 14:50:28.225] subprocess.CalledProcessError: Command '('bash', '-c', 'cd ./../../k8s.io/kubernetes && source ./../test-infra/experiment/kind-conformance-e2e.sh')' returned non-zero exit status 2\r\nE0622 14:50:28.230] Command failed\r\n```\r\n\r\nSo I've integrated into the build and as a test target, is there somewhere else I need to update? Or is there a different place just for the dockerized artifacts? Or is this a problem because of a disconnect between test infra and k/k?",
        "createdAt" : "2019-06-23T01:09:08Z",
        "updatedAt" : "2019-07-01T21:26:31Z",
        "lastEditedBy" : "73cba353-2317-4305-8981-830b29b34769",
        "tags" : [
        ]
      },
      {
        "id" : "e5d89f85-2f87-490d-9eb8-e03fc47d0c07",
        "parentId" : "d2a494fa-a976-4716-9ede-80a6e8d6545f",
        "authorId" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "body" : "forgot that our script:\r\nhttps://github.com/kubernetes/test-infra/blob/master/experiment/kind-conformance-e2e.sh#L40\r\nloads an image from GCR and does not build a new image, thus the runner will be absent there.\r\n\r\nso my idea will not work.\r\n\r\n",
        "createdAt" : "2019-06-23T02:41:09Z",
        "updatedAt" : "2019-07-01T21:26:31Z",
        "lastEditedBy" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "tags" : [
        ]
      },
      {
        "id" : "85cb88fd-5d14-471e-9a6f-91a4b2632602",
        "parentId" : "d2a494fa-a976-4716-9ede-80a6e8d6545f",
        "authorId" : "73cba353-2317-4305-8981-830b29b34769",
        "body" : "That's just a `kind load` which is going to load the image you have tagged locally, right? And right above that, it builds this image.\r\n\r\nI think that's the problem I'm having now: It tries to build/load the image but that script is in the `test-infra` repo. @fejta said there isn't a way to update that script at the same time as this PR because they are in different repos; so I feel like I'm in a chicken/egg situation.",
        "createdAt" : "2019-06-23T16:30:14Z",
        "updatedAt" : "2019-07-01T21:26:31Z",
        "lastEditedBy" : "73cba353-2317-4305-8981-830b29b34769",
        "tags" : [
        ]
      }
    ],
    "commit" : "b3f5a086ab40c5810995f5d8829ac68d8dd49ae6",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +39,43 @@# Optional Golang runner alternative to the bash script.\n# Entry provided via env var to simplify invocation. \nif [[ -n ${E2E_USE_GO_RUNNER:-} ]]; then\n    set -x\n    /gorunner"
  },
  {
    "id" : "9cfb34c2-c749-462a-87eb-5b094aea62d5",
    "prId" : 74854,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/74854#pullrequestreview-263247102",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c375fc3f-5aa9-4ffa-afc1-fae0f51437f8",
        "parentId" : null,
        "authorId" : "0c79e151-79e2-4fef-ab72-e16e6286b31d",
        "body" : "This is somewhat naive. It means any conformance tests marked with `[Serial]` won't be run, which reduces the value of the conformance suite. That being said, I have noticed that the number of such tests has significantly reduced (if i remember correctly, in kubernetes 1.11.x it was around 7).",
        "createdAt" : "2019-07-17T18:33:21Z",
        "updatedAt" : "2019-07-17T18:33:21Z",
        "lastEditedBy" : "0c79e151-79e2-4fef-ab72-e16e6286b31d",
        "tags" : [
        ]
      },
      {
        "id" : "27325bd9-3d59-4eeb-bc7c-4f4f77aa10b7",
        "parentId" : "c375fc3f-5aa9-4ffa-afc1-fae0f51437f8",
        "authorId" : "46e1ba13-482b-4bcd-8fb1-be821bac3b04",
        "body" : "You cannot safely run `[Serial]` tagged tests in parallel, that's what the tag means. ginkgo nodes must be zero to run these.",
        "createdAt" : "2019-07-17T18:36:16Z",
        "updatedAt" : "2019-07-17T18:36:16Z",
        "lastEditedBy" : "46e1ba13-482b-4bcd-8fb1-be821bac3b04",
        "tags" : [
        ]
      },
      {
        "id" : "b1062cdd-b8d1-4957-a941-78358492659d",
        "parentId" : "c375fc3f-5aa9-4ffa-afc1-fae0f51437f8",
        "authorId" : "0c79e151-79e2-4fef-ab72-e16e6286b31d",
        "body" : "I think \"naive\" was probably a bad choice of words, I was actually thinking of \"misleading\". It's misleading because it allows users to think they have run all conformance tests, when in reality there may be some `[Serial]` tests that haven't been run. Maybe I'm just overreacting though. Anyway, previously for CI purposes I would run `sonobuoy` twice -- once for all the tests that could be run in parallel, and again for all the tests that had to be run serially.",
        "createdAt" : "2019-07-17T18:42:38Z",
        "updatedAt" : "2019-07-17T18:42:38Z",
        "lastEditedBy" : "0c79e151-79e2-4fef-ab72-e16e6286b31d",
        "tags" : [
        ]
      },
      {
        "id" : "012faeb4-c793-413b-98ed-e9d955dd93e1",
        "parentId" : "c375fc3f-5aa9-4ffa-afc1-fae0f51437f8",
        "authorId" : "46e1ba13-482b-4bcd-8fb1-be821bac3b04",
        "body" : "For submitting conformance results the standard is one run in non-serial mode / a single ginkgo node with a specific config, but doing something like this is definitely very useful for CI results. :+1: ",
        "createdAt" : "2019-07-17T18:44:56Z",
        "updatedAt" : "2019-07-17T18:44:56Z",
        "lastEditedBy" : "46e1ba13-482b-4bcd-8fb1-be821bac3b04",
        "tags" : [
        ]
      }
    ],
    "commit" : "fe2301f17d4664b49216f6f3a42c21dec6c15f9b",
    "line" : 31,
    "diffHunk" : "@@ -1,1 +50,54 @@        ginkgo_args+=(\"--p\")\n        # Skip serial tests if parallel mode is enabled.\n        E2E_SKIP=\"\\\\[Serial\\\\]|${E2E_SKIP}\" ;;\nesac\n"
  },
  {
    "id" : "660444ea-5dac-42b1-9bde-f71db6eac4e0",
    "prId" : 74854,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/74854#pullrequestreview-263243078",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5ef3c0ef-48d8-4323-9691-f88f740c1e68",
        "parentId" : null,
        "authorId" : "0c79e151-79e2-4fef-ab72-e16e6286b31d",
        "body" : "I suspect this newfangled way of constructing the `ginkgo` command line has consequences for how special characters in `E2E_SKIP` AND `E2E_FOCUS` need to be escaped since the same values for these variables that worked on older kubernetes versions (using the old heptio conformance image) cause my conformance tests to run 0 tests total. This combined with the changes in this PR to the way `E2E_PARALLEL` is handled was sufficient to fool me into thinking that my tests were passing since `sonobuoy e2e <tarball>` only shows the number of failed tests, nothing about the total number of tests run.",
        "createdAt" : "2019-07-17T18:37:31Z",
        "updatedAt" : "2019-07-17T18:37:32Z",
        "lastEditedBy" : "0c79e151-79e2-4fef-ab72-e16e6286b31d",
        "tags" : [
        ]
      }
    ],
    "commit" : "fe2301f17d4664b49216f6f3a42c21dec6c15f9b",
    "line" : 43,
    "diffHunk" : "@@ -1,1 +60,64 @@\nset -x\n/usr/local/bin/ginkgo \"${ginkgo_args[@]}\" /usr/local/bin/e2e.test -- --disable-log-dump --repo-root=/kubernetes --provider=\"${E2E_PROVIDER}\" --report-dir=\"${RESULTS_DIR}\" --kubeconfig=\"${KUBECONFIG}\" | tee \"${RESULTS_DIR}\"/e2e.log &\nset +x\n# $! is the pid of tee, not ginkgo"
  },
  {
    "id" : "8d93e348-d82b-41c4-860e-04695898e9d7",
    "prId" : 69368,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/69368#pullrequestreview-164073050",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e30d7ae0-f08b-4c31-b484-742cb0301434",
        "parentId" : null,
        "authorId" : "719d0e19-fcef-4b47-afac-404318b9514f",
        "body" : "should this script have `errexit`, `nounset`, and `pipefail` per usual?",
        "createdAt" : "2018-10-11T23:27:51Z",
        "updatedAt" : "2018-10-12T19:33:50Z",
        "lastEditedBy" : "719d0e19-fcef-4b47-afac-404318b9514f",
        "tags" : [
        ]
      },
      {
        "id" : "43298f60-c31d-4a23-8979-ab2247211ef0",
        "parentId" : "e30d7ae0-f08b-4c31-b484-742cb0301434",
        "authorId" : "bd04f755-e62f-45fb-8771-4cc2b5db49d4",
        "body" : "fixing",
        "createdAt" : "2018-10-12T01:41:08Z",
        "updatedAt" : "2018-10-12T19:33:50Z",
        "lastEditedBy" : "bd04f755-e62f-45fb-8771-4cc2b5db49d4",
        "tags" : [
        ]
      }
    ],
    "commit" : "6830bad2a6d082bf40e1fbb8026bf3018ccc0707",
    "line" : 1,
    "diffHunk" : "@@ -1,1 +-1,3 @@#!/bin/bash\n# Copyright 2018 The Kubernetes Authors.\n#"
  },
  {
    "id" : "6271963c-4554-46fd-9b85-2834be5b5671",
    "prId" : 69368,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/69368#pullrequestreview-164384764",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "94a8ffc7-f48c-40a4-9149-47afbe2e95e5",
        "parentId" : null,
        "authorId" : "719d0e19-fcef-4b47-afac-404318b9514f",
        "body" : "`E2E_SKIP` isn't defined by default - should it be?",
        "createdAt" : "2018-10-12T18:47:04Z",
        "updatedAt" : "2018-10-12T19:33:50Z",
        "lastEditedBy" : "719d0e19-fcef-4b47-afac-404318b9514f",
        "tags" : [
        ]
      },
      {
        "id" : "c669d1c6-8508-4b97-90af-6cb45ef1f7b0",
        "parentId" : "94a8ffc7-f48c-40a4-9149-47afbe2e95e5",
        "authorId" : "bd04f755-e62f-45fb-8771-4cc2b5db49d4",
        "body" : "Fixing",
        "createdAt" : "2018-10-12T19:01:14Z",
        "updatedAt" : "2018-10-12T19:33:50Z",
        "lastEditedBy" : "bd04f755-e62f-45fb-8771-4cc2b5db49d4",
        "tags" : [
        ]
      },
      {
        "id" : "dfb9cb06-80a7-4ce1-88af-290b64226f15",
        "parentId" : "94a8ffc7-f48c-40a4-9149-47afbe2e95e5",
        "authorId" : "f81960f6-a033-4403-bebf-c8ebb484e444",
        "body" : "It doesn't need to be and it's defined in the dockerfile. ",
        "createdAt" : "2018-10-12T19:43:05Z",
        "updatedAt" : "2018-10-12T19:43:06Z",
        "lastEditedBy" : "f81960f6-a033-4403-bebf-c8ebb484e444",
        "tags" : [
        ]
      },
      {
        "id" : "cfb0596a-2128-4f1c-8054-1e4af3d87432",
        "parentId" : "94a8ffc7-f48c-40a4-9149-47afbe2e95e5",
        "authorId" : "bd04f755-e62f-45fb-8771-4cc2b5db49d4",
        "body" : "@timothysc i had removed it in one of the edits. yes, should be good with latest changes",
        "createdAt" : "2018-10-12T19:46:10Z",
        "updatedAt" : "2018-10-12T19:46:11Z",
        "lastEditedBy" : "bd04f755-e62f-45fb-8771-4cc2b5db49d4",
        "tags" : [
        ]
      }
    ],
    "commit" : "6830bad2a6d082bf40e1fbb8026bf3018ccc0707",
    "line" : 44,
    "diffHunk" : "@@ -1,1 +42,46 @@ginkgo_args=(\n    \"--focus=${E2E_FOCUS}\"\n    \"--skip=${E2E_SKIP}\"\n    \"--noColor=true\"\n)"
  },
  {
    "id" : "9e28d848-bd6b-4478-b99b-7696a42b63f0",
    "prId" : 69368,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/69368#pullrequestreview-164384890",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f8c01b5b-bf05-4463-b276-3f268a6b4004",
        "parentId" : null,
        "authorId" : "719d0e19-fcef-4b47-afac-404318b9514f",
        "body" : "similarly for `KUBECONFIG`",
        "createdAt" : "2018-10-12T18:47:41Z",
        "updatedAt" : "2018-10-12T19:33:50Z",
        "lastEditedBy" : "719d0e19-fcef-4b47-afac-404318b9514f",
        "tags" : [
        ]
      },
      {
        "id" : "01ce3a07-1267-4157-a9d6-a238cc1f1299",
        "parentId" : "f8c01b5b-bf05-4463-b276-3f268a6b4004",
        "authorId" : "bd04f755-e62f-45fb-8771-4cc2b5db49d4",
        "body" : "Done",
        "createdAt" : "2018-10-12T19:03:13Z",
        "updatedAt" : "2018-10-12T19:33:50Z",
        "lastEditedBy" : "bd04f755-e62f-45fb-8771-4cc2b5db49d4",
        "tags" : [
        ]
      },
      {
        "id" : "99a67e04-7cc2-4755-bc61-bb1b646a4c65",
        "parentId" : "f8c01b5b-bf05-4463-b276-3f268a6b4004",
        "authorId" : "f81960f6-a033-4403-bebf-c8ebb484e444",
        "body" : "same answer.",
        "createdAt" : "2018-10-12T19:43:35Z",
        "updatedAt" : "2018-10-12T19:43:35Z",
        "lastEditedBy" : "f81960f6-a033-4403-bebf-c8ebb484e444",
        "tags" : [
        ]
      },
      {
        "id" : "2457a68e-5796-45b7-a3b8-221eae85773e",
        "parentId" : "f8c01b5b-bf05-4463-b276-3f268a6b4004",
        "authorId" : "bd04f755-e62f-45fb-8771-4cc2b5db49d4",
        "body" : "y i added it after @ixdy's nudge",
        "createdAt" : "2018-10-12T19:46:32Z",
        "updatedAt" : "2018-10-12T19:46:32Z",
        "lastEditedBy" : "bd04f755-e62f-45fb-8771-4cc2b5db49d4",
        "tags" : [
        ]
      }
    ],
    "commit" : "6830bad2a6d082bf40e1fbb8026bf3018ccc0707",
    "line" : 53,
    "diffHunk" : "@@ -1,1 +51,55 @@esac\n\necho \"/usr/local/bin/ginkgo ${ginkgo_args[@]} /usr/local/bin/e2e.test -- --disable-log-dump --repo-root=/kubernetes --provider=\\\"${E2E_PROVIDER}\\\" --report-dir=\\\"${RESULTS_DIR}\\\" --kubeconfig=\\\"${KUBECONFIG}\\\"\"\n/usr/local/bin/ginkgo \"${ginkgo_args[@]}\" /usr/local/bin/e2e.test -- --disable-log-dump --repo-root=/kubernetes --provider=\"${E2E_PROVIDER}\" --report-dir=\"${RESULTS_DIR}\" --kubeconfig=\"${KUBECONFIG}\" | tee ${RESULTS_DIR}/e2e.log &\n# $! is the pid of tee, not ginkgo"
  }
]