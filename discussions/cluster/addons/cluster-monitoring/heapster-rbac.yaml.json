[
  {
    "id" : "28b104eb-ac82-4897-8bfa-7d7330a9d80f",
    "prId" : 46750,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/46750#pullrequestreview-41669266",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2c4f3c70-a450-4c0f-9d8e-7b579e5a6959",
        "parentId" : null,
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "heapster only gets pods in the kube-system namespace?",
        "createdAt" : "2017-06-01T05:01:18Z",
        "updatedAt" : "2017-06-06T16:26:47Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "2c99ea99-1040-4a08-8f85-556aebeb450d",
        "parentId" : "2c4f3c70-a450-4c0f-9d8e-7b579e5a6959",
        "authorId" : "3cd3a661-80f4-45b3-bae0-5a78fbaedc59",
        "body" : "I saw the \"pod_nanny\" (one of heapster's containers) getting the heapster pod from the API.",
        "createdAt" : "2017-06-01T05:52:48Z",
        "updatedAt" : "2017-06-06T16:26:47Z",
        "lastEditedBy" : "3cd3a661-80f4-45b3-bae0-5a78fbaedc59",
        "tags" : [
        ]
      },
      {
        "id" : "3c6532da-e6a4-442f-b650-b0ca3da8d1dd",
        "parentId" : "2c4f3c70-a450-4c0f-9d8e-7b579e5a6959",
        "authorId" : "c2b5c827-efcd-438f-8db5-52d917b1cde9",
        "body" : "the sidecar dynamically resizes the heapster deployment, so it'll also need to do a put/patch on deployments to resize itself. \r\n\r\n@Q-Lee ",
        "createdAt" : "2017-06-01T06:59:46Z",
        "updatedAt" : "2017-06-06T16:26:47Z",
        "lastEditedBy" : "c2b5c827-efcd-438f-8db5-52d917b1cde9",
        "tags" : [
        ]
      },
      {
        "id" : "d83760ea-6b46-4b83-83d6-34374eac1023",
        "parentId" : "2c4f3c70-a450-4c0f-9d8e-7b579e5a6959",
        "authorId" : "6c7e5fb3-9a32-484a-be21-c70b4d00de52",
        "body" : "Ya, you need write on deployments.",
        "createdAt" : "2017-06-01T07:59:45Z",
        "updatedAt" : "2017-06-06T16:26:47Z",
        "lastEditedBy" : "6c7e5fb3-9a32-484a-be21-c70b4d00de52",
        "tags" : [
        ]
      },
      {
        "id" : "e53db7ff-1a32-464c-9750-22bd01ffe909",
        "parentId" : "2c4f3c70-a450-4c0f-9d8e-7b579e5a6959",
        "authorId" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "body" : "> the sidecar dynamically resizes the heapster deployment, so it'll also need to do a put/patch on deployments to resize itself.\r\n\r\nThis seems like a questionable power to grant to a pod.  If its given the power to modify its own deployment, then a compromise of a particular pod cannot be resolved by simply deleting the pod since it has been allowed to modify its own config.\r\n\r\nIn addition, by doing it inside of the kube-system namespace, if you compromise the heapster pod, you will have compromised every deployment, rs, rc, secret, etc in the cluster because it gained the power to change its service account which gave it the power to mount any SA token in the `kube-system` namespace where controller SAs are located.\r\n",
        "createdAt" : "2017-06-01T12:00:58Z",
        "updatedAt" : "2017-06-06T16:26:47Z",
        "lastEditedBy" : "fa477146-9a47-4754-b38c-de8062e65e13",
        "tags" : [
        ]
      },
      {
        "id" : "cf4a6839-9d56-479a-8a0f-cb38de6e051a",
        "parentId" : "2c4f3c70-a450-4c0f-9d8e-7b579e5a6959",
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "> This seems like a questionable power to grant to a pod\r\n\r\nAgree, and since not all installations run the pod nanny, it shouldn't be part of the standard heapster role.",
        "createdAt" : "2017-06-01T13:43:19Z",
        "updatedAt" : "2017-06-06T16:26:47Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "fd27b258-35df-42b0-8974-2cb806291803",
        "parentId" : "2c4f3c70-a450-4c0f-9d8e-7b579e5a6959",
        "authorId" : "6c7e5fb3-9a32-484a-be21-c70b4d00de52",
        "body" : "It would be nice if we could assign service accounts to individual pods. I wonder if there's a work around.\r\n\r\nCould we create a \"heapster-nanny\" role, bind it to a service account, and mount the service account's secret where SAs are usually mounted?",
        "createdAt" : "2017-06-02T00:12:13Z",
        "updatedAt" : "2017-06-06T16:26:47Z",
        "lastEditedBy" : "6c7e5fb3-9a32-484a-be21-c70b4d00de52",
        "tags" : [
        ]
      },
      {
        "id" : "fb4bbb17-37a9-4511-b458-175c1ee4b0b8",
        "parentId" : "2c4f3c70-a450-4c0f-9d8e-7b579e5a6959",
        "authorId" : "3cd3a661-80f4-45b3-bae0-5a78fbaedc59",
        "body" : "[All 5](https://github.com/kubernetes/kubernetes/blob/master/cluster/gce/gci/configure-helper.sh#L1355-L1359) of the supported CLUSTER_MONITORING setups have the pod-nanny running with heapster, and we don't create this role/binding unless one of those is selected.\r\n\r\nI renamed that role to system:pod-nanny.",
        "createdAt" : "2017-06-02T00:14:54Z",
        "updatedAt" : "2017-06-06T16:26:47Z",
        "lastEditedBy" : "3cd3a661-80f4-45b3-bae0-5a78fbaedc59",
        "tags" : [
        ]
      },
      {
        "id" : "220282bc-5851-42a2-9e26-3e4ec6698d7c",
        "parentId" : "2c4f3c70-a450-4c0f-9d8e-7b579e5a6959",
        "authorId" : "3cd3a661-80f4-45b3-bae0-5a78fbaedc59",
        "body" : "I agree that it is not optimal, but it's better than what currently exists.",
        "createdAt" : "2017-06-02T00:22:43Z",
        "updatedAt" : "2017-06-06T16:26:47Z",
        "lastEditedBy" : "3cd3a661-80f4-45b3-bae0-5a78fbaedc59",
        "tags" : [
        ]
      }
    ],
    "commit" : "eba50dfeb60e45382a799f403cad52b3390b2471",
    "line" : 33,
    "diffHunk" : "@@ -1,1 +31,35 @@  - pods\n  verbs:\n  - get\n- apiGroups:\n  - \"extensions\""
  }
]