[
  {
    "id" : "1ace8d62-bf7d-4bce-bbfd-353dd9ce282d",
    "prId" : 4746,
    "prUrl" : "https://github.com/apache/kafka/pull/4746#pullrequestreview-105946071",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e2fb1afe-5303-41c2-aa67-9d5b6026e0aa",
        "parentId" : null,
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "Hmm... if we hard-code the version here how it could be extended in newer versions with multiple possible values of `UPGRADE_KAFKA_STREAMS_TEST_VERSION`?",
        "createdAt" : "2018-03-21T23:19:08Z",
        "updatedAt" : "2018-03-27T01:03:28Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      },
      {
        "id" : "eb72d220-11c4-4445-8f91-f865ccee347d",
        "parentId" : "e2fb1afe-5303-41c2-aa67-9d5b6026e0aa",
        "authorId" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "body" : "Yes. In newer version we extend this and replace hard-coded `0100` with `$UPGRADE_KAFKA_STREAMS_TEST_VERSION` -- did just omit it here and fix when porting this PR to 0.10.2 branch",
        "createdAt" : "2018-03-21T23:36:52Z",
        "updatedAt" : "2018-03-27T01:03:28Z",
        "lastEditedBy" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "tags" : [
        ]
      }
    ],
    "commit" : "fe469ed34fb4f0d1094a542e2b2dd7d27cedd2e2",
    "line" : 46,
    "diffHunk" : "@@ -1,1 +107,111 @@  done\nelse\n  for file in \"$base_dir\"/streams/upgrade-system-tests-0100/build/libs/kafka-streams-upgrade-system-tests*.jar;\n  do\n    if should_include_file \"$file\"; then"
  },
  {
    "id" : "ab0292ad-f161-41ca-96c2-3420b8571893",
    "prId" : 4779,
    "prUrl" : "https://github.com/apache/kafka/pull/4779#pullrequestreview-108434918",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8149cca2-a758-46e8-beef-be1a12f3f119",
        "parentId" : null,
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "Just for my own education: why we want to only include example jars if it is not for upgrade tests?",
        "createdAt" : "2018-03-28T04:26:30Z",
        "updatedAt" : "2018-04-06T20:42:09Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      },
      {
        "id" : "e9ff8184-bf0d-482a-bfb4-dc7bac82cec4",
        "parentId" : "8149cca2-a758-46e8-beef-be1a12f3f119",
        "authorId" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "body" : "We don't need them for upgrade test -- it's just to reduce CLASSPATH to the minimum for this case.",
        "createdAt" : "2018-03-30T20:58:00Z",
        "updatedAt" : "2018-04-06T20:42:09Z",
        "lastEditedBy" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "tags" : [
        ]
      }
    ],
    "commit" : "5d3ab018050d173f706fda430415498072ccc6c1",
    "line" : 38,
    "diffHunk" : "@@ -1,1 +95,99 @@done\n\nif [ -z \"$UPGRADE_KAFKA_STREAMS_TEST_VERSION\" ]; then\n  for file in \"$base_dir\"/streams/examples/build/libs/kafka-streams-examples*.jar;\n  do"
  },
  {
    "id" : "24a37bc3-7e68-4882-afeb-284225bd98aa",
    "prId" : 5605,
    "prUrl" : "https://github.com/apache/kafka/pull/5605#pullrequestreview-152960922",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "19478aaa-a188-4230-98dd-d9166322ce25",
        "parentId" : null,
        "authorId" : "4c968502-bb3d-46ee-8719-0c0bdbc6242f",
        "body" : "This change is required so associated `upgrade-system-tests-XX` module is first in the classpath and the updated `StreamsUpgradeTest` for the specific version is run by the upgrade/downgrade tests",
        "createdAt" : "2018-09-03T20:21:26Z",
        "updatedAt" : "2018-09-13T16:35:40Z",
        "lastEditedBy" : "4c968502-bb3d-46ee-8719-0c0bdbc6242f",
        "tags" : [
        ]
      },
      {
        "id" : "a0674cb3-6e68-4fd5-abad-62fa8665af18",
        "parentId" : "19478aaa-a188-4230-98dd-d9166322ce25",
        "authorId" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "body" : "Cannot follow. Can you elaborate? Also, why was this not an issue in the past?",
        "createdAt" : "2018-09-05T18:53:31Z",
        "updatedAt" : "2018-09-13T16:35:40Z",
        "lastEditedBy" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "tags" : [
        ]
      },
      {
        "id" : "07ac278d-3edd-4dd2-bfd3-ffd563ab89ea",
        "parentId" : "19478aaa-a188-4230-98dd-d9166322ce25",
        "authorId" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "body" : "Hmm, now that I think about this more, if memory serves, this is not a reliable way to ensure the right class gets loaded, since the classloader spec specifically leaves undefined how a class should be chosen when multiple are available.\r\n\r\nMaybe we should just give the classes unique names instead?",
        "createdAt" : "2018-09-05T22:11:41Z",
        "updatedAt" : "2018-09-13T16:35:40Z",
        "lastEditedBy" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "tags" : [
        ]
      },
      {
        "id" : "e97ecf7f-c8eb-4b41-8cad-09df0c6ddc56",
        "parentId" : "19478aaa-a188-4230-98dd-d9166322ce25",
        "authorId" : "4c968502-bb3d-46ee-8719-0c0bdbc6242f",
        "body" : "That's true extension classes (https://docs.oracle.com/javase/8/docs/technotes/tools/findingclasses.html#extclass)  but for user classes, the first one found on the classpath is what is used",
        "createdAt" : "2018-09-06T00:32:00Z",
        "updatedAt" : "2018-09-13T16:35:40Z",
        "lastEditedBy" : "4c968502-bb3d-46ee-8719-0c0bdbc6242f",
        "tags" : [
        ]
      },
      {
        "id" : "f584f19b-fa49-4202-afb5-088a692749f3",
        "parentId" : "19478aaa-a188-4230-98dd-d9166322ce25",
        "authorId" : "4c968502-bb3d-46ee-8719-0c0bdbc6242f",
        "body" : ">Cannot follow. Can you elaborate? Also, why was this not an issue in the past?\r\n\r\nWhen searching for classes on the classpath, if multiple classes with the same name exist on the classpath, the first one found wins.  This was causing the failures of the test, as it was using the `StreamsUpgradeTest` found in trunk.\r\n\r\nFor the `1.1.1` upgrade the test is using the `StreamsUpgradeTest` in trunk and not the `upgrade-system-tests-11` module and failing due changes how the test is loaded.  It wasn't an issue before because we were specifying those versions.  The `StreamsUpgradeTest` in the `upgrade-system-tests` expects different arguments (kafka bootstrap servers string and a properties file name).\r\n\r\nI made the changes to the other `kafka-run-class` assuming the same problem would occur as it was the same situation.",
        "createdAt" : "2018-09-06T00:38:35Z",
        "updatedAt" : "2018-09-13T16:35:40Z",
        "lastEditedBy" : "4c968502-bb3d-46ee-8719-0c0bdbc6242f",
        "tags" : [
        ]
      },
      {
        "id" : "63c723ec-0104-484d-9a9a-ce4fe2e71ed0",
        "parentId" : "19478aaa-a188-4230-98dd-d9166322ce25",
        "authorId" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "body" : "Thanks for the reference. It might be a failure to read, but I couldn't find where it specifies that it searches the classpath in order. Only that it searches jar manifests in order.\r\n\r\nIt seems plausible that the file classloader does actually traverse the classpath in order, but it still looks like it's not guaranteed, since it's not in the spec.\r\n\r\nIt may not be a huge deal, since the only impact of loading the wrong class is a flaky test, which we can easily just fix again later on.",
        "createdAt" : "2018-09-06T14:33:38Z",
        "updatedAt" : "2018-09-13T16:35:40Z",
        "lastEditedBy" : "f84c555e-0e5d-4773-b994-4121b6b8dada",
        "tags" : [
        ]
      }
    ],
    "commit" : "16e7a0147fd58b9c3c876902b1fef6fae6638fad",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +108,112 @@  do\n    if should_include_file \"$file\"; then\n      CLASSPATH=\"$file\":\"$CLASSPATH\"\n    fi\n  done"
  },
  {
    "id" : "30dbc638-c7f6-4890-9932-d21ad36961ec",
    "prId" : 5607,
    "prUrl" : "https://github.com/apache/kafka/pull/5607#pullrequestreview-153031348",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "4e8ecff8-1833-4b8b-b99e-0c293305329c",
        "parentId" : null,
        "authorId" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "body" : "why this?",
        "createdAt" : "2018-09-05T17:43:29Z",
        "updatedAt" : "2018-09-05T17:44:39Z",
        "lastEditedBy" : "9baadc38-cd41-4762-be0c-791258ced78c",
        "tags" : [
        ]
      },
      {
        "id" : "78da960f-e55a-4c12-a778-be44d5ac60d9",
        "parentId" : "4e8ecff8-1833-4b8b-b99e-0c293305329c",
        "authorId" : "4c968502-bb3d-46ee-8719-0c0bdbc6242f",
        "body" : "For the same reason in #5605, in enabling the upgrade tests the trunk version of `StreamsUpgradeTest` was executed over the version in `upgrade-system-test` modules. As for why it wasn't a problem before, I can't say.",
        "createdAt" : "2018-09-06T17:08:48Z",
        "updatedAt" : "2018-09-06T17:08:48Z",
        "lastEditedBy" : "4c968502-bb3d-46ee-8719-0c0bdbc6242f",
        "tags" : [
        ]
      }
    ],
    "commit" : "a5754e1059ea7fcb45828276652ab0e88e3161b4",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +112,116 @@  do\n    if should_include_file \"$file\"; then\n      CLASSPATH=\"$file\":\"$CLASSPATH\"\n    fi\n  done"
  }
]