[
  {
    "id" : "fa61d5c8-f991-4799-9c42-42b63d0248e3",
    "prId" : 64773,
    "prUrl" : "https://github.com/flutter/flutter/pull/64773#pullrequestreview-477928286",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9d2b0207-a68e-4cad-ad33-b1b36805116c",
        "parentId" : null,
        "authorId" : "7ae842f7-1029-4528-8bf6-8472584744ed",
        "body" : "so `exit $LASTEXITCODE` is setting `%ERRORLEVEL%`?",
        "createdAt" : "2020-08-28T17:21:51Z",
        "updatedAt" : "2020-08-31T16:02:27Z",
        "lastEditedBy" : "7ae842f7-1029-4528-8bf6-8472584744ed",
        "tags" : [
        ]
      },
      {
        "id" : "61f68177-0149-4de5-8663-b243987f7716",
        "parentId" : "9d2b0207-a68e-4cad-ad33-b1b36805116c",
        "authorId" : "e73873df-c6ef-4dd5-ad17-dc7a574dcf0b",
        "body" : "Yes, by default when you run powershell with -Command, all non-zero exit codes are translated into `1`.  This LASTEXITCODE trick allows me to set the exit code to the value from the command, which I set to 2 specifically for the case where the version is incorrect.",
        "createdAt" : "2020-08-28T17:24:54Z",
        "updatedAt" : "2020-08-31T16:02:27Z",
        "lastEditedBy" : "e73873df-c6ef-4dd5-ad17-dc7a574dcf0b",
        "tags" : [
        ]
      },
      {
        "id" : "df1595a2-72ce-4e80-aec8-86c636f0e1eb",
        "parentId" : "9d2b0207-a68e-4cad-ad33-b1b36805116c",
        "authorId" : "7ae842f7-1029-4528-8bf6-8472584744ed",
        "body" : "Could you add a comment, just because I know I won't remember that? Otherwise, LGTM.",
        "createdAt" : "2020-08-28T17:39:39Z",
        "updatedAt" : "2020-08-31T16:02:27Z",
        "lastEditedBy" : "7ae842f7-1029-4528-8bf6-8472584744ed",
        "tags" : [
        ]
      },
      {
        "id" : "7e615239-8b55-4ed5-9c72-6d7e83958130",
        "parentId" : "9d2b0207-a68e-4cad-ad33-b1b36805116c",
        "authorId" : "e73873df-c6ef-4dd5-ad17-dc7a574dcf0b",
        "body" : "Added more details and combined the two comments",
        "createdAt" : "2020-08-28T18:04:48Z",
        "updatedAt" : "2020-08-31T16:02:27Z",
        "lastEditedBy" : "e73873df-c6ef-4dd5-ad17-dc7a574dcf0b",
        "tags" : [
        ]
      }
    ],
    "commit" : "4c4208cfb36de6b18e26496a6c6916c4e1c2d081",
    "line" : 8,
    "diffHunk" : "@@ -1,1 +96,100 @@    REM into 1. The exit code 2 is used to detect the case where the major version is incorrect and there should be\n    REM no subsequent retries.\n    %powershell_executable% -ExecutionPolicy Bypass -Command \"Unblock-File -Path '%update_dart_bin%'; & '%update_dart_bin%'; exit $LASTEXITCODE;\"\n    IF \"%ERRORLEVEL%\" EQU \"2\" (\n      EXIT 1"
  },
  {
    "id" : "049498ee-29cc-48d2-a016-3d6967e5a5a6",
    "prId" : 64773,
    "prUrl" : "https://github.com/flutter/flutter/pull/64773#pullrequestreview-478057820",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "cf98f178-80f7-4725-96cf-c88b4c5534d8",
        "parentId" : null,
        "authorId" : "d61ab95a-0bf0-4571-9098-19991dd821ca",
        "body" : "I _think_ this only exits you out of the subroutine and then actually not sure what it executes next (would it retry the subroutine again? That wouldn't make much sense since this error is unreoverable.). I would have expected this to set `exit_code` and then jump to `: final_exit`?",
        "createdAt" : "2020-08-28T21:18:12Z",
        "updatedAt" : "2020-08-31T16:02:27Z",
        "lastEditedBy" : "d61ab95a-0bf0-4571-9098-19991dd821ca",
        "tags" : [
        ]
      },
      {
        "id" : "e58d4a87-3f7e-4639-8c68-6580653fa1e9",
        "parentId" : "cf98f178-80f7-4725-96cf-c88b4c5534d8",
        "authorId" : "e73873df-c6ef-4dd5-ad17-dc7a574dcf0b",
        "body" : "/B is subroutine only - you can test this locally by removing the condition for the pwsh version detection, but it will immediately exit.",
        "createdAt" : "2020-08-28T22:30:09Z",
        "updatedAt" : "2020-08-31T16:02:27Z",
        "lastEditedBy" : "e73873df-c6ef-4dd5-ad17-dc7a574dcf0b",
        "tags" : [
        ]
      },
      {
        "id" : "52b3f804-4be8-48fc-9579-377a6d3b33ec",
        "parentId" : "cf98f178-80f7-4725-96cf-c88b4c5534d8",
        "authorId" : "d61ab95a-0bf0-4571-9098-19991dd821ca",
        "body" : "I wonder why we do the 'final_exit' dance below then... But if you tried this and it works: LGTM",
        "createdAt" : "2020-08-28T22:34:10Z",
        "updatedAt" : "2020-08-31T16:02:27Z",
        "lastEditedBy" : "d61ab95a-0bf0-4571-9098-19991dd821ca",
        "tags" : [
        ]
      }
    ],
    "commit" : "4c4208cfb36de6b18e26496a6c6916c4e1c2d081",
    "line" : 10,
    "diffHunk" : "@@ -1,1 +98,102 @@    %powershell_executable% -ExecutionPolicy Bypass -Command \"Unblock-File -Path '%update_dart_bin%'; & '%update_dart_bin%'; exit $LASTEXITCODE;\"\n    IF \"%ERRORLEVEL%\" EQU \"2\" (\n      EXIT 1\n    )\n    IF \"%ERRORLEVEL%\" NEQ \"0\" ("
  }
]