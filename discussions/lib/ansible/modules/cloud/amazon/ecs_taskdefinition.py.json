[
  {
    "id" : "3fd97eae-e59a-4e57-81c8-9e79a8a62604",
    "prId" : 20561,
    "prUrl" : "https://github.com/ansible/ansible/pull/20561#pullrequestreview-18026673",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7a6c6e62-70c0-4e79-88c7-cfab61bd357d",
        "parentId" : null,
        "authorId" : "827fe88a-e16d-4f84-ab3a-66404851ba6c",
        "body" : "wouldn't this still fail if `existing_definitions_in_family = []` ?\r\nI think it'd be safer to keep it as `(not existing_definitions_in_family or len(existing_definitions_in_family) == 0) and revision != 1`  for the `if` and \r\n\r\n`existing_definitions_in_family and len(existing_definitions_in_family)>0 and ...` for the `elif` condition",
        "createdAt" : "2017-01-23T19:07:44Z",
        "updatedAt" : "2017-01-23T19:09:01Z",
        "lastEditedBy" : "827fe88a-e16d-4f84-ab3a-66404851ba6c",
        "tags" : [
        ]
      },
      {
        "id" : "37733601-13aa-4769-a9bf-be00f17329c8",
        "parentId" : "7a6c6e62-70c0-4e79-88c7-cfab61bd357d",
        "authorId" : "2ab05ff6-d3ea-4ed2-9e90-40861dc60270",
        "body" : "Problem is access to last element of empty array ```existing_definitions_in_family[-1]```. Array truthiness check ensures array is not empty:\r\n```\r\nIn [1]: bool([])\r\nOut[1]: False\r\n\r\nIn [2]: bool([1])\r\nOut[2]: True\r\n```",
        "createdAt" : "2017-01-23T19:18:13Z",
        "updatedAt" : "2017-01-23T19:18:13Z",
        "lastEditedBy" : "2ab05ff6-d3ea-4ed2-9e90-40861dc60270",
        "tags" : [
        ]
      },
      {
        "id" : "4955d083-a269-4d25-889f-8aeb3cfa3e7d",
        "parentId" : "7a6c6e62-70c0-4e79-88c7-cfab61bd357d",
        "authorId" : "827fe88a-e16d-4f84-ab3a-66404851ba6c",
        "body" : "I just learned something :) looks good !",
        "createdAt" : "2017-01-23T21:13:51Z",
        "updatedAt" : "2017-01-23T21:13:51Z",
        "lastEditedBy" : "827fe88a-e16d-4f84-ab3a-66404851ba6c",
        "tags" : [
        ]
      },
      {
        "id" : "7a7674d8-35e4-4ccb-a0e6-93b1e08e7293",
        "parentId" : "7a6c6e62-70c0-4e79-88c7-cfab61bd357d",
        "authorId" : "2ab05ff6-d3ea-4ed2-9e90-40861dc60270",
        "body" : "heh, glad to be helpful :)",
        "createdAt" : "2017-01-23T21:16:01Z",
        "updatedAt" : "2017-01-23T21:16:01Z",
        "lastEditedBy" : "2ab05ff6-d3ea-4ed2-9e90-40861dc60270",
        "tags" : [
        ]
      }
    ],
    "commit" : "4e2bce23d59c958e4fa72e2c2006cb0a3b399aec",
    "line" : 8,
    "diffHunk" : "@@ -1,1 +258,262 @@                if not existing_definitions_in_family and revision != 1:\n                    module.fail_json(msg=\"You have specified a revision of %d but a created revision would be 1\" % revision)\n                elif existing_definitions_in_family and existing_definitions_in_family[-1]['revision'] + 1 != revision:\n                    module.fail_json(msg=\"You have specified a revision of %d but a created revision would be %d\" % (revision, existing_definitions_in_family[-1]['revision'] + 1))\n        else:"
  }
]