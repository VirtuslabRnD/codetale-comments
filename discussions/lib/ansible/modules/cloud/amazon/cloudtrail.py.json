[
  {
    "id" : "58bd3703-b1b5-4c0d-a7a1-b3e2f4876c48",
    "prId" : 34745,
    "prUrl" : "https://github.com/ansible/ansible/pull/34745#pullrequestreview-88518830",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "cc00a991-8921-4ff5-9b3b-cec73820e002",
        "parentId" : null,
        "authorId" : "91c63cfe-0504-4f72-afa0-80b301c25eca",
        "body" : "This works in China? I thought the param would have to be missing.",
        "createdAt" : "2018-01-12T15:35:45Z",
        "updatedAt" : "2018-01-12T15:35:45Z",
        "lastEditedBy" : "91c63cfe-0504-4f72-afa0-80b301c25eca",
        "tags" : [
        ]
      },
      {
        "id" : "be5e879e-b2c1-447e-810e-49e4cc1a1265",
        "parentId" : "cc00a991-8921-4ff5-9b3b-cec73820e002",
        "authorId" : "852d9b40-f103-40b8-9f52-ce8110aaad2c",
        "body" : "This isn't making a real request to Cloudtrail in China - it's constructing the spoof return values from a request (hence the fake ARN).",
        "createdAt" : "2018-01-12T15:42:42Z",
        "updatedAt" : "2018-01-12T15:42:42Z",
        "lastEditedBy" : "852d9b40-f103-40b8-9f52-ce8110aaad2c",
        "tags" : [
        ]
      },
      {
        "id" : "5eb31f2c-f203-42b5-bd56-b5de077988b3",
        "parentId" : "cc00a991-8921-4ff5-9b3b-cec73820e002",
        "authorId" : "91c63cfe-0504-4f72-afa0-80b301c25eca",
        "body" : "Aha. I need more coffee. Thanks for doing this.",
        "createdAt" : "2018-01-12T15:47:08Z",
        "updatedAt" : "2018-01-12T15:47:08Z",
        "lastEditedBy" : "91c63cfe-0504-4f72-afa0-80b301c25eca",
        "tags" : [
        ]
      },
      {
        "id" : "315e566b-0b8d-4557-b8bb-ac70d2d2e99b",
        "parentId" : "cc00a991-8921-4ff5-9b3b-cec73820e002",
        "authorId" : "852d9b40-f103-40b8-9f52-ce8110aaad2c",
        "body" : "If I'm reading right, what's happening is that the check mode opens an STS connection a few lines up to make sure you've passed real credentials and it really can connect to the region, but then basically makes up a fake API return output right here... \r\n\r\n```\r\n$ ./hacking/test-module -m lib/ansible/modules/cloud/amazon/cloudtrail.py -a \"name='test-trail-1' s3_bucket_name='cn-sh-cnn1-cloud-trail' region='cn-north-1' state=present profile='<redacted>'\" -c\r\n* including generated source, if any, saving to: /Users/nbailey/.ansible_module_generated\r\n* ansiballz module detected; extracted module source to: /Users/nbailey/debug_dir\r\n***********************************\r\nRAW OUTPUT\r\n\r\n{\"invocation\": {\"module_args\": {\"profile\": \"<redacted>\", \"aws_secret_key\": null, \"aws_access_key\": null, \"include_global_events\": true, \"name\": \"test-trail-1\", \"security_token\": null, \"tags\": {}, \"validate_certs\": true, \"region\": \"cn-north-1\", \"kms_key_id\": null, \"cloudwatch_logs_log_group_arn\": null, \"s3_bucket_name\": \"cn-sh-cnn1-cloud-trail\", \"is_multi_region_trail\": false, \"state\": \"present\", \"cloudwatch_logs_role_arn\": null, \"ec2_url\": null, \"enable_log_file_validation\": null, \"sns_topic_name\": null, \"s3_key_prefix\": null, \"enable_logging\": true}}, \"trail\": {\"name\": \"test-trail-1\", \"has_custom_event_selectors\": false, \"tags\": {}, \"include_global_service_events\": true, \"s3_bucket_name\": \"cn-sh-cnn1-cloud-trail\", \"home_region\": \"cn-north-1\", \"is_logging\": true, \"is_multi_region_trail\": false, \"trail_arn\": \"arn:aws:cloudtrail:cn-north-1:640673851126:trail/test-trail-1\"}, \"changed\": true, \"exists\": false}\r\n\r\n***********************************\r\nPARSED OUTPUT\r\n{\r\n    \"changed\": true,\r\n    \"exists\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"aws_access_key\": null,\r\n            \"aws_secret_key\": null,\r\n            \"cloudwatch_logs_log_group_arn\": null,\r\n            \"cloudwatch_logs_role_arn\": null,\r\n            \"ec2_url\": null,\r\n            \"enable_log_file_validation\": null,\r\n            \"enable_logging\": true,\r\n            \"include_global_events\": true,\r\n            \"is_multi_region_trail\": false,\r\n            \"kms_key_id\": null,\r\n            \"name\": \"test-trail-1\",\r\n            \"profile\": \"<redacted>\",\r\n            \"region\": \"cn-north-1\",\r\n            \"s3_bucket_name\": \"cn-sh-cnn1-cloud-trail\",\r\n            \"s3_key_prefix\": null,\r\n            \"security_token\": null,\r\n            \"sns_topic_name\": null,\r\n            \"state\": \"present\",\r\n            \"tags\": {},\r\n            \"validate_certs\": true\r\n        }\r\n    },\r\n    \"trail\": {\r\n        \"has_custom_event_selectors\": false,\r\n        \"home_region\": \"cn-north-1\",\r\n        \"include_global_service_events\": true,\r\n        \"is_logging\": true,\r\n        \"is_multi_region_trail\": false,\r\n        \"name\": \"test-trail-1\",\r\n        \"s3_bucket_name\": \"cn-sh-cnn1-cloud-trail\",\r\n        \"tags\": {},\r\n        \"trail_arn\": \"arn:aws:cloudtrail:cn-north-1:640673851126:trail/test-trail-1\"\r\n    }\r\n}\r\n```\r\n\r\nnote: \"trail_arn\": \"arn:aws:cloudtrail:cn-north-1:640673851126:trail/test-trail-1\" isn't a possible ARN, the partition name would be `aws-cn` for a real trail.",
        "createdAt" : "2018-01-12T15:47:14Z",
        "updatedAt" : "2018-01-12T15:48:33Z",
        "lastEditedBy" : "852d9b40-f103-40b8-9f52-ce8110aaad2c",
        "tags" : [
        ]
      },
      {
        "id" : "b517e58f-9c13-44f1-bc70-6f4197ff585b",
        "parentId" : "cc00a991-8921-4ff5-9b3b-cec73820e002",
        "authorId" : "852d9b40-f103-40b8-9f52-ce8110aaad2c",
        "body" : "Ha, no problem. Thanks for picking up bug reports that affect a tiiiiiiny percentage of Cloudtrail users :)",
        "createdAt" : "2018-01-12T15:49:36Z",
        "updatedAt" : "2018-01-12T15:49:36Z",
        "lastEditedBy" : "852d9b40-f103-40b8-9f52-ce8110aaad2c",
        "tags" : [
        ]
      }
    ],
    "commit" : "190286271eaa1e5c68a4c9065cf369fa6f86a574",
    "line" : 47,
    "diffHunk" : "@@ -1,1 +598,602 @@            if 'EnableLogFileValidation' not in ct_params:\n                ct_params['EnableLogFileValidation'] = False\n            trail['EnableLogFileValidation'] = ct_params['EnableLogFileValidation']\n            trail.pop('EnableLogFileValidation')\n            fake_arn = 'arn:aws:cloudtrail:' + region + ':' + acct_id + ':trail/' + ct_params['Name']"
  },
  {
    "id" : "bab76426-623b-4893-a78f-2ba72da2abe9",
    "prId" : 67191,
    "prUrl" : "https://github.com/ansible/ansible/pull/67191#pullrequestreview-363430256",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "10cfb166-9b6c-47c1-a35e-a73d2573b373",
        "parentId" : null,
        "authorId" : "6b7e4265-ae86-4269-9bd7-f8ffa9085df6",
        "body" : "Is this pass statement right now? I wonder if the original author of these couple lines of code meant to pass on a certain error code (which would occur with ClientError). BotoCoreErrors should usually just be fatal. I didn't dig into git history though.",
        "createdAt" : "2020-02-24T14:03:11Z",
        "updatedAt" : "2020-02-24T14:24:02Z",
        "lastEditedBy" : "6b7e4265-ae86-4269-9bd7-f8ffa9085df6",
        "tags" : [
        ]
      },
      {
        "id" : "4b916915-6269-406b-a755-7626d9a41e48",
        "parentId" : "10cfb166-9b6c-47c1-a35e-a73d2573b373",
        "authorId" : "7243ee41-f7f6-470f-8b39-aec91451b808",
        "body" : "This fragment is only fetching the current AccountID while running in check_mode and is only used to generate a 'fake' ARN.  My thoughts were that since we don't explode in most cases, we might as well do our best to continue.",
        "createdAt" : "2020-02-24T14:27:34Z",
        "updatedAt" : "2020-02-24T14:27:35Z",
        "lastEditedBy" : "7243ee41-f7f6-470f-8b39-aec91451b808",
        "tags" : [
        ]
      },
      {
        "id" : "622fb8e9-bfc0-4362-8cb0-0e737d69df05",
        "parentId" : "10cfb166-9b6c-47c1-a35e-a73d2573b373",
        "authorId" : "6b7e4265-ae86-4269-9bd7-f8ffa9085df6",
        "body" : "Sounds reasonable! Thanks for looking into it. I'll look back through this again over lunch in a few hours and merge. Thanks for all your work cleaning these things up.",
        "createdAt" : "2020-02-24T14:32:13Z",
        "updatedAt" : "2020-02-24T14:32:14Z",
        "lastEditedBy" : "6b7e4265-ae86-4269-9bd7-f8ffa9085df6",
        "tags" : [
        ]
      }
    ],
    "commit" : "c32c31649279d794124318afdb70a0ee3e05ec68",
    "line" : 223,
    "diffHunk" : "@@ -1,1 +596,600 @@                acct_id = sts_client.get_caller_identity()['Account']\n            except (BotoCoreError, ClientError):\n                pass\n            trail = dict()\n            trail.update(ct_params)"
  }
]