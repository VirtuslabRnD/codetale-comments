[
  {
    "id" : "a62dc9a3-11cd-409e-857f-420167b2623d",
    "prId" : 39491,
    "prUrl" : "https://github.com/ansible/ansible/pull/39491#pullrequestreview-117106194",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "347b6494-a076-43b7-901f-935460044a0e",
        "parentId" : null,
        "authorId" : "183d9a20-6a5e-4432-9fe9-9fd6fe9514fb",
        "body" : "Use a paginator: boto3.readthedocs.io/en/latest/reference/services/storagegateway.html#paginators\r\n\r\nhttps://github.com/ansible/ansible/blob/devel/lib/ansible/modules/cloud/amazon/GUIDELINES.md#api-throttling-and-pagination",
        "createdAt" : "2018-04-30T11:50:34Z",
        "updatedAt" : "2018-04-30T20:49:49Z",
        "lastEditedBy" : "183d9a20-6a5e-4432-9fe9-9fd6fe9514fb",
        "tags" : [
        ]
      },
      {
        "id" : "53f9056d-3627-40a0-8c66-954f10e51061",
        "parentId" : "347b6494-a076-43b7-901f-935460044a0e",
        "authorId" : "6346842a-d3f9-4ecc-8c03-3b174ff9b4f0",
        "body" : "boto refused it\r\n\r\nbotocore.exceptions.OperationNotPageableError: Operation cannot be paginated: list_file_shares\r\n",
        "createdAt" : "2018-04-30T12:32:52Z",
        "updatedAt" : "2018-04-30T20:49:49Z",
        "lastEditedBy" : "6346842a-d3f9-4ecc-8c03-3b174ff9b4f0",
        "tags" : [
        ]
      },
      {
        "id" : "a756e59c-9615-4cf0-8b4c-4ba6a15789d3",
        "parentId" : "347b6494-a076-43b7-901f-935460044a0e",
        "authorId" : "183d9a20-6a5e-4432-9fe9-9fd6fe9514fb",
        "body" : "Might be worth raising bugs against botocore where paginators don't exist but should. Won't help us now but we can migrate to them a year after the bugs are resolved ;)",
        "createdAt" : "2018-05-02T23:45:54Z",
        "updatedAt" : "2018-05-02T23:45:54Z",
        "lastEditedBy" : "183d9a20-6a5e-4432-9fe9-9fd6fe9514fb",
        "tags" : [
        ]
      }
    ],
    "commit" : "868e68b800d9e71779bb711d3f4ef00f41a0d6a6",
    "line" : 286,
    "diffHunk" : "@@ -1,1 +284,288 @@            tapes.append(tape_obj)\n\n        return aws_response[\"Marker\"] if \"Marker\" in aws_response else None\n\n    \"\"\""
  },
  {
    "id" : "39b15b0e-4161-44fe-aa44-902c0d931432",
    "prId" : 39491,
    "prUrl" : "https://github.com/ansible/ansible/pull/39491#pullrequestreview-116267434",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5212057b-5939-48c2-afb0-feb1d2cccbe1",
        "parentId" : null,
        "authorId" : "183d9a20-6a5e-4432-9fe9-9fd6fe9514fb",
        "body" : "This is basically\r\n\r\n```\r\ngateway['local_disks']=[camel_dict_to_snake_dict(disk) for disk in \r\n                        self.connection.list_local_dists(GatewayARN=gateway[\"gateway_arn\"])]\r\n```",
        "createdAt" : "2018-04-30T11:52:31Z",
        "updatedAt" : "2018-04-30T20:49:49Z",
        "lastEditedBy" : "183d9a20-6a5e-4432-9fe9-9fd6fe9514fb",
        "tags" : [
        ]
      },
      {
        "id" : "2cca65cc-2975-4710-a6aa-9605f8b620d3",
        "parentId" : "5212057b-5939-48c2-afb0-feb1d2cccbe1",
        "authorId" : "6346842a-d3f9-4ecc-8c03-3b174ff9b4f0",
        "body" : "Fixed",
        "createdAt" : "2018-04-30T12:17:03Z",
        "updatedAt" : "2018-04-30T20:49:49Z",
        "lastEditedBy" : "6346842a-d3f9-4ecc-8c03-3b174ff9b4f0",
        "tags" : [
        ]
      }
    ],
    "commit" : "868e68b800d9e71779bb711d3f4ef00f41a0d6a6",
    "line" : 267,
    "diffHunk" : "@@ -1,1 +265,269 @@    List storage gateway local disks\n    \"\"\"\n    def list_local_disks(self, gateway):\n        try:\n            gateway['local_disks'] = [camel_dict_to_snake_dict(disk) for disk in"
  },
  {
    "id" : "6ebfa5fb-a50a-440e-b797-4381b9c2808e",
    "prId" : 39491,
    "prUrl" : "https://github.com/ansible/ansible/pull/39491#pullrequestreview-116275277",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "862f12ca-f1fa-4fef-9db9-f519ad755537",
        "parentId" : null,
        "authorId" : "06ab4cf8-4a18-478e-93ee-69929f4bffc6",
        "body" : "As Will recommends, paginators will simplify this code very much. There's a hidden gem in paginators called `search` that will also let you pull out all of one key and merge those lists: \r\n\r\n```\r\npg = self.connection.get_paginator('list_gateways')\r\nreturn list(pg.paginate().search('Gateways[*]'))\r\n\r\n# or, if the result will only be used in a for loop\r\nreturn pg.paginate().search('Gateways[*]')\r\n# will return an iterator that will build results on the fly\r\n```\r\n\r\nThis would grab the paginated list of all gateways and merge them all, or if there were no gateways it would return an empty list. \r\n\r\nExample (cloudformation module, but all paginators have this) https://github.com/ansible/ansible/blob/devel/lib/ansible/modules/cloud/amazon/cloudformation.py#L294",
        "createdAt" : "2018-04-30T12:28:20Z",
        "updatedAt" : "2018-04-30T20:49:49Z",
        "lastEditedBy" : "06ab4cf8-4a18-478e-93ee-69929f4bffc6",
        "tags" : [
        ]
      },
      {
        "id" : "60df49d4-d4e7-479c-bf1c-d98c4ab9786b",
        "parentId" : "862f12ca-f1fa-4fef-9db9-f519ad755537",
        "authorId" : "6346842a-d3f9-4ecc-8c03-3b174ff9b4f0",
        "body" : "I just changed the code to use paginator where needed",
        "createdAt" : "2018-04-30T12:50:21Z",
        "updatedAt" : "2018-04-30T20:49:49Z",
        "lastEditedBy" : "6346842a-d3f9-4ecc-8c03-3b174ff9b4f0",
        "tags" : [
        ]
      }
    ],
    "commit" : "868e68b800d9e71779bb711d3f4ef00f41a0d6a6",
    "line" : 208,
    "diffHunk" : "@@ -1,1 +206,210 @@    List all storage gateways for the AWS endpoint.\n    \"\"\"\n    def list_gateways(self):\n        try:\n            paginator = self.client.get_paginator('list_gateways')"
  },
  {
    "id" : "8499c695-e2bd-4cf3-8506-f8bd7adb5625",
    "prId" : 39491,
    "prUrl" : "https://github.com/ansible/ansible/pull/39491#pullrequestreview-117106522",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8fb1be64-07fb-44f8-aa21-82c2cda7f95f",
        "parentId" : null,
        "authorId" : "183d9a20-6a5e-4432-9fe9-9fd6fe9514fb",
        "body" : "Not sure the PaginationConfig is necessary - we don't have it in any other modules.",
        "createdAt" : "2018-05-02T23:48:07Z",
        "updatedAt" : "2018-05-02T23:48:07Z",
        "lastEditedBy" : "183d9a20-6a5e-4432-9fe9-9fd6fe9514fb",
        "tags" : [
        ]
      }
    ],
    "commit" : "868e68b800d9e71779bb711d3f4ef00f41a0d6a6",
    "line" : 319,
    "diffHunk" : "@@ -1,1 +317,321 @@                GatewayARN=gateway[\"gateway_arn\"],\n                PaginationConfig={\n                    'PageSize': 100,\n                }\n            ).build_full_result()"
  }
]