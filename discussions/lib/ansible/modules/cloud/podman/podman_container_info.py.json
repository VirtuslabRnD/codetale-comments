[
  {
    "id" : "7a0bd692-f425-4397-bf15-c20a526ef50d",
    "prId" : 64361,
    "prUrl" : "https://github.com/ansible/ansible/pull/64361#pullrequestreview-312678103",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3e429509-91f4-43a1-8477-717b8cdddafe",
        "parentId" : null,
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "```suggestion\r\n    type: list\r\n    elements: dict\r\n```",
        "createdAt" : "2019-11-04T05:05:09Z",
        "updatedAt" : "2019-12-05T20:22:07Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      },
      {
        "id" : "f39f9e8c-7937-4c76-9c8d-aff8a465fd6e",
        "parentId" : "3e429509-91f4-43a1-8477-717b8cdddafe",
        "authorId" : "fdd13dc1-6674-4eea-bbd6-8b7526582f27",
        "body" : "fixed",
        "createdAt" : "2019-11-06T19:15:35Z",
        "updatedAt" : "2019-12-05T20:22:07Z",
        "lastEditedBy" : "fdd13dc1-6674-4eea-bbd6-8b7526582f27",
        "tags" : [
        ]
      }
    ],
    "commit" : "8ce6a29a384dc5d61a4bb4597c9612e0026f2a23",
    "line" : 60,
    "diffHunk" : "@@ -1,1 +58,62 @@    description: Facts from all or specificed containers\n    returned: always\n    type: list\n    elements: dict\n    sample: ["
  },
  {
    "id" : "de63104b-715e-4a16-bf1c-9288b3e4959b",
    "prId" : 64361,
    "prUrl" : "https://github.com/ansible/ansible/pull/64361#pullrequestreview-313112051",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "559d1ec7-1439-4717-ab21-46d60cc45182",
        "parentId" : null,
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "Why this `if`?",
        "createdAt" : "2019-11-04T05:08:09Z",
        "updatedAt" : "2019-12-05T20:22:07Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      },
      {
        "id" : "0e1db7f7-29c9-4c5b-887a-a00c93602141",
        "parentId" : "559d1ec7-1439-4717-ab21-46d60cc45182",
        "authorId" : "fdd13dc1-6674-4eea-bbd6-8b7526582f27",
        "body" : "if no containers exist",
        "createdAt" : "2019-11-06T19:17:51Z",
        "updatedAt" : "2019-12-05T20:22:07Z",
        "lastEditedBy" : "fdd13dc1-6674-4eea-bbd6-8b7526582f27",
        "tags" : [
        ]
      },
      {
        "id" : "9b2323b3-9d48-4d4d-92df-1d63e03d58af",
        "parentId" : "559d1ec7-1439-4717-ab21-46d60cc45182",
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "Ah sorry, I think I misunderstood something. Now it's clear.",
        "createdAt" : "2019-11-07T05:11:18Z",
        "updatedAt" : "2019-12-05T20:22:07Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      }
    ],
    "commit" : "8ce6a29a384dc5d61a4bb4597c9612e0026f2a23",
    "line" : 343,
    "diffHunk" : "@@ -1,1 +341,345 @@            module.fail_json(msg=\"Unable to get list of containers: %s\" % err)\n        name = out.split()\n        if not name:\n            return [], out, err\n    command = [executable, 'container', 'inspect']"
  },
  {
    "id" : "249fd012-492d-4fad-813f-5ee01a36b0a8",
    "prId" : 64361,
    "prUrl" : "https://github.com/ansible/ansible/pull/64361#pullrequestreview-314558029",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "584e61b0-dfbf-4185-a231-91ea30f201a3",
        "parentId" : null,
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "You should check the return value here as well. Also, why have these two different code-paths? Is there anything which needs to be different except composing the command line?",
        "createdAt" : "2019-11-04T05:08:45Z",
        "updatedAt" : "2019-12-05T20:22:07Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      },
      {
        "id" : "2dccebf8-99ef-40dd-a387-7cc60b330d23",
        "parentId" : "584e61b0-dfbf-4185-a231-91ea30f201a3",
        "authorId" : "fdd13dc1-6674-4eea-bbd6-8b7526582f27",
        "body" : "Not sure what you mean by different code path. If not name is specified - return data for all existing containers.",
        "createdAt" : "2019-11-06T19:32:39Z",
        "updatedAt" : "2019-12-05T20:22:07Z",
        "lastEditedBy" : "fdd13dc1-6674-4eea-bbd6-8b7526582f27",
        "tags" : [
        ]
      },
      {
        "id" : "4e94ef6b-b68e-44cf-878d-2ffefcb9d29d",
        "parentId" : "584e61b0-dfbf-4185-a231-91ea30f201a3",
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "Sorry, that was part of the confusion with the previous comment. Please ignore it.\r\n\r\nThere still needs to be some return code checking, though.",
        "createdAt" : "2019-11-07T05:12:49Z",
        "updatedAt" : "2019-12-05T20:22:07Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      },
      {
        "id" : "f1219261-4803-4750-b5b9-74c63e0733c7",
        "parentId" : "584e61b0-dfbf-4185-a231-91ea30f201a3",
        "authorId" : "fdd13dc1-6674-4eea-bbd6-8b7526582f27",
        "body" : "Fixed",
        "createdAt" : "2019-11-09T13:19:32Z",
        "updatedAt" : "2019-12-05T20:22:07Z",
        "lastEditedBy" : "fdd13dc1-6674-4eea-bbd6-8b7526582f27",
        "tags" : [
        ]
      }
    ],
    "commit" : "8ce6a29a384dc5d61a4bb4597c9612e0026f2a23",
    "line" : 339,
    "diffHunk" : "@@ -1,1 +337,341 @@    if not name:\n        all_names = [executable, 'container', 'ls', '-q', '-a']\n        rc, out, err = module.run_command(all_names)\n        if rc != 0:\n            module.fail_json(msg=\"Unable to get list of containers: %s\" % err)"
  },
  {
    "id" : "730124e8-8bb2-428c-b8ab-7ef4c18558c5",
    "prId" : 64361,
    "prUrl" : "https://github.com/ansible/ansible/pull/64361#pullrequestreview-317966101",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d0cace42-63b0-48e1-905d-325f051e57b0",
        "parentId" : null,
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "If `rc != 0 and ' no such container ' not in err` you should fail the module.",
        "createdAt" : "2019-11-16T08:35:52Z",
        "updatedAt" : "2019-12-05T20:22:07Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      },
      {
        "id" : "0f05749a-3313-4851-ad2f-65c7c0074458",
        "parentId" : "d0cace42-63b0-48e1-905d-325f051e57b0",
        "authorId" : "fdd13dc1-6674-4eea-bbd6-8b7526582f27",
        "body" : "Yeah, but it seems like overreaction because we did this in get_containers_facts function, but fine with me.",
        "createdAt" : "2019-11-16T11:27:47Z",
        "updatedAt" : "2019-12-05T20:22:07Z",
        "lastEditedBy" : "fdd13dc1-6674-4eea-bbd6-8b7526582f27",
        "tags" : [
        ]
      }
    ],
    "commit" : "8ce6a29a384dc5d61a4bb4597c9612e0026f2a23",
    "line" : 378,
    "diffHunk" : "@@ -1,1 +376,380 @@        if rc != 0 and 'no such ' not in err:\n            module.fail_json(msg=\"Unable to gather info for %s: %s\" % (container, err))\n        if rc == 0 and out:\n            json_out = json.loads(out)\n            if json_out:"
  },
  {
    "id" : "8dcf4f39-0849-4598-a086-a4ca11c2a509",
    "prId" : 64361,
    "prUrl" : "https://github.com/ansible/ansible/pull/64361#pullrequestreview-327913668",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "53c50d06-9a91-494d-bd4a-ed7c37887dcb",
        "parentId" : null,
        "authorId" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "body" : "This chunk of code seems overly complicated. I am partially done with a simpler suggestion. I'll share it tomorrow if it's any good.",
        "createdAt" : "2019-12-02T23:03:37Z",
        "updatedAt" : "2019-12-05T20:22:07Z",
        "lastEditedBy" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "tags" : [
        ]
      },
      {
        "id" : "80b586ce-92d4-4656-ace9-aa10b31df6eb",
        "parentId" : "53c50d06-9a91-494d-bd4a-ed7c37887dcb",
        "authorId" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "body" : "This took me a bit longer to refactor. Sorry. You can see what I did [here](https://github.com/samdoran/ansible/commit/57de0404bea89c0246a3f23639a345acb6dc9138).\r\n\r\nMy changes brought the cyclomatic complexity down for `get_containers_facts()` from 8 to 5.\r\n\r\n```\r\n# Original\r\nbad-mccabe lib/ansible/modules/cloud/podman/podman_container_info.py\r\nAverage: 4\r\nMedian: 3\r\nMax: 8\r\nMin: 1\r\nTotal: 16\r\n\r\npodman_container_info.py:326:0: get_containers_facts (complexity 8)\r\npodman_container_info.py:360:0: cycle_over (complexity 5)\r\npodman_container_info.py:409:0: If 409 (complexity 2)\r\npodman_container_info.py:386:0: main (complexity 1)\r\n```\r\n\r\n```\r\n# Refactored\r\nbad-mccabe lib/ansible/modules/cloud/podman/podman_container_info.py\r\nAverage: 3\r\nMedian: 3\r\nMax: 5\r\nMin: 1\r\nTotal: 13\r\n\r\npodman_container_info.py:326:0: inspect_containers (complexity 5)\r\npodman_container_info.py:354:0: get_containers_facts (complexity 5)\r\npodman_container_info.py:413:0: If 413 (complexity 2)\r\npodman_container_info.py:390:0: main (complexity 1)\r\n```\r\n\r\nI may have missed some things, but maybe there is something useful in there you can use to simplify this a bit.",
        "createdAt" : "2019-12-05T22:50:51Z",
        "updatedAt" : "2019-12-05T22:50:51Z",
        "lastEditedBy" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "tags" : [
        ]
      },
      {
        "id" : "00bb658b-1044-43e4-ba89-b350e96bf352",
        "parentId" : "53c50d06-9a91-494d-bd4a-ed7c37887dcb",
        "authorId" : "fdd13dc1-6674-4eea-bbd6-8b7526582f27",
        "body" : "Well, it's kind of returning back to first module iterations which were reworked and added functionality according to @felixfontein comments. We can't just remove half of functionality and call it \"simplifying\". This version will fail in a few cases that are handled in my code. Every line has its reason to be there and I can explain each of it. Also the code was optimized to have better user experience and speed.\r\nSorry, but I'd continue with my version, I don't over-complicate anything without a good reason for it. I'd happy to have a simpler code with the same functionality, but not with half of it.",
        "createdAt" : "2019-12-05T23:12:51Z",
        "updatedAt" : "2019-12-05T23:12:51Z",
        "lastEditedBy" : "fdd13dc1-6674-4eea-bbd6-8b7526582f27",
        "tags" : [
        ]
      }
    ],
    "commit" : "8ce6a29a384dc5d61a4bb4597c9612e0026f2a23",
    "line" : 357,
    "diffHunk" : "@@ -1,1 +355,359 @@            return [], out, err\n        return cycle_over(module, executable, name)\n    module.fail_json(msg=\"Unable to gather info for %s: %s\" % (\",\".join(name), err))\n\n"
  },
  {
    "id" : "7fdedc4b-20a9-4dc4-994f-d1fa3b817cd4",
    "prId" : 64361,
    "prUrl" : "https://github.com/ansible/ansible/pull/64361#pullrequestreview-327908954",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "bc7befe5-07a8-4104-843f-f0960e2bfaf4",
        "parentId" : null,
        "authorId" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "body" : "What's the point of this test?",
        "createdAt" : "2019-12-05T22:34:53Z",
        "updatedAt" : "2019-12-05T22:34:53Z",
        "lastEditedBy" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "tags" : [
        ]
      },
      {
        "id" : "8643251a-6ef6-4780-8af9-c4f198b86f35",
        "parentId" : "bc7befe5-07a8-4104-843f-f0960e2bfaf4",
        "authorId" : "fdd13dc1-6674-4eea-bbd6-8b7526582f27",
        "body" : "When you do multiple inspection in podman and one containers is missing it will fail. If we have only one container to inspect - it means we don't have anything to work on. If we have multiple containers, it could be that only one missing and we can go \"cycle_over\" function below.",
        "createdAt" : "2019-12-05T22:59:44Z",
        "updatedAt" : "2019-12-05T23:00:24Z",
        "lastEditedBy" : "fdd13dc1-6674-4eea-bbd6-8b7526582f27",
        "tags" : [
        ]
      }
    ],
    "commit" : "8ce6a29a384dc5d61a4bb4597c9612e0026f2a23",
    "line" : 354,
    "diffHunk" : "@@ -1,1 +352,356 @@        return json_out, out, err\n    if rc != 0 and 'no such ' in err:\n        if len(name) < 2:\n            return [], out, err\n        return cycle_over(module, executable, name)"
  }
]