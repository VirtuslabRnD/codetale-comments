[
  {
    "id" : "3195a21e-d1a8-4b85-881d-81d56036086f",
    "prId" : 46750,
    "prUrl" : "https://github.com/ansible/ansible/pull/46750#pullrequestreview-166630030",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5b30f630-1b26-4ed6-9de4-61df0142ad66",
        "parentId" : null,
        "authorId" : "96aeecbb-c275-402c-b904-a795c82efb48",
        "body" : "Add additional information about previous and current state of hyperthreading so that user can do stuff depending on that information in next tasks of playbook.",
        "createdAt" : "2018-10-11T10:18:33Z",
        "updatedAt" : "2018-10-27T13:06:24Z",
        "lastEditedBy" : "96aeecbb-c275-402c-b904-a795c82efb48",
        "tags" : [
        ]
      },
      {
        "id" : "03ecd5f1-4569-4cca-8b02-5d0ba718e437",
        "parentId" : "5b30f630-1b26-4ed6-9de4-61df0142ad66",
        "authorId" : "f937ecfe-3ff6-49a2-8b12-3923c563f54b",
        "body" : "@Akasurde Can you give me an example? I think you implemented this already in one of your other modules!? Otherwise, I would do something like this:\r\n```\r\nresults['result'][host.name]['before'] = ...\r\nresults['result'][host.name]['after'] = ...\r\n```",
        "createdAt" : "2018-10-11T10:48:37Z",
        "updatedAt" : "2018-10-27T13:06:24Z",
        "lastEditedBy" : "f937ecfe-3ff6-49a2-8b12-3923c563f54b",
        "tags" : [
        ]
      },
      {
        "id" : "758e9184-60c2-4dd6-8f64-2447d0e17b5b",
        "parentId" : "5b30f630-1b26-4ed6-9de4-61df0142ad66",
        "authorId" : "96aeecbb-c275-402c-b904-a795c82efb48",
        "body" : "Something similar - https://github.com/ansible/ansible/blob/fb72a5424cab097d28670d00cf107fd515cee3f0/lib/ansible/modules/cloud/vmware/vmware_host_lockdown.py#L114",
        "createdAt" : "2018-10-11T12:32:55Z",
        "updatedAt" : "2018-10-27T13:06:24Z",
        "lastEditedBy" : "96aeecbb-c275-402c-b904-a795c82efb48",
        "tags" : [
        ]
      },
      {
        "id" : "3f3f79bb-c8af-4395-b365-2aab93687026",
        "parentId" : "5b30f630-1b26-4ed6-9de4-61df0142ad66",
        "authorId" : "f937ecfe-3ff6-49a2-8b12-3923c563f54b",
        "body" : "@Akasurde What's the benefit of `current_state`. Looks like it's similar to `desired_state` all the time!?\r\n\r\nThen you can access the state like this?:\r\n```\r\n- name: Enable Hyperthreading\r\n  tags: hyperthreading\r\n  vmware_host_hyperthreading:\r\n    hostname: \"{{ vcenter_server }}\"\r\n    username: \"{{ vcenter_username }}\"\r\n    password: \"{{ vcenter_password }}\"\r\n    esxi_hostname: \"{{ inventory_hostname }}\"\r\n    enabled: true\r\n    validate_certs: false\r\n  register: hyperthreading_state\r\n  delegate_to: \"{{ jump_server }}\"\r\n\r\n- name: Hyperthreading status\r\n  tags: hyperthreading\r\n  debug:\r\n    var: hyperthreading_state['result']['{{ inventory_hostname }}']['current_state']\r\n```",
        "createdAt" : "2018-10-11T16:43:31Z",
        "updatedAt" : "2018-10-27T13:06:24Z",
        "lastEditedBy" : "f937ecfe-3ff6-49a2-8b12-3923c563f54b",
        "tags" : [
        ]
      },
      {
        "id" : "aae9d1ff-f47b-4ecd-adf5-97147ef428dc",
        "parentId" : "5b30f630-1b26-4ed6-9de4-61df0142ad66",
        "authorId" : "f937ecfe-3ff6-49a2-8b12-3923c563f54b",
        "body" : "@Akasurde Could you please answer my question? I need that information for other modules as well. Thanks.",
        "createdAt" : "2018-10-14T11:11:26Z",
        "updatedAt" : "2018-10-27T13:06:24Z",
        "lastEditedBy" : "f937ecfe-3ff6-49a2-8b12-3923c563f54b",
        "tags" : [
        ]
      },
      {
        "id" : "86e17cc2-2c95-46b7-94f3-f58465da935c",
        "parentId" : "5b30f630-1b26-4ed6-9de4-61df0142ad66",
        "authorId" : "96aeecbb-c275-402c-b904-a795c82efb48",
        "body" : "`current_state` is state after performing vmware task and we can use that information in next ansible task in playbook.\r\n```yaml\r\n  register: hyperthreading_state\r\n  delegate_to: \"{{ jump_server }}\"\r\n\r\n- name: Perform some task depending upon current state of hyperthreading\r\n  debug:\r\n    var: \"I am here\"\r\n  when: hyperthreading_state['result']['{{ inventory_hostname }}']['current_state'] == 'enabled'\r\n```\r\n",
        "createdAt" : "2018-10-14T12:12:18Z",
        "updatedAt" : "2018-10-27T13:06:24Z",
        "lastEditedBy" : "96aeecbb-c275-402c-b904-a795c82efb48",
        "tags" : [
        ]
      },
      {
        "id" : "9d5b4560-1822-49f0-a924-4caf62c0f88b",
        "parentId" : "5b30f630-1b26-4ed6-9de4-61df0142ad66",
        "authorId" : "f937ecfe-3ff6-49a2-8b12-3923c563f54b",
        "body" : "And use `desired_state` only for reference? They have similar values (if we don't have any errors, but the play would fail anyway). They would be only different if you run in check mode, but this depends on how it's implemented.\r\n\r\nEnable Hyperthreading (no check mode)\r\n```\r\nresults['result'][host.name]['desired_state'] = \"enabled\"\r\nresults['result'][host.name]['previous_state'] = \"disabled\"\r\nresults['result'][host.name]['current_state'] = \"enabled\"\r\n```\r\nEnable Hyperthreading (check mode)\r\n```\r\nresults['result'][host.name]['desired_state'] = \"enabled\"\r\nresults['result'][host.name]['previous_state'] = \"disabled\"\r\nresults['result'][host.name]['current_state'] = \"disabled\"\r\n```\r\n\r\nDoes this makes sense?",
        "createdAt" : "2018-10-14T12:24:36Z",
        "updatedAt" : "2018-10-27T13:06:24Z",
        "lastEditedBy" : "f937ecfe-3ff6-49a2-8b12-3923c563f54b",
        "tags" : [
        ]
      },
      {
        "id" : "e66d4cb0-0227-46ed-8fab-67aa54ee686b",
        "parentId" : "5b30f630-1b26-4ed6-9de4-61df0142ad66",
        "authorId" : "96aeecbb-c275-402c-b904-a795c82efb48",
        "body" : " I think in check mode is like dry-run without any action. so Enable hyperthreading in check mode should have current_state and desired_state as enabled. ",
        "createdAt" : "2018-10-14T12:40:22Z",
        "updatedAt" : "2018-10-27T13:06:24Z",
        "lastEditedBy" : "96aeecbb-c275-402c-b904-a795c82efb48",
        "tags" : [
        ]
      },
      {
        "id" : "2ef1fcb8-8c17-458c-86eb-ba41445bc983",
        "parentId" : "5b30f630-1b26-4ed6-9de4-61df0142ad66",
        "authorId" : "f937ecfe-3ff6-49a2-8b12-3923c563f54b",
        "body" : "Done. This just doesn't work if another task depends on `current_state` and would throw an error if Hyperthreading is not active.",
        "createdAt" : "2018-10-19T17:49:16Z",
        "updatedAt" : "2018-10-27T13:06:24Z",
        "lastEditedBy" : "f937ecfe-3ff6-49a2-8b12-3923c563f54b",
        "tags" : [
        ]
      }
    ],
    "commit" : "b307403c9793f88059603ab0272a8a4838a17e78",
    "line" : 95,
    "diffHunk" : "@@ -1,1 +93,97 @@    sample: {\n        \"esxi01\": {\n            \"msg\": \"Hyperthreading is already enabled and active for host 'esxi01'\",\n            \"state_current\": \"active\",\n            \"state\": \"enabled\","
  }
]