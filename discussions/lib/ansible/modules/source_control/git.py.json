[
  {
    "id" : "5b0f614e-bbff-4b60-9c27-9ec1f7ce8314",
    "prId" : 23332,
    "prUrl" : "https://github.com/ansible/ansible/pull/23332#pullrequestreview-33500834",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d18cd299-86dc-479c-af7a-3a8f2c5523ad",
        "parentId" : null,
        "authorId" : "f239a73a-a28d-436b-80b0-e91c91281bb6",
        "body" : "The remove is in the wrong place and tempdir is not removed. Better:\r\n```\r\ntempdir = tempfile.mkdtemp()\r\nnew_archive = os.path.join(tempdir,  'archive.' + archive_fmt)\r\ngit_archive(git_path, module, dest, new_archive, archive_fmt, version)\r\n\r\narchive_unchanged = filecmp.cmp(new_archive, archive)\r\nshutil.rmtree(tempdir)\r\n\r\nif archive_unchanged:\r\n    result.update(changed=False)\r\nelse:\r\n...\r\n```",
        "createdAt" : "2017-04-19T13:44:29Z",
        "updatedAt" : "2017-05-04T05:22:01Z",
        "lastEditedBy" : "f239a73a-a28d-436b-80b0-e91c91281bb6",
        "tags" : [
        ]
      }
    ],
    "commit" : "354eb7ad57eaac8137fd16e9c0773e35dabf0b54",
    "line" : 85,
    "diffHunk" : "@@ -1,1 +953,957 @@        # if match, do nothing\n        # if does not match, then replace existing with temp archive file.\n        tempdir = tempfile.mkdtemp()\n        new_archive_dest = os.path.join(tempdir, repo_name)\n        new_archive = new_archive_dest + '.' + archive_fmt"
  },
  {
    "id" : "db1aa4dd-daaf-4a91-81e5-2deb95759475",
    "prId" : 29069,
    "prUrl" : "https://github.com/ansible/ansible/pull/29069#pullrequestreview-61680853",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "86771c9e-4254-4614-a599-a80f5fb6e37d",
        "parentId" : null,
        "authorId" : "f239a73a-a28d-436b-80b0-e91c91281bb6",
        "body" : "As far as I see `GIT_SSH_COMMAND` was only introduced in git 2.3, so this change will not fix the issue on many systems, including rhel7.",
        "createdAt" : "2017-09-10T10:06:45Z",
        "updatedAt" : "2017-09-10T10:06:50Z",
        "lastEditedBy" : "f239a73a-a28d-436b-80b0-e91c91281bb6",
        "tags" : [
        ]
      }
    ],
    "commit" : "0adda5f9491f9d5f9c20bebe683abf88d73bdfd9",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +372,376 @@def set_git_ssh(ssh_wrapper, key_file, ssh_opts):\n\n    # git_ssh_command will override git_ssh, so only older git needs it\n    os.environ[\"GIT_SSH\"] = ssh_wrapper\n    # using shell to avoid 'noexec' issues if module temp dir is located in such a mount"
  },
  {
    "id" : "d4b2fa1d-6e0d-4116-adcb-5c9c122ac24f",
    "prId" : 38016,
    "prUrl" : "https://github.com/ansible/ansible/pull/38016#pullrequestreview-121905965",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8375c92b-36cd-4e3d-a956-6998d362c9fb",
        "parentId" : null,
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "@cmrd-senya `IOError` can happen in case of insufficient privileges or similar issues while accessing fs, but I cannot see `AttributeError` appearing. Do you recall anything causing it?",
        "createdAt" : "2018-05-18T13:29:26Z",
        "updatedAt" : "2018-05-22T13:30:20Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      },
      {
        "id" : "4bf8adf0-ab5a-4c6d-b8f0-6061141a2777",
        "parentId" : "8375c92b-36cd-4e3d-a956-6998d362c9fb",
        "authorId" : "421ffd2f-6e48-44c2-b9a9-70bf5e988db9",
        "body" : "I don't. `AttributeError` was present in the original code and I don't think I ever saw it being thrown.",
        "createdAt" : "2018-05-21T18:48:04Z",
        "updatedAt" : "2018-05-22T13:30:13Z",
        "lastEditedBy" : "421ffd2f-6e48-44c2-b9a9-70bf5e988db9",
        "tags" : [
        ]
      }
    ],
    "commit" : "59d07dc721ae9909f4fe15a5bcdb45e20649d261",
    "line" : 62,
    "diffHunk" : "@@ -1,1 +630,634 @@    try:\n        repo_path = get_repo_path(dest, bare)\n    except (IOError, ValueError) as err:\n        # No repo path found\n        \"\"\"``.git`` file does not have a valid format for detached Git dir.\"\"\""
  },
  {
    "id" : "c7cabe23-6749-4c65-b9bf-d767dfb64f3f",
    "prId" : 41712,
    "prUrl" : "https://github.com/ansible/ansible/pull/41712#pullrequestreview-145659686",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "22ee9fc4-f56d-4f3c-97ef-f30c6cd5e0b4",
        "parentId" : null,
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "What if it was also `bare` and the user is changing it into non-bare along with setting up `separate_git_dir`?",
        "createdAt" : "2018-06-26T20:46:12Z",
        "updatedAt" : "2018-08-09T14:56:36Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      },
      {
        "id" : "7435f807-3c11-4f79-861c-46a4974e9cab",
        "parentId" : "22ee9fc4-f56d-4f3c-97ef-f30c6cd5e0b4",
        "authorId" : "d4d9c718-1dc0-4822-aff8-adc9e4e0e5d7",
        "body" : "I go through some doc about `git`, it seems people will not frequently change a bare repo to a full repo. And to do that, the command is not related with `bare` or `separate_git_dir`, so I think we don't need to worry about this.",
        "createdAt" : "2018-08-13T13:46:40Z",
        "updatedAt" : "2018-08-13T13:46:41Z",
        "lastEditedBy" : "d4d9c718-1dc0-4822-aff8-adc9e4e0e5d7",
        "tags" : [
        ]
      }
    ],
    "commit" : "63b73cbcce2e76defcd48a9c9b87cecbc90d1d34",
    "line" : 134,
    "diffHunk" : "@@ -1,1 +1090,1094 @@        try:\n            repo_path = get_repo_path(dest, bare)\n            if separate_git_dir and os.path.exists(repo_path) and separate_git_dir != repo_path:\n                result['changed'] = True\n                if not module.check_mode:"
  },
  {
    "id" : "4ceac20c-f68d-44f5-935d-abb3dae38c75",
    "prId" : 41712,
    "prUrl" : "https://github.com/ansible/ansible/pull/41712#pullrequestreview-132203008",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "24d0fc0c-af47-4516-a9a4-a65243d8b50c",
        "parentId" : null,
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "We might want to introduce new/old git dir path in the result.",
        "createdAt" : "2018-06-26T21:00:18Z",
        "updatedAt" : "2018-08-09T14:56:36Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      }
    ],
    "commit" : "63b73cbcce2e76defcd48a9c9b87cecbc90d1d34",
    "line" : 134,
    "diffHunk" : "@@ -1,1 +1090,1094 @@        try:\n            repo_path = get_repo_path(dest, bare)\n            if separate_git_dir and os.path.exists(repo_path) and separate_git_dir != repo_path:\n                result['changed'] = True\n                if not module.check_mode:"
  },
  {
    "id" : "4a6b3292-c439-44ad-81e6-3f04cd0991e0",
    "prId" : 41712,
    "prUrl" : "https://github.com/ansible/ansible/pull/41712#pullrequestreview-132776538",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "98cddc2c-caea-4062-9e81-9d7bdf4ff853",
        "parentId" : null,
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "It might be a better idea to feature-detect its support using smth like `git clone --help | grep '\\-\\-separate-git-dir'` (while a bit more expensive).",
        "createdAt" : "2018-06-28T10:03:34Z",
        "updatedAt" : "2018-08-09T14:56:36Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      }
    ],
    "commit" : "63b73cbcce2e76defcd48a9c9b87cecbc90d1d34",
    "line" : 88,
    "diffHunk" : "@@ -1,1 +477,481 @@        if git_version_used is None:\n            module.fail_json(msg='Can not find git executable at %s' % git_path)\n        if git_version_used < LooseVersion('1.7.5'):\n            # git before 1.7.5 doesn't have separate-git-dir argument, do fallback\n            needs_separate_git_dir_fallback = True"
  },
  {
    "id" : "c87f5183-aa56-43b3-8008-81829367b0c9",
    "prId" : 41712,
    "prUrl" : "https://github.com/ansible/ansible/pull/41712#pullrequestreview-132986986",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d098a4a4-70a1-4685-8032-4bdcce1c0d69",
        "parentId" : null,
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "Is it intentional that you don't match an empty string?",
        "createdAt" : "2018-06-28T10:05:47Z",
        "updatedAt" : "2018-08-09T14:56:36Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      },
      {
        "id" : "c0cdbc31-57a2-4a30-b1bb-94283ec76371",
        "parentId" : "d098a4a4-70a1-4685-8032-4bdcce1c0d69",
        "authorId" : "d4d9c718-1dc0-4822-aff8-adc9e4e0e5d7",
        "body" : "empty `separate_git_dir` makes no sense so I ignore that.",
        "createdAt" : "2018-06-28T19:28:41Z",
        "updatedAt" : "2018-08-09T14:56:36Z",
        "lastEditedBy" : "d4d9c718-1dc0-4822-aff8-adc9e4e0e5d7",
        "tags" : [
        ]
      }
    ],
    "commit" : "63b73cbcce2e76defcd48a9c9b87cecbc90d1d34",
    "line" : 124,
    "diffHunk" : "@@ -1,1 +1080,1084 @@    module.run_command_environ_update = dict(LANG='C', LC_ALL='C', LC_MESSAGES='C', LC_CTYPE='C')\n\n    if separate_git_dir:\n        separate_git_dir = os.path.realpath(separate_git_dir)\n"
  },
  {
    "id" : "381280eb-99ce-46f7-a7fc-f8e321de765b",
    "prId" : 46950,
    "prUrl" : "https://github.com/ansible/ansible/pull/46950#pullrequestreview-164298649",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a11b73a5-0ecc-49e8-88f6-cc635ed5ca0c",
        "parentId" : null,
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "basically everywhere where you merge possible bytes + unicode use u-prefix",
        "createdAt" : "2018-10-12T15:38:36Z",
        "updatedAt" : "2018-11-08T18:06:08Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      }
    ],
    "commit" : "7c94117989acb64b97dc14c9d7b2d0c0cb1b954f",
    "line" : 34,
    "diffHunk" : "@@ -1,1 +994,998 @@                                     (new_archive, archive),\n                                 details=u\"Error occured while moving : %s\"\n                                         % to_text(e))\n    else:\n        # Perform archive from local directory"
  },
  {
    "id" : "b7a8c221-259e-49d6-a4b0-d5f7fa598116",
    "prId" : 46950,
    "prUrl" : "https://github.com/ansible/ansible/pull/46950#pullrequestreview-171002203",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "4688662e-5689-4814-838e-0aab2db152cb",
        "parentId" : null,
        "authorId" : "838eb58c-0fa8-4742-994f-a407c7183e57",
        "body" : "Module side usually uses to_native.  It's okay to use to_text with fail_json/exit_json, though, as those particular functions can handle string init as either bytes or text. Just letting you know that there's nothing wrong with setting to_native in modules instead. ",
        "createdAt" : "2018-11-01T22:31:35Z",
        "updatedAt" : "2018-11-08T18:06:08Z",
        "lastEditedBy" : "838eb58c-0fa8-4742-994f-a407c7183e57",
        "tags" : [
        ]
      },
      {
        "id" : "a39a4f68-a7ab-441f-8072-f019651bb891",
        "parentId" : "4688662e-5689-4814-838e-0aab2db152cb",
        "authorId" : "94ae5814-8889-4328-9b58-745772997928",
        "body" : ":+1: ",
        "createdAt" : "2018-11-02T08:14:43Z",
        "updatedAt" : "2018-11-08T18:06:08Z",
        "lastEditedBy" : "94ae5814-8889-4328-9b58-745772997928",
        "tags" : [
        ]
      }
    ],
    "commit" : "7c94117989acb64b97dc14c9d7b2d0c0cb1b954f",
    "line" : 23,
    "diffHunk" : "@@ -1,1 +691,695 @@            msg='Current repo does not have a valid reference to a '\n            'separate Git dir or it refers to the invalid path',\n            details=to_text(err),\n        )\n    # Read .git/HEAD for the name of the branch."
  }
]