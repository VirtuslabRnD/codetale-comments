[
  {
    "id" : "515c25f2-6d54-426b-bae6-dd84a5bac465",
    "prId" : 25614,
    "prUrl" : "https://github.com/ansible/ansible/pull/25614#pullrequestreview-46280774",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "1b5ce70f-ae4a-497c-9f03-7a03f18cf8df",
        "parentId" : null,
        "authorId" : "7a1e5757-684b-4684-bcab-c114385bca28",
        "body" : "Is the module meant to run on control node and connect to the remote device? Can `connection: local` be used similar to other network modules in this case?",
        "createdAt" : "2017-06-23T16:46:40Z",
        "updatedAt" : "2017-06-23T16:46:41Z",
        "lastEditedBy" : "7a1e5757-684b-4684-bcab-c114385bca28",
        "tags" : [
        ]
      },
      {
        "id" : "6927926c-8fbe-420a-9e95-8f449bea7592",
        "parentId" : "1b5ce70f-ae4a-497c-9f03-7a03f18cf8df",
        "authorId" : "84ea9a86-bae4-4020-820d-279401a8c99f",
        "body" : "The modules make http requests utilizing the NITRO API.\r\n\r\nThe NITRO API allows access from outside the Netscaler node. If you try to run the http requests form inside Netscaler to locahost they will fail.\r\n\r\nSo the ``delegate_to`` semantically means go to the node that has http access to the Netscaler node and run the http requests there.\r\n\r\nIn our examples we use only the local machine but in real world deployments it is common to have \"bastion\" hosts that are used to access the actual Netscaler.\r\n\r\nIn such a case we would utilize ``delegate_to: bastion_host``\r\n\r\nAs far as the ``connection: local`` I am not very familiar with how it is used.\r\n\r\nReading the documentation I get the impression that semantically it means that the actual node to configure is the ansible node. Also I don't know how you could emulate the bastion server use case.\r\n\r\nIn the inline example the values for ``nsip``, ``nitro_user``, ``nitro_pass`` are given directly while in most real world cases they would take values from varibales.\r\n\r\nIn such case, you can run the example with ``connection:local`` but you would have to change ``hosts: 127.0.0.1`` and also provide values for the variables ``nsip``, ``nitro_user``, ``nitro_pass`` which in the [samples](https://github.com/citrix/netscaler-ansible-modules/tree/master/samples) we have in our repository are defined as per host variables for the netscaler node.\r\n\r\nIt seems to me that ``delegate_to`` is more fitting for the use cases we have for Netscaler.",
        "createdAt" : "2017-06-26T11:46:08Z",
        "updatedAt" : "2017-06-26T11:46:08Z",
        "lastEditedBy" : "84ea9a86-bae4-4020-820d-279401a8c99f",
        "tags" : [
        ]
      },
      {
        "id" : "58ded1a0-44d6-4434-82e0-4d5ace3901de",
        "parentId" : "1b5ce70f-ae4a-497c-9f03-7a03f18cf8df",
        "authorId" : "7a1e5757-684b-4684-bcab-c114385bca28",
        "body" : "With `connection=local` the modules run locally on control node and connect to the remote device (managed node) based on the transport. So for example in case of [eos_conifg](https://docs.ansible.com/ansible/eos_config_module.html) if `connection=local` and  `transport=eapi` the module runs locally on control node and connects to managed device over `http`.\r\nSo in this case module is not copied to managed host and again delegated back to control node.\r\n \r\nHowever, if you think `delegate_to` is the right option I am ok with it.\r\n",
        "createdAt" : "2017-06-26T12:37:48Z",
        "updatedAt" : "2017-06-26T12:37:49Z",
        "lastEditedBy" : "7a1e5757-684b-4684-bcab-c114385bca28",
        "tags" : [
        ]
      },
      {
        "id" : "fe863cef-978a-4c2f-af6a-8550dc13c5bf",
        "parentId" : "1b5ce70f-ae4a-497c-9f03-7a03f18cf8df",
        "authorId" : "84ea9a86-bae4-4020-820d-279401a8c99f",
        "body" : "Since all other netscaler modules are written with the ``delegate_to`` in mind I think it is best to go by it for now.\r\n\r\nThanks for the review.",
        "createdAt" : "2017-06-26T14:37:42Z",
        "updatedAt" : "2017-06-26T14:37:42Z",
        "lastEditedBy" : "84ea9a86-bae4-4020-820d-279401a8c99f",
        "tags" : [
        ]
      }
    ],
    "commit" : "e135e7fef56580de49e8c678d5b7f3da2d6fbb48",
    "line" : 88,
    "diffHunk" : "@@ -1,1 +86,90 @@\n- name: Setup server without saving  configuration\n  delegate_to: localhost\n  notify: Save configuration\n  netscaler_server:"
  }
]