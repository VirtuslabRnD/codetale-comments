[
  {
    "id" : "e7287391-5d47-497f-b0b2-3c9cc80f6ea9",
    "prId" : 25079,
    "prUrl" : "https://github.com/ansible/ansible/pull/25079#pullrequestreview-181867700",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0d62c93e-0441-48f4-b622-6fd59fc0cd8d",
        "parentId" : null,
        "authorId" : "d4c7fda6-9311-4eb9-91ca-d3f1cbccd288",
        "body" : "when `state` is `present`: either (`username` and `password`) or `activation_key` are used in [`register`](https://github.com/WhyIsThisOpen/ansible/blob/57cf604488ed3051fa111a288f008fe6c3444d06/lib/ansible/modules/packaging/os/rhn_register.py#L252) method. `register` method is called independently from `channels` value.\r\n\r\nSomething like that could be used:\r\n```\r\nrequired_if=[\r\n    ('state', 'present', ('username', 'activationkey'), True), # fourth item is True: at least one requirement should be present\r\n    ('state', 'absent', ('username',)),\r\n],\r\nrequired_together=[('username', 'password')],\r\n\r\n# then check values of channels and username, potentially calling 'module.fail_json'\r\n```\r\n\r\nSee 61116a6f1fb56f784a77312e98c3f707577e649d.",
        "createdAt" : "2017-07-25T03:23:59Z",
        "updatedAt" : "2018-11-27T16:12:28Z",
        "lastEditedBy" : "d4c7fda6-9311-4eb9-91ca-d3f1cbccd288",
        "tags" : [
        ]
      },
      {
        "id" : "db059233-764a-4f6e-be68-b82d9e9720be",
        "parentId" : "0d62c93e-0441-48f4-b622-6fd59fc0cd8d",
        "authorId" : "38f1a2ff-4f1a-4c3d-b78a-3bae3b91d930",
        "body" : "FWIW, this was discussed on IRC and @abadger @samdoran and myself agreed that while the `required_if` and `required_together` is more compact and a mechanism meant to be leveraged by modules, given the complexity of the decision matrix required it ends up being simpler and more maintainable code without using those.",
        "createdAt" : "2018-12-05T17:02:50Z",
        "updatedAt" : "2018-12-05T17:02:50Z",
        "lastEditedBy" : "38f1a2ff-4f1a-4c3d-b78a-3bae3b91d930",
        "tags" : [
        ]
      }
    ],
    "commit" : "336b48ae9a199e70cd7b1d59f2486f2bd85eea2d",
    "line" : 34,
    "diffHunk" : "@@ -1,1 +351,355 @@            channels=dict(default=[], type='list'),\n        ),\n        # username/password is required for state=absent, or if channels is not empty\n        # (basically anything that uses self.api requires username/password) but it doesnt\n        # look like we can express that with required_if/required_together/mutually_exclusive"
  }
]