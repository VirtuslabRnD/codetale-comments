[
  {
    "id" : "96935a1b-7dec-416f-9075-d40c9405d76f",
    "prId" : 46436,
    "prUrl" : "https://github.com/ansible/ansible/pull/46436#pullrequestreview-161793183",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "fe66f68c-2d38-418e-ab5c-114a1d02ef86",
        "parentId" : null,
        "authorId" : "0e28b588-4137-48f1-8040-bb2cde473e74",
        "body" : "I don't think the `+` applies, if I read COPYING.",
        "createdAt" : "2018-10-04T17:10:27Z",
        "updatedAt" : "2018-10-22T09:12:14Z",
        "lastEditedBy" : "0e28b588-4137-48f1-8040-bb2cde473e74",
        "tags" : [
        ]
      },
      {
        "id" : "84ace8a2-2bd9-4353-af74-5d8d0e58830f",
        "parentId" : "fe66f68c-2d38-418e-ab5c-114a1d02ef86",
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "There are a *lot* of Ansible modules having exactly this line. (I guess @lolcube, like most people, just copied that from another module :) )",
        "createdAt" : "2018-10-04T20:20:51Z",
        "updatedAt" : "2018-10-22T09:12:15Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      }
    ],
    "commit" : "287d304445840afb2727c82b4c7d6156bad2442d",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +3,7 @@\n# (c) 2018, David Kainz <dkainz@mgit.at> <dave.jokain@gmx.at>\n# GNU General Public License v3.0+ (see COPYING or https://www.gnu.org/licenses/gpl-3.0.txt)\n\nfrom __future__ import absolute_import, division, print_function"
  },
  {
    "id" : "0fb7bc85-1db1-45ab-b453-9bdb3119d1c0",
    "prId" : 46436,
    "prUrl" : "https://github.com/ansible/ansible/pull/46436#pullrequestreview-164671189",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "aa3e5c8f-45e9-460d-9ff1-23ac464c5087",
        "parentId" : null,
        "authorId" : "0e28b588-4137-48f1-8040-bb2cde473e74",
        "body" : "It should be possible to do this in Python I think... But that may be more complicated. I know PyCrypto can create RSA and P256 keys, but I don't think it supports ed25519. If you choose to stick to calling `ssh-keygen`, that's fine, but just so you're aware.",
        "createdAt" : "2018-10-04T17:28:31Z",
        "updatedAt" : "2018-10-22T09:12:15Z",
        "lastEditedBy" : "0e28b588-4137-48f1-8040-bb2cde473e74",
        "tags" : [
        ]
      },
      {
        "id" : "02fe616d-edca-4359-8ba0-d9a6e43d72db",
        "parentId" : "aa3e5c8f-45e9-460d-9ff1-23ac464c5087",
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "I would stick to [cryptography](https://cryptography.io/en/latest/). PyCrypto was last updated in 2013 (!), so it seems pretty dead.",
        "createdAt" : "2018-10-04T20:32:21Z",
        "updatedAt" : "2018-10-22T09:12:15Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      },
      {
        "id" : "f02dd563-ca6e-4dfe-8da7-699b0d910533",
        "parentId" : "aa3e5c8f-45e9-460d-9ff1-23ac464c5087",
        "authorId" : "57db1e2a-9c1c-4c08-b54f-9731aff18e36",
        "body" : "The same issue was already happening with the `openssl_*` modules (pyOpenSSL is EOL already for a while and was even already mostly abandoned when these modules were written) - it is extremely hard to support even the most recent LTS distributions. The goal for the `openssl_*` ones that we needed internally was Debian Jessie (with backports being acceptable) --> https://packages.debian.org/jessie-backports/python-openssl\r\n\r\nThis is even an issue even on RHEL/CentOS latest (https://pkgs.org/download/pyopenssl), where some parts of the `openssl_*` modules don't work.\r\n\r\nPotentially using/requiring `cryptography` ~~1.7~~ 1.4 (https://cryptography.io/en/latest/hazmat/primitives/asymmetric/serialization/#cryptography.hazmat.primitives.serialization.PublicFormat.OpenSSH for public keys, but I didn't find anything regarding private ones... - but PKCS#1 might be enough for those?) might be an option for this one, but writing parts of openssh-keygen in Python (probably Python 2+3 by the way for the next few years) is also not a great thing to do, but doesn't seem to hard for simple key files: https://stackoverflow.com/a/39126754\r\n\r\nThis might get hairy though if more advanced features get used.",
        "createdAt" : "2018-10-11T09:35:02Z",
        "updatedAt" : "2018-10-22T09:12:15Z",
        "lastEditedBy" : "57db1e2a-9c1c-4c08-b54f-9731aff18e36",
        "tags" : [
        ]
      },
      {
        "id" : "c2a60033-b225-493f-84b7-c07abb61d0e1",
        "parentId" : "aa3e5c8f-45e9-460d-9ff1-23ac464c5087",
        "authorId" : "57db1e2a-9c1c-4c08-b54f-9731aff18e36",
        "body" : "By the way, we plan to also write and ship a module for OpenSSH certificates (https://blog.habets.se/2011/07/OpenSSH-certificates.html) and these are even worse concerning support in any established library. That means for that one we need `ssh-keygen` anyways, so having this module use it too is more consistent. I'm sure that patches would be welcome though if someone wants to rewrite this module to use `cryptography` (maybe optionally?), shouldn't be too hard to do.",
        "createdAt" : "2018-10-15T12:01:39Z",
        "updatedAt" : "2018-10-22T09:12:15Z",
        "lastEditedBy" : "57db1e2a-9c1c-4c08-b54f-9731aff18e36",
        "tags" : [
        ]
      }
    ],
    "commit" : "287d304445840afb2727c82b4c7d6156bad2442d",
    "line" : 169,
    "diffHunk" : "@@ -1,1 +167,171 @@                '-t', self.type,\n                '-f', self.path,\n            ]\n\n            if self.comment:"
  },
  {
    "id" : "c77ff463-1da5-4d38-8408-8569ffb98771",
    "prId" : 46436,
    "prUrl" : "https://github.com/ansible/ansible/pull/46436#pullrequestreview-165162090",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f58b4fd6-35b1-4c60-bc5c-155380fb61d4",
        "parentId" : null,
        "authorId" : "57db1e2a-9c1c-4c08-b54f-9731aff18e36",
        "body" : "This gets called in check mode too and might change attributes on disk",
        "createdAt" : "2018-10-15T12:13:37Z",
        "updatedAt" : "2018-10-22T09:12:16Z",
        "lastEditedBy" : "57db1e2a-9c1c-4c08-b54f-9731aff18e36",
        "tags" : [
        ]
      },
      {
        "id" : "2c105b42-6a19-4368-9785-6bd7958c6bf6",
        "parentId" : "f58b4fd6-35b1-4c60-bc5c-155380fb61d4",
        "authorId" : "57db1e2a-9c1c-4c08-b54f-9731aff18e36",
        "body" : "Looks like an issue in https://github.com/ansible/ansible/blob/8a6059ad0a5c9e96adb24f9dec1da9687a415045/lib/ansible/module_utils/crypto.py#L129-L131 too",
        "createdAt" : "2018-10-15T12:16:53Z",
        "updatedAt" : "2018-10-22T09:12:16Z",
        "lastEditedBy" : "57db1e2a-9c1c-4c08-b54f-9731aff18e36",
        "tags" : [
        ]
      },
      {
        "id" : "9b542996-a5cd-4ac3-8c86-951f13786d84",
        "parentId" : "f58b4fd6-35b1-4c60-bc5c-155380fb61d4",
        "authorId" : "0e28b588-4137-48f1-8040-bb2cde473e74",
        "body" : "No, `set_fs_attributes_if_different` respects `module.check`.",
        "createdAt" : "2018-10-16T05:25:28Z",
        "updatedAt" : "2018-10-22T09:12:16Z",
        "lastEditedBy" : "0e28b588-4137-48f1-8040-bb2cde473e74",
        "tags" : [
        ]
      },
      {
        "id" : "bc191b59-a440-4985-8633-5790188b94ae",
        "parentId" : "f58b4fd6-35b1-4c60-bc5c-155380fb61d4",
        "authorId" : "57db1e2a-9c1c-4c08-b54f-9731aff18e36",
        "body" : "Ah thanks, I checked the implementation again, it verifies this here:\r\n\r\nhttps://github.com/ansible/ansible/blob/f2dccb90e893df30c2b8bfc925dba80f6ceed6a7/lib/ansible/module_utils/basic.py#L1376",
        "createdAt" : "2018-10-16T13:36:28Z",
        "updatedAt" : "2018-10-22T09:12:17Z",
        "lastEditedBy" : "57db1e2a-9c1c-4c08-b54f-9731aff18e36",
        "tags" : [
        ]
      }
    ],
    "commit" : "287d304445840afb2727c82b4c7d6156bad2442d",
    "line" : 205,
    "diffHunk" : "@@ -1,1 +203,207 @@        def _check_perms(module):\n            file_args = module.load_file_common_arguments(module.params)\n            return not module.set_fs_attributes_if_different(file_args, False)\n\n        def _check_type():"
  },
  {
    "id" : "7da8e763-6761-449a-adec-a97f9557698f",
    "prId" : 46436,
    "prUrl" : "https://github.com/ansible/ansible/pull/46436#pullrequestreview-166095722",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "15652dae-215b-4ff5-a9cc-2330f5f2ad68",
        "parentId" : null,
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "Shouldn't `changed` only be set to `True` if something is actually deleted? Otherwise, calling the module twice with `state == absent` will result in the module reporting a change twice (i.e. idempotency is violated).",
        "createdAt" : "2018-10-18T11:30:02Z",
        "updatedAt" : "2018-10-22T09:12:17Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      },
      {
        "id" : "6b4aaa4e-6191-4ed0-a763-b8f18be9f578",
        "parentId" : "15652dae-215b-4ff5-a9cc-2330f5f2ad68",
        "authorId" : "57db1e2a-9c1c-4c08-b54f-9731aff18e36",
        "body" : "This is 1:1 the same code as in https://github.com/ansible/ansible/blob/8a671f54ddc5ec114ef807dc71f49d61261d2107/lib/ansible/module_utils/crypto.py#L150-L160",
        "createdAt" : "2018-10-18T12:39:31Z",
        "updatedAt" : "2018-10-22T09:12:17Z",
        "lastEditedBy" : "57db1e2a-9c1c-4c08-b54f-9731aff18e36",
        "tags" : [
        ]
      },
      {
        "id" : "986594cb-2cb4-4bfd-8a93-18b017a7de2d",
        "parentId" : "15652dae-215b-4ff5-a9cc-2330f5f2ad68",
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "Ah, I think the point is that `os.remove()` raises an exception if the file isn't there, so `changed` won't be set to `True`.",
        "createdAt" : "2018-10-18T13:36:24Z",
        "updatedAt" : "2018-10-22T09:12:18Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      }
    ],
    "commit" : "287d304445840afb2727c82b4c7d6156bad2442d",
    "line" : 240,
    "diffHunk" : "@@ -1,1 +238,242 @@        try:\n            os.remove(self.path)\n            self.changed = True\n        except OSError as exc:\n            if exc.errno != errno.ENOENT:"
  }
]