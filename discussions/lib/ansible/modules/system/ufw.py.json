[
  {
    "id" : "b128e6ad-08de-41b5-89c6-49f498f63d1a",
    "prId" : 49796,
    "prUrl" : "https://github.com/ansible/ansible/pull/49796#pullrequestreview-202128710",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "842c60bf-be8e-4ff6-a6d7-ca8b91f8fa7f",
        "parentId" : null,
        "authorId" : "e0821cf2-fc82-4ec6-8b28-72b8016ac45c",
        "body" : "How that supposed to be third there?",
        "createdAt" : "2019-02-11T13:49:46Z",
        "updatedAt" : "2019-02-11T13:59:54Z",
        "lastEditedBy" : "e0821cf2-fc82-4ec6-8b28-72b8016ac45c",
        "tags" : [
        ]
      },
      {
        "id" : "044ceafa-436a-4a3f-aca3-b25515632e6a",
        "parentId" : "842c60bf-be8e-4ff6-a6d7-ca8b91f8fa7f",
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "I guess it should have been `insert: -3`... I'll change that.",
        "createdAt" : "2019-02-11T13:55:02Z",
        "updatedAt" : "2019-02-11T13:59:54Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      },
      {
        "id" : "054a86fd-a8b4-4baa-b585-30ac9b57cdfc",
        "parentId" : "842c60bf-be8e-4ff6-a6d7-ca8b91f8fa7f",
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "Ah. No. `-1` is correct: this will add the new rule at the position where currently the second last IPv4 rule is (`insert: 0` would be position of last IPv4 rule, `insert: -1` the position of the second to last IPv4 rule), and since ufw will insert it before these two rules then, it will end up as the third to last.",
        "createdAt" : "2019-02-11T13:57:14Z",
        "updatedAt" : "2019-02-11T13:59:54Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      },
      {
        "id" : "91f7134b-9b5c-4a7a-bb36-0b64998adde5",
        "parentId" : "842c60bf-be8e-4ff6-a6d7-ca8b91f8fa7f",
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "I guess it needs more documentation, though ;-)",
        "createdAt" : "2019-02-11T13:57:25Z",
        "updatedAt" : "2019-02-11T13:59:54Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      },
      {
        "id" : "667572a6-9865-46f7-9cfd-65b9c68d5d69",
        "parentId" : "842c60bf-be8e-4ff6-a6d7-ca8b91f8fa7f",
        "authorId" : "e0821cf2-fc82-4ec6-8b28-72b8016ac45c",
        "body" : "Third to last seems right here. But it is just confusing :)",
        "createdAt" : "2019-02-11T14:06:17Z",
        "updatedAt" : "2019-02-11T14:06:17Z",
        "lastEditedBy" : "e0821cf2-fc82-4ec6-8b28-72b8016ac45c",
        "tags" : [
        ]
      },
      {
        "id" : "e6203c87-16fb-4018-9f46-b829064c92d7",
        "parentId" : "842c60bf-be8e-4ff6-a6d7-ca8b91f8fa7f",
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "It is indeed! I hope with the new comment (see 689ebf0a7b31083b17799c8452b25023260572da) it is clearer. I guess most people would simply need \"insert as first IPv6 command\" (that's what I need this for), for example to insert an ALLOW from-ip before some DENYs, and there it's much less confusing...",
        "createdAt" : "2019-02-11T14:20:17Z",
        "updatedAt" : "2019-02-11T14:20:17Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      }
    ],
    "commit" : "689ebf0a7b31083b17799c8452b25023260572da",
    "line" : 51,
    "diffHunk" : "@@ -1,1 +236,240 @@\n- name: Deny all IPv4 traffic to tcp port 20 on this host\n  # This should be the third to last IPv4 rule\n  # (insert: -1 addresses the second to last IPv4 rule;\n  #  so the new rule will be inserted before the second"
  },
  {
    "id" : "502a84f3-6d90-4446-af1a-27673b2416d4",
    "prId" : 49796,
    "prUrl" : "https://github.com/ansible/ansible/pull/49796#pullrequestreview-202127805",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5ea86963-491b-4b67-9723-b93be2dbfd19",
        "parentId" : null,
        "authorId" : "e0821cf2-fc82-4ec6-8b28-72b8016ac45c",
        "body" : "No defaults? Why?",
        "createdAt" : "2019-02-11T13:50:47Z",
        "updatedAt" : "2019-02-11T13:59:54Z",
        "lastEditedBy" : "e0821cf2-fc82-4ec6-8b28-72b8016ac45c",
        "tags" : [
        ]
      },
      {
        "id" : "18f6b4bf-817f-4f86-90f8-5b0c40213d6c",
        "parentId" : "5ea86963-491b-4b67-9723-b93be2dbfd19",
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "Depending on what `insert_relative_to` is, the default should be 0 or 1. So it's better to not have a default, and in case this is not specified, select a sensible default depending on context in the code.",
        "createdAt" : "2019-02-11T13:54:17Z",
        "updatedAt" : "2019-02-11T13:59:54Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      },
      {
        "id" : "476654f9-1ef4-453f-bc96-b0d77e785d75",
        "parentId" : "5ea86963-491b-4b67-9723-b93be2dbfd19",
        "authorId" : "e0821cf2-fc82-4ec6-8b28-72b8016ac45c",
        "body" : "I see you point from detailed code review. But what if we have two variables?\r\n`insert`, type: `boolean` - defining do we need to insert the rule with default `false`\r\n`insert_position`, type: `int` - insert as a specified rule number with default `0`",
        "createdAt" : "2019-02-11T14:01:43Z",
        "updatedAt" : "2019-02-11T14:01:44Z",
        "lastEditedBy" : "e0821cf2-fc82-4ec6-8b28-72b8016ac45c",
        "tags" : [
        ]
      },
      {
        "id" : "80878d3b-9b8c-4749-b571-6bd1664375df",
        "parentId" : "5ea86963-491b-4b67-9723-b93be2dbfd19",
        "authorId" : "e0821cf2-fc82-4ec6-8b28-72b8016ac45c",
        "body" : "And if you are using `insert` together with `insert_relative_to` then `insert_position` will be calculated automatically",
        "createdAt" : "2019-02-11T14:04:28Z",
        "updatedAt" : "2019-02-11T14:04:28Z",
        "lastEditedBy" : "e0821cf2-fc82-4ec6-8b28-72b8016ac45c",
        "tags" : [
        ]
      },
      {
        "id" : "594952fc-dc36-4eaf-8771-cae69289d678",
        "parentId" : "5ea86963-491b-4b67-9723-b93be2dbfd19",
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "The problem is that `insert` has already been there, so we cannot change its type to `bool` without breaking backwards compatibility.",
        "createdAt" : "2019-02-11T14:05:21Z",
        "updatedAt" : "2019-02-11T14:05:22Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      },
      {
        "id" : "0b274b93-e20d-4a4b-8930-1ca6810e8e26",
        "parentId" : "5ea86963-491b-4b67-9723-b93be2dbfd19",
        "authorId" : "e0821cf2-fc82-4ec6-8b28-72b8016ac45c",
        "body" : "But it was string type?",
        "createdAt" : "2019-02-11T14:11:12Z",
        "updatedAt" : "2019-02-11T14:11:12Z",
        "lastEditedBy" : "e0821cf2-fc82-4ec6-8b28-72b8016ac45c",
        "tags" : [
        ]
      },
      {
        "id" : "12d84730-1872-4f41-858d-a0064258ee91",
        "parentId" : "5ea86963-491b-4b67-9723-b93be2dbfd19",
        "authorId" : "e0821cf2-fc82-4ec6-8b28-72b8016ac45c",
        "body" : "OK, I buy it. No other easy way to keep compatibility.",
        "createdAt" : "2019-02-11T14:15:52Z",
        "updatedAt" : "2019-02-11T14:15:52Z",
        "lastEditedBy" : "e0821cf2-fc82-4ec6-8b28-72b8016ac45c",
        "tags" : [
        ]
      },
      {
        "id" : "e7c2e559-0793-40e2-8711-66867ca6db16",
        "parentId" : "5ea86963-491b-4b67-9723-b93be2dbfd19",
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "It was string type, but if you put in there anything else than an integer (in the correct range), `ufw` would die anyway. So forcing it to be of type `int` shouldn't break any valid use-case :)",
        "createdAt" : "2019-02-11T14:18:29Z",
        "updatedAt" : "2019-02-11T14:18:29Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      }
    ],
    "commit" : "689ebf0a7b31083b17799c8452b25023260572da",
    "line" : 7,
    "diffHunk" : "@@ -1,1 +55,59 @@      - Insert the corresponding rule as rule number NUM.\n      - Note that ufw numbers rules starting with 1.\n    type: int\n  insert_relative_to:\n    description:"
  },
  {
    "id" : "532497fe-dbdb-453f-8469-c25c4e57836a",
    "prId" : 49796,
    "prUrl" : "https://github.com/ansible/ansible/pull/49796#pullrequestreview-202114228",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "69821d70-1a61-438e-b401-cf3c296133ef",
        "parentId" : null,
        "authorId" : "e0821cf2-fc82-4ec6-8b28-72b8016ac45c",
        "body" : "Related to no default value...",
        "createdAt" : "2019-02-11T13:51:27Z",
        "updatedAt" : "2019-02-11T13:59:54Z",
        "lastEditedBy" : "e0821cf2-fc82-4ec6-8b28-72b8016ac45c",
        "tags" : [
        ]
      }
    ],
    "commit" : "689ebf0a7b31083b17799c8452b25023260572da",
    "line" : 72,
    "diffHunk" : "@@ -1,1 +299,303 @@            delete=dict(type='bool', default=False),\n            route=dict(type='bool', default=False),\n            insert=dict(type='int'),\n            insert_relative_to=dict(choices=['zero', 'first-ipv4', 'last-ipv4', 'first-ipv6', 'last-ipv6'], default='zero'),\n            rule=dict(type='str', choices=['allow', 'deny', 'limit', 'reject']),"
  },
  {
    "id" : "70c72aa5-9680-4332-ab4b-265e622003af",
    "prId" : 49796,
    "prUrl" : "https://github.com/ansible/ansible/pull/49796#pullrequestreview-202118182",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "84f17b55-5356-4e1d-95d3-5a3249478c92",
        "parentId" : null,
        "authorId" : "e0821cf2-fc82-4ec6-8b28-72b8016ac45c",
        "body" : "Skipping insert?",
        "createdAt" : "2019-02-11T13:55:59Z",
        "updatedAt" : "2019-02-11T13:59:54Z",
        "lastEditedBy" : "e0821cf2-fc82-4ec6-8b28-72b8016ac45c",
        "tags" : [
        ]
      },
      {
        "id" : "7f1098ce-ff37-4675-9faf-3c57f1bb9d37",
        "parentId" : "84f17b55-5356-4e1d-95d3-5a3249478c92",
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "Without `insert`, `ufw` will just append the new rule.",
        "createdAt" : "2019-02-11T13:59:21Z",
        "updatedAt" : "2019-02-11T13:59:54Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      }
    ],
    "commit" : "689ebf0a7b31083b17799c8452b25023260572da",
    "line" : 106,
    "diffHunk" : "@@ -1,1 +500,504 @@                        # ufw does not like it when the insert number is larger than the\n                        # maximal rule number for IPv4/IPv6.\n                        insert_to = None\n                cmd.append([insert_to is not None, \"insert %s\" % insert_to])\n            cmd.append([value])"
  }
]