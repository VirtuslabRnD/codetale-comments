[
  {
    "id" : "aaec0f9f-9d83-420d-9db4-c457baa4632e",
    "prId" : 20164,
    "prUrl" : "https://github.com/ansible/ansible/pull/20164#pullrequestreview-16331170",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b01bd357-0cc1-4683-91ed-4e8e4c1187a4",
        "parentId" : null,
        "authorId" : "311820dd-fcb9-46df-a201-9c0e7d6fac58",
        "body" : "For COM/IDispatch objects like this without a managed interface wrapper, this is unfortunately about the best you can do (otherwise you'd just do `-is [type]`). The \"technically proper\" thing would be a `Marshal.QueryInterface` for the IID of WshShortcut/WshUrlShortcut, but that's pretty fugly. Given how ancient this stuff is and how unlikely it is that `Arguments` will magically appear on the WshUrlShortcut down the line, this is probably the best balance of readability/pedantic correctness. A comment explaining why you're doing it for the next guy might be good though, eg, \"determine if we have a WshShortcut or WshUrlShortcut by checking for presence of Arguments property\"...",
        "createdAt" : "2017-01-12T05:08:37Z",
        "updatedAt" : "2017-01-15T21:26:35Z",
        "lastEditedBy" : "311820dd-fcb9-46df-a201-9c0e7d6fac58",
        "tags" : [
        ]
      },
      {
        "id" : "706df1a9-2ab4-4259-a966-57a270f05b27",
        "parentId" : "b01bd357-0cc1-4683-91ed-4e8e4c1187a4",
        "authorId" : "7268595c-1eb4-4b5f-9277-90f183130a4b",
        "body" : "Well, the thing is (and I only learned it yesterday !) that a URL shortcut object only has a location and a URL. That is why I had to move everything out of the way if it was an URL shortcut. It looks a bit weird/wrong, but a URL shortcut is just very limited (and decided based on the extension...).\r\n\r\nWhich means I can also look at the destination to know what object it will be. But I prefer to leave that up to Windows (who knows what they will come up with in the future ;-)).\r\n\r\nSo I read from you that I need to document this more explicitly in the code, will do.\r\n(For me this is new, but maybe this was common knowledge for Windows admins ;-))",
        "createdAt" : "2017-01-12T10:52:37Z",
        "updatedAt" : "2017-01-15T21:26:35Z",
        "lastEditedBy" : "7268595c-1eb4-4b5f-9277-90f183130a4b",
        "tags" : [
        ]
      }
    ],
    "commit" : "2bb1e87da15f75cf0f305220b972cc13ff01222f",
    "line" : null,
    "diffHunk" : "@@ -1,1 +96,100 @@\n    # TODO: Find a better way to do has_attr() or isinstance() ?\n    If (Get-Member -InputObject $ShortCut -Name Arguments) {\n\n        # This is a full-featured application shortcut !"
  },
  {
    "id" : "ba058334-688b-4258-ad42-03a4226d74f7",
    "prId" : 20164,
    "prUrl" : "https://github.com/ansible/ansible/pull/20164#pullrequestreview-16331419",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "95129946-b8c8-424a-b8ca-03d2928b3454",
        "parentId" : null,
        "authorId" : "311820dd-fcb9-46df-a201-9c0e7d6fac58",
        "body" : "Also, doesn't look like you did anything with the WshUrlShortcut case (eg, delete/re-create if necessary)",
        "createdAt" : "2017-01-12T05:11:38Z",
        "updatedAt" : "2017-01-15T21:26:35Z",
        "lastEditedBy" : "311820dd-fcb9-46df-a201-9c0e7d6fac58",
        "tags" : [
        ]
      },
      {
        "id" : "4d8c8bbb-7f4f-47ea-b1bd-cb36d0a44204",
        "parentId" : "95129946-b8c8-424a-b8ca-03d2928b3454",
        "authorId" : "7268595c-1eb4-4b5f-9277-90f183130a4b",
        "body" : "Exactly, for a WshUrlShortcut object only the TargetPath can be managed. I will have to make that clear in the documentation. But I wonder if a hard failure is in order if it is a URL shortcut and other parameters are provided ? Currently I ignore them if it is a WshUrlShortcut.\r\n\r\nPS I think this is pretty limited anyway, what I did at the elementary school is encapsulated the URL in a call to Chrome so that you can have a proper icon, description, etc... (I now added an example for a wshShortcut and a WshUrlShortcut for a URL, the first is more comprehensive and powerful)",
        "createdAt" : "2017-01-12T10:54:11Z",
        "updatedAt" : "2017-01-15T21:26:35Z",
        "lastEditedBy" : "7268595c-1eb4-4b5f-9277-90f183130a4b",
        "tags" : [
        ]
      }
    ],
    "commit" : "2bb1e87da15f75cf0f305220b972cc13ff01222f",
    "line" : null,
    "diffHunk" : "@@ -1,1 +97,101 @@    # TODO: Find a better way to do has_attr() or isinstance() ?\n    If (Get-Member -InputObject $ShortCut -Name Arguments) {\n\n        # This is a full-featured application shortcut !\n        If ($orig_args -ne $null -and $ShortCut.Arguments -ne $args) {"
  },
  {
    "id" : "8b93aaad-ff10-4b1a-a0c0-139e9d514d2b",
    "prId" : 20164,
    "prUrl" : "https://github.com/ansible/ansible/pull/20164#pullrequestreview-16331987",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ba5293f5-2729-4d37-a2d0-9adceb1d3866",
        "parentId" : null,
        "authorId" : "311820dd-fcb9-46df-a201-9c0e7d6fac58",
        "body" : "Again a pedantic thing, but shouldn't it be possible to set most of these to null/empty?",
        "createdAt" : "2017-01-12T05:19:09Z",
        "updatedAt" : "2017-01-15T21:26:35Z",
        "lastEditedBy" : "311820dd-fcb9-46df-a201-9c0e7d6fac58",
        "tags" : [
        ]
      },
      {
        "id" : "f2871958-27f3-4584-948d-f0cffc53f965",
        "parentId" : "ba5293f5-2729-4d37-a2d0-9adceb1d3866",
        "authorId" : "7268595c-1eb4-4b5f-9277-90f183130a4b",
        "body" : "I did this on purpose actually. The reason is that I want to check if it set to $null (from the parameter handling) and not explicitly set to \"\". Two reasons:\r\n1. Maybe the user wants it empty\r\n2. When environment variables are substituted, $null becomes \"\", so I loose whether it was originally undefined, or explicitely set to an empty string. That is why I eventually moved to $orig_ variables, and I prefer to keep the exact $null match.",
        "createdAt" : "2017-01-12T10:57:22Z",
        "updatedAt" : "2017-01-15T21:26:35Z",
        "lastEditedBy" : "7268595c-1eb4-4b5f-9277-90f183130a4b",
        "tags" : [
        ]
      }
    ],
    "commit" : "2bb1e87da15f75cf0f305220b972cc13ff01222f",
    "line" : null,
    "diffHunk" : "@@ -1,1 +112,116 @@\n        # FIXME: Not all values are accepted here !\n        If ($hotkey -ne $null -and $ShortCut.Hotkey -ne $hotkey) {\n            $result.changed = $true\n            $ShortCut.Hotkey = $hotkey"
  }
]