[
  {
    "id" : "f12d7e7b-b22e-4923-b3b8-174516234372",
    "prId" : 55862,
    "prUrl" : "https://github.com/ansible/ansible/pull/55862#pullrequestreview-236850711",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f49d1ba0-c739-4565-ad24-994f863e313c",
        "parentId" : null,
        "authorId" : "7268595c-1eb4-4b5f-9277-90f183130a4b",
        "body" : "Not sure if this should be part of this PR. May need to be discussed separately.",
        "createdAt" : "2019-05-13T14:35:00Z",
        "updatedAt" : "2019-07-05T09:16:56Z",
        "lastEditedBy" : "7268595c-1eb4-4b5f-9277-90f183130a4b",
        "tags" : [
        ]
      },
      {
        "id" : "5829144f-4231-428f-8155-1929add901d2",
        "parentId" : "f49d1ba0-c739-4565-ad24-994f863e313c",
        "authorId" : "36bff90a-e429-4cb4-8593-f59950bc4761",
        "body" : "This was one of the problems with pslint and it is the same implementation just with CIM without any functional change",
        "createdAt" : "2019-05-13T18:35:02Z",
        "updatedAt" : "2019-07-05T09:16:56Z",
        "lastEditedBy" : "36bff90a-e429-4cb4-8593-f59950bc4761",
        "tags" : [
        ]
      },
      {
        "id" : "4977eef8-2c55-4ee8-b31f-7050d3b78c15",
        "parentId" : "f49d1ba0-c739-4565-ad24-994f863e313c",
        "authorId" : "7268595c-1eb4-4b5f-9277-90f183130a4b",
        "body" : "As I said, I am not sure. Someone else has to verify this.",
        "createdAt" : "2019-05-13T18:41:24Z",
        "updatedAt" : "2019-07-05T09:16:56Z",
        "lastEditedBy" : "7268595c-1eb4-4b5f-9277-90f183130a4b",
        "tags" : [
        ]
      }
    ],
    "commit" : "7d1c44e5425f6f8faa5a058a6b599a0979339eeb",
    "line" : 58,
    "diffHunk" : "@@ -1,1 +147,151 @@    Write-DebugLog (\"Calling JoinDomainOrWorkgroup with workgroup {0}\" -f $workgroup_name)\n    try {\n        $swg_result = Get-CimInstance Win32_ComputerSystem | Invoke-CimMethod -MethodName JoinDomainOrWorkgroup -Arguments @{Name=\"$workgroup_name\"}\n    } catch {\n        Fail-Json -obj $result -message \"failed to call Win32_ComputerSystem.JoinDomainOrWorkgroup($workgroup_name): $($_.Exception.Message)\""
  },
  {
    "id" : "a3e85b1d-5754-4e27-a1d9-47e693eb7175",
    "prId" : 55862,
    "prUrl" : "https://github.com/ansible/ansible/pull/55862#pullrequestreview-242449508",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f0742b36-8d5c-46e1-94d0-21588c821835",
        "parentId" : null,
        "authorId" : "7c547162-2334-4e33-a627-e146840da9ec",
        "body" : "Set-Workgroup looks like it returns something, we should case piping to `$null` or using the var.",
        "createdAt" : "2019-05-28T05:13:27Z",
        "updatedAt" : "2019-07-05T09:16:56Z",
        "lastEditedBy" : "7c547162-2334-4e33-a627-e146840da9ec",
        "tags" : [
        ]
      }
    ],
    "commit" : "7d1c44e5425f6f8faa5a058a6b599a0979339eeb",
    "line" : 85,
    "diffHunk" : "@@ -1,1 +177,181 @@    # we're already on a workgroup- change it.\n    Else {\n        Set-Workgroup $workgroup_name\n    }\n}"
  },
  {
    "id" : "a342ba80-6160-4264-ba03-c4fcff4c5748",
    "prId" : 55862,
    "prUrl" : "https://github.com/ansible/ansible/pull/55862#pullrequestreview-242890396",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "86fe3a94-6386-44c0-a1b3-62fc1620196d",
        "parentId" : null,
        "authorId" : "7c547162-2334-4e33-a627-e146840da9ec",
        "body" : "`Join-Workgroup` can call `Set-Workgroup` which can return something, we will still need to make sure the output is put somewhere and not returned back to the controller.",
        "createdAt" : "2019-05-28T05:14:42Z",
        "updatedAt" : "2019-07-05T09:16:56Z",
        "lastEditedBy" : "7c547162-2334-4e33-a627-e146840da9ec",
        "tags" : [
        ]
      },
      {
        "id" : "5299e23e-a9d2-45e6-a4dd-0184a1b2d2ec",
        "parentId" : "86fe3a94-6386-44c0-a1b3-62fc1620196d",
        "authorId" : "36bff90a-e429-4cb4-8593-f59950bc4761",
        "body" : "I can redirect to null",
        "createdAt" : "2019-05-28T20:00:59Z",
        "updatedAt" : "2019-07-05T09:16:56Z",
        "lastEditedBy" : "36bff90a-e429-4cb4-8593-f59950bc4761",
        "tags" : [
        ]
      }
    ],
    "commit" : "7d1c44e5425f6f8faa5a058a6b599a0979339eeb",
    "line" : 121,
    "diffHunk" : "@@ -1,1 +288,292 @@                If(-not $workgroup_match) {\n                    Write-DebugLog (\"setting workgroup to {0}\" -f $workgroup_name)\n                    Join-Workgroup -workgroup_name $workgroup_name -domain_admin_user $domain_admin_user -domain_admin_password $domain_admin_password\n\n                    # this change requires a reboot"
  },
  {
    "id" : "ffdfe68a-9eb8-43c0-90bb-1a8fd3278cf5",
    "prId" : 55862,
    "prUrl" : "https://github.com/ansible/ansible/pull/55862#pullrequestreview-258185461",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "1d5a648b-9803-402e-91fe-7f1ca7a67db4",
        "parentId" : null,
        "authorId" : "7c547162-2334-4e33-a627-e146840da9ec",
        "body" : "My comment still stands here, `Set-Workgroup` returns something and we should be redirecting it to `$null` to no confuse the json parser on the controller side.",
        "createdAt" : "2019-07-04T22:28:10Z",
        "updatedAt" : "2019-07-05T09:16:56Z",
        "lastEditedBy" : "7c547162-2334-4e33-a627-e146840da9ec",
        "tags" : [
        ]
      },
      {
        "id" : "4646368e-6653-4b87-9377-cf3fc3c17a1a",
        "parentId" : "1d5a648b-9803-402e-91fe-7f1ca7a67db4",
        "authorId" : "36bff90a-e429-4cb4-8593-f59950bc4761",
        "body" : "and my response too :), changing it breaks the CI - you want to keep it or should I look into changing the tests?\r\n",
        "createdAt" : "2019-07-04T22:45:38Z",
        "updatedAt" : "2019-07-05T09:16:56Z",
        "lastEditedBy" : "36bff90a-e429-4cb4-8593-f59950bc4761",
        "tags" : [
        ]
      },
      {
        "id" : "1c78b351-68d9-4a21-8c0c-5fc299720af4",
        "parentId" : "1d5a648b-9803-402e-91fe-7f1ca7a67db4",
        "authorId" : "7c547162-2334-4e33-a627-e146840da9ec",
        "body" : "Hmm I don't see how based on looking at the code, do you have a link to the failure? I'm just looking at `Set-Workgroup` and the return statement is on a newline but still part of the failing brace so it doesn't even look like that does anything https://github.com/ansible/ansible/blob/66e0041b3ab5d24ae51f28938cf6a90af60374e6/lib/ansible/modules/windows/win_domain_membership.ps1#L158. So maybe just return that line from the function as the module will exit out when calling `Fail-Json`.",
        "createdAt" : "2019-07-04T22:49:36Z",
        "updatedAt" : "2019-07-05T09:16:56Z",
        "lastEditedBy" : "7c547162-2334-4e33-a627-e146840da9ec",
        "tags" : [
        ]
      },
      {
        "id" : "fc8d30df-11b8-47f3-880b-523a839283d7",
        "parentId" : "1d5a648b-9803-402e-91fe-7f1ca7a67db4",
        "authorId" : "36bff90a-e429-4cb4-8593-f59950bc4761",
        "body" : "https://app.shippable.com/github/ansible/ansible/runs/125201",
        "createdAt" : "2019-07-04T23:10:16Z",
        "updatedAt" : "2019-07-05T09:16:56Z",
        "lastEditedBy" : "36bff90a-e429-4cb4-8593-f59950bc4761",
        "tags" : [
        ]
      },
      {
        "id" : "dd673475-c5c1-4a76-a8c6-c5f2ef9a1e80",
        "parentId" : "1d5a648b-9803-402e-91fe-7f1ca7a67db4",
        "authorId" : "7c547162-2334-4e33-a627-e146840da9ec",
        "body" : "Ahhh, it's because we call `Fail-Json` which outputs the return json in the output stream instead of stdout. While we exit it early the json string is redirected. Ok If you can just fix up the indentation of line 158 and remove that return statement I think we are all good.",
        "createdAt" : "2019-07-04T23:21:50Z",
        "updatedAt" : "2019-07-05T09:16:56Z",
        "lastEditedBy" : "7c547162-2334-4e33-a627-e146840da9ec",
        "tags" : [
        ]
      },
      {
        "id" : "23bd5a0e-e7f7-4837-b47d-007f7bb0b56d",
        "parentId" : "1d5a648b-9803-402e-91fe-7f1ca7a67db4",
        "authorId" : "36bff90a-e429-4cb4-8593-f59950bc4761",
        "body" : "you want the function to not return anything then?",
        "createdAt" : "2019-07-04T23:29:28Z",
        "updatedAt" : "2019-07-05T09:16:56Z",
        "lastEditedBy" : "36bff90a-e429-4cb4-8593-f59950bc4761",
        "tags" : [
        ]
      },
      {
        "id" : "3fffc2ff-db0d-4018-ae19-ef5d29d344ca",
        "parentId" : "1d5a648b-9803-402e-91fe-7f1ca7a67db4",
        "authorId" : "7c547162-2334-4e33-a627-e146840da9ec",
        "body" : "Yes, the `Set-Workgroup` function has the following line https://github.com/ansible/ansible/blob/devel/lib/ansible/modules/windows/win_domain_membership.ps1#L156. It makes it look like the function returns that result but because the brace for the if statement is placed after this call it is actually being run after `Fail-Json`. `Fail-Json` stops the pipeline so nothing will ever be called making the `return` line unreachable. So right now it works it's just horribly confusing and leads to the conversation above.",
        "createdAt" : "2019-07-04T23:36:20Z",
        "updatedAt" : "2019-07-05T09:16:56Z",
        "lastEditedBy" : "7c547162-2334-4e33-a627-e146840da9ec",
        "tags" : [
        ]
      },
      {
        "id" : "3dac4e08-bfa2-4abd-8634-72f4c406590c",
        "parentId" : "1d5a648b-9803-402e-91fe-7f1ca7a67db4",
        "authorId" : "36bff90a-e429-4cb4-8593-f59950bc4761",
        "body" : "removed, let's see what happens - fingers crossed",
        "createdAt" : "2019-07-05T00:09:09Z",
        "updatedAt" : "2019-07-05T09:16:56Z",
        "lastEditedBy" : "36bff90a-e429-4cb4-8593-f59950bc4761",
        "tags" : [
        ]
      }
    ],
    "commit" : "7d1c44e5425f6f8faa5a058a6b599a0979339eeb",
    "line" : 85,
    "diffHunk" : "@@ -1,1 +177,181 @@    # we're already on a workgroup- change it.\n    Else {\n        Set-Workgroup $workgroup_name\n    }\n}"
  },
  {
    "id" : "6b18eaa0-752c-4e72-a3d5-1b10fc34c73f",
    "prId" : 55862,
    "prUrl" : "https://github.com/ansible/ansible/pull/55862#pullrequestreview-258179502",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "78e7fff0-d4b8-4b21-a88f-cc11ed8cd0e9",
        "parentId" : null,
        "authorId" : "7c547162-2334-4e33-a627-e146840da9ec",
        "body" : "`Join-Workgroup` can call `Set-Workgroup` which returns something, we need to redirect to `$null`.",
        "createdAt" : "2019-07-04T22:29:59Z",
        "updatedAt" : "2019-07-05T09:16:56Z",
        "lastEditedBy" : "7c547162-2334-4e33-a627-e146840da9ec",
        "tags" : [
        ]
      },
      {
        "id" : "60275ec7-7480-4366-958e-3481d3fa35c5",
        "parentId" : "78e7fff0-d4b8-4b21-a88f-cc11ed8cd0e9",
        "authorId" : "36bff90a-e429-4cb4-8593-f59950bc4761",
        "body" : "changing it breaks the CI - you want to keep it or should I look into changing the tests?\r\n",
        "createdAt" : "2019-07-04T22:45:52Z",
        "updatedAt" : "2019-07-05T09:16:56Z",
        "lastEditedBy" : "36bff90a-e429-4cb4-8593-f59950bc4761",
        "tags" : [
        ]
      }
    ],
    "commit" : "7d1c44e5425f6f8faa5a058a6b599a0979339eeb",
    "line" : 121,
    "diffHunk" : "@@ -1,1 +288,292 @@                If(-not $workgroup_match) {\n                    Write-DebugLog (\"setting workgroup to {0}\" -f $workgroup_name)\n                    Join-Workgroup -workgroup_name $workgroup_name -domain_admin_user $domain_admin_user -domain_admin_password $domain_admin_password\n\n                    # this change requires a reboot"
  }
]