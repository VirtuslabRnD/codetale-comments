[
  {
    "id" : "961d37a0-85f4-46e0-8301-e16819e10191",
    "prId" : 27678,
    "prUrl" : "https://github.com/ansible/ansible/pull/27678#pullrequestreview-54794495",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "90dc6961-9b00-45f4-ad81-1e8dc8efe74b",
        "parentId" : null,
        "authorId" : "7268595c-1eb4-4b5f-9277-90f183130a4b",
        "body" : "I just noticed that the module creates the destination directory, but that is not done on purpose (even in the copy module).",
        "createdAt" : "2017-08-04T08:22:34Z",
        "updatedAt" : "2017-08-19T00:49:22Z",
        "lastEditedBy" : "7268595c-1eb4-4b5f-9277-90f183130a4b",
        "tags" : [
        ]
      },
      {
        "id" : "90e06fdf-060f-4dc2-8258-984e6a6b34c2",
        "parentId" : "90dc6961-9b00-45f4-ad81-1e8dc8efe74b",
        "authorId" : "7c547162-2334-4e33-a627-e146840da9ec",
        "body" : "I just checked `copy` and it created whatever directories were required, even if it was nested in a directory that didn't exist.",
        "createdAt" : "2017-08-06T21:02:49Z",
        "updatedAt" : "2017-08-19T00:49:22Z",
        "lastEditedBy" : "7c547162-2334-4e33-a627-e146840da9ec",
        "tags" : [
        ]
      },
      {
        "id" : "1d0febbb-fdbd-4640-b60f-0e26f689a15c",
        "parentId" : "90dc6961-9b00-45f4-ad81-1e8dc8efe74b",
        "authorId" : "7268595c-1eb4-4b5f-9277-90f183130a4b",
        "body" : "Weird, that hasn't been the case in the past IIRC. One of the issues is how would it translate the `mode` parameter to directories. So a likely security issue when done. The other problem is that if it would fail for whatever reason (i.e. filesystem full) the directory might have been created, the action failed but there was still a change. Those are just a few reasons why in the past we expected the directory to exist.",
        "createdAt" : "2017-08-06T21:23:50Z",
        "updatedAt" : "2017-08-19T00:49:22Z",
        "lastEditedBy" : "7268595c-1eb4-4b5f-9277-90f183130a4b",
        "tags" : [
        ]
      },
      {
        "id" : "de6fb049-b296-4ada-b4d4-645d8b5f3374",
        "parentId" : "90dc6961-9b00-45f4-ad81-1e8dc8efe74b",
        "authorId" : "7268595c-1eb4-4b5f-9277-90f183130a4b",
        "body" : "Also adding and removing would not restore to how it was in this case.",
        "createdAt" : "2017-08-06T21:26:53Z",
        "updatedAt" : "2017-08-19T00:49:22Z",
        "lastEditedBy" : "7268595c-1eb4-4b5f-9277-90f183130a4b",
        "tags" : [
        ]
      },
      {
        "id" : "19a6ab80-ac55-45d6-ad83-e28d074f93a7",
        "parentId" : "90dc6961-9b00-45f4-ad81-1e8dc8efe74b",
        "authorId" : "7c547162-2334-4e33-a627-e146840da9ec",
        "body" : "Not sure, I would have thought it wouldn't have created it but was basing my changes from how it was currently functioning, will follow up as well.",
        "createdAt" : "2017-08-06T22:02:22Z",
        "updatedAt" : "2017-08-19T00:49:22Z",
        "lastEditedBy" : "7c547162-2334-4e33-a627-e146840da9ec",
        "tags" : [
        ]
      },
      {
        "id" : "a2ce8c0a-b802-4868-ade2-8238226b443b",
        "parentId" : "90dc6961-9b00-45f4-ad81-1e8dc8efe74b",
        "authorId" : "7c547162-2334-4e33-a627-e146840da9ec",
        "body" : "I just tested Ansible from 1.9.4 and onwards and they all create the parent directory if it doesn't exist. I'll update the documentation but because the functionality is already there for so many versions I don't think we will easily be able to remove it.\r\n\r\nEdit: looks like there is one case where it doesn't create the parent dir, that's if dest is the path to a file without `/` or `\\` at the end. I'll test this out and update the docs",
        "createdAt" : "2017-08-07T22:41:44Z",
        "updatedAt" : "2017-08-19T00:49:22Z",
        "lastEditedBy" : "7c547162-2334-4e33-a627-e146840da9ec",
        "tags" : [
        ]
      }
    ],
    "commit" : "f1fa9f0ed0bff23c8e2d3215e522c8140f7bc272",
    "line" : 119,
    "diffHunk" : "@@ -1,1 +72,76 @@        } elseif (-not (Test-Path -Path $file_dir)) {\n            # directory doesn't exist, need to create\n            New-Item -Path $file_dir -ItemType Directory -WhatIf:$check_mode | Out-Null\n            $diff += \"+$file_dir\\`n\"\n        }"
  },
  {
    "id" : "270b15e0-2b7b-45a1-9174-1558cce3393a",
    "prId" : 27678,
    "prUrl" : "https://github.com/ansible/ansible/pull/27678#pullrequestreview-54543873",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "49374d51-c5a1-4e6a-82fe-0389cdc063a5",
        "parentId" : null,
        "authorId" : "7268595c-1eb4-4b5f-9277-90f183130a4b",
        "body" : "And this shouldn't be a concern if the module doesn't create the directory. (Obviously this module would still fail if the directory was created in the same playbook run in check-mode, but also not our concern)",
        "createdAt" : "2017-08-04T08:23:55Z",
        "updatedAt" : "2017-08-19T00:49:22Z",
        "lastEditedBy" : "7268595c-1eb4-4b5f-9277-90f183130a4b",
        "tags" : [
        ]
      },
      {
        "id" : "8b818385-1826-429c-a18e-df9842579aeb",
        "parentId" : "49374d51-c5a1-4e6a-82fe-0389cdc063a5",
        "authorId" : "7c547162-2334-4e33-a627-e146840da9ec",
        "body" : "See comment above",
        "createdAt" : "2017-08-06T21:03:12Z",
        "updatedAt" : "2017-08-19T00:49:22Z",
        "lastEditedBy" : "7c547162-2334-4e33-a627-e146840da9ec",
        "tags" : [
        ]
      }
    ],
    "commit" : "f1fa9f0ed0bff23c8e2d3215e522c8140f7bc272",
    "line" : 137,
    "diffHunk" : "@@ -1,1 +84,88 @@            # cannot run with -WhatIf:$check_mode as if the parent dir didn't\n            # exist and was created above would still not exist in check mode\n            Copy-Item -Path $source -Destination $dest -Force | Out-Null\n        }\n        $diff += \"+$dest`n\""
  },
  {
    "id" : "60b6e506-cc97-4d1e-b0e2-000ecbcf0881",
    "prId" : 27678,
    "prUrl" : "https://github.com/ansible/ansible/pull/27678#pullrequestreview-56988068",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5b9c33b3-749e-426f-a5fe-3e8e5fcb1f94",
        "parentId" : null,
        "authorId" : "311820dd-fcb9-46df-a201-9c0e7d6fac58",
        "body" : "Is the `-Recurse` necessary for file symlinks or something? Seems superfluous at first glance (since we know it's not a dir)...",
        "createdAt" : "2017-08-17T16:52:48Z",
        "updatedAt" : "2017-08-19T03:33:23Z",
        "lastEditedBy" : "311820dd-fcb9-46df-a201-9c0e7d6fac58",
        "tags" : [
        ]
      }
    ],
    "commit" : "f1fa9f0ed0bff23c8e2d3215e522c8140f7bc272",
    "line" : 130,
    "diffHunk" : "@@ -1,1 +77,81 @@\n        if (Test-Path -Path $dest -PathType Leaf) {\n            Remove-Item -Path $dest -Force -Recurse | Out-Null\n            $diff += \"-$dest`n\"\n        }"
  },
  {
    "id" : "36ec4410-af26-43a8-ad81-449af515f71b",
    "prId" : 27678,
    "prUrl" : "https://github.com/ansible/ansible/pull/27678#pullrequestreview-56988068",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0d05298f-e9c1-4018-9fdb-cd5557bd1865",
        "parentId" : null,
        "authorId" : "311820dd-fcb9-46df-a201-9c0e7d6fac58",
        "body" : "s/file file/file/",
        "createdAt" : "2017-08-19T03:22:21Z",
        "updatedAt" : "2017-08-19T03:33:23Z",
        "lastEditedBy" : "311820dd-fcb9-46df-a201-9c0e7d6fac58",
        "tags" : [
        ]
      }
    ],
    "commit" : "f1fa9f0ed0bff23c8e2d3215e522c8140f7bc272",
    "line" : 292,
    "diffHunk" : "@@ -1,1 +225,229 @@    # on the win_copy action plugin and is only run if a change needs to occur\n    if (-not (Test-Path -Path $src -PathType Leaf)) {\n        Fail-Json -obj $result -message \"Cannot expand src zip file file: $src as it does not exist\"\n    }\n"
  }
]