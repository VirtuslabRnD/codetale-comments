[
  {
    "id" : "53ed02f4-68fc-4afa-b37d-4425bbd0e12b",
    "prId" : 26404,
    "prUrl" : "https://github.com/ansible/ansible/pull/26404#pullrequestreview-51478375",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e5713d08-173c-470b-8dcd-0e20a561df23",
        "parentId" : null,
        "authorId" : "7c547162-2334-4e33-a627-e146840da9ec",
        "body" : "Is this being used for anything?",
        "createdAt" : "2017-07-20T21:55:52Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "7c547162-2334-4e33-a627-e146840da9ec",
        "tags" : [
        ]
      },
      {
        "id" : "48ca59a4-5ee4-4dfa-87aa-c5c6657c38dd",
        "parentId" : "e5713d08-173c-470b-8dcd-0e20a561df23",
        "authorId" : "c924d213-2d83-41dd-901a-d29b595f0eeb",
        "body" : "This is used to determine the debug level See below.",
        "createdAt" : "2017-07-21T13:48:05Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "c924d213-2d83-41dd-901a-d29b595f0eeb",
        "tags" : [
        ]
      }
    ],
    "commit" : "1d0b00c6cc6aec5b1198faf0a18debe24a033ebf",
    "line" : 91,
    "diffHunk" : "@@ -1,1 +89,93 @@$check_mode = Get-AnsibleParam -obj $params -name \"_ansible_check_mode\" -type \"bool\" -default $false\n\n$debug_level = Get-AnsibleParam -obj $params -name \"_ansible_verbosity\" -type \"int\"\n$debug = $debug_level -gt 2\n"
  },
  {
    "id" : "acca4a5f-98bf-434c-b775-ca4aee5caa2c",
    "prId" : 26404,
    "prUrl" : "https://github.com/ansible/ansible/pull/26404#pullrequestreview-51478259",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "be733936-788b-4056-91cd-389102c3688f",
        "parentId" : null,
        "authorId" : "7c547162-2334-4e33-a627-e146840da9ec",
        "body" : "Same as above, is this being used for anything. I'm also not sure what the Ansible practice is around returning extra values based on the verbosity level set.",
        "createdAt" : "2017-07-20T21:58:38Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "7c547162-2334-4e33-a627-e146840da9ec",
        "tags" : [
        ]
      },
      {
        "id" : "a88728bd-741a-4567-9875-35d5f6ee7691",
        "parentId" : "be733936-788b-4056-91cd-389102c3688f",
        "authorId" : "c924d213-2d83-41dd-901a-d29b595f0eeb",
        "body" : "The $debug variable is used to determine whether to return XML comparison errors. I can take all the functionality out or take the debug gate out. This was work in concert with removing the emission of the errors to a log on the remote server. ",
        "createdAt" : "2017-07-21T13:47:38Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "c924d213-2d83-41dd-901a-d29b595f0eeb",
        "tags" : [
        ]
      }
    ],
    "commit" : "1d0b00c6cc6aec5b1198faf0a18debe24a033ebf",
    "line" : 92,
    "diffHunk" : "@@ -1,1 +90,94 @@\n$debug_level = Get-AnsibleParam -obj $params -name \"_ansible_verbosity\" -type \"int\"\n$debug = $debug_level -gt 2\n\n$dest = Get-AnsibleParam $params \"path\" -type \"path\" -FailIfEmpty $true -aliases \"dest\", \"file\""
  },
  {
    "id" : "274eb040-8437-4951-91c1-2332a1a1f3a5",
    "prId" : 26404,
    "prUrl" : "https://github.com/ansible/ansible/pull/26404#pullrequestreview-54547008",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e639c075-cab6-4ad2-8070-1b149914ec7d",
        "parentId" : null,
        "authorId" : "7268595c-1eb4-4b5f-9277-90f183130a4b",
        "body" : "Having diff support would be nice.\r\nI plan to add it once **xml** is merged upstream.",
        "createdAt" : "2017-08-06T23:45:36Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "7268595c-1eb4-4b5f-9277-90f183130a4b",
        "tags" : [
        ]
      }
    ],
    "commit" : "1d0b00c6cc6aec5b1198faf0a18debe24a033ebf",
    "line" : 90,
    "diffHunk" : "@@ -1,1 +88,92 @@$params = Parse-Args $args -supports_check_mode $true\n$check_mode = Get-AnsibleParam -obj $params -name \"_ansible_check_mode\" -type \"bool\" -default $false\n\n$debug_level = Get-AnsibleParam -obj $params -name \"_ansible_verbosity\" -type \"int\"\n$debug = $debug_level -gt 2"
  },
  {
    "id" : "d6e9231e-4632-4b79-afa8-468288f2ea33",
    "prId" : 26404,
    "prUrl" : "https://github.com/ansible/ansible/pull/26404#pullrequestreview-123261055",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "af990f39-b407-48d1-865f-f015563f3f40",
        "parentId" : null,
        "authorId" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "body" : "@richardcs I am trying to remove an element from xml file but its not working for me. I am trying following, Please correct me if i am doing wrong.\r\n\r\n`- name: Running XML Transformations with state Absent\r\n     win_xml:\r\n       path:      \"path\\to\\xml\\file\"\r\n       xpath:     \"/configuration/configSections/sectionGroup/section[@name='authentication']\"\r\n       state:     \"absent\"\r\n       fragment: \" \"`",
        "createdAt" : "2018-04-10T12:03:37Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "tags" : [
        ]
      },
      {
        "id" : "a7d2becc-8d40-4818-bb45-5fb7b9f1e365",
        "parentId" : "af990f39-b407-48d1-865f-f015563f3f40",
        "authorId" : "96c857f9-7aca-429f-a0d3-ae94f2034ead",
        "body" : "Should the xpath be `//configuration/configSections/sectionGroup/section[@name='authentication']` - double initial slash?",
        "createdAt" : "2018-04-10T12:10:41Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "96c857f9-7aca-429f-a0d3-ae94f2034ead",
        "tags" : [
        ]
      },
      {
        "id" : "cee72735-e71c-4088-b977-35a37beb001d",
        "parentId" : "af990f39-b407-48d1-865f-f015563f3f40",
        "authorId" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "body" : "@petemounce it worked for other paramerters without adding double initial slash. its not working only if i am trying to delete an element.",
        "createdAt" : "2018-04-10T13:27:44Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "tags" : [
        ]
      },
      {
        "id" : "5e530dec-b183-4c8b-adc8-a99420125c3a",
        "parentId" : "af990f39-b407-48d1-865f-f015563f3f40",
        "authorId" : "c924d213-2d83-41dd-901a-d29b595f0eeb",
        "body" : "I dont think you can have an empty fragment. The xpath should find the root of your XML where the child fragment is, then it will remove that child fragment.\r\n\r\nSo to guess maybe your xpath is \"/configuration/configSections/sectionGroup/\" and your fragment is \"section[@name='authentication']\"",
        "createdAt" : "2018-04-10T15:14:12Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "c924d213-2d83-41dd-901a-d29b595f0eeb",
        "tags" : [
        ]
      },
      {
        "id" : "beb91765-5dd6-488f-91ff-b90ef0ba0a66",
        "parentId" : "af990f39-b407-48d1-865f-f015563f3f40",
        "authorId" : "c924d213-2d83-41dd-901a-d29b595f0eeb",
        "body" : "@petemounce  \"//\" means find it at the root, which is probably artificially the case, but not explicitly necessary .",
        "createdAt" : "2018-04-10T15:19:15Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "c924d213-2d83-41dd-901a-d29b595f0eeb",
        "tags" : [
        ]
      },
      {
        "id" : "e531be86-9e25-41fc-a5cb-9084c20d8b40",
        "parentId" : "af990f39-b407-48d1-865f-f015563f3f40",
        "authorId" : "96c857f9-7aca-429f-a0d3-ae94f2034ead",
        "body" : "Ah, pardon.",
        "createdAt" : "2018-04-10T16:52:37Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "96c857f9-7aca-429f-a0d3-ae94f2034ead",
        "tags" : [
        ]
      },
      {
        "id" : "78dfdd2c-431d-493e-ade8-08c5c8b3bbfd",
        "parentId" : "af990f39-b407-48d1-865f-f015563f3f40",
        "authorId" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "body" : "@richardcs it didn't worked for me , if we give any value in fragment, it tries to add that element( even with the combination of state: \"absent\" ).\r\n\r\n`-name: Running XML Transformations with state Absent\r\n   win_xml: \r\n       path: \"path\\to\\xml\\file\" \r\n       xpath: \"/configuration/configSections/sectionGroup/\" \r\n       state: \"absent\" \r\n       fragment: \"section[@name='authentication']\"\r\n`\r\nit gives following error : **Failed to parse fragment as XML: Cannot convert value \\\"section[@name='authorization']\\\" to type \\\"System.Xml.XmlDocument\\\". Error: \\\"The specified node cannot be inserted as the valid child of this node, because the specified node is the wrong type.\\**",
        "createdAt" : "2018-04-11T05:17:26Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "tags" : [
        ]
      },
      {
        "id" : "0c2118de-bab9-48e2-8e51-ce6295d19c9d",
        "parentId" : "af990f39-b407-48d1-865f-f015563f3f40",
        "authorId" : "c924d213-2d83-41dd-901a-d29b595f0eeb",
        "body" : "Could you provide the XML or a facsimile thereof? I I have enough info to reproduce and test what you are trying to do but need some XML to test with. ",
        "createdAt" : "2018-04-11T14:10:45Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "c924d213-2d83-41dd-901a-d29b595f0eeb",
        "tags" : [
        ]
      },
      {
        "id" : "6e1521a8-77f2-4bdb-aeba-fc98461c11d9",
        "parentId" : "af990f39-b407-48d1-865f-f015563f3f40",
        "authorId" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "body" : "```\r\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<!--\r\n  For more information on how to configure your ASP.NET application, please visit\r\n  http://go.microsoft.com/fwlink/?LinkId=169433\r\n  -->\r\n<configuration>\r\n  <configSections>\r\n      <sectionGroup name=\"applicationSettings\" type=\"System.Configuration.ApplicationSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" >\r\n          <section name=\"GKE.DS.ALM.Patterns.DotNet.App.Web.Properties.Settings\" type=\"System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" requirePermission=\"false\" />\r\n      </sectionGroup>\r\n\t <sectionGroup name=\"GKE.ds.security\" type=\"GKE.DS.Security.Configuration.SecuritySectionGroup, GKE.DS.Security\">\r\n      <section name=\"authorization\" type=\"GKE.DS.Security.Configuration.AuthorizationSection, GKE.DS.Security\" />\r\n      <section name=\"authentication\" type=\"GKE.DS.Security.Configuration.AuthenticationSection, GKE.DS.Security\" />    \r\n     </sectionGroup>\r\n\t<!--\r\n  Adding a multiline comment\r\n  second line comment\r\n  third line\r\n  -->\r\n  </configSections>\r\n  <system.web>\r\n    <compilation debug=\"true\" targetFramework=\"4.5\" />\r\n    <httpRuntime targetFramework=\"4.5\" />\r\n  </system.web>\r\n  <appSettings>\r\n  </appSettings>\r\n<applicationSettings>\r\n    <GKE.DS.ALM.Patterns.DotNet.App.Web.Properties.Settings>\r\n      <setting name=\"Setting1\" serializeAs=\"String\">\r\n        <value>Setting1Value</value>\r\n      </setting>\r\n    </GKE.DS.ALM.Patterns.DotNet.App.Web.Properties.Settings>\r\n  </applicationSettings>\r\n</configuration>\r\n```",
        "createdAt" : "2018-04-11T15:04:35Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "tags" : [
        ]
      },
      {
        "id" : "0d8e9e09-9b52-44b8-9035-3b7e428e6dac",
        "parentId" : "af990f39-b407-48d1-865f-f015563f3f40",
        "authorId" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "body" : "We need to remove these lines.\r\n`<section name=\"authorization\" type=\"GKE.DS.Security.Configuration.AuthorizationSection, GKE.DS.Security\" />\r\n      <section name=\"authentication\" type=\"GKE.DS.Security.Configuration.AuthenticationSection, GKE.DS.Security\" />    `",
        "createdAt" : "2018-04-11T15:07:16Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "tags" : [
        ]
      },
      {
        "id" : "efe9814b-4796-4139-bf2b-5357ce45afce",
        "parentId" : "af990f39-b407-48d1-865f-f015563f3f40",
        "authorId" : "c924d213-2d83-41dd-901a-d29b595f0eeb",
        "body" : "I apologize, I was confused. If you were adding an element you would specify the XPath and the entire element you want added for the fragment. I think for removing you would also have to specify the entire fragment you want removed. The module recursively checks for \"equality\" so you  have to have the entire fragment. Also fragments are not treated as XPath, sorry for that mistake. \r\n\r\nSo your xpath would be \"/configuration/configSections\" (n.b. no ending slash) and you would need to use the module twice, once with fragment as `'<section name=\"authorization\" type=\"GKE.DS.Security.Configuration.AuthorizationSection, GKE.DS.Security\" />'` and again with fragment as `'<section name=\"authentication\" type=\"GKE.DS.Security.Configuration.AuthenticationSection, GKE.DS.Security\" />'`",
        "createdAt" : "2018-04-11T17:13:27Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "c924d213-2d83-41dd-901a-d29b595f0eeb",
        "tags" : [
        ]
      },
      {
        "id" : "9b157f16-969b-41c3-b005-222a8b9a19f4",
        "parentId" : "af990f39-b407-48d1-865f-f015563f3f40",
        "authorId" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "body" : "This also didn't worked for me.\r\n\r\n`-name: Running XML Transformations with state Absent win_xml: path: \"path\\to\\xml\\file\" xpath: \"/configuration/configSections\" state: \"absent\" fragment: \"<section name='authorization' type='GKE.DS.Security.Configuration.AuthorizationSection, GKE.DS.Security' />\"`\r\n\r\nthis passes the task but nothing changes. I am completely stuck here, I need to find a way to delete the elements from the xml file.\r\n\r\nDo you have any example for which the \"absent\" keyword works?\r\n",
        "createdAt" : "2018-04-13T08:21:33Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "tags" : [
        ]
      },
      {
        "id" : "a4e98313-622a-4ff7-9eb4-c095cab87209",
        "parentId" : "af990f39-b407-48d1-865f-f015563f3f40",
        "authorId" : "c924d213-2d83-41dd-901a-d29b595f0eeb",
        "body" : "Ok, I have tested this and verified that this works. The way GitHub formats the code blocks makes it hard to read the XML you're working with. The XPath should be `'/configuration/configSections/sectionGroup[@name=\"GKE.ds.security\"]'` and the full playbook used is as follows:\r\n\r\n```\r\n---\r\n - name: win_xml module test with absent\r\n   hosts: []\r\n   tasks:\r\n     - name: run the win_xml module\r\n       win_xml:\r\n          path: C:\\\\Users\\richardcs\\Temp\\test.xml\r\n          xpath: '/configuration/configSections/sectionGroup[@name=\"GKE.ds.security\"]'\r\n          fragment: '<section name=\"authorization\" type=\"GKE.DS.Security.Configuration.AuthorizationSection, GKE.DS.Security\" />'\r\n          type: element\r\n          state: absent\r\n```",
        "createdAt" : "2018-04-13T15:44:13Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "c924d213-2d83-41dd-901a-d29b595f0eeb",
        "tags" : [
        ]
      },
      {
        "id" : "54e70548-b398-4b2e-a19b-7e40091030d9",
        "parentId" : "af990f39-b407-48d1-865f-f015563f3f40",
        "authorId" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "body" : "Okay I will give it a try.",
        "createdAt" : "2018-04-14T05:46:53Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "tags" : [
        ]
      },
      {
        "id" : "15b56d07-f245-4309-a475-46a74a36ccd8",
        "parentId" : "af990f39-b407-48d1-865f-f015563f3f40",
        "authorId" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "body" : "@richardcs its worked ..!! thanks for helping me out. In Fragment , you have to give element exactly the same as in your xml file.",
        "createdAt" : "2018-04-23T09:47:03Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "tags" : [
        ]
      },
      {
        "id" : "ed678019-e5ec-4de7-8c12-530cbac53e41",
        "parentId" : "af990f39-b407-48d1-865f-f015563f3f40",
        "authorId" : "c924d213-2d83-41dd-901a-d29b595f0eeb",
        "body" : "@abhijeetka yes, the logic there is if you were adding it, the default behavior, you would have to give the entire XML fragment you wanted to add, obviously. So to delete, you do the same. Glad it worked for you. ",
        "createdAt" : "2018-04-23T14:15:45Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "c924d213-2d83-41dd-901a-d29b595f0eeb",
        "tags" : [
        ]
      },
      {
        "id" : "3fd7356c-5d3d-4829-ad2b-6fb4e980b77c",
        "parentId" : "af990f39-b407-48d1-865f-f015563f3f40",
        "authorId" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "body" : "@richardcs one last thing that i want to know, Can we add the capability to delete even the attributes from the elements?\r\nWe are trying to remove only the attributes from the xml element.\r\nFor. Ex `<language default=\"eng\" style=\"arial\"></language>`\r\nWe want to delete the default attribute only.",
        "createdAt" : "2018-05-14T14:46:57Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "tags" : [
        ]
      },
      {
        "id" : "5cf92539-d748-4b6c-97d0-133a7dd75d8c",
        "parentId" : "af990f39-b407-48d1-865f-f015563f3f40",
        "authorId" : "c924d213-2d83-41dd-901a-d29b595f0eeb",
        "body" : "I don't think the current module supports absent for attributes. If you give me the .xml you are working with I can probably add it. ",
        "createdAt" : "2018-05-15T21:09:22Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "c924d213-2d83-41dd-901a-d29b595f0eeb",
        "tags" : [
        ]
      },
      {
        "id" : "9a8bc746-631f-45c4-8156-e884059f73be",
        "parentId" : "af990f39-b407-48d1-865f-f015563f3f40",
        "authorId" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "body" : "@richardcs   Here is the xml file.\r\n```\r\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<!--\r\n  For more information on how to configure your ASP.NET application, please visit\r\n  http://go.microsoft.com/fwlink/?LinkId=169433\r\n  -->\r\n<configuration>\r\n  <configSections>\r\n      <sectionGroup name=\"applicationSettings\" type=\"System.Configuration.ApplicationSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" >\r\n          <section name=\"GKE.DS.ALM.Patterns.DotNet.App.Web.Properties.Settings\" type=\"System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" requirePermission=\"false\" />\r\n      </sectionGroup>\r\n\t <sectionGroup name=\"GKE.ds.security\" type=\"GKE.DS.Security.Configuration.SecuritySectionGroup, GKE.DS.Security\">\r\n      <section name=\"authorization\" type=\"GKE.DS.Security.Configuration.AuthorizationSection, GKE.DS.Security\" />\r\n      <section name=\"authentication\" type=\"GKE.DS.Security.Configuration.AuthenticationSection, GKE.DS.Security\" />    \r\n     </sectionGroup>\r\n\t<!--\r\n  Adding a multiline comment\r\n  second line comment\r\n  third line\r\n  -->\r\n  </configSections>\r\n  <system.web>\r\n    <compilation debug=\"true\" targetFramework=\"4.5\" />\r\n    <httpRuntime targetFramework=\"4.5\" />\r\n  </system.web>\r\n  <appSettings>\r\n  </appSettings>\r\n<applicationSettings>\r\n    <GKE.DS.ALM.Patterns.DotNet.App.Web.Properties.Settings>\r\n      <setting name=\"Setting1\" serializeAs=\"String\">\r\n        <value>Setting1Value</value>\r\n      </setting>\r\n    </GKE.DS.ALM.Patterns.DotNet.App.Web.Properties.Settings>\r\n  </applicationSettings>\r\n</configuration>\r\n```\r\nwe want to remove a attribute `serializeAs=\"String\"` which is present in  `<setting name=\"Setting1\" serializeAs=\"String\">` element.",
        "createdAt" : "2018-05-16T08:50:33Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "tags" : [
        ]
      },
      {
        "id" : "f0c651b9-2e95-4657-aa87-0979208ae67c",
        "parentId" : "af990f39-b407-48d1-865f-f015563f3f40",
        "authorId" : "c924d213-2d83-41dd-901a-d29b595f0eeb",
        "body" : "@abhijeetka I modified the win_xml module to support your use case. It was tested with this playbook. \r\n```\r\n---\r\n - name: win_xml module test with absent attribute\r\n   hosts: []\r\n   tasks:\r\n     - name: run the win_xml module\r\n       win_xml:\r\n          path: C:\\\\Users\\richardcs\\Temp\\test.xml\r\n          xpath: '/configuration/applicationSettings/GKE.DS.ALM.Patterns.DotNet.App.Web.Properties.Settings/setting'\r\n          type: attribute\r\n          fragment: String\r\n          attribute: serializeAs\r\n          state: absent\r\n```",
        "createdAt" : "2018-05-17T18:51:04Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "c924d213-2d83-41dd-901a-d29b595f0eeb",
        "tags" : [
        ]
      },
      {
        "id" : "0f8ebbb3-f254-4fa2-a1db-7111434f1ab7",
        "parentId" : "af990f39-b407-48d1-865f-f015563f3f40",
        "authorId" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "body" : "@richardcs  that works like a charm ...!! Thanks for adding this functionality.",
        "createdAt" : "2018-05-25T06:57:20Z",
        "updatedAt" : "2018-08-31T01:45:33Z",
        "lastEditedBy" : "bc11d346-bb09-46d7-ae9e-6d25de01c274",
        "tags" : [
        ]
      }
    ],
    "commit" : "1d0b00c6cc6aec5b1198faf0a18debe24a033ebf",
    "line" : 162,
    "diffHunk" : "@@ -1,1 +160,164 @@            $result.msg = \"xml added\"\n            $changed = $true\n        } elseif ($present -and ($state -eq \"absent\")) {\n            [void]$node.RemoveChild($element)\n            $result.msg = \"xml removed\""
  },
  {
    "id" : "749111a9-c8d2-4378-bd48-25f5223f1031",
    "prId" : 49206,
    "prUrl" : "https://github.com/ansible/ansible/pull/49206#pullrequestreview-179167564",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "df4f234f-0348-45e0-8d6f-96bc266e2075",
        "parentId" : null,
        "authorId" : "a42ef04e-9973-4624-ace3-3da0615d5fc2",
        "body" : "I get that this is done to preserve existing behaviour.  Might be nice to have an option to validate on load in future though.  However any such feature would be best in a separate PR.",
        "createdAt" : "2018-11-28T08:22:33Z",
        "updatedAt" : "2018-12-03T15:37:04Z",
        "lastEditedBy" : "a42ef04e-9973-4624-ace3-3da0615d5fc2",
        "tags" : [
        ]
      }
    ],
    "commit" : "1bd73b8fa626a0ebc5e490f9df08a8fed7bc2141",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +109,113 @@\n$xmlorig = New-Object -TypeName System.Xml.XmlDocument\n$xmlorig.XmlResolver = $null\nTry {\n    $xmlorig.Load($dest)"
  }
]