[
  {
    "id" : "e589c291-ed09-4df3-a14c-fdc50b742bd7",
    "prId" : 49025,
    "prUrl" : "https://github.com/ansible/ansible/pull/49025#pullrequestreview-178410626",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7f5f3f55-f09f-466a-950c-c4104f29d7d5",
        "parentId" : null,
        "authorId" : "fe92d178-e923-4a45-ae7f-b51490c45c31",
        "body" : "I vault dictionaries and lists. With this allow for that?",
        "createdAt" : "2018-11-26T17:31:09Z",
        "updatedAt" : "2018-11-26T17:31:48Z",
        "lastEditedBy" : "fe92d178-e923-4a45-ae7f-b51490c45c31",
        "tags" : [
        ]
      }
    ],
    "commit" : "65b8b391651444559966285dd8ed6291d5512a5d",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +34,38 @@        out = head[0]\n\n        # TODO send unvaulted data to literal_eval?\n        if isinstance(out, AnsibleVaultEncryptedUnicode):\n            return out.data"
  },
  {
    "id" : "c0ea9d9f-1c7a-4a88-8c72-99e5b414103c",
    "prId" : 52237,
    "prUrl" : "https://github.com/ansible/ansible/pull/52237#pullrequestreview-204382363",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e4dc2c6e-0471-41e5-8dbc-5d732153cfd8",
        "parentId" : null,
        "authorId" : "38b7d9c4-df1f-44d2-a0a2-539900170fbe",
        "body" : "It was cool to see the form your solution took. It's super targeted, because it won't touch the code path if the setting is off, and is kind of defensive in how it uses type checking first.",
        "createdAt" : "2019-02-15T14:43:09Z",
        "updatedAt" : "2019-02-15T17:58:11Z",
        "lastEditedBy" : "38b7d9c4-df1f-44d2-a0a2-539900170fbe",
        "tags" : [
        ]
      },
      {
        "id" : "820019e8-489a-4957-8d0d-8d83db373597",
        "parentId" : "e4dc2c6e-0471-41e5-8dbc-5d732153cfd8",
        "authorId" : "94ae5814-8889-4328-9b58-745772997928",
        "body" : ":+1: It was fun too.",
        "createdAt" : "2019-02-15T18:41:18Z",
        "updatedAt" : "2019-02-15T18:41:18Z",
        "lastEditedBy" : "94ae5814-8889-4328-9b58-745772997928",
        "tags" : [
        ]
      }
    ],
    "commit" : "61efec1ceae708d148d8d8b9ee125b65a9e03381",
    "line" : 21,
    "diffHunk" : "@@ -1,1 +48,52 @@            # See https://github.com/ansible/ansible/issues/52158\n            # We do that only here because it is taken care of by text_type() in the else block below already.\n            str(out)\n\n        # short circuit literal_eval when possible"
  },
  {
    "id" : "423d9ad1-6031-45f8-a0eb-c8cda01e63fc",
    "prId" : 70988,
    "prUrl" : "https://github.com/ansible/ansible/pull/70988#pullrequestreview-464372673",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b0a14af6-aa5c-4eb9-ae2e-2229ace483c5",
        "parentId" : null,
        "authorId" : "4b69a0b5-ac6f-45e9-9507-dd1385182f29",
        "body" : "After looking at the added integration tests, I wonder if we should do `return text_type(out)` so that we \"unwrap\" the var at this point.  I don't think it should matter, but I also don't think we should expose the implementation details of how we achieve this to users.  I think using `text_type` instead of `to_text` would be required.",
        "createdAt" : "2020-08-10T13:56:09Z",
        "updatedAt" : "2020-08-10T13:56:09Z",
        "lastEditedBy" : "4b69a0b5-ac6f-45e9-9507-dd1385182f29",
        "tags" : [
        ]
      },
      {
        "id" : "590a7c1a-8be3-46d1-b91b-51cf1520756d",
        "parentId" : "b0a14af6-aa5c-4eb9-ae2e-2229ace483c5",
        "authorId" : "94ae5814-8889-4328-9b58-745772997928",
        "body" : "I agree we should not expose the implementation details however it is kept wrapped on purpose so we can do:\r\n```yaml\r\ncompose:\r\n  ec2_account_id: 1234567890 | string\r\nkeyed_groups:\r\n- key: ec2_account_id\r\n  parent_group: accounts\r\n  prefix: ''\r\n  separator: ''\r\nplugin: constructed\r\n```\r\nIf we unwrapped the var in `ansible_native_concat` then `ec2_account_id` in `- key:` would be run through `literal_eval` again which would result in the error from the original issue. So we need to preserve the `NativeJinjaText` information across `template()` calls.\r\n\r\nRegardless of (un)wrapping this would still work though:\r\n```yaml\r\ncompose:\r\n  ec2_account_id: 1234567890\r\nkeyed_groups:\r\n- key: ec2_account_id | string\r\n  parent_group: accounts\r\n  prefix: ''\r\n  separator: ''\r\nplugin: constructed\r\n```",
        "createdAt" : "2020-08-10T16:05:01Z",
        "updatedAt" : "2020-08-10T16:05:01Z",
        "lastEditedBy" : "94ae5814-8889-4328-9b58-745772997928",
        "tags" : [
        ]
      },
      {
        "id" : "eb2d179b-f8e8-4cb5-b870-a66b5fea0f99",
        "parentId" : "b0a14af6-aa5c-4eb9-ae2e-2229ace483c5",
        "authorId" : "4b69a0b5-ac6f-45e9-9507-dd1385182f29",
        "body" : "Ok, that was the concern I had, is that this wasn't \"final\" enough in this location.  That it was intermediate.",
        "createdAt" : "2020-08-10T16:08:37Z",
        "updatedAt" : "2020-08-10T16:08:38Z",
        "lastEditedBy" : "4b69a0b5-ac6f-45e9-9507-dd1385182f29",
        "tags" : [
        ]
      }
    ],
    "commit" : "9149130130016237ced373425fd6cd89998a3548",
    "line" : 29,
    "diffHunk" : "@@ -1,1 +76,80 @@            # https://github.com/pallets/jinja/issues/1200\n            # https://github.com/ansible/ansible/issues/70831#issuecomment-664190894\n            return out\n    else:\n        if isinstance(nodes, types.GeneratorType):"
  }
]