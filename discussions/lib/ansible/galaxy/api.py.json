[
  {
    "id" : "408a4195-31c8-42e5-9509-f60c732e02ac",
    "prId" : 39396,
    "prUrl" : "https://github.com/ansible/ansible/pull/39396#pullrequestreview-115764691",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "fe7d3e60-503b-43db-abf1-818e23af0649",
        "parentId" : null,
        "authorId" : "3d5987fe-7304-48f0-a541-f2863ae8b5aa",
        "body" : "In Pulp, roles are indexed by a UUID instead of an int id.",
        "createdAt" : "2018-04-26T22:03:54Z",
        "updatedAt" : "2018-04-26T22:03:54Z",
        "lastEditedBy" : "3d5987fe-7304-48f0-a541-f2863ae8b5aa",
        "tags" : [
        ]
      }
    ],
    "commit" : "ad303f97ec93838458df331e16f59ed41dc85146",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +204,208 @@\n        try:\n            url = '%s/roles/%s/%s/?page_size=50' % (self.baseurl, role_id, related)\n            data = self.__call_galaxy(url)\n            results = data['results']"
  },
  {
    "id" : "7371828a-7124-4f92-bd8d-8a35080238e1",
    "prId" : 60982,
    "prUrl" : "https://github.com/ansible/ansible/pull/60982#pullrequestreview-281042942",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f18a7186-4e85-4ef0-a4db-10ee8e63fb60",
        "parentId" : null,
        "authorId" : "3c2d2125-0d1f-41a8-b9f4-2c8913ca435d",
        "body" : "We said that we're going to deprecate current_version from the Galaxy API, so it seems we should remove this check altogether and just default to `v1`.",
        "createdAt" : "2019-08-27T14:52:24Z",
        "updatedAt" : "2019-08-28T20:34:58Z",
        "lastEditedBy" : "3c2d2125-0d1f-41a8-b9f4-2c8913ca435d",
        "tags" : [
        ]
      },
      {
        "id" : "8e45bfa9-e7fe-4c1b-89f5-e3c28b99bdfc",
        "parentId" : "f18a7186-4e85-4ef0-a4db-10ee8e63fb60",
        "authorId" : "a333664b-bd2f-4848-8827-f90665eeb5ff",
        "body" : "We can't actually get rid of it, since existing supported versions of `ansible-galaxy` depend on it. But we _should_ remove uses of it and rely on `available_versions` instead and make sure there's an overlap between that and `SUPPORTED_VERSIONS` here.",
        "createdAt" : "2019-08-27T15:05:42Z",
        "updatedAt" : "2019-08-28T20:34:58Z",
        "lastEditedBy" : "a333664b-bd2f-4848-8827-f90665eeb5ff",
        "tags" : [
        ]
      },
      {
        "id" : "f5bd7a00-f22e-415f-bfee-ee58d866e926",
        "parentId" : "f18a7186-4e85-4ef0-a4db-10ee8e63fb60",
        "authorId" : "fa0144fc-7424-474a-9ab5-059de28814b7",
        "body" : "Wasn't planning on changing _get_server_api_version() related code for this PR given the time frame, but can revisit if necessary. ",
        "createdAt" : "2019-08-28T13:01:05Z",
        "updatedAt" : "2019-08-28T20:34:58Z",
        "lastEditedBy" : "fa0144fc-7424-474a-9ab5-059de28814b7",
        "tags" : [
        ]
      },
      {
        "id" : "fb3d435b-ebf7-479c-9a2d-710bea019c56",
        "parentId" : "f18a7186-4e85-4ef0-a4db-10ee8e63fb60",
        "authorId" : "3c2d2125-0d1f-41a8-b9f4-2c8913ca435d",
        "body" : "Let it go for now.",
        "createdAt" : "2019-08-28T19:09:37Z",
        "updatedAt" : "2019-08-28T20:34:58Z",
        "lastEditedBy" : "3c2d2125-0d1f-41a8-b9f4-2c8913ca435d",
        "tags" : [
        ]
      }
    ],
    "commit" : "058a6df0a249ae95ea132ffd68e262a46b2fc165",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +46,50 @@\n            if server_version not in self.SUPPORTED_VERSIONS:\n                raise AnsibleError(\"Unsupported Galaxy server API version: %s\" % server_version)\n\n            self.baseurl = _urljoin(self.api_server, \"api\", server_version)"
  },
  {
    "id" : "fe83340d-bd74-4d43-b00a-edc0a814e54a",
    "prId" : 60982,
    "prUrl" : "https://github.com/ansible/ansible/pull/60982#pullrequestreview-280821124",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "19ab1958-7f54-4b06-af88-73091c1b7045",
        "parentId" : null,
        "authorId" : "7c547162-2334-4e33-a627-e146840da9ec",
        "body" : "It seems like this should potentially be based on the API version that is being used and not something explicitly set. Would there be a reason why this should be configurable outside of using `Bearer` for `v3` and `Token` for older versions?",
        "createdAt" : "2019-08-27T21:10:47Z",
        "updatedAt" : "2019-08-28T20:34:58Z",
        "lastEditedBy" : "7c547162-2334-4e33-a627-e146840da9ec",
        "tags" : [
        ]
      },
      {
        "id" : "58762174-993e-403c-84e7-cf0b608d374f",
        "parentId" : "19ab1958-7f54-4b06-af88-73091c1b7045",
        "authorId" : "fa0144fc-7424-474a-9ab5-059de28814b7",
        "body" : "Considered passing in api_version or some slightly more abstract authentication option and letting GalaxyAPI choose the right auth mechanism based on that. \r\n\r\nChose to pass in 'token_type' since it seemed more consistent with the existing params which are all very explicit and concrete. Though, at the moment, nothing passes 'token_type' to the the GalaxyAPI() init (ie, it's not configurable or setup from cli/galaxy.py for ex). So the token_type param could be removed and default to 'Token'[1]\r\n\r\nI'm taking a look at what changes to use api_version would look like. Assuming no problems I can change it.\r\n\r\n[1] or api_version or auth_type etc defaults could be setup.",
        "createdAt" : "2019-08-28T13:17:49Z",
        "updatedAt" : "2019-08-28T20:34:58Z",
        "lastEditedBy" : "fa0144fc-7424-474a-9ab5-059de28814b7",
        "tags" : [
        ]
      }
    ],
    "commit" : "058a6df0a249ae95ea132ffd68e262a46b2fc165",
    "line" : 26,
    "diffHunk" : "@@ -1,1 +73,77 @@        self.password = password\n        self.token = token\n        self.token_type = token_type or 'Token'\n        self.api_server = url\n        self.validate_certs = not context.CLIARGS['ignore_certs']"
  },
  {
    "id" : "e8e7d67c-977e-42ae-bdd8-ebc7212ee893",
    "prId" : 60982,
    "prUrl" : "https://github.com/ansible/ansible/pull/60982#pullrequestreview-280842473",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8e65a38c-3207-4ba4-9eb2-a20aa637cb3e",
        "parentId" : null,
        "authorId" : "7c547162-2334-4e33-a627-e146840da9ec",
        "body" : "Leading into my other comments, I think this should be lazily evaluated on this class when called for the first time to save the time it takes for `ansible-galaxy` to complete an operation.",
        "createdAt" : "2019-08-27T21:11:42Z",
        "updatedAt" : "2019-08-28T20:34:58Z",
        "lastEditedBy" : "7c547162-2334-4e33-a627-e146840da9ec",
        "tags" : [
        ]
      },
      {
        "id" : "e83bc6b1-7585-45d6-b21f-e0a561ac8d95",
        "parentId" : "8e65a38c-3207-4ba4-9eb2-a20aa637cb3e",
        "authorId" : "fa0144fc-7424-474a-9ab5-059de28814b7",
        "body" : "@jborean93 The problem I ran into trying to set it up lazily was a bit of a catch-22 for things like 'publish_collection' where the API version needs to be known before the `PUSH /api/v2/collections/` or `PUSH /api/v3/artifacts/collections/` is made so the right url is chosen. So I changed it to explicitly check the avail versions before those calls.\r\n\r\nI could move those calls into the GalaxyAPI class and wrap them with @gconnect(). And abstract them slightly for v2/v3 diffs. \r\n\r\nAny reason not to move those url requests into GalaxyAPI? I left the galaxy API open_urls() calls in collection.py, Should they be moved into ansible.galaxy.api.GalaxyAPI() ?",
        "createdAt" : "2019-08-28T13:48:38Z",
        "updatedAt" : "2019-08-28T20:34:58Z",
        "lastEditedBy" : "fa0144fc-7424-474a-9ab5-059de28814b7",
        "tags" : [
        ]
      }
    ],
    "commit" : "058a6df0a249ae95ea132ffd68e262a46b2fc165",
    "line" : 32,
    "diffHunk" : "@@ -1,1 +79,83 @@        self.version = None\n        self.initialized = False\n        self.available_api_versions = {}\n\n        display.debug('Validate TLS certificates for %s: %s' % (self.api_server, self.validate_certs))"
  }
]