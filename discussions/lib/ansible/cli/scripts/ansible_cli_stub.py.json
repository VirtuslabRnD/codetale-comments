[
  {
    "id" : "6670878c-442a-408b-86a2-a590aa61614b",
    "prId" : 60615,
    "prUrl" : "https://github.com/ansible/ansible/pull/60615#pullrequestreview-275650875",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0f5a3e8b-a294-4bc6-ac8a-5207d067c004",
        "parentId" : null,
        "authorId" : "a333664b-bd2f-4848-8827-f90665eeb5ff",
        "body" : "Should this use `os.path.dirname(C.GALAXY_TOKEN_PATH)` so it acts correctly if this configuration variable is changed and the default `~/.ansible/` is not actually the correct location to create? And, if so, should it use `os.makedirs()` in case there are multiple levels configured in the token path that might need to be created?",
        "createdAt" : "2019-08-15T13:57:09Z",
        "updatedAt" : "2019-08-15T20:35:43Z",
        "lastEditedBy" : "a333664b-bd2f-4848-8827-f90665eeb5ff",
        "tags" : [
        ]
      },
      {
        "id" : "df5d59f5-5cf1-4ee6-9522-40f5707b41ff",
        "parentId" : "0f5a3e8b-a294-4bc6-ac8a-5207d067c004",
        "authorId" : "7c547162-2334-4e33-a627-e146840da9ec",
        "body" : "I originally had this that way but after talking with @abadger he informed me of a security implications of doing that. The trouble with that is if a user has changed the path to something like `/var/tmp/totally_secure/.ansible`. If a malicious user knows about this dir they could redirect where the files get written using a symlink and will now be able to read your token. We can assume on Linux that `~/[anything]` is secure so are happy to hardcode that path so our defaults work properly. But as soon as a user changes that path it is up to them to ensure that 1. the directory exists, 2. the directory is secure and owned by them.\r\n\r\nSo ultimately this change will ensure that the default of `C.GALAXY_TOKEN_PATH` works without the user having the create the directory but if a user changes the path then they need to ensure the dir is present and is secure.",
        "createdAt" : "2019-08-15T20:25:59Z",
        "updatedAt" : "2019-08-15T20:35:43Z",
        "lastEditedBy" : "7c547162-2334-4e33-a627-e146840da9ec",
        "tags" : [
        ]
      }
    ],
    "commit" : "12762d94c09fe49e3f486fee4338a728ce2b3e47",
    "line" : 12,
    "diffHunk" : "@@ -1,1 +102,106 @@                raise\n\n        b_ansible_dir = os.path.expanduser(os.path.expandvars(b\"~/.ansible\"))\n        try:\n            os.mkdir(b_ansible_dir, 0o700)"
  }
]