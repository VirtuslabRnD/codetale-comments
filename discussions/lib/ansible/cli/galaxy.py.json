[
  {
    "id" : "2f5fbd97-2ea8-447f-ae17-866af0df1c04",
    "prId" : 57106,
    "prUrl" : "https://github.com/ansible/ansible/pull/57106#pullrequestreview-251208271",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ce30c3b6-aa52-4ada-9cab-6957cc1f4513",
        "parentId" : null,
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "I'd just put a deprecation warning here right away...",
        "createdAt" : "2019-06-18T16:13:12Z",
        "updatedAt" : "2019-07-09T04:43:59Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      }
    ],
    "commit" : "d5577e43d8dacb3adba02056fd793f6cdfb9e0f4",
    "line" : 25,
    "diffHunk" : "@@ -1,1 +44,48 @@        # Inject role into sys.argv[1] as a backwards compatibility step\n        if len(args) > 1 and args[1] not in ['-h', '--help'] and 'role' not in args and 'collection' not in args:\n            # TODO: Should we add a warning here and eventually deprecate the implicit role subcommand choice\n            args.insert(1, 'role')\n"
  },
  {
    "id" : "811c2ee5-2913-41a7-b50e-d571656d5137",
    "prId" : 57106,
    "prUrl" : "https://github.com/ansible/ansible/pull/57106#pullrequestreview-255529015",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3b55f512-e36b-4f64-9f1a-47091df2d6e3",
        "parentId" : null,
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "No need for an intermediate list in memory.\r\n```suggestion\r\n            if len(p for p in collections_path if p.startswith(output_path)) == 0:\r\n```",
        "createdAt" : "2019-06-27T08:29:31Z",
        "updatedAt" : "2019-07-09T04:43:59Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      },
      {
        "id" : "360caccd-ca65-4da2-8743-e3235ebba046",
        "parentId" : "3b55f512-e36b-4f64-9f1a-47091df2d6e3",
        "authorId" : "7c547162-2334-4e33-a627-e146840da9ec",
        "body" : "Seems like there is on Python 2.7, fails without it.",
        "createdAt" : "2019-06-27T23:37:59Z",
        "updatedAt" : "2019-07-09T04:44:00Z",
        "lastEditedBy" : "7c547162-2334-4e33-a627-e146840da9ec",
        "tags" : [
        ]
      }
    ],
    "commit" : "d5577e43d8dacb3adba02056fd793f6cdfb9e0f4",
    "line" : 453,
    "diffHunk" : "@@ -1,1 +523,527 @@            collections_path = C.COLLECTIONS_PATHS\n\n            if len([p for p in collections_path if p.startswith(output_path)]) == 0:\n                display.warning(\"The specified collections path '%s' is not part of the configured Ansible \"\n                                \"collections paths '%s'. The installed collection won't be picked up in an Ansible \""
  },
  {
    "id" : "cab19157-151e-4768-b041-849c782e43d2",
    "prId" : 62870,
    "prUrl" : "https://github.com/ansible/ansible/pull/62870#pullrequestreview-295763495",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a6cad8f7-6fd4-44e3-8b8d-7a895a1247d2",
        "parentId" : null,
        "authorId" : "fa0144fc-7424-474a-9ab5-059de28814b7",
        "body" : "The only odd behavior I can create is if I set 'collections_paths = :'  (an empty list)\r\n\r\n``` ini\r\n[defaults]\r\ncollections_paths = :\r\n```\r\n\r\nIn that case, the collection ends up getting installed into $PWD/ansible_collections/.\r\nBut I suspect that is a general issue with config types of 'pathspec' and not specific\r\nto collection_path.",
        "createdAt" : "2019-09-27T15:43:38Z",
        "updatedAt" : "2019-10-02T13:32:51Z",
        "lastEditedBy" : "fa0144fc-7424-474a-9ab5-059de28814b7",
        "tags" : [
        ]
      },
      {
        "id" : "b14953b3-2ca5-42c5-8a85-568c9730c772",
        "parentId" : "a6cad8f7-6fd4-44e3-8b8d-7a895a1247d2",
        "authorId" : "311820dd-fcb9-46df-a201-9c0e7d6fac58",
        "body" : "Yeah, this should probably be an error if the config has explicitly removed the paths...",
        "createdAt" : "2019-10-01T17:21:07Z",
        "updatedAt" : "2019-10-02T13:32:51Z",
        "lastEditedBy" : "311820dd-fcb9-46df-a201-9c0e7d6fac58",
        "tags" : [
        ]
      }
    ],
    "commit" : "70feb012b33d0578b1991a2f4960f8e2b5731ebe",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +253,257 @@        if galaxy_type == 'collection':\n            install_parser.add_argument('-p', '--collections-path', dest='collections_path',\n                                        default=C.COLLECTIONS_PATHS[0],\n                                        help='The path to the directory containing your collections.')\n            install_parser.add_argument('-r', '--requirements-file', dest='requirements',"
  },
  {
    "id" : "d9ef5330-f1a3-43ef-b763-91f7219c63a6",
    "prId" : 65022,
    "prUrl" : "https://github.com/ansible/ansible/pull/65022#pullrequestreview-344876837",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2059408b-c76f-4c65-b429-a61ffa6f3451",
        "parentId" : null,
        "authorId" : "6b7e4265-ae86-4269-9bd7-f8ffa9085df6",
        "body" : "path_found isn't set so this particular code path fails.",
        "createdAt" : "2019-12-23T19:09:28Z",
        "updatedAt" : "2020-02-14T19:14:30Z",
        "lastEditedBy" : "6b7e4265-ae86-4269-9bd7-f8ffa9085df6",
        "tags" : [
        ]
      },
      {
        "id" : "02d8418b-683d-403a-81fb-b20df403ffe3",
        "parentId" : "2059408b-c76f-4c65-b429-a61ffa6f3451",
        "authorId" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "body" : "> You could probably move this for path in collections_search_paths + appending the warnings before if collection_name: so you don't need to write it for the else below too.\r\n\r\nBrilliant! I did that and the code is now far less redundant.",
        "createdAt" : "2020-01-17T21:48:51Z",
        "updatedAt" : "2020-02-14T19:14:30Z",
        "lastEditedBy" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "tags" : [
        ]
      },
      {
        "id" : "02ee6f12-4422-489f-b6d3-00787e08f695",
        "parentId" : "2059408b-c76f-4c65-b429-a61ffa6f3451",
        "authorId" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "body" : "> path_found isn't set so this particular code path fails.\r\n\r\nI see what you mean. I need to rework the role section since the collection section is gathering everything and displaying at the end rather than as encountered.\r\n\r\nYet another reason I need to break these up. They are becoming far too intertwined.",
        "createdAt" : "2020-01-17T22:33:06Z",
        "updatedAt" : "2020-02-14T19:14:30Z",
        "lastEditedBy" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "tags" : [
        ]
      }
    ],
    "commit" : "881f49076b456ee7fb374c7ff003b33c48213da6",
    "line" : 213,
    "diffHunk" : "@@ -1,1 +1100,1104 @@                    role_found = True\n                    display.display('# %s' % os.path.dirname(gr.path))\n                    _display_role(gr)\n                    break\n                warnings.append(\"- the role %s was not found\" % role_name)"
  },
  {
    "id" : "7977b2a7-9b41-4676-bc69-ca73ef39eec4",
    "prId" : 65022,
    "prUrl" : "https://github.com/ansible/ansible/pull/65022#pullrequestreview-346890999",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e98a41ed-4f05-4ae6-bfed-a9cfc6660831",
        "parentId" : null,
        "authorId" : "4b69a0b5-ac6f-45e9-9507-dd1385182f29",
        "body" : "This PR increases the complexity of `execute_list` a lot:\r\n\r\ndevel:\r\n```\r\ngalaxy.py:958:4: GalaxyCLI.execute_list (complexity 13)\r\n```\r\n\r\nThis PR:\r\n```\r\ngalaxy.py:976:4: GalaxyCLI.execute_list (complexity 31)\r\n```\r\n\r\nI'd recommend breaking this method up into a method for each \"type\". As it is, I feel like it makes it difficult to review.",
        "createdAt" : "2020-01-07T21:49:10Z",
        "updatedAt" : "2020-02-14T19:14:30Z",
        "lastEditedBy" : "4b69a0b5-ac6f-45e9-9507-dd1385182f29",
        "tags" : [
        ]
      },
      {
        "id" : "dd848c8a-92ca-4801-8f1d-c578eb88a40d",
        "parentId" : "e98a41ed-4f05-4ae6-bfed-a9cfc6660831",
        "authorId" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "body" : "I agree, it's really bloated now. Now that I have it working, I'll simplify it.",
        "createdAt" : "2020-01-17T16:21:03Z",
        "updatedAt" : "2020-02-14T19:14:30Z",
        "lastEditedBy" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "tags" : [
        ]
      },
      {
        "id" : "d5becc0f-7c8b-4ebf-b2b3-d922c2693523",
        "parentId" : "e98a41ed-4f05-4ae6-bfed-a9cfc6660831",
        "authorId" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "body" : "I have replaced `execute_list()` with two separate methods and moved the nested methods to private class methods. Things are looking much better now.\r\n```\r\ngalaxy.py:1035:4: GalaxyCLI.execute_role_list (complexity 9)\r\ngalaxy.py:1077:4: GalaxyCLI.execute_collection_list (complexity 9)\r\n```",
        "createdAt" : "2020-01-22T20:47:37Z",
        "updatedAt" : "2020-02-14T19:14:30Z",
        "lastEditedBy" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "tags" : [
        ]
      }
    ],
    "commit" : "881f49076b456ee7fb374c7ff003b33c48213da6",
    "line" : 189,
    "diffHunk" : "@@ -1,1 +1076,1080 @@\n    def execute_list_role(self):\n        \"\"\"\n        List all roles installed on the local system or a specific role\n        \"\"\""
  },
  {
    "id" : "b09451d0-5197-4d2c-a044-9eaf7e5d5da7",
    "prId" : 65022,
    "prUrl" : "https://github.com/ansible/ansible/pull/65022#pullrequestreview-351740871",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ba60d438-4b09-4476-aa6c-b181cde7e841",
        "parentId" : null,
        "authorId" : "6b7e4265-ae86-4269-9bd7-f8ffa9085df6",
        "body" : "This would fix the sanity error.\r\n```suggestion\r\n         list_parser = parser.add_parser('list_%s' % galaxy_type, parents=parents,\r\n```\r\nI wonder if hacking/build_library/build_ansible/command_plugins/generate_man.py should inspect parser.get_default(dest='func') instead/additionally, but that's probably something to look into another time.",
        "createdAt" : "2020-01-30T14:03:58Z",
        "updatedAt" : "2020-02-14T19:14:30Z",
        "lastEditedBy" : "6b7e4265-ae86-4269-9bd7-f8ffa9085df6",
        "tags" : [
        ]
      },
      {
        "id" : "f64b39ab-57bf-4b41-bdc2-b54b0f541d8e",
        "parentId" : "ba60d438-4b09-4476-aa6c-b181cde7e841",
        "authorId" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "body" : "I was looking at fixing it in `hacking/build_library/build_ansible/command_plugins/generate_man.py` because maybe we want to generate man pages for the collection options too? I really don't know exactly what that file is doing, so your fix is probably the better option for now.",
        "createdAt" : "2020-01-30T22:16:37Z",
        "updatedAt" : "2020-02-14T19:14:30Z",
        "lastEditedBy" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "tags" : [
        ]
      },
      {
        "id" : "10d04ee0-3d11-4fcb-9607-43b81b11e2bf",
        "parentId" : "ba60d438-4b09-4476-aa6c-b181cde7e841",
        "authorId" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "body" : "So this fixed the sanity test, but broke the CLI. I'm toying with some other ways to solve it.",
        "createdAt" : "2020-01-31T18:07:12Z",
        "updatedAt" : "2020-02-14T19:14:30Z",
        "lastEditedBy" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "tags" : [
        ]
      },
      {
        "id" : "d80ce429-c02d-44fe-8dee-a0b323a20413",
        "parentId" : "ba60d438-4b09-4476-aa6c-b181cde7e841",
        "authorId" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "body" : "Ok, I think I got it sorted. I put `execute_list()` back in and it just calls the correct underlying method.",
        "createdAt" : "2020-01-31T19:54:21Z",
        "updatedAt" : "2020-02-14T19:14:30Z",
        "lastEditedBy" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "tags" : [
        ]
      }
    ],
    "commit" : "881f49076b456ee7fb374c7ff003b33c48213da6",
    "line" : 111,
    "diffHunk" : "@@ -1,1 +229,233 @@            galaxy_type = 'collection'\n\n        list_parser = parser.add_parser('list', parents=parents,\n                                        help='Show the name and version of each {0} installed in the {0}s_path.'.format(galaxy_type))\n"
  }
]