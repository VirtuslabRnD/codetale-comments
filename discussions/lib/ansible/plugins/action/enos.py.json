[
  {
    "id" : "9de742bb-ff7d-4076-99de-fcbe6923e1af",
    "prId" : 32966,
    "prUrl" : "https://github.com/ansible/ansible/pull/32966#pullrequestreview-77337587",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f7bbe0aa-2e69-4e2e-b84c-1c26662c2ba6",
        "parentId" : null,
        "authorId" : "1ceb194f-0857-46b7-866c-2125bdec60c5",
        "body" : "If you have an option of `end` command (similar to IOSXR) or an `abort` command (this will take care of any stale uncommitted changes), use those\r\n\r\nAlso, when you exit out of configure mode, I believe you will be in `exec` mode? In that case, you might want to run `enable` command every time and not just in the `else` part?\r\nOR even better (however make sure you are in exec mode before doing this)\r\n```\r\nif to_text(out, errors='surrogate_then_replace').strip().endswith('>'):\r\n    conn.send_command('enable')\r\n```",
        "createdAt" : "2017-11-16T12:13:14Z",
        "updatedAt" : "2017-11-16T12:14:35Z",
        "lastEditedBy" : "1ceb194f-0857-46b7-866c-2125bdec60c5",
        "tags" : [
        ]
      },
      {
        "id" : "86a30b84-5648-404a-8000-79f67acb3fa0",
        "parentId" : "f7bbe0aa-2e69-4e2e-b84c-1c26662c2ba6",
        "authorId" : "274c7d77-be5e-4b51-8b54-c58e1df5d726",
        "body" : "Hi Kedar,\r\n\r\nThank you very much for the valuable feedback. \r\nNow let me explain my logic here. There could be three scenarios here. \r\nCase 1. First time login. Unfortunately this will be the response an ENOS system.\r\n\r\n_login as: admin\r\nUsing keyboard-interactive authentication.\r\nEnter login password:\r\nLenovo RackSwitch G8272.\r\nNote: The current running configuration includes changes\r\n      that have NOT been saved to FLASH.\r\nRS G8272>\r\nNov 16 16:58:39 192.168.49.50 NOTICE  mgmt: admin(admin) login from host 10.38.100.104_\r\n\r\nThis means that the end character is not \">\" rather it cannot be predicted. But \">\" is present there which I am using in Regular expression\r\n\r\nCase 2  . Connection is already in enable mode.  In that case we need not do anything\r\n\r\nCase 3 . Connection is already in configure terminal mode. In that the end character will be as shown below.\r\n\r\n_RS G8272#conf t\r\nEnter configuration commands, one per line.  End with Ctrl/Z.\r\nRS G8272(config)#_\r\n\r\nSo my logic is like this. If its in configure mode, it has to come into enable mode , \r\nFor that I will issue an exit command\r\nElse if it is exec mode, it has to come to enable mode, for that I will issue an \"enable\" command\r\nElse if its already in enable mode, another enable command will do nothing.\r\n\r\nThis is the logic I have coded there. I feel this logic is OK.  I am just taking care of all scenarios of a persistent connection. \r\nBehavior of ENOS switches are like this and I have to live with it.",
        "createdAt" : "2017-11-16T17:12:51Z",
        "updatedAt" : "2017-11-16T17:19:22Z",
        "lastEditedBy" : "274c7d77-be5e-4b51-8b54-c58e1df5d726",
        "tags" : [
        ]
      },
      {
        "id" : "59118d8b-ae33-496c-9f00-e2a926cb7275",
        "parentId" : "f7bbe0aa-2e69-4e2e-b84c-1c26662c2ba6",
        "authorId" : "1ceb194f-0857-46b7-866c-2125bdec60c5",
        "body" : "sounds good.",
        "createdAt" : "2017-11-17T04:32:00Z",
        "updatedAt" : "2017-11-17T04:32:05Z",
        "lastEditedBy" : "1ceb194f-0857-46b7-866c-2125bdec60c5",
        "tags" : [
        ]
      }
    ],
    "commit" : "33c25a193a0c5312bd7e99835f9463ba839cf2d4",
    "line" : 31,
    "diffHunk" : "@@ -1,1 +93,97 @@        if to_text(out, errors='surrogate_then_replace').strip().endswith(')#'):\n            display.vvvv('In Config mode, sending exit to device', self._play_context.remote_addr)\n            conn.send_command('exit')\n        else:\n            conn.send_command('enable')"
  }
]