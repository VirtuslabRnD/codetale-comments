[
  {
    "id" : "11094860-ae1c-473c-a393-70fce94cca96",
    "prId" : 5692,
    "prUrl" : "https://github.com/apache/airflow/pull/5692#pullrequestreview-268884822",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d1e6ff9d-88b3-45c9-a379-dc00ffa8c384",
        "parentId" : null,
        "authorId" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "body" : "Do we use only JDK and curl? I think it's worth looking for a better base image.\r\n\r\nIs sudo used in this file? ",
        "createdAt" : "2019-07-31T06:50:23Z",
        "updatedAt" : "2019-07-31T06:50:32Z",
        "lastEditedBy" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "tags" : [
        ]
      },
      {
        "id" : "b1578baa-bd5b-4cdd-a724-f92b83d6300c",
        "parentId" : "d1e6ff9d-88b3-45c9-a379-dc00ffa8c384",
        "authorId" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "body" : "https://blog.docker.com/2019/07/intro-guide-to-dockerfile-best-practices/\r\nTip #6",
        "createdAt" : "2019-07-31T06:55:00Z",
        "updatedAt" : "2019-07-31T06:55:00Z",
        "lastEditedBy" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "tags" : [
        ]
      },
      {
        "id" : "73a046c7-42da-4811-9277-7e1e46c3c993",
        "parentId" : "d1e6ff9d-88b3-45c9-a379-dc00ffa8c384",
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "Good point. Perhaps just don't have this line -- since this shares a base image with our other images and can share layers it is less to download than a whole new image",
        "createdAt" : "2019-07-31T07:29:01Z",
        "updatedAt" : "2019-07-31T07:29:01Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "f9919b15-418f-4825-8191-f5e7b7d6458f",
        "parentId" : "d1e6ff9d-88b3-45c9-a379-dc00ffa8c384",
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "If we wanted we could even not have curl:\r\n\r\n```\r\nADD http://repo1.maven.org/maven2/org/apache/rat/apache-rat/${RAT_VERSION}/apache-rat-${RAT_VERSION}.jar /tmp/apache-rat-${RAT_VERSION}.jar\r\n```\r\n\r\n(`ADD` can add direct from URLs.)",
        "createdAt" : "2019-07-31T07:30:23Z",
        "updatedAt" : "2019-07-31T07:30:23Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "f3d46e65-ab02-42a2-b5f7-5e452fb03367",
        "parentId" : "d1e6ff9d-88b3-45c9-a379-dc00ffa8c384",
        "authorId" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "body" : "@ashb @mik-laj :  exactly this is what I wanted to achieve - to share image layers with the other images we have. \r\n\r\nAnother reason - I wanted to keep as much similarities as possible between the images (hence I install curl). \r\n\r\n@ashb: Curl is also generally useful if you ever want to do enter that image and do some download. But also from https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#add-or-copy:\r\n\r\n\"Because image size matters, using ADD to fetch packages from remote URLs is strongly discouraged; you should use curl or wget instead.\"\r\n\r\n@mik-laj : Yes. Sudo is used in the run_* script. it's absolutely needed in order to cope with linux case. That's why we have to run everything as root user inside. otherwise we have problems with file permissions for files mounted from the host.\r\n",
        "createdAt" : "2019-07-31T07:41:57Z",
        "updatedAt" : "2019-07-31T07:41:58Z",
        "lastEditedBy" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "tags" : [
        ]
      },
      {
        "id" : "28a5be4e-06ea-4770-bb75-4ff3445243c9",
        "parentId" : "d1e6ff9d-88b3-45c9-a379-dc00ffa8c384",
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "> Because image size matters, using ADD to fetch packages from remote URLs is strongly discouraged. **That way you can delete the files you no longer need after they’ve been extracted and you don’t have to add another layer in your image**\r\n\r\nYes, but I don't think that applies when the URL is for a versioned release artefact -- the file at that url won't change, the URL will instead.\r\n\r\nAnd the file we donwload is the file we want -- we don't uncompress a jar like we might with a tar or a zip.\r\n\r\n(Not saying we need to change it, just pointing it out)",
        "createdAt" : "2019-07-31T09:19:44Z",
        "updatedAt" : "2019-07-31T09:21:20Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      }
    ],
    "commit" : "f5eb614aa83d5a053f0444d57a5306cda8a14a88",
    "line" : 38,
    "diffHunk" : "@@ -1,1 +36,40 @@            curl \\\n            openjdk-8-jdk \\\n    && apt-get autoremove -yqq --purge \\\n    && apt-get clean \\\n    && rm -rf /var/lib/apt/lists/*"
  }
]