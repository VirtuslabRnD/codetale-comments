[
  {
    "id" : "058865ad-4009-4a90-a6a7-7adde1aeab17",
    "prId" : 10070,
    "prUrl" : "https://github.com/apache/kafka/pull/10070#pullrequestreview-587009179",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "21a95a60-1991-4aee-b143-6ac6fd02d9de",
        "parentId" : null,
        "authorId" : "e0554c25-f6f3-4e49-a325-bcc5d4dc5fb2",
        "body" : "`public void remove(...)`?",
        "createdAt" : "2021-02-09T17:44:04Z",
        "updatedAt" : "2021-02-20T00:12:14Z",
        "lastEditedBy" : "e0554c25-f6f3-4e49-a325-bcc5d4dc5fb2",
        "tags" : [
        ]
      },
      {
        "id" : "95e251fc-51ac-4506-b457-e36c5a99f1aa",
        "parentId" : "21a95a60-1991-4aee-b143-6ac6fd02d9de",
        "authorId" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "body" : "Hmm, are you suggesting that it should be public?  I'd rather not make this public because it's only accessed from within the controller package",
        "createdAt" : "2021-02-09T20:57:26Z",
        "updatedAt" : "2021-02-20T00:12:14Z",
        "lastEditedBy" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "tags" : [
        ]
      },
      {
        "id" : "e2b1f73b-b5af-473d-95da-930ddc593c9c",
        "parentId" : "21a95a60-1991-4aee-b143-6ac6fd02d9de",
        "authorId" : "e0554c25-f6f3-4e49-a325-bcc5d4dc5fb2",
        "body" : "> only accessed from within the controller package\r\n\r\nOk, I was just checking.  These are all fine then.",
        "createdAt" : "2021-02-09T21:06:23Z",
        "updatedAt" : "2021-02-20T00:12:14Z",
        "lastEditedBy" : "e0554c25-f6f3-4e49-a325-bcc5d4dc5fb2",
        "tags" : [
        ]
      }
    ],
    "commit" : "7bcdd2ec50b7fbacffcb3c5810a37ae8161a64c3",
    "line" : 292,
    "diffHunk" : "@@ -1,1 +290,294 @@     * @param brokerId      The ID of the broker to remove.\n     */\n    void remove(int brokerId) {\n        BrokerHeartbeatState broker = brokers.remove(brokerId);\n        if (broker != null) {"
  },
  {
    "id" : "da9601cf-39c9-4520-bc7e-b57096a0134d",
    "prId" : 10070,
    "prUrl" : "https://github.com/apache/kafka/pull/10070#pullrequestreview-587009640",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "89b351f9-62e3-4699-8b10-04107e0cb5f1",
        "parentId" : null,
        "authorId" : "e0554c25-f6f3-4e49-a325-bcc5d4dc5fb2",
        "body" : "`boolean hasValidSession(...)`?",
        "createdAt" : "2021-02-09T17:44:38Z",
        "updatedAt" : "2021-02-20T00:12:14Z",
        "lastEditedBy" : "e0554c25-f6f3-4e49-a325-bcc5d4dc5fb2",
        "tags" : [
        ]
      },
      {
        "id" : "1d783d15-a0f6-4838-b663-12e2ac28161d",
        "parentId" : "89b351f9-62e3-4699-8b10-04107e0cb5f1",
        "authorId" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "body" : "Hmm, I'm not sure I understand the question....",
        "createdAt" : "2021-02-09T20:57:55Z",
        "updatedAt" : "2021-02-20T00:12:14Z",
        "lastEditedBy" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "tags" : [
        ]
      },
      {
        "id" : "aa1d83f4-c9a3-4cea-98ea-b0f36a9a1064",
        "parentId" : "89b351f9-62e3-4699-8b10-04107e0cb5f1",
        "authorId" : "e0554c25-f6f3-4e49-a325-bcc5d4dc5fb2",
        "body" : "Sorry, was asking if it should be public -- but I assume not.  Was just checking.  It's fine now.",
        "createdAt" : "2021-02-09T21:07:00Z",
        "updatedAt" : "2021-02-20T00:12:14Z",
        "lastEditedBy" : "e0554c25-f6f3-4e49-a325-bcc5d4dc5fb2",
        "tags" : [
        ]
      }
    ],
    "commit" : "7bcdd2ec50b7fbacffcb3c5810a37ae8161a64c3",
    "line" : 321,
    "diffHunk" : "@@ -1,1 +319,323 @@     * @return              True if the given broker has a valid session.\n     */\n    boolean hasValidSession(int brokerId) {\n        BrokerHeartbeatState broker = brokers.get(brokerId);\n        if (broker == null) return false;"
  },
  {
    "id" : "a9a9a651-347b-4f2c-bef5-b60b01a13584",
    "prId" : 10070,
    "prUrl" : "https://github.com/apache/kafka/pull/10070#pullrequestreview-587003223",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d460b978-f1be-4ca8-a23d-7832bf1f00ba",
        "parentId" : null,
        "authorId" : "e0554c25-f6f3-4e49-a325-bcc5d4dc5fb2",
        "body" : "`public void touch(...)`?",
        "createdAt" : "2021-02-09T17:45:26Z",
        "updatedAt" : "2021-02-20T00:12:14Z",
        "lastEditedBy" : "e0554c25-f6f3-4e49-a325-bcc5d4dc5fb2",
        "tags" : [
        ]
      },
      {
        "id" : "05e39479-75fa-4e97-80a6-07956ecb4d75",
        "parentId" : "d460b978-f1be-4ca8-a23d-7832bf1f00ba",
        "authorId" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "body" : "Hmm, are you suggesting that it should be public?  I'd rather not make this public because it's only accessed from within the controller package",
        "createdAt" : "2021-02-09T20:58:15Z",
        "updatedAt" : "2021-02-20T00:12:14Z",
        "lastEditedBy" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "tags" : [
        ]
      }
    ],
    "commit" : "7bcdd2ec50b7fbacffcb3c5810a37ae8161a64c3",
    "line" : 349,
    "diffHunk" : "@@ -1,1 +347,351 @@     * @param metadataOffset    The latest metadata offset of the broker.\n     */\n    void touch(int brokerId, boolean fenced, long metadataOffset) {\n        BrokerHeartbeatState broker = brokers.get(brokerId);\n        if (broker == null) {"
  },
  {
    "id" : "0028806c-ac2b-4761-ac3e-ee06e6848721",
    "prId" : 10070,
    "prUrl" : "https://github.com/apache/kafka/pull/10070#pullrequestreview-592595550",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e266f7c2-e14a-408a-a3b5-ee39ff1222b8",
        "parentId" : null,
        "authorId" : "442b5138-0781-4001-8ac5-0593f2136d1c",
        "body" : "I thought we want to allow topics to be created even when there is not enough live brokers now?",
        "createdAt" : "2021-02-12T19:44:40Z",
        "updatedAt" : "2021-02-20T00:12:14Z",
        "lastEditedBy" : "442b5138-0781-4001-8ac5-0593f2136d1c",
        "tags" : [
        ]
      },
      {
        "id" : "a3ace911-4eb4-4c84-8ce8-dcd4803b2d24",
        "parentId" : "e266f7c2-e14a-408a-a3b5-ee39ff1222b8",
        "authorId" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "body" : "good point.  Since we don't have much time for 2.8, I will add a TODO for now.",
        "createdAt" : "2021-02-17T20:23:00Z",
        "updatedAt" : "2021-02-20T00:12:14Z",
        "lastEditedBy" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "tags" : [
        ]
      }
    ],
    "commit" : "7bcdd2ec50b7fbacffcb3c5810a37ae8161a64c3",
    "line" : 454,
    "diffHunk" : "@@ -1,1 +452,456 @@        Iterator<UsableBroker> iterator = new UsableBrokerIterator(\n            unfenced.iterator(), idToRack);\n        return policy.createPlacement(numPartitions, numReplicas, iterator);\n    }\n"
  },
  {
    "id" : "aefdda33-44ac-404e-ba11-e4aacbda0761",
    "prId" : 10070,
    "prUrl" : "https://github.com/apache/kafka/pull/10070#pullrequestreview-593482574",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8dbf4b40-f883-4d24-8644-7510280a4e11",
        "parentId" : null,
        "authorId" : "442b5138-0781-4001-8ac5-0593f2136d1c",
        "body" : "If a broker wants to shut down and is only included in ISR, we still want to remove the broker from ISR before allowing it to shutdown. Otherwise, a new published record needs to wait for the session timeout before it can be committed.",
        "createdAt" : "2021-02-17T23:22:16Z",
        "updatedAt" : "2021-02-20T00:12:14Z",
        "lastEditedBy" : "442b5138-0781-4001-8ac5-0593f2136d1c",
        "tags" : [
        ]
      },
      {
        "id" : "8cc0554e-a232-4b57-9557-54564b9e8d89",
        "parentId" : "8dbf4b40-f883-4d24-8644-7510280a4e11",
        "authorId" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "body" : "OK, that makes sense.  I will remove it from all non-singleton ISRs as well as removing it from all leaderships.",
        "createdAt" : "2021-02-18T17:40:46Z",
        "updatedAt" : "2021-02-20T00:12:14Z",
        "lastEditedBy" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "tags" : [
        ]
      }
    ],
    "commit" : "7bcdd2ec50b7fbacffcb3c5810a37ae8161a64c3",
    "line" : 568,
    "diffHunk" : "@@ -1,1 +566,570 @@                        log.info(\"Unfenced broker {} has requested and been granted an \" +\n                            \"immediate shutdown.\", brokerId);\n                        return new BrokerControlStates(currentState, SHUTDOWN_NOW);\n                    }\n                }"
  },
  {
    "id" : "6a6e26fb-d45d-49dc-982b-07787b554908",
    "prId" : 10070,
    "prUrl" : "https://github.com/apache/kafka/pull/10070#pullrequestreview-593496859",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "823b577a-d519-442b-a281-50f1f5ae42c4",
        "parentId" : null,
        "authorId" : "442b5138-0781-4001-8ac5-0593f2136d1c",
        "body" : "Is there any benefit/enough to only allow the broker to shutdown when all brokers have caught up to controlledShutDownOffset? The ZK-based criteria is that a broker is allowed to shut down as long as all leaders have been moved off the shutting down broker.",
        "createdAt" : "2021-02-18T01:08:09Z",
        "updatedAt" : "2021-02-20T00:12:14Z",
        "lastEditedBy" : "442b5138-0781-4001-8ac5-0593f2136d1c",
        "tags" : [
        ]
      },
      {
        "id" : "599aac51-48dc-4993-9180-61e5d7824e83",
        "parentId" : "823b577a-d519-442b-a281-50f1f5ae42c4",
        "authorId" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "body" : "Basically it lets us know that the other brokers have successfully taken over as leader (where needed) which avoids having a period of unavailability, ideally",
        "createdAt" : "2021-02-18T17:56:43Z",
        "updatedAt" : "2021-02-20T00:12:14Z",
        "lastEditedBy" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "tags" : [
        ]
      }
    ],
    "commit" : "7bcdd2ec50b7fbacffcb3c5810a37ae8161a64c3",
    "line" : 585,
    "diffHunk" : "@@ -1,1 +583,587 @@                        \"broker's controlled shutdown offset {}.\", brokerId,\n                        lowestActiveOffset, broker.controlledShutDownOffset);\n                    return new BrokerControlStates(currentState, SHUTDOWN_NOW);\n                }\n                log.debug(\"The request from broker {} to shut down can not yet be granted \" +"
  },
  {
    "id" : "b45b62e1-b272-4124-8f4a-7e3ff31cb8a1",
    "prId" : 10070,
    "prUrl" : "https://github.com/apache/kafka/pull/10070#pullrequestreview-593736438",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "cb89d525-57fd-48e0-8fa1-2c498263e04d",
        "parentId" : null,
        "authorId" : "442b5138-0781-4001-8ac5-0593f2136d1c",
        "body" : "Do we allow a heartbeat request to set both the fence and wantShutDown flag?",
        "createdAt" : "2021-02-18T18:47:22Z",
        "updatedAt" : "2021-02-20T00:12:14Z",
        "lastEditedBy" : "442b5138-0781-4001-8ac5-0593f2136d1c",
        "tags" : [
        ]
      },
      {
        "id" : "4781c293-4544-4817-a944-2ffdb075c168",
        "parentId" : "cb89d525-57fd-48e0-8fa1-2c498263e04d",
        "authorId" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "body" : "yes, it can set both",
        "createdAt" : "2021-02-18T23:24:57Z",
        "updatedAt" : "2021-02-20T00:12:14Z",
        "lastEditedBy" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "tags" : [
        ]
      }
    ],
    "commit" : "7bcdd2ec50b7fbacffcb3c5810a37ae8161a64c3",
    "line" : 551,
    "diffHunk" : "@@ -1,1 +549,553 @@            case UNFENCED:\n                if (request.wantFence()) {\n                    if (request.wantShutDown()) {\n                        log.info(\"Unfenced broker {} has requested and been granted an \" +\n                            \"immediate shutdown.\", brokerId);"
  }
]