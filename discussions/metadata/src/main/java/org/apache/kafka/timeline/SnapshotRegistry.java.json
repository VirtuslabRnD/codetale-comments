[
  {
    "id" : "149a6b72-1139-401c-a31f-bc6bc95dc2b6",
    "prId" : 9901,
    "prUrl" : "https://github.com/apache/kafka/pull/9901#pullrequestreview-580625589",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6d70ae7e-f615-49dd-a556-376765ea7d09",
        "parentId" : null,
        "authorId" : "442b5138-0781-4001-8ac5-0593f2136d1c",
        "body" : "Not sure that I understand why we need to merge the deleted snapshot to previous snapshot. It seems that the previous snapshot should already have everything needed from the deleted snapshot?",
        "createdAt" : "2021-01-30T02:34:15Z",
        "updatedAt" : "2021-02-02T05:06:53Z",
        "lastEditedBy" : "442b5138-0781-4001-8ac5-0593f2136d1c",
        "tags" : [
        ]
      },
      {
        "id" : "673d90a8-da9e-4df7-a03b-13c9025de245",
        "parentId" : "6d70ae7e-f615-49dd-a556-376765ea7d09",
        "authorId" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "body" : "This is an optimization I made (I should have mentioned it earlier maybe).  I wanted PUT to be independent of the number of snapshot in existence.  So, PUT now adds a delta only to the latest snapshot, not to all snapshots where it is relevant.  That means that sometimes when reading a snapshot, we have to look at other snapshots to see if there are relevant entries in there.  Since reading from a snapshot is less common than modifying the current state, this seemed like a good tradeoff.",
        "createdAt" : "2021-02-01T18:04:40Z",
        "updatedAt" : "2021-02-02T05:06:53Z",
        "lastEditedBy" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "tags" : [
        ]
      },
      {
        "id" : "57cb1e17-afc9-44b9-912b-0e41477ff1f3",
        "parentId" : "6d70ae7e-f615-49dd-a556-376765ea7d09",
        "authorId" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "body" : "So the merging logic is needed when deleting a snapshot that isn't the oldest snapshot",
        "createdAt" : "2021-02-01T18:05:14Z",
        "updatedAt" : "2021-02-02T05:06:53Z",
        "lastEditedBy" : "514c0afb-8649-4fd9-a6ea-ee9e1b695274",
        "tags" : [
        ]
      }
    ],
    "commit" : "42a34b3b008bc3b65b17d79c8e2c4dd4de9b4f95",
    "line" : 221,
    "diffHunk" : "@@ -1,1 +219,223 @@        Snapshot prev = snapshot.prev();\n        if (prev != head) {\n            prev.mergeFrom(snapshot);\n        } else {\n            snapshot.erase();"
  },
  {
    "id" : "88cb023f-9b9f-47df-a23f-1a56a00b6ca3",
    "prId" : 9901,
    "prUrl" : "https://github.com/apache/kafka/pull/9901#pullrequestreview-580637396",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e11cf5d5-94fd-4a97-9dee-b264d1b02b0f",
        "parentId" : null,
        "authorId" : "442b5138-0781-4001-8ac5-0593f2136d1c",
        "body" : "Could we add a comment on the ordering for SnapshotIterator and ReverseSnapshotIterator? ",
        "createdAt" : "2021-02-01T18:19:15Z",
        "updatedAt" : "2021-02-02T05:06:53Z",
        "lastEditedBy" : "442b5138-0781-4001-8ac5-0593f2136d1c",
        "tags" : [
        ]
      }
    ],
    "commit" : "42a34b3b008bc3b65b17d79c8e2c4dd4de9b4f95",
    "line" : 40,
    "diffHunk" : "@@ -1,1 +38,42 @@     * snapshots come first.\n     */\n    class SnapshotIterator implements Iterator<Snapshot> {\n        Snapshot cur;\n        Snapshot result = null;"
  }
]