[
  {
    "id" : "32504ac9-9031-40cf-824c-1b427bc00638",
    "prId" : 19121,
    "prUrl" : "https://github.com/tensorflow/tensorflow/pull/19121#pullrequestreview-121139866",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c6534302-3ac3-49ab-a066-c25088daeb25",
        "parentId" : null,
        "authorId" : "0ba8fb18-637a-4ab3-a7c8-cd971823fe45",
        "body" : "This may have significant performance impact. We cannot just change this globally.",
        "createdAt" : "2018-05-11T16:38:08Z",
        "updatedAt" : "2018-05-11T16:38:27Z",
        "lastEditedBy" : "0ba8fb18-637a-4ab3-a7c8-cd971823fe45",
        "tags" : [
        ]
      },
      {
        "id" : "fe704a90-6819-495f-94b3-4378889ca0cf",
        "parentId" : "c6534302-3ac3-49ab-a066-c25088daeb25",
        "authorId" : "043876bb-642a-41f5-8285-ef756bc536d9",
        "body" : "This change was made following the suggestions in this [comment](https://github.com/tensorflow/tensorflow/pull/15606#issuecomment-361359663) in the previous PR, and also because it fixes the crashes.\r\n\r\nNewbie question here, but what is the alternative to setting this globally?  Perhaps try and figure out why EIGEN_MAX_ALIGN_BYTES=0 does not seem do the correct thing?",
        "createdAt" : "2018-05-11T17:03:59Z",
        "updatedAt" : "2018-05-11T17:03:59Z",
        "lastEditedBy" : "043876bb-642a-41f5-8285-ef756bc536d9",
        "tags" : [
        ]
      },
      {
        "id" : "f7910318-5bb3-459a-897a-627541ec0b53",
        "parentId" : "c6534302-3ac3-49ab-a066-c25088daeb25",
        "authorId" : "f5785553-22db-491f-baa4-8fd14128a264",
        "body" : "Hi,\r\nI just applied markdryan's changes and built in Ubuntu 17.10.\r\nIt doesn’t crash now but I’m getting NaN for the loss.\r\n(my code works fine with the regular distributed package)",
        "createdAt" : "2018-05-15T18:48:58Z",
        "updatedAt" : "2018-05-15T18:48:58Z",
        "lastEditedBy" : "f5785553-22db-491f-baa4-8fd14128a264",
        "tags" : [
        ]
      },
      {
        "id" : "a8b92554-0f9c-4216-ae29-4d0ba14fed53",
        "parentId" : "c6534302-3ac3-49ab-a066-c25088daeb25",
        "authorId" : "043876bb-642a-41f5-8285-ef756bc536d9",
        "body" : "The NaN failures seemed to be caused by a bug in eigen as reported here (https://github.com/tensorflow/tensorflow/issues/18718).  Updating eigen locally to the latest version fixed these issues for me.  However, even with this patch and an updated eigen, I'm still getting some unit test failures on AVX512, which I have yet to investigate.\r\n\r\nRegarding this PR, I'm currently trying to understand why the compiler options specified on the bazel build command, e.g., -copt=-march=native, get applied to some, but not all c++ targets.",
        "createdAt" : "2018-05-15T20:26:46Z",
        "updatedAt" : "2018-05-15T20:26:46Z",
        "lastEditedBy" : "043876bb-642a-41f5-8285-ef756bc536d9",
        "tags" : [
        ]
      },
      {
        "id" : "8c39da2b-b8d2-445c-a9f9-75efb777787d",
        "parentId" : "c6534302-3ac3-49ab-a066-c25088daeb25",
        "authorId" : "6699b080-3d91-4335-aff4-60d8e8393b11",
        "body" : "@markdryan we are investigating some of the unit test failures with Eigen/AVX512 as well. https://github.com/tensorflow/tensorflow/issues/18676 is an issue with Eigen FP16 matmul. ",
        "createdAt" : "2018-05-17T17:25:18Z",
        "updatedAt" : "2018-05-17T17:25:18Z",
        "lastEditedBy" : "6699b080-3d91-4335-aff4-60d8e8393b11",
        "tags" : [
        ]
      }
    ],
    "commit" : "8ced05bfe0317047c0467b18d4e374b49e931cfe",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +65,69 @@        # code. We use it, but we do not rely on it, as evidenced above.\n        \"EIGEN_MPL2_ONLY\",\n        \"EIGEN_MAX_ALIGN_BYTES=64\",\n    ],\n    includes = [\".\"],"
  }
]