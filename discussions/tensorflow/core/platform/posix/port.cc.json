[
  {
    "id" : "2ebf8310-f62c-4ef4-b4bc-8faa535b29ce",
    "prId" : 19136,
    "prUrl" : "https://github.com/tensorflow/tensorflow/pull/19136#pullrequestreview-124757522",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "da62cbe1-70c6-45d0-abbb-7994d6acf341",
        "parentId" : null,
        "authorId" : "0ba8fb18-637a-4ab3-a7c8-cd971823fe45",
        "body" : "I think we should implement this properly in tensorflow/core/platform/cpu_info.{h,cc}, i.e. query the relevant bit fields in the cpu info). Here's a stack overflow article with example code: https://stackoverflow.com/questions/2901694/programmatically-detect-number-of-physical-processors-cores-or-if-hyper-threadin/2921632#2921632\r\n\r\nHmmm, wait a second, you're the Intel engineer, you probably know how to do this even better :-)",
        "createdAt" : "2018-05-09T17:33:13Z",
        "updatedAt" : "2018-05-21T16:53:34Z",
        "lastEditedBy" : "0ba8fb18-637a-4ab3-a7c8-cd971823fe45",
        "tags" : [
        ]
      },
      {
        "id" : "7f91295a-d9b8-4f6a-8544-91d26e78ee69",
        "parentId" : "da62cbe1-70c6-45d0-abbb-7994d6acf341",
        "authorId" : "6699b080-3d91-4335-aff4-60d8e8393b11",
        "body" : "I was going to go down the CPUID route but wanted to check if 'hwloc' (https://www.open-mpi.org/projects/hwloc/ BSD license) was acceptable instead. With that we dont have to maintain the code inside tensorflow. \r\n\r\nIf we decide to enumerate cpuid instead, this is the best source so far for Intel CPUs: https://software.intel.com/en-us/articles/intel-64-architecture-processor-topology-enumeration). Need to look into what AMD cpus use. \r\n",
        "createdAt" : "2018-05-09T18:06:38Z",
        "updatedAt" : "2018-05-21T16:53:34Z",
        "lastEditedBy" : "6699b080-3d91-4335-aff4-60d8e8393b11",
        "tags" : [
        ]
      },
      {
        "id" : "b2e222ee-6a1b-4d48-a860-c44cd67b732f",
        "parentId" : "da62cbe1-70c6-45d0-abbb-7994d6acf341",
        "authorId" : "6699b080-3d91-4335-aff4-60d8e8393b11",
        "body" : "@rmlarsen added code to extract SMT contexts per core on modern intel cpus. can you take a look now?",
        "createdAt" : "2018-05-14T21:38:49Z",
        "updatedAt" : "2018-05-21T16:53:34Z",
        "lastEditedBy" : "6699b080-3d91-4335-aff4-60d8e8393b11",
        "tags" : [
        ]
      },
      {
        "id" : "aa775daa-4765-499b-bbe3-34b19a6403d4",
        "parentId" : "da62cbe1-70c6-45d0-abbb-7994d6acf341",
        "authorId" : "65b4affa-0d22-4d64-851b-e5716a2cf5a1",
        "body" : "This change appears to have broken my build on Windows.  I get LNK2019 on tensorflow::Port::NumHyperthreadsPerCore. Verified that the commit preceding this builds fine. (2058a241f159a9a6658d48156cca2a2906e1d712). ",
        "createdAt" : "2018-05-27T14:12:29Z",
        "updatedAt" : "2018-05-27T14:12:29Z",
        "lastEditedBy" : "65b4affa-0d22-4d64-851b-e5716a2cf5a1",
        "tags" : [
        ]
      },
      {
        "id" : "20663c3d-b1a2-4e3c-9725-3f28b8d7f353",
        "parentId" : "da62cbe1-70c6-45d0-abbb-7994d6acf341",
        "authorId" : "dcccf1c4-5e01-40c9-90a5-0da885e340d2",
        "body" : "Me too . This change appears to have broken my build on Windows. I get LNK2019 on tensorflow::Port::NumHyperthreadsPerCore",
        "createdAt" : "2018-05-31T10:53:30Z",
        "updatedAt" : "2018-06-04T11:57:05Z",
        "lastEditedBy" : "dcccf1c4-5e01-40c9-90a5-0da885e340d2",
        "tags" : [
        ]
      }
    ],
    "commit" : "a7f096a05f36d34462df77ed467577254f594ab1",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +75,79 @@}\n\nint NumHyperthreadsPerCore() {\n  static const int ht_per_core = tensorflow::port::CPUIDNumSMT();\n  return (ht_per_core > 0) ? ht_per_core : 1;"
  }
]