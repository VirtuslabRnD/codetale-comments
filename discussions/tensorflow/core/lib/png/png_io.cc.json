[
  {
    "id" : "5aca5389-9a82-4942-8e2f-d64bdd40ef0b",
    "prId" : 20029,
    "prUrl" : "https://github.com/tensorflow/tensorflow/pull/20029#pullrequestreview-137580707",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8c668b67-0886-4545-8562-b6e328c23352",
        "parentId" : null,
        "authorId" : "3aa28542-364d-4b33-92fe-22177c758757",
        "body" : "I'm not familiar with this code -- why do we need to handle PNG_COLOR_TYPE_PALETTE specially? Is it because we convert palette to rgb below?",
        "createdAt" : "2018-07-16T14:29:38Z",
        "updatedAt" : "2018-07-26T06:49:14Z",
        "lastEditedBy" : "3aa28542-364d-4b33-92fe-22177c758757",
        "tags" : [
        ]
      },
      {
        "id" : "db4cb21a-ba06-4f9f-a7c3-0343f99b733b",
        "parentId" : "8c668b67-0886-4545-8562-b6e328c23352",
        "authorId" : "3353ae94-0513-49e4-84f3-84d73dd95d14",
        "body" : "Certainly, you convert palette to rgb bellow.\r\nBut grayscale conversion run after that, because channels is 1 (args channels=0)\r\n\r\nThis issue depends on meaning of:\r\n \"the number of channels in the PNG-encoded image.\"\r\nhttps://www.tensorflow.org/api_docs/python/tf/image/decode_png\r\n\r\npng_get_channels function return 1 if colortype is PALETTE.\r\nhttp://www.libpng.org/pub/png/libpng-manual.html#section-3.6\r\nPalette has indices channels so channels 1 only.\r\n\r\nI think that the current decode_png behavior is unkind.",
        "createdAt" : "2018-07-16T18:12:18Z",
        "updatedAt" : "2018-07-26T06:49:14Z",
        "lastEditedBy" : "3353ae94-0513-49e4-84f3-84d73dd95d14",
        "tags" : [
        ]
      },
      {
        "id" : "2d6d94d5-89af-4893-b5d2-19f1a08e5a16",
        "parentId" : "8c668b67-0886-4545-8562-b6e328c23352",
        "authorId" : "3aa28542-364d-4b33-92fe-22177c758757",
        "body" : "Ah I see, thank you for the explanation. I hadn't looked at the documentation before, but now it makes sense.",
        "createdAt" : "2018-07-16T20:20:15Z",
        "updatedAt" : "2018-07-26T06:49:14Z",
        "lastEditedBy" : "3aa28542-364d-4b33-92fe-22177c758757",
        "tags" : [
        ]
      }
    ],
    "commit" : "141fe1e7dccd97c99a60bbabfd1e8c52a7d3348a",
    "line" : 10,
    "diffHunk" : "@@ -1,1 +236,240 @@      (png_get_valid(context->png_ptr, context->info_ptr, PNG_INFO_tRNS)) != 0;\n  if (context->channels == 0) {  // Autodetect number of channels\n    if (context->color_type == PNG_COLOR_TYPE_PALETTE) {\n      if (has_tRNS) {\n        context->channels = 4; // RGB + A(tRNS)"
  }
]