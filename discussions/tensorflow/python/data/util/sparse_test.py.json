[
  {
    "id" : "aa0e74e9-d2b1-405c-9b12-fb5d267b3635",
    "prId" : 47118,
    "prUrl" : "https://github.com/tensorflow/tensorflow/pull/47118#pullrequestreview-592449133",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2b9d3c30-56a7-4e5f-8216-e73589c1e6f0",
        "parentId" : null,
        "authorId" : "b4c739be-8aba-4687-9314-60b582f3b6d6",
        "body" : "What happens when you do not use lambdas?",
        "createdAt" : "2021-02-16T21:16:22Z",
        "updatedAt" : "2021-02-18T17:56:32Z",
        "lastEditedBy" : "b4c739be-8aba-4687-9314-60b582f3b6d6",
        "tags" : [
        ]
      },
      {
        "id" : "18a41ede-1392-46ee-bf84-ca02d2c012ed",
        "parentId" : "2b9d3c30-56a7-4e5f-8216-e73589c1e6f0",
        "authorId" : "86ac81e0-c752-48e1-ab1f-2754e8fe88ef",
        "body" : "I ran the tests without lambdas in `random_seed_test` (a similar situation to what we have in sparse_test).\r\n\r\nIf we do not use lambdas, then for the test combination of `(mode='graph', tf_api_version=2)`, when the `get_seed()` method is called from `tensorflow.python.data.util.random_seed` during testing, the tests throw:\r\n\r\n```console\r\nFile \"/root/.cache/bazel/_bazel_root/f04f3979d0f8981d3682673d5f0c4874/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/data/util/random_seed_test.runfiles/org_tensorflow/tensorflow/python/framework/ops.py\", line 1513, in convert_to_tensor\r\n    raise RuntimeError(\"Attempting to capture an EagerTensor without \"\r\nRuntimeError: Attempting to capture an EagerTensor without building a function.\r\n```\r\n\r\nReference: https://github.com/tensorflow/tensorflow/blob/f6957507f30597fd458028de1470010312b979f8/tensorflow/python/framework/ops.py#L1495-L1515\r\n\r\nDue to this reason, The tests in `structure_test.py` were already using lambdas. Thus instead of splitting existing tests based on different execution modes, using lambdas can remove that redundancy as it works with all test_base combinations.\r\n",
        "createdAt" : "2021-02-17T05:26:56Z",
        "updatedAt" : "2021-02-18T17:56:32Z",
        "lastEditedBy" : "86ac81e0-c752-48e1-ab1f-2754e8fe88ef",
        "tags" : [
        ]
      },
      {
        "id" : "dbfd5e8d-78a8-4b71-b401-bcecb5039053",
        "parentId" : "2b9d3c30-56a7-4e5f-8216-e73589c1e6f0",
        "authorId" : "b4c739be-8aba-4687-9314-60b582f3b6d6",
        "body" : "thanks for the detailed response",
        "createdAt" : "2021-02-17T17:30:30Z",
        "updatedAt" : "2021-02-18T17:56:32Z",
        "lastEditedBy" : "b4c739be-8aba-4687-9314-60b582f3b6d6",
        "tags" : [
        ]
      }
    ],
    "commit" : "a1fd8e82ea4a140d24328a5e322468c69e1fff54",
    "line" : 58,
    "diffHunk" : "@@ -1,1 +35,39 @@\n\n# NOTE(vikoth18): Arguments of parameterized tests are lifted into lambdas to make\n# sure they are not executed before the (eager- or graph-mode) test environment\n# has been set up."
  }
]