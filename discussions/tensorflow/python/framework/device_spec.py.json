[
  {
    "id" : "0685367d-9605-41e1-a60d-73c478584920",
    "prId" : 47900,
    "prUrl" : "https://github.com/tensorflow/tensorflow/pull/47900#pullrequestreview-616874817",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "336786b4-e739-4b36-ae30-7dfaa5c0cb84",
        "parentId" : null,
        "authorId" : "e08938af-f8a8-460f-881b-a60c1ee311f5",
        "body" : "Can this set of valid devices be cached and re-generated only on failure? There may be quite a few physical devices, and parsing device strings happens quite frequently.",
        "createdAt" : "2021-03-19T17:19:04Z",
        "updatedAt" : "2021-03-20T06:44:39Z",
        "lastEditedBy" : "e08938af-f8a8-460f-881b-a60c1ee311f5",
        "tags" : [
        ]
      },
      {
        "id" : "8bb6b7fa-f367-4249-8807-f05e34640ad5",
        "parentId" : "336786b4-e739-4b36-ae30-7dfaa5c0cb84",
        "authorId" : "0fa85d2b-d37c-423a-902d-562beed7cb04",
        "body" : "@allenlavoie  `_get_valid_device_type()` is only called by _string_to_components, I think device_spec is already cached by \r\n```\r\n\r\n327     cached_result = _STRING_TO_COMPONENTS_CACHE.get(spec)\r\n328     if cached_result is not None:\r\n329       return cached_result\r\n```\r\n\r\n`_get_valid_device_type` itself can not do cache because it's first time called  is earlier than `load_pluggable_device_library`, so it can not get the plug in device type if it is cached.",
        "createdAt" : "2021-03-20T02:20:25Z",
        "updatedAt" : "2021-03-20T06:44:39Z",
        "lastEditedBy" : "0fa85d2b-d37c-423a-902d-562beed7cb04",
        "tags" : [
        ]
      }
    ],
    "commit" : "bafdc549c902bcd11e57d59db48f627920c03020",
    "line" : 18,
    "diffHunk" : "@@ -1,1 +308,312 @@    physical_devices = pywrap_tfe.TF_ListPluggablePhysicalDevices()\n    for device in physical_devices:\n      valid_device_types.add(device.decode().split(\":\")[1]) \n    valid_device_types = valid_device_types | _VALID_DEVICE_TYPES\n    return valid_device_types"
  }
]