[
  {
    "id" : "4a0d2df2-03a0-45be-bd21-196bd22bfed1",
    "prId" : 50552,
    "prUrl" : "https://github.com/tensorflow/tensorflow/pull/50552#pullrequestreview-706665521",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "914a2d9e-71f5-4f4a-9df2-3a0909fb5072",
        "parentId" : null,
        "authorId" : "90c49754-7917-45e3-8dd2-8e09527f3d4c",
        "body" : "Will putting the assert and the env variable reset in a try-finally block like here work?\r\n\r\nos.environ[\"TF_TRT_ALLOW_ENGINE_NATIVE_SEGMENT_EXECUTION\"] = \"False\"\r\ntry:\r\n    with self.assertRaisesRegex(\r\n        errors.AbortedError,\r\n        r\"User disallowed engine native segment execution\"):\r\n      converter.build(input_fn=_InputFn)\r\nfinally:\r\n    # Always reset the environment variable.\r\n    os.environ[\"TF_TRT_ALLOW_ENGINE_NATIVE_SEGMENT_EXECUTION\"] = \"True\"\r\n\r\n# Continue the test by repeating the build method with native segments allowed. \r\nconverter.build(input_fn=_InputFn)\r\n",
        "createdAt" : "2021-07-07T19:22:54Z",
        "updatedAt" : "2021-07-07T19:24:38Z",
        "lastEditedBy" : "90c49754-7917-45e3-8dd2-8e09527f3d4c",
        "tags" : [
        ]
      },
      {
        "id" : "03d139c2-c1fa-4553-a6d7-33d1a78ad0e3",
        "parentId" : "914a2d9e-71f5-4f4a-9df2-3a0909fb5072",
        "authorId" : "7a011a45-bec1-4f51-b4ca-ba0fca447df9",
        "body" : "Absolutely it would work as discussed by email. I made the choice to implement this in a utils function since it could be useful for other tests/usecases: https://github.com/tensorflow/tensorflow/commit/da5eba6e9a#diff-64310e778a6bbfd7b6505d834ebce26a563f76ee821db8542227c329c76bbf84R52-R58\r\n\r\nLet me know if that works for you\r\n",
        "createdAt" : "2021-07-09T21:39:36Z",
        "updatedAt" : "2021-07-09T21:39:36Z",
        "lastEditedBy" : "7a011a45-bec1-4f51-b4ca-ba0fca447df9",
        "tags" : [
        ]
      },
      {
        "id" : "81113afe-3483-4969-8a76-b14d96fcce6c",
        "parentId" : "914a2d9e-71f5-4f4a-9df2-3a0909fb5072",
        "authorId" : "90c49754-7917-45e3-8dd2-8e09527f3d4c",
        "body" : "What you have here is still not what I was talking about. We shouldn't need disable_native_segment_fallback and @contextmanager.",
        "createdAt" : "2021-07-12T17:37:22Z",
        "updatedAt" : "2021-07-12T17:38:55Z",
        "lastEditedBy" : "90c49754-7917-45e3-8dd2-8e09527f3d4c",
        "tags" : [
        ]
      },
      {
        "id" : "f13e61ce-73e3-4ae1-955f-cd12d641e7f7",
        "parentId" : "914a2d9e-71f5-4f4a-9df2-3a0909fb5072",
        "authorId" : "7a011a45-bec1-4f51-b4ca-ba0fca447df9",
        "body" : "contextmanager removed. Replace by a try/finally block in the unittest",
        "createdAt" : "2021-07-14T19:58:10Z",
        "updatedAt" : "2021-07-14T19:58:10Z",
        "lastEditedBy" : "7a011a45-bec1-4f51-b4ca-ba0fca447df9",
        "tags" : [
        ]
      }
    ],
    "commit" : "81dc3a385fb0dc2dbcbbb7991c6c651683c6b1f1",
    "line" : 27,
    "diffHunk" : "@@ -1,1 +948,952 @@        os.environ[\"TF_TRT_ALLOW_ENGINE_NATIVE_SEGMENT_EXECUTION\"] = \"True\"\n\n    converter.build(input_fn=_InputFn)\n\n  @test_util.run_v2_only"
  },
  {
    "id" : "8f873b06-cf30-4bec-acaf-e6984f7efd5a",
    "prId" : 50552,
    "prUrl" : "https://github.com/tensorflow/tensorflow/pull/50552#pullrequestreview-705660508",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a6ced6c9-b3ed-45d6-b5bc-bbf8b74b97a4",
        "parentId" : null,
        "authorId" : "90c49754-7917-45e3-8dd2-8e09527f3d4c",
        "body" : "Can you put this comment to the final block:\r\n# Always reset the environment variable.",
        "createdAt" : "2021-07-12T19:44:08Z",
        "updatedAt" : "2021-07-12T19:44:12Z",
        "lastEditedBy" : "90c49754-7917-45e3-8dd2-8e09527f3d4c",
        "tags" : [
        ]
      },
      {
        "id" : "8042b053-3955-4997-b3e7-6cdcdb057fbf",
        "parentId" : "a6ced6c9-b3ed-45d6-b5bc-bbf8b74b97a4",
        "authorId" : "7a011a45-bec1-4f51-b4ca-ba0fca447df9",
        "body" : "Fixed",
        "createdAt" : "2021-07-13T21:23:52Z",
        "updatedAt" : "2021-07-13T21:23:53Z",
        "lastEditedBy" : "7a011a45-bec1-4f51-b4ca-ba0fca447df9",
        "tags" : [
        ]
      }
    ],
    "commit" : "81dc3a385fb0dc2dbcbbb7991c6c651683c6b1f1",
    "line" : 22,
    "diffHunk" : "@@ -1,1 +944,948 @@      try:\n        converter.build(input_fn=_InputFn)\n      finally:\n        # Always reset the environment variable.\n        os.environ[\"TF_TRT_ALLOW_ENGINE_NATIVE_SEGMENT_EXECUTION\"] = \"True\""
  },
  {
    "id" : "78d784d0-f271-4758-94ba-7b7860a1c8de",
    "prId" : 34660,
    "prUrl" : "https://github.com/tensorflow/tensorflow/pull/34660#pullrequestreview-326542764",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0dc4b880-065c-4184-839e-8f654427106d",
        "parentId" : null,
        "authorId" : "1c0d3996-f30e-4521-a42e-7a5cdc08f5b5",
        "body" : "This PR also checks in the variables of the test model, is that required even after the conversion?",
        "createdAt" : "2019-12-03T17:06:13Z",
        "updatedAt" : "2019-12-10T17:29:37Z",
        "lastEditedBy" : "1c0d3996-f30e-4521-a42e-7a5cdc08f5b5",
        "tags" : [
        ]
      },
      {
        "id" : "73b94212-6ba2-4460-97a7-8099b3e7e9cc",
        "parentId" : "0dc4b880-065c-4184-839e-8f654427106d",
        "authorId" : "d8ccd123-f416-49e8-8333-df30e2a1eb20",
        "body" : "I just added check for correctness which would need the variables.",
        "createdAt" : "2019-12-04T00:47:12Z",
        "updatedAt" : "2019-12-10T17:29:37Z",
        "lastEditedBy" : "d8ccd123-f416-49e8-8333-df30e2a1eb20",
        "tags" : [
        ]
      }
    ],
    "commit" : "d066b24d024220ffbf19c98cc34b7162ba2203e1",
    "line" : 22,
    "diffHunk" : "@@ -1,1 +845,849 @@\n    model_dir = test.test_src_dir_path(\n        'python/compiler/tensorrt/test/testdata/tftrt_2.0_saved_model')\n    saved_model_loaded = load.load(\n        model_dir, tags=[tag_constants.SERVING])"
  }
]