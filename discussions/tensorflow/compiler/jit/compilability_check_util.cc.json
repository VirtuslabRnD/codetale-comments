[
  {
    "id" : "c4e02e6a-9a67-4f58-9904-a3798d96b6a3",
    "prId" : 31012,
    "prUrl" : "https://github.com/tensorflow/tensorflow/pull/31012#pullrequestreview-267867118",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d0a29c14-c6e5-47a4-9c4d-e0eb97a74efd",
        "parentId" : null,
        "authorId" : "2861a495-42d5-4ac3-b543-23cf14c0a980",
        "body" : "Normally we file a bug internally with some details on why the op is slow.  Since you can't file an internal bug do you mind adding some comments on why these ops are slow / undesirable?",
        "createdAt" : "2019-07-25T15:53:14Z",
        "updatedAt" : "2019-07-26T16:50:14Z",
        "lastEditedBy" : "2861a495-42d5-4ac3-b543-23cf14c0a980",
        "tags" : [
        ]
      },
      {
        "id" : "c3f69af3-bca8-47f1-a7a0-5d7bac1d8f4b",
        "parentId" : "d0a29c14-c6e5-47a4-9c4d-e0eb97a74efd",
        "authorId" : "eca90909-340c-4f15-9af5-58905c41473a",
        "body" : "To be precise, I am opting out these ops, no because they are slow, but because they create convolutions that CuDNN can't handle.  I looked around for lists similar to OpIsSlow, but didn't find anything more proper.  Please let me if there is a better way, or whether to create another list.\r\n\r\nI have explained how the error is triggered in my first comment in this PR.  I am attaching a python code reproducing the error.  You can switch on/off XLA to observe the difference.  Hopefully it is sufficient for a bug description.\r\n\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\nimage = tf.placeholder(tf.float32, shape=[16, 256, 256, 16], name='image')\r\nresize_nearest_neighbor = tf.image.resize_images(image, size=[512,512], method=tf.image.ResizeMethod.NEAREST_NEIGHBOR, align_corners=True)\r\nfeed_dict={image: np.random.random_sample([16, 256, 256, 16])}\r\n\r\nsess = tf.Session()\r\nwith sess.as_default():\r\n    actual_resize_nearest_neighbor = resize_nearest_neighbor.eval(feed_dict)\r\n",
        "createdAt" : "2019-07-25T16:47:20Z",
        "updatedAt" : "2019-07-26T16:50:14Z",
        "lastEditedBy" : "eca90909-340c-4f15-9af5-58905c41473a",
        "tags" : [
        ]
      },
      {
        "id" : "28749592-6557-4ed2-91d3-195dc30884a1",
        "parentId" : "d0a29c14-c6e5-47a4-9c4d-e0eb97a74efd",
        "authorId" : "2861a495-42d5-4ac3-b543-23cf14c0a980",
        "body" : "Sorry, I meant comments in the code.\r\n\r\nAlthough I guess just liking to this discussion thread would be fine too.",
        "createdAt" : "2019-07-26T15:35:40Z",
        "updatedAt" : "2019-07-26T16:50:14Z",
        "lastEditedBy" : "2861a495-42d5-4ac3-b543-23cf14c0a980",
        "tags" : [
        ]
      },
      {
        "id" : "31604441-c061-44eb-800d-2a8880cf23d7",
        "parentId" : "d0a29c14-c6e5-47a4-9c4d-e0eb97a74efd",
        "authorId" : "eca90909-340c-4f15-9af5-58905c41473a",
        "body" : "@sanjoy, I have added comments that link to this thread.\r\nBTW, I suppose that users can switch cluster/allow_slow_ops at run-time.  Can you show me how to do that?\r\nP.S. I will make merge to push forward https://github.com/tensorflow/tensorflow/pull/30336, as I don't change image_resize_ops.cc.  I will need your help to review it again.",
        "createdAt" : "2019-07-26T17:13:27Z",
        "updatedAt" : "2019-07-26T17:13:27Z",
        "lastEditedBy" : "eca90909-340c-4f15-9af5-58905c41473a",
        "tags" : [
        ]
      },
      {
        "id" : "eda9bad7-8de9-486d-bcb9-8162842d05b9",
        "parentId" : "d0a29c14-c6e5-47a4-9c4d-e0eb97a74efd",
        "authorId" : "2861a495-42d5-4ac3-b543-23cf14c0a980",
        "body" : "> @sanjoy, I have added comments that link to this thread.\r\n\r\nThanks!\r\n\r\n> BTW, I suppose that users can switch cluster/allow_slow_ops at run-time. Can you show me how to do that?\r\n\r\nTF users can't change these options directly.  These bits are mainly used to control the behavior of `RecursiveCompilabilityChecker` by the various clients of the class (none of which are directly user facing).\r\n\r\n> P.S. I will make merge to push forward #30336, as I don't change image_resize_ops.cc. I will need your help to review it again.\r\n\r\n",
        "createdAt" : "2019-07-26T17:44:32Z",
        "updatedAt" : "2019-07-26T17:47:38Z",
        "lastEditedBy" : "2861a495-42d5-4ac3-b543-23cf14c0a980",
        "tags" : [
        ]
      },
      {
        "id" : "ef88c135-090d-4474-a27f-01edd86dc592",
        "parentId" : "d0a29c14-c6e5-47a4-9c4d-e0eb97a74efd",
        "authorId" : "eca90909-340c-4f15-9af5-58905c41473a",
        "body" : "Is there any further comment for me to address?  If not, please approve the PR.",
        "createdAt" : "2019-07-29T03:36:11Z",
        "updatedAt" : "2019-07-29T03:36:11Z",
        "lastEditedBy" : "eca90909-340c-4f15-9af5-58905c41473a",
        "tags" : [
        ]
      },
      {
        "id" : "8d0841b3-7bfb-4b13-b16a-0469afbaf298",
        "parentId" : "d0a29c14-c6e5-47a4-9c4d-e0eb97a74efd",
        "authorId" : "2861a495-42d5-4ac3-b543-23cf14c0a980",
        "body" : "I already approved it the last time, but it looks like a CI build failed.  I'll re-trigger the CI.",
        "createdAt" : "2019-07-29T15:37:16Z",
        "updatedAt" : "2019-07-29T15:37:16Z",
        "lastEditedBy" : "2861a495-42d5-4ac3-b543-23cf14c0a980",
        "tags" : [
        ]
      }
    ],
    "commit" : "4b81649a0e740e9856ec69be3f75958331167ac7",
    "line" : 11,
    "diffHunk" : "@@ -1,1 +270,274 @@         node.type_string() == \"Svd\" || node.type_string() == \"Qr\" ||\n         node.type_string() == \"MatrixInverse\" ||\n         node.type_string() == \"ResizeNearestNeighbor\" ||\n         node.type_string() == \"ResizeBilinear\" ||\n         node.type_string() == \"ResizeBilinearGrad\";"
  }
]