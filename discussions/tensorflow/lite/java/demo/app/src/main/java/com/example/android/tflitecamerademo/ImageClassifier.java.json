[
  {
    "id" : "fd45b1a4-8ae8-4198-a83d-dbffcb8e675c",
    "prId" : 28011,
    "prUrl" : "https://github.com/tensorflow/tensorflow/pull/28011#pullrequestreview-232479926",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b86c8d2f-b982-4012-bed3-70f16ff6a192",
        "parentId" : null,
        "authorId" : "188e576a-21d3-4c6f-bf41-5747a83bdb5b",
        "body" : "Just confirming that you've tested this path on Android and it works?",
        "createdAt" : "2019-04-30T15:50:11Z",
        "updatedAt" : "2019-05-02T22:44:34Z",
        "lastEditedBy" : "188e576a-21d3-4c6f-bf41-5747a83bdb5b",
        "tags" : [
        ]
      },
      {
        "id" : "8f10c2b6-c012-4541-88f5-53f617a389aa",
        "parentId" : "b86c8d2f-b982-4012-bed3-70f16ff6a192",
        "authorId" : "15fbfdc4-23b1-4ed3-9c13-a4cc1dffc6de",
        "body" : "Yes, it works on various devices I tested. Some of them need extra setAllowFp16PrecisionForFp32() though.",
        "createdAt" : "2019-05-01T02:35:20Z",
        "updatedAt" : "2019-05-02T22:44:34Z",
        "lastEditedBy" : "15fbfdc4-23b1-4ed3-9c13-a4cc1dffc6de",
        "tags" : [
        ]
      }
    ],
    "commit" : "0500f716902d44052f79b3c8c8d4af8ba38f4efc",
    "line" : 29,
    "diffHunk" : "@@ -1,1 +186,190 @@    nnapiDelegate = new NnApiDelegate();\n    tfliteOptions.addDelegate(nnapiDelegate);\n    recreateInterpreter();\n  }\n"
  },
  {
    "id" : "13a0bce7-a8f5-4028-be21-db6e54b97abe",
    "prId" : 28011,
    "prUrl" : "https://github.com/tensorflow/tensorflow/pull/28011#pullrequestreview-233107006",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "146cb277-5f75-4cf5-8411-bf35328a9d89",
        "parentId" : null,
        "authorId" : "188e576a-21d3-4c6f-bf41-5747a83bdb5b",
        "body" : "Thinking about this some more, we might need to clear the delegates from the options. Otherwise you might still have a GPU delegate (or an NNAPI delegate) when using the CPU.\r\n\r\nFeel free to add a \"clearDelegates()\" method to Interpreter.Options. Alternatively, maybe undo the changes to this file, and we can fix that in a separate change?",
        "createdAt" : "2019-05-01T16:09:28Z",
        "updatedAt" : "2019-05-02T22:44:34Z",
        "lastEditedBy" : "188e576a-21d3-4c6f-bf41-5747a83bdb5b",
        "tags" : [
        ]
      },
      {
        "id" : "cf1d20be-9828-4cb3-acd9-b0b40465136a",
        "parentId" : "146cb277-5f75-4cf5-8411-bf35328a9d89",
        "authorId" : "15fbfdc4-23b1-4ed3-9c13-a4cc1dffc6de",
        "body" : "Argh, thanks, I understand you concern now. I'll add clearDelegates().",
        "createdAt" : "2019-05-02T02:33:55Z",
        "updatedAt" : "2019-05-02T22:44:34Z",
        "lastEditedBy" : "15fbfdc4-23b1-4ed3-9c13-a4cc1dffc6de",
        "tags" : [
        ]
      },
      {
        "id" : "26f3397c-02b3-431f-90ff-98f3957d7d03",
        "parentId" : "146cb277-5f75-4cf5-8411-bf35328a9d89",
        "authorId" : "15fbfdc4-23b1-4ed3-9c13-a4cc1dffc6de",
        "body" : "I further tested the app. It really works because [recreateInterpreter()](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/lite/java/demo/app/src/main/java/com/example/android/tflitecamerademo/ImageClassifier.java#L163-L168) closes current interpreter instance (`org.tensorflow.lite.Interpreter` which relies on `org.tensorflow.lite.NativeInterpreterWrapper` to do real jobs) and creates a new instance. And, in [close()](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/lite/java/src/main/java/org/tensorflow/lite/NativeInterpreterWrapper.java#L92-L115) of `org.tensorflow.lite.NativeInterpreterWrapper`, delegates are cleared already. And according to git log (b23bb8ae967), you added the line to clear delegates :-)",
        "createdAt" : "2019-05-02T03:22:38Z",
        "updatedAt" : "2019-05-02T22:44:34Z",
        "lastEditedBy" : "15fbfdc4-23b1-4ed3-9c13-a4cc1dffc6de",
        "tags" : [
        ]
      },
      {
        "id" : "959107b7-a0be-487b-9fc0-a59ec185ac25",
        "parentId" : "146cb277-5f75-4cf5-8411-bf35328a9d89",
        "authorId" : "188e576a-21d3-4c6f-bf41-5747a83bdb5b",
        "body" : "Ah good point, looks good then!",
        "createdAt" : "2019-05-02T16:21:20Z",
        "updatedAt" : "2019-05-02T22:44:34Z",
        "lastEditedBy" : "188e576a-21d3-4c6f-bf41-5747a83bdb5b",
        "tags" : [
        ]
      }
    ],
    "commit" : "0500f716902d44052f79b3c8c8d4af8ba38f4efc",
    "line" : 28,
    "diffHunk" : "@@ -1,1 +185,189 @@  public void useNNAPI() {\n    nnapiDelegate = new NnApiDelegate();\n    tfliteOptions.addDelegate(nnapiDelegate);\n    recreateInterpreter();\n  }"
  }
]