[
  {
    "id" : "e577aea8-4697-42d6-bb15-8d8f01203de7",
    "prId" : 47621,
    "prUrl" : "https://github.com/tensorflow/tensorflow/pull/47621#pullrequestreview-626078341",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3607700e-f268-40d2-945b-cadcae5ee043",
        "parentId" : null,
        "authorId" : "47ddd433-c835-4958-95b7-07277656ff33",
        "body" : "Then show about the following?\r\n```\r\n#if defined(_WIN32)\r\n#if defined(TFL_SHARED_LIBRARY_BUILD) ||  defined(TFL_COMPILE_LIBRARY)\r\n```\r\n\r\nI'd like to reduce the depth of the conditions.",
        "createdAt" : "2021-03-22T05:57:36Z",
        "updatedAt" : "2021-04-01T12:54:48Z",
        "lastEditedBy" : "47ddd433-c835-4958-95b7-07277656ff33",
        "tags" : [
        ]
      },
      {
        "id" : "b71393db-08df-41d8-a8c9-bad13438b51a",
        "parentId" : "3607700e-f268-40d2-945b-cadcae5ee043",
        "authorId" : "6f348406-cf83-44c0-a3a5-bfd3274d863e",
        "body" : "Probably. But there is also branch for not Windows depended on TFL_COMPILE_LIBRARY. ",
        "createdAt" : "2021-03-22T06:04:58Z",
        "updatedAt" : "2021-04-01T12:54:48Z",
        "lastEditedBy" : "6f348406-cf83-44c0-a3a5-bfd3274d863e",
        "tags" : [
        ]
      },
      {
        "id" : "d6cf1395-169b-409a-950e-62534f2368ca",
        "parentId" : "3607700e-f268-40d2-945b-cadcae5ee043",
        "authorId" : "47ddd433-c835-4958-95b7-07277656ff33",
        "body" : "sorry, I don't get it. Could you elaborate?\r\nThe definition TFL_COMPILE_LIBRARY is only used under  _WIN32 in the original code.",
        "createdAt" : "2021-03-22T06:08:09Z",
        "updatedAt" : "2021-04-01T12:54:48Z",
        "lastEditedBy" : "47ddd433-c835-4958-95b7-07277656ff33",
        "tags" : [
        ]
      },
      {
        "id" : "2d2d2afa-71a2-43f6-b4a3-2d32ce0e7775",
        "parentId" : "3607700e-f268-40d2-945b-cadcae5ee043",
        "authorId" : "6f348406-cf83-44c0-a3a5-bfd3274d863e",
        "body" : "Sorry. My mistake. \n\nBut I just realize. You can join checks unfortunately. There are 3 outcome needed. \n\n```\nIf build_shared\n  If build_library\n    Tfl_capi=dllexport\n  Else\n    Tfl_capi=dllimport\nElse\n  Tfl_capi=\n```\n\nProbably whole this block could be moved under `ifdef WIN32` but for not win32 checks TFL_BUILD_SHARED_LIBRARY still needed. ",
        "createdAt" : "2021-03-22T06:18:32Z",
        "updatedAt" : "2021-04-01T12:54:48Z",
        "lastEditedBy" : "6f348406-cf83-44c0-a3a5-bfd3274d863e",
        "tags" : [
        ]
      },
      {
        "id" : "de630016-e554-454e-a163-0a97b232bca2",
        "parentId" : "3607700e-f268-40d2-945b-cadcae5ee043",
        "authorId" : "47ddd433-c835-4958-95b7-07277656ff33",
        "body" : "I see. One issue is that TFL_SHARED_LIBRARY_BUILD will be defined only with CMake so it will break Bazel builds.\r\n\r\nHow about defining TFL_STATIC_LIBRARY_BUILD instead?\r\nThen the logic will be\r\n```\r\n#if defined(_WIN32)\r\n#if defined(TFL_STATIC_LIBRARY_BUILD)\r\n#define TFL_CAPI_EXPORT\r\n#elif defined(TFL_COMPILE_LIBRARY)\r\n#define TFL_CAPI_EXPORT __declspec(dllexport)\r\n#else\r\n#define TFL_CAPI_EXPORT __declspec(dllimport)\r\n#endif  // TFL_STATIC_LIBRARY_BUILD\r\n```",
        "createdAt" : "2021-03-22T06:30:06Z",
        "updatedAt" : "2021-04-01T12:54:48Z",
        "lastEditedBy" : "47ddd433-c835-4958-95b7-07277656ff33",
        "tags" : [
        ]
      },
      {
        "id" : "eacaa3e1-8e08-49db-8fcc-c32bf9ebdefa",
        "parentId" : "3607700e-f268-40d2-945b-cadcae5ee043",
        "authorId" : "6f348406-cf83-44c0-a3a5-bfd3274d863e",
        "body" : "For me it's ok. But I know nothing about Bazel and do not know where fix it? ",
        "createdAt" : "2021-03-22T06:35:33Z",
        "updatedAt" : "2021-04-01T12:54:48Z",
        "lastEditedBy" : "6f348406-cf83-44c0-a3a5-bfd3274d863e",
        "tags" : [
        ]
      },
      {
        "id" : "0e394790-2450-4ed4-9899-27d48888c9ff",
        "parentId" : "3607700e-f268-40d2-945b-cadcae5ee043",
        "authorId" : "47ddd433-c835-4958-95b7-07277656ff33",
        "body" : "In Bazel, TFL_STATIC_LIBRARY_BUILD won't be defined.\r\nSo the logic will be identical to the original logic which means no regression. ",
        "createdAt" : "2021-03-22T07:12:38Z",
        "updatedAt" : "2021-04-01T12:54:48Z",
        "lastEditedBy" : "47ddd433-c835-4958-95b7-07277656ff33",
        "tags" : [
        ]
      },
      {
        "id" : "176d20b3-55e7-4720-b07f-0adb04114a3a",
        "parentId" : "3607700e-f268-40d2-945b-cadcae5ee043",
        "authorId" : "6f348406-cf83-44c0-a3a5-bfd3274d863e",
        "body" : "Ok. I will fix it later today. ",
        "createdAt" : "2021-03-22T07:45:04Z",
        "updatedAt" : "2021-04-01T12:54:48Z",
        "lastEditedBy" : "6f348406-cf83-44c0-a3a5-bfd3274d863e",
        "tags" : [
        ]
      },
      {
        "id" : "2bfce0bd-ec64-4021-80b5-62afe9083c4f",
        "parentId" : "3607700e-f268-40d2-945b-cadcae5ee043",
        "authorId" : "47ddd433-c835-4958-95b7-07277656ff33",
        "body" : "ping?",
        "createdAt" : "2021-03-29T01:07:05Z",
        "updatedAt" : "2021-04-01T12:54:48Z",
        "lastEditedBy" : "47ddd433-c835-4958-95b7-07277656ff33",
        "tags" : [
        ]
      },
      {
        "id" : "c85714c7-1e09-4adf-8f0c-7b6296c91256",
        "parentId" : "3607700e-f268-40d2-945b-cadcae5ee043",
        "authorId" : "6f348406-cf83-44c0-a3a5-bfd3274d863e",
        "body" : "Fixed. Sorry, suddenly was AWK",
        "createdAt" : "2021-04-01T09:37:24Z",
        "updatedAt" : "2021-04-01T12:54:48Z",
        "lastEditedBy" : "6f348406-cf83-44c0-a3a5-bfd3274d863e",
        "tags" : [
        ]
      }
    ],
    "commit" : "15b99227c3b5359fbcf78832fe83b4db75e94628",
    "line" : 9,
    "diffHunk" : "@@ -1,1 +34,38 @@#else   // not definded TFL_STATIC_LIBRARY_BUILD \n#if defined(_WIN32)\n#ifdef TFL_COMPILE_LIBRARY\n#define TFL_CAPI_EXPORT __declspec(dllexport)\n#else"
  },
  {
    "id" : "7f15f76e-44eb-4448-99af-5b9259d180ca",
    "prId" : 47621,
    "prUrl" : "https://github.com/tensorflow/tensorflow/pull/47621#pullrequestreview-626103216",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b51e7b72-b521-4649-a3cd-e47c4c7f1ddd",
        "parentId" : null,
        "authorId" : "47ddd433-c835-4958-95b7-07277656ff33",
        "body" : "ditto",
        "createdAt" : "2021-04-01T10:07:31Z",
        "updatedAt" : "2021-04-01T12:54:48Z",
        "lastEditedBy" : "47ddd433-c835-4958-95b7-07277656ff33",
        "tags" : [
        ]
      }
    ],
    "commit" : "15b99227c3b5359fbcf78832fe83b4db75e94628",
    "line" : 7,
    "diffHunk" : "@@ -1,1 +32,36 @@#elif defined(TFL_STATIC_LIBRARY_BUILD)\n#define TFL_CAPI_EXPORT\n#else   // not definded TFL_STATIC_LIBRARY_BUILD \n#if defined(_WIN32)\n#ifdef TFL_COMPILE_LIBRARY"
  }
]