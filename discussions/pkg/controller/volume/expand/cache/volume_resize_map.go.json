[
  {
    "id" : "2c163027-8a8f-4336-86d7-51905d5999cf",
    "prId" : 58415,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/58415#pullrequestreview-91279038",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c99d302c-ea76-41f0-8f24-49a01bb1107e",
        "parentId" : null,
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "take a look at what other condition updaters do... if the PersistentVolumeClaimFileSystemResizePending condition already exists with the status ConditionTrue, I wouldn't expect LastTransitionTime to be updated on the object. as written, MergeResizeConditionOnPVC doesn't consider whether the condition has actually updated, and always results in a write",
        "createdAt" : "2018-01-24T05:36:27Z",
        "updatedAt" : "2018-01-29T20:08:05Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "12d6cea1-d1d8-4383-b329-154bdcb62880",
        "parentId" : "c99d302c-ea76-41f0-8f24-49a01bb1107e",
        "authorId" : "d3e684d7-edd2-4290-a8bf-e8b698c97338",
        "body" : "I am not sure - that is true.\r\n\r\nIf `PersistentVolumeClaimFileSystemResizePending` already exists on the PVC and user has requested another resize while resize was pending on the node, the code will try and resize the PVC again and set a new `PersistentVolumeClaimFileSystemResizePending` with a new `LastTransitionTime` and it would be incorrect to not update it.. \r\n\r\n",
        "createdAt" : "2018-01-24T13:12:16Z",
        "updatedAt" : "2018-01-29T20:08:05Z",
        "lastEditedBy" : "d3e684d7-edd2-4290-a8bf-e8b698c97338",
        "tags" : [
        ]
      },
      {
        "id" : "c66b9040-667d-4594-85a7-c9ff61357cf7",
        "parentId" : "c99d302c-ea76-41f0-8f24-49a01bb1107e",
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "> If PersistentVolumeClaimFileSystemResizePending already exists on the PVC and user has requested another resize while resize was pending on the node, the code will try and resize the PVC again and set a new PersistentVolumeClaimFileSystemResizePending with a new LastTransitionTime and it would be incorrect to not update it..\r\n\r\nI don't think that's accurate... in that scenario, the condition status has not changed, so the last transition time should not change",
        "createdAt" : "2018-01-24T16:07:51Z",
        "updatedAt" : "2018-01-29T20:08:05Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "a6e4508a-060a-4cf1-b737-d3ae33315229",
        "parentId" : "c99d302c-ea76-41f0-8f24-49a01bb1107e",
        "authorId" : "d3e684d7-edd2-4290-a8bf-e8b698c97338",
        "body" : "fixed",
        "createdAt" : "2018-01-24T16:44:07Z",
        "updatedAt" : "2018-01-29T20:08:05Z",
        "lastEditedBy" : "d3e684d7-edd2-4290-a8bf-e8b698c97338",
        "tags" : [
        ]
      },
      {
        "id" : "2644ee15-81ac-418e-8a5a-b12dded0a92a",
        "parentId" : "c99d302c-ea76-41f0-8f24-49a01bb1107e",
        "authorId" : "d3e684d7-edd2-4290-a8bf-e8b698c97338",
        "body" : "I have fixed this as per ^ discussion. But I am curious - why  does it matter? What happens if same condition (with same status) does end up changing `LastTransitionTime`?",
        "createdAt" : "2018-01-24T17:47:36Z",
        "updatedAt" : "2018-01-29T20:08:05Z",
        "lastEditedBy" : "d3e684d7-edd2-4290-a8bf-e8b698c97338",
        "tags" : [
        ]
      },
      {
        "id" : "9410131e-2708-4870-9dae-90f8080f22ac",
        "parentId" : "c99d302c-ea76-41f0-8f24-49a01bb1107e",
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "that tends to lead to what should be a no-op API write continuously generating changes/writes/watch events",
        "createdAt" : "2018-01-24T18:13:07Z",
        "updatedAt" : "2018-01-29T20:08:05Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "d813e807-aa28-4065-83ee-a40d3e5c7292",
        "parentId" : "c99d302c-ea76-41f0-8f24-49a01bb1107e",
        "authorId" : "d3e684d7-edd2-4290-a8bf-e8b698c97338",
        "body" : "ack. can you please approve the PR? ",
        "createdAt" : "2018-01-24T18:23:12Z",
        "updatedAt" : "2018-01-29T20:08:05Z",
        "lastEditedBy" : "d3e684d7-edd2-4290-a8bf-e8b698c97338",
        "tags" : [
        ]
      }
    ],
    "commit" : "1fa8cbc5e417005b85b9ed8061285e7ef8876618",
    "line" : 37,
    "diffHunk" : "@@ -1,1 +174,178 @@\tconditions := []v1.PersistentVolumeClaimCondition{pvcCondition}\n\tnewPVC := pvcr.PVC.DeepCopy()\n\tnewPVC = util.MergeResizeConditionOnPVC(newPVC, conditions)\n\t_, err := util.PatchPVCStatus(pvcr.PVC /*oldPVC*/, newPVC, resizeMap.kubeClient)\n\treturn err"
  },
  {
    "id" : "29e60808-8cbd-4336-84a6-a0354e7a2a27",
    "prId" : 57676,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/57676#pullrequestreview-85773652",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "25065d0c-1760-412e-ac1c-c52f5571adb9",
        "parentId" : null,
        "authorId" : "c29e1906-5f0b-4d7b-af8b-d664805e8c8e",
        "body" : "move the lock here to deduce critical section",
        "createdAt" : "2017-12-28T06:48:47Z",
        "updatedAt" : "2017-12-28T07:12:31Z",
        "lastEditedBy" : "c29e1906-5f0b-4d7b-af8b-d664805e8c8e",
        "tags" : [
        ]
      }
    ],
    "commit" : "bfa462a8c013d8bfd6a86ea004315ef7fc9db168",
    "line" : 25,
    "diffHunk" : "@@ -1,1 +121,125 @@\n\tresizeMap.Lock()\n\tdefer resizeMap.Unlock()\n\tresizeMap.pvcrs[types.UniquePVCName(pvc.UID)] = pvcRequest\n}"
  },
  {
    "id" : "28b08309-1216-48d2-b0f5-03ecf800ea7a",
    "prId" : 57676,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/57676#pullrequestreview-85773678",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0417547b-ab1a-443b-9514-7f0680b4be78",
        "parentId" : null,
        "authorId" : "c29e1906-5f0b-4d7b-af8b-d664805e8c8e",
        "body" : "same as above",
        "createdAt" : "2017-12-28T06:49:03Z",
        "updatedAt" : "2017-12-28T07:12:31Z",
        "lastEditedBy" : "c29e1906-5f0b-4d7b-af8b-d664805e8c8e",
        "tags" : [
        ]
      }
    ],
    "commit" : "bfa462a8c013d8bfd6a86ea004315ef7fc9db168",
    "line" : 38,
    "diffHunk" : "@@ -1,1 +145,149 @@\tglog.V(5).Infof(\"Removing PVC %v from resize map\", pvcUniqueName)\n\tresizeMap.Lock()\n\tdefer resizeMap.Unlock()\n\tdelete(resizeMap.pvcrs, pvcUniqueName)\n}"
  },
  {
    "id" : "6723fd49-821b-4184-910b-7e305309ccd5",
    "prId" : 57676,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/57676#pullrequestreview-85773733",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "96c73c86-0300-4270-ba4c-effb51b626dc",
        "parentId" : null,
        "authorId" : "c29e1906-5f0b-4d7b-af8b-d664805e8c8e",
        "body" : "no operation on map, so no need lock.",
        "createdAt" : "2017-12-28T06:49:40Z",
        "updatedAt" : "2017-12-28T07:12:31Z",
        "lastEditedBy" : "c29e1906-5f0b-4d7b-af8b-d664805e8c8e",
        "tags" : [
        ]
      }
    ],
    "commit" : "bfa462a8c013d8bfd6a86ea004315ef7fc9db168",
    "line" : 47,
    "diffHunk" : "@@ -1,1 +151,155 @@// MarkAsResized marks a pvc as fully resized\nfunc (resizeMap *volumeResizeMap) MarkAsResized(pvcr *PVCWithResizeRequest, newSize resource.Quantity) error {\n\temptyCondition := []v1.PersistentVolumeClaimCondition{}\n\n\terr := resizeMap.updatePVCCapacityAndConditions(pvcr, newSize, emptyCondition)"
  },
  {
    "id" : "0ca8caa5-2aee-4d3c-805e-c57eb023c29d",
    "prId" : 57676,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/57676#pullrequestreview-85773744",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7a924ece-d57b-492a-bab8-aed287472c32",
        "parentId" : null,
        "authorId" : "c29e1906-5f0b-4d7b-af8b-d664805e8c8e",
        "body" : "same, no operation on map, so no need lock.",
        "createdAt" : "2017-12-28T06:49:51Z",
        "updatedAt" : "2017-12-28T07:12:31Z",
        "lastEditedBy" : "c29e1906-5f0b-4d7b-af8b-d664805e8c8e",
        "tags" : [
        ]
      }
    ],
    "commit" : "bfa462a8c013d8bfd6a86ea004315ef7fc9db168",
    "line" : 57,
    "diffHunk" : "@@ -1,1 +163,167 @@// UpdatePVSize updates just pv size after cloudprovider resizing is successful\nfunc (resizeMap *volumeResizeMap) UpdatePVSize(pvcr *PVCWithResizeRequest, newSize resource.Quantity) error {\n\toldPv := pvcr.PersistentVolume\n\tpvClone := oldPv.DeepCopy()\n"
  },
  {
    "id" : "f48b048a-42ed-4b98-a7fc-ea2f43e06126",
    "prId" : 49727,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/49727#pullrequestreview-59940029",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "951614f8-d212-437c-83e4-86dfca11d3fe",
        "parentId" : null,
        "authorId" : "8b64e744-955d-4523-a3b7-60fae9df0857",
        "body" : "this function  must call `addBackResizeRequest` on error so the operation is re-tried.",
        "createdAt" : "2017-08-31T16:32:03Z",
        "updatedAt" : "2017-09-04T07:08:19Z",
        "lastEditedBy" : "8b64e744-955d-4523-a3b7-60fae9df0857",
        "tags" : [
        ]
      },
      {
        "id" : "0eaa50dc-85f9-45d0-a73e-8e1a02e91627",
        "parentId" : "951614f8-d212-437c-83e4-86dfca11d3fe",
        "authorId" : "8b64e744-955d-4523-a3b7-60fae9df0857",
        "body" : "this comment is no longer valid, addBackResizeRequest  was removed",
        "createdAt" : "2017-08-31T17:55:04Z",
        "updatedAt" : "2017-09-04T07:08:19Z",
        "lastEditedBy" : "8b64e744-955d-4523-a3b7-60fae9df0857",
        "tags" : [
        ]
      }
    ],
    "commit" : "84029c2c1a798bab26781c0219186b278ad69af7",
    "line" : 162,
    "diffHunk" : "@@ -1,1 +160,164 @@\n// UpdatePVSize updates just pv size after cloudprovider resizing is successful\nfunc (resizeMap *volumeResizeMap) UpdatePVSize(pvcr *PVCWithResizeRequest, newSize resource.Quantity) error {\n\tresizeMap.Lock()\n\tdefer resizeMap.Unlock()"
  }
]