[
  {
    "id" : "15b63a27-861e-418d-b479-c752a2aa5a9c",
    "prId" : 68673,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/68673#pullrequestreview-155894434",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "df724603-2ae4-4406-aaad-b4e3ccf18675",
        "parentId" : null,
        "authorId" : "209ee091-cf29-4efa-8a1b-a98334ea3f9a",
        "body" : "I think we can only ignore PVs in Pending.\r\n\r\nWe need to keep matching PVs that are also Bound.  Because we may still have to finish the PVC->PV binding half.",
        "createdAt" : "2018-09-14T22:42:16Z",
        "updatedAt" : "2018-09-19T05:14:03Z",
        "lastEditedBy" : "209ee091-cf29-4efa-8a1b-a98334ea3f9a",
        "tags" : [
        ]
      },
      {
        "id" : "6a8d4e98-7545-4c73-90f4-0a211611e292",
        "parentId" : "df724603-2ae4-4406-aaad-b4e3ccf18675",
        "authorId" : "e4e7c71f-23b5-4203-b65d-3f5f3c503b64",
        "body" : "This has been handled before:\r\nhttps://github.com/kubernetes/kubernetes/blob/b207c759a951f8a1d2ca9c32f72d7f4e9dfdd3d9/pkg/controller/volume/persistentvolume/index.go#L188-L204\r\n\r\nAfter checking pre-bind PVs, all its purpose is to find a available matching and smallest volume. It's safe to ignore all non-available volumes because \r\n\r\n1) Failed volumes will not match (and should not be used)\r\n2) Released volumes must be recycled before becoming available again\r\n3) Pending or empty phase volumes will be updated to Available",
        "createdAt" : "2018-09-14T23:25:04Z",
        "updatedAt" : "2018-09-19T05:14:03Z",
        "lastEditedBy" : "e4e7c71f-23b5-4203-b65d-3f5f3c503b64",
        "tags" : [
        ]
      },
      {
        "id" : "e360caa3-521b-4612-91e1-9885a6a37b64",
        "parentId" : "df724603-2ae4-4406-aaad-b4e3ccf18675",
        "authorId" : "209ee091-cf29-4efa-8a1b-a98334ea3f9a",
        "body" : "Thanks, makes sense to me.  Can you add some unit tests to check that we don't choose PVs in non-Available states?",
        "createdAt" : "2018-09-15T01:07:55Z",
        "updatedAt" : "2018-09-19T05:14:03Z",
        "lastEditedBy" : "209ee091-cf29-4efa-8a1b-a98334ea3f9a",
        "tags" : [
        ]
      },
      {
        "id" : "cf16edb7-017d-4747-a43e-b2c190b2af40",
        "parentId" : "df724603-2ae4-4406-aaad-b4e3ccf18675",
        "authorId" : "e4e7c71f-23b5-4203-b65d-3f5f3c503b64",
        "body" : "Added in https://github.com/kubernetes/kubernetes/pull/68673/commits/1f8b4b1e1444529d6a536180d48c775e0aac7109.",
        "createdAt" : "2018-09-17T12:16:54Z",
        "updatedAt" : "2018-09-19T05:14:03Z",
        "lastEditedBy" : "e4e7c71f-23b5-4203-b65d-3f5f3c503b64",
        "tags" : [
        ]
      }
    ],
    "commit" : "1e27a28dca346149e8278ee6b6b05c34bc6beb4c",
    "line" : 10,
    "diffHunk" : "@@ -1,1 +217,221 @@\t\t// - volumes in Class that is not requested\n\t\t// - volumes whose NodeAffinity does not match the node\n\t\tif volume.Status.Phase != v1.VolumeAvailable {\n\t\t\t// We ignore volumes in non-available phase, because volumes that\n\t\t\t// satisfies matching criteria will be updated to available, binding"
  }
]