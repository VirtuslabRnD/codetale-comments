[
  {
    "id" : "ea09e692-eaab-4e85-a308-a4e0280d2493",
    "prId" : 96417,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/96417#pullrequestreview-532554038",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9ac39853-ea43-4347-b9ed-e8085d055cbe",
        "parentId" : null,
        "authorId" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "body" : "this runs sequential, add comments to explain what we expect at each step.\r\n// allocate 1 subnet",
        "createdAt" : "2020-11-17T16:29:10Z",
        "updatedAt" : "2020-11-23T07:09:31Z",
        "lastEditedBy" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "tags" : [
        ]
      }
    ],
    "commit" : "c8c81be8af90db3e0aba9d4e5eb5638cbe0e2757",
    "line" : 23,
    "diffHunk" : "@@ -1,1 +354,358 @@\t}{\n\t\t// Occupy 1 element: +1\n\t\t{\n\t\t\tcidrStr:     \"10.42.5.0/24\",\n\t\t\toperation:   \"occupy\","
  },
  {
    "id" : "fcc45bdb-29bd-492a-b340-45ee0e726daf",
    "prId" : 96417,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/96417#pullrequestreview-532554317",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "fb9a5e8e-4e92-46d4-ba11-a61a639cee0e",
        "parentId" : null,
        "authorId" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "body" : "// allocate another subnet",
        "createdAt" : "2020-11-17T16:29:26Z",
        "updatedAt" : "2020-11-23T07:09:31Z",
        "lastEditedBy" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "tags" : [
        ]
      }
    ],
    "commit" : "c8c81be8af90db3e0aba9d4e5eb5638cbe0e2757",
    "line" : 29,
    "diffHunk" : "@@ -1,1 +360,364 @@\t\t},\n\t\t// Occupy 1 more element: +1\n\t\t{\n\t\t\tcidrStr:     \"10.42.9.0/24\",\n\t\t\toperation:   \"occupy\","
  },
  {
    "id" : "fcb7c61e-f954-4f9b-ba72-5960a68ffdb6",
    "prId" : 96417,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/96417#pullrequestreview-532554594",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "78eae03b-2cf7-41e4-8679-a380d026ad65",
        "parentId" : null,
        "authorId" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "body" : "allocate an subnet containing previous allocated subnets and 3 new ones",
        "createdAt" : "2020-11-17T16:29:42Z",
        "updatedAt" : "2020-11-23T07:09:31Z",
        "lastEditedBy" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "tags" : [
        ]
      }
    ],
    "commit" : "c8c81be8af90db3e0aba9d4e5eb5638cbe0e2757",
    "line" : 35,
    "diffHunk" : "@@ -1,1 +366,370 @@\t\t},\n\t\t// Occupy 4 elements overlapping with one from the above: +3\n\t\t{\n\t\t\tcidrStr:     \"10.42.8.0/22\",\n\t\t\toperation:   \"occupy\","
  },
  {
    "id" : "c60e582a-8db7-4f9a-8bef-1072e3621854",
    "prId" : 96417,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/96417#pullrequestreview-532555518",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "11033b33-344c-4b5f-a59d-b4dbb41ddfef",
        "parentId" : null,
        "authorId" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "body" : "allocate an overlap subnet, should not increase the number of occupied",
        "createdAt" : "2020-11-17T16:30:35Z",
        "updatedAt" : "2020-11-23T07:09:31Z",
        "lastEditedBy" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "tags" : [
        ]
      }
    ],
    "commit" : "c8c81be8af90db3e0aba9d4e5eb5638cbe0e2757",
    "line" : 41,
    "diffHunk" : "@@ -1,1 +372,376 @@\t\t},\n\t\t// Occupy an already-coccupied element: no change\n\t\t{\n\t\t\tcidrStr:     \"10.42.9.0/24\",\n\t\t\toperation:   \"occupy\","
  },
  {
    "id" : "97647c3a-75af-44fb-b695-54b4c1798f80",
    "prId" : 96417,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/96417#pullrequestreview-532555816",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f2112801-ee7d-4f0f-b6dc-0401c347aef1",
        "parentId" : null,
        "authorId" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "body" : "release one of the allocated subnets",
        "createdAt" : "2020-11-17T16:30:54Z",
        "updatedAt" : "2020-11-23T07:09:31Z",
        "lastEditedBy" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "tags" : [
        ]
      }
    ],
    "commit" : "c8c81be8af90db3e0aba9d4e5eb5638cbe0e2757",
    "line" : 47,
    "diffHunk" : "@@ -1,1 +378,382 @@\t\t},\n\t\t// Release an coccupied element: -1\n\t\t{\n\t\t\tcidrStr:     \"10.42.9.0/24\",\n\t\t\toperation:   \"release\","
  },
  {
    "id" : "8a865ae9-c5b5-4761-87b1-489e3af2b7ed",
    "prId" : 96417,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/96417#pullrequestreview-532556452",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6676ee7c-7533-4ec9-a6e1-6ef5bbb1d030",
        "parentId" : null,
        "authorId" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "body" : "release an previous deallocated subnet, should not decrease the number of occupied",
        "createdAt" : "2020-11-17T16:31:31Z",
        "updatedAt" : "2020-11-23T07:09:31Z",
        "lastEditedBy" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "tags" : [
        ]
      }
    ],
    "commit" : "c8c81be8af90db3e0aba9d4e5eb5638cbe0e2757",
    "line" : 53,
    "diffHunk" : "@@ -1,1 +384,388 @@\t\t},\n\t\t// Release an unoccupied element: no change\n\t\t{\n\t\t\tcidrStr:     \"10.42.9.0/24\",\n\t\t\toperation:   \"release\","
  },
  {
    "id" : "531ac344-5f61-4634-a905-5305f3ea63cf",
    "prId" : 96417,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/96417#pullrequestreview-532557572",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a285d762-f9f7-490e-924b-b7857abf0ac3",
        "parentId" : null,
        "authorId" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "body" : "add another case releasing a subnet that comprises more than 1 of the previous allocated ones",
        "createdAt" : "2020-11-17T16:32:24Z",
        "updatedAt" : "2020-11-23T07:09:31Z",
        "lastEditedBy" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "tags" : [
        ]
      }
    ],
    "commit" : "c8c81be8af90db3e0aba9d4e5eb5638cbe0e2757",
    "line" : 57,
    "diffHunk" : "@@ -1,1 +388,392 @@\t\t\toperation:   \"release\",\n\t\t\tnumOccupied: 4,\n\t\t},\n\t\t// Release 4 elements, only one of which is occupied: -1\n\t\t{"
  },
  {
    "id" : "305acd8c-352c-47df-8d45-7bed855f9497",
    "prId" : 96417,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/96417#pullrequestreview-532558410",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "64bc0842-f4b1-4653-b6d8-74acc908516a",
        "parentId" : null,
        "authorId" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "body" : "add comment here explaining that we are going to allocate the rest of the subnets, to fill the pool",
        "createdAt" : "2020-11-17T16:33:14Z",
        "updatedAt" : "2020-11-23T07:09:31Z",
        "lastEditedBy" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "tags" : [
        ]
      }
    ],
    "commit" : "c8c81be8af90db3e0aba9d4e5eb5638cbe0e2757",
    "line" : 92,
    "diffHunk" : "@@ -1,1 +423,427 @@\n\t// Make sure that we can allocate exactly `numAllocatable24s` elements.\n\tfor i := 0; i < numAllocatable24s; i++ {\n\t\t_, err := a.AllocateNext()\n\t\tif err != nil {"
  },
  {
    "id" : "fa073019-96eb-4458-9148-38615f72a6aa",
    "prId" : 96417,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/96417#pullrequestreview-532558785",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "eba4bda8-2fdc-4d55-8d99-43552631db2e",
        "parentId" : null,
        "authorId" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "body" : "comment explaining that, once it is full, it should fail to allocate a new one",
        "createdAt" : "2020-11-17T16:33:37Z",
        "updatedAt" : "2020-11-23T07:09:31Z",
        "lastEditedBy" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "tags" : [
        ]
      }
    ],
    "commit" : "c8c81be8af90db3e0aba9d4e5eb5638cbe0e2757",
    "line" : 99,
    "diffHunk" : "@@ -1,1 +430,434 @@\t}\n\n\t_, err = a.AllocateNext()\n\tif err == nil {\n\t\tt.Fatalf(\"Expected to be able to allocate exactly %d CIDRS, got one more\", numAllocatable24s)"
  },
  {
    "id" : "02546853-452b-44a1-83c4-18632590eaea",
    "prId" : 90288,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/90288#pullrequestreview-396539621",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0453a042-ce7e-411c-a305-19cd2be6b7ea",
        "parentId" : null,
        "authorId" : "24302707-9254-48df-89a5-cbcc349462b8",
        "body" : "The changes themselves look fine, though I don't think the benchmark is super-representative.\r\nBasically what happens is that for large enough N:\r\n- previously we were going over whole table to find a free bit\r\n- now we exit early\r\nI don't think it happens often in reality that we try to allocate many times if we don't have anything to allocate.\r\n\r\nI'm fine with the improvement itself, but I think the better benchmark would be to in a loop:\r\n- call maxCidrs time AllocateNext()\r\n- the maxCidrs time Release() to free the usage\r\n\r\n[currently the benchmark is pretty much proving that the corner case works fine only]",
        "createdAt" : "2020-04-20T15:02:40Z",
        "updatedAt" : "2020-06-16T22:04:17Z",
        "lastEditedBy" : "24302707-9254-48df-89a5-cbcc349462b8",
        "tags" : [
        ]
      }
    ],
    "commit" : "069707f75a14b9c98538755b089a123192bb0368",
    "line" : 195,
    "diffHunk" : "@@ -1,1 +921,925 @@\t_, clusterCIDR, _ := net.ParseCIDR(cidr)\n\ta, _ := NewCIDRSet(clusterCIDR, subnetMaskSize)\n\tfor n := 0; n < b.N; n++ {\n\t\t// Allocate the whole range + 1\n\t\tfor i := 0; i <= a.maxCIDRs; i++ {"
  }
]