[
  {
    "id" : "b766bd8a-b03e-44a8-ada3-8561c2114ddd",
    "prId" : 94739,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/94739#pullrequestreview-487813814",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "36e586ec-ff1b-4e98-9468-5a2a783323fd",
        "parentId" : null,
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "thanksâ€¦ this is the second time an issue has come up like this in a unit test. do you mind sweeping for other places we're setting up NewSharedInformerFactory in unit tests to see if there are other places we need to do this?",
        "createdAt" : "2020-09-12T14:57:28Z",
        "updatedAt" : "2020-09-15T08:02:50Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "d966627a-94ef-482f-b354-218ac7bba229",
        "parentId" : "36e586ec-ff1b-4e98-9468-5a2a783323fd",
        "authorId" : "9e6ce3ed-e2f7-40ea-b6d7-b1b04fc48f70",
        "body" : "@liggitt I would love to and I wrote a small program https://gist.github.com/knight42/73c13a0166a5d0884545f78bafc64acc to find out all the cases, and we seem to be lucky to have few tests to fix:\r\n\r\n```\r\n$ ./detect pkg\r\npkg/controller/daemon/daemon_controller_test.go TestExpectationsOnRecreate\r\npkg/controller/deployment/sync_test.go TestDeploymentController_cleanupDeployment\r\npkg/controller/replicaset/replica_set_test.go TestWatchControllers\r\npkg/controller/replicaset/replica_set_test.go TestExpectationsOnRecreate\r\npkg/controller/volume/persistentvolume/pv_controller_test.go TestControllerSync\r\npkg/volume/csi/csi_test.go TestCSI_VolumeAll\r\n$ ./detect staging\r\n$\r\n```\r\n\r\nNote that there might be false negatives, i.e. if sharedInformerFactory is not created or started in test function directly, the program would fail to detect.",
        "createdAt" : "2020-09-13T14:19:37Z",
        "updatedAt" : "2020-09-15T08:02:50Z",
        "lastEditedBy" : "9e6ce3ed-e2f7-40ea-b6d7-b1b04fc48f70",
        "tags" : [
        ]
      },
      {
        "id" : "250386f3-0e04-477d-8d5e-a49e522d90e4",
        "parentId" : "36e586ec-ff1b-4e98-9468-5a2a783323fd",
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "great, thanks! do you mind adding the waits to those tests as well in this PR?",
        "createdAt" : "2020-09-14T14:14:01Z",
        "updatedAt" : "2020-09-15T08:02:50Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      }
    ],
    "commit" : "e89e72b6375193cc884429a70071c62f4888fec1",
    "line" : 22,
    "diffHunk" : "@@ -1,1 +1154,1158 @@\tf.Start(stopCh)\n\tf.WaitForCacheSync(stopCh)\n\tfakePodControl := controller.FakePodControl{}\n\tmanager.podControl = &fakePodControl\n"
  },
  {
    "id" : "06ac874b-ce81-46fc-a35a-5e9589f1d8d7",
    "prId" : 80004,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/80004#pullrequestreview-288986903",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2d3ad975-13d7-4635-8982-fc14a69fb2a5",
        "parentId" : null,
        "authorId" : "6e2b5eda-1533-4798-a56c-432faaf38480",
        "body" : "Can you make these changes in a separate commit, this is really hard to read",
        "createdAt" : "2019-09-16T21:28:31Z",
        "updatedAt" : "2019-10-17T15:53:09Z",
        "lastEditedBy" : "6e2b5eda-1533-4798-a56c-432faaf38480",
        "tags" : [
        ]
      },
      {
        "id" : "8dd8216c-fb91-42d1-adf5-8b4c9faa9eee",
        "parentId" : "2d3ad975-13d7-4635-8982-fc14a69fb2a5",
        "authorId" : "6e2b5eda-1533-4798-a56c-432faaf38480",
        "body" : "Thanks",
        "createdAt" : "2019-09-17T02:07:22Z",
        "updatedAt" : "2019-10-17T15:53:09Z",
        "lastEditedBy" : "6e2b5eda-1533-4798-a56c-432faaf38480",
        "tags" : [
        ]
      },
      {
        "id" : "bddd65d7-7645-44d2-a8b6-826adc973a5d",
        "parentId" : "2d3ad975-13d7-4635-8982-fc14a69fb2a5",
        "authorId" : "b3da6e51-33c0-47c8-b02f-5822b5139f82",
        "body" : "Done.",
        "createdAt" : "2019-09-17T02:11:53Z",
        "updatedAt" : "2019-10-17T15:53:09Z",
        "lastEditedBy" : "b3da6e51-33c0-47c8-b02f-5822b5139f82",
        "tags" : [
        ]
      }
    ],
    "commit" : "980b6406b24b41bc0ef061624385f1f420708819",
    "line" : 243,
    "diffHunk" : "@@ -1,1 +1630,1634 @@\t\t// Note that a pending pod cannot be ready\n\t\t{\n\t\t\tname:                 \"len(pods) = 0 (i.e., diff = 0 too)\",\n\t\t\tpods:                 []*v1.Pod{},\n\t\t\tdiff:                 0,"
  },
  {
    "id" : "2f7cc8ba-b7b9-41c1-ae27-85fe0e8fdfee",
    "prId" : 42938,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/42938#pullrequestreview-27700424",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7717bd70-e5d2-4032-918b-4e4795845efa",
        "parentId" : null,
        "authorId" : "01c14569-b640-48af-98cc-aa9dd12da7b6",
        "body" : "Why change this?",
        "createdAt" : "2017-03-17T22:05:03Z",
        "updatedAt" : "2017-03-17T22:39:37Z",
        "lastEditedBy" : "01c14569-b640-48af-98cc-aa9dd12da7b6",
        "tags" : [
        ]
      },
      {
        "id" : "ae3996d3-7137-4ba7-a194-668fe9c31dc5",
        "parentId" : "7717bd70-e5d2-4032-918b-4e4795845efa",
        "authorId" : "97dce74b-9a86-4bd2-812f-a7a70df47473",
        "body" : "The fakeHandlers that use this skipListerFunc are really just looking for updates (PUT). I hit a case where due to the changes, an additional GET happened on a subresource of `/replicasets`, so I expanded the set of paths that get ignored.",
        "createdAt" : "2017-03-17T22:25:19Z",
        "updatedAt" : "2017-03-17T22:39:37Z",
        "lastEditedBy" : "97dce74b-9a86-4bd2-812f-a7a70df47473",
        "tags" : [
        ]
      }
    ],
    "commit" : "b4b8fdbca32211fd193ca5475294b861371b3956",
    "line" : 21,
    "diffHunk" : "@@ -1,1 +90,94 @@\t\treturn false\n\t}\n\tif strings.HasSuffix(url.Path, \"/pods\") || strings.Contains(url.Path, \"/replicasets\") {\n\t\treturn true\n\t}"
  },
  {
    "id" : "bdd8482e-9b07-4d04-b74e-d47204c21401",
    "prId" : 41984,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/41984#pullrequestreview-24626835",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f37bd3d5-a0ac-4057-9108-de2244345b83",
        "parentId" : null,
        "authorId" : "ca7e5a52-cab7-4f09-8ff8-da79f43339d4",
        "body" : "typo: s/2/3/ ",
        "createdAt" : "2017-03-02T00:24:20Z",
        "updatedAt" : "2017-03-02T00:24:20Z",
        "lastEditedBy" : "ca7e5a52-cab7-4f09-8ff8-da79f43339d4",
        "tags" : [
        ]
      }
    ],
    "commit" : "2c2fc9c707efd66cd4ac98ba918e09fa803578be",
    "line" : 209,
    "diffHunk" : "@@ -1,1 +725,729 @@\t}\n\n\t// case 2: Remove ControllerRef (orphan). Expect to sync both former owner and\n\t// any label-matching RS.\n\tpod1 = newPodList(informers.Core().V1().Pods().Informer().GetIndexer(), 1, v1.PodRunning, labelMap1, testRSSpec1, \"pod\").Items[0]"
  },
  {
    "id" : "b3d95a37-5ec7-46e1-a3bd-9d050c3e0dc0",
    "prId" : 34645,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/34645#pullrequestreview-6605622",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "97d9d585-59b9-4e5a-8312-95481b60a8bc",
        "parentId" : null,
        "authorId" : "01c14569-b640-48af-98cc-aa9dd12da7b6",
        "body" : "Not sure if I understand this change. Why 2 PUTs?\n",
        "createdAt" : "2016-10-31T21:21:22Z",
        "updatedAt" : "2016-11-02T12:08:25Z",
        "lastEditedBy" : "01c14569-b640-48af-98cc-aa9dd12da7b6",
        "tags" : [
        ]
      },
      {
        "id" : "e2f41b04-620e-48b4-84d8-03c3d20a9717",
        "parentId" : "97d9d585-59b9-4e5a-8312-95481b60a8bc",
        "authorId" : "11efe503-096f-46dd-a8c8-28ba38a0157a",
        "body" : "There is an extra update in the RS with a ReplicaFailure condition because of the fake error that is set in the pod client. \n",
        "createdAt" : "2016-11-01T12:40:50Z",
        "updatedAt" : "2016-11-02T12:08:25Z",
        "lastEditedBy" : "11efe503-096f-46dd-a8c8-28ba38a0157a",
        "tags" : [
        ]
      }
    ],
    "commit" : "e865692d441d2d2cbeeb6cf354f643eda01de8d4",
    "line" : 24,
    "diffHunk" : "@@ -1,1 +448,452 @@\t// 2 PUT for the ReplicaSet status during dormancy window.\n\t// Note that the pod creates go through pod control so they're not recorded.\n\tfakeHandler.ValidateRequestCount(t, 2)\n}\n"
  },
  {
    "id" : "b9b4bf4b-77ed-4508-b40a-127250843902",
    "prId" : 32771,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/32771#pullrequestreview-1441199",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "541a9e56-fb28-4eb1-bba5-6c954138d017",
        "parentId" : null,
        "authorId" : "01c14569-b640-48af-98cc-aa9dd12da7b6",
        "body" : "Is `now` only used here (in the unit test)? Why not just declare it here?\n",
        "createdAt" : "2016-09-23T17:24:10Z",
        "updatedAt" : "2016-09-28T09:25:32Z",
        "lastEditedBy" : "01c14569-b640-48af-98cc-aa9dd12da7b6",
        "tags" : [
        ]
      },
      {
        "id" : "976bfd35-64cd-416e-90f3-872daaaa0ed5",
        "parentId" : "541a9e56-fb28-4eb1-bba5-6c954138d017",
        "authorId" : "11efe503-096f-46dd-a8c8-28ba38a0157a",
        "body" : "Yes, it's used only for unit testing but we need to declare it in replica_set.go since it's part of it.:)\n",
        "createdAt" : "2016-09-23T20:05:11Z",
        "updatedAt" : "2016-09-28T09:25:32Z",
        "lastEditedBy" : "11efe503-096f-46dd-a8c8-28ba38a0157a",
        "tags" : [
        ]
      },
      {
        "id" : "c673fea3-56b3-42b0-a314-b893d8bd05e0",
        "parentId" : "541a9e56-fb28-4eb1-bba5-6c954138d017",
        "authorId" : "01c14569-b640-48af-98cc-aa9dd12da7b6",
        "body" : "Ah, now I see what `now` is for. Could you instead create a private function in `manager`/`ReplicaSetController` (e.g. `setNow()`) that does what now did? It'd be more clear IMO. \n",
        "createdAt" : "2016-09-23T21:18:58Z",
        "updatedAt" : "2016-09-28T09:25:32Z",
        "lastEditedBy" : "01c14569-b640-48af-98cc-aa9dd12da7b6",
        "tags" : [
        ]
      },
      {
        "id" : "246ba7d3-ee30-4614-bc9f-a88e30c42df0",
        "parentId" : "541a9e56-fb28-4eb1-bba5-6c954138d017",
        "authorId" : "11efe503-096f-46dd-a8c8-28ba38a0157a",
        "body" : "done\n",
        "createdAt" : "2016-09-24T20:19:40Z",
        "updatedAt" : "2016-09-28T09:25:32Z",
        "lastEditedBy" : "11efe503-096f-46dd-a8c8-28ba38a0157a",
        "tags" : [
        ]
      }
    ],
    "commit" : "d8dc2aac07809eb914c675caf8e73c05969617a6",
    "line" : null,
    "diffHunk" : "@@ -1,1 +1367,1371 @@\n\t// The controller should see only one available pod.\n\tmanager.syncReplicaSet(getKey(rs, t))\n\n\trs.Status = extensions.ReplicaSetStatus{Replicas: 2, ReadyReplicas: 2, AvailableReplicas: 1, ObservedGeneration: 1}"
  },
  {
    "id" : "f08343e0-3ed7-42e2-893b-118ab7f2bcef",
    "prId" : 22579,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "06e43f29-8c77-4260-99a6-53ffa96ccd62",
        "parentId" : null,
        "authorId" : "7be32503-562e-4caa-838d-bba025e626b5",
        "body" : "This is the replicaset test.\n",
        "createdAt" : "2016-03-06T06:24:44Z",
        "updatedAt" : "2016-03-06T06:24:44Z",
        "lastEditedBy" : "7be32503-562e-4caa-838d-bba025e626b5",
        "tags" : [
        ]
      }
    ],
    "commit" : "7f5c9bd676de75f113faf39b1a865a4716cfa474",
    "line" : 21,
    "diffHunk" : "@@ -1,1 +706,710 @@\t\t\t\tpodExp, exists, err := manager.expectations.GetExpectations(rsKey)\n\t\t\t\tif !exists || err != nil {\n\t\t\t\t\tt.Fatalf(\"Did not find expectations for rc.\")\n\t\t\t\t}\n\t\t\t\tif add, _ := podExp.GetExpectations(); add != 1 {"
  }
]