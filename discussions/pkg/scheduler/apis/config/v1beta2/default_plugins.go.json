[
  {
    "id" : "449ca228-8ba5-443e-9464-b4d471918adf",
    "prId" : 99582,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/99582#pullrequestreview-699764867",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2c0a793a-f8d8-4efc-82d5-86a9fc2a0da8",
        "parentId" : null,
        "authorId" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "body" : "This is not doing what we proposed:\r\n\r\n- Fail when plugin is already registered in the custom configuration, and only warning if the plugin was already part of defaults.\r\n- Override the default weight, preserving order\r\n\r\n\r\nThe failure should not happen in defaults.go. It should happen during validation. So:\r\n- The first time a plugin shows up in `customPluginSet`, you replace the weight that `defaultPluginSet` has.\r\n- The second time, you append.",
        "createdAt" : "2021-07-05T14:33:11Z",
        "updatedAt" : "2021-07-05T14:33:12Z",
        "lastEditedBy" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "tags" : [
        ]
      },
      {
        "id" : "591c57a6-d243-4aac-b262-11daeaa3e87d",
        "parentId" : "2c0a793a-f8d8-4efc-82d5-86a9fc2a0da8",
        "authorId" : "1fde46ca-8fae-4b82-9978-f266fdae6ffe",
        "body" : "> Fail when plugin is already registered in the custom configuration, and only warning if the plugin was already part of defaults.\r\n\r\nI think I was over-thinking about the duplicate config, it has been validated when the framework is initialized and is banned there, valid this ahead of framework initialization might be better but at least it has not caused any problem today. \r\n\r\nOne line of warning will be added.\r\n\r\nhttps://github.com/kubernetes/kubernetes/blob/554c65fb776c5e93f8540799424f8006a88a0e3e/pkg/scheduler/framework/runtime/framework.go#L432-L434\r\n\r\n> The first time a plugin shows up in customPluginSet, you replace the weight that defaultPluginSet has.\r\n> The second time, you append.\r\n\r\nImplementation in this PR is a little different but achieve the same goal,  it is checking the existence of custom plugin when looping the `defaultPluginSet`, so needn't loop them separately, pls let me know your thoughts on this IMPL?\r\n",
        "createdAt" : "2021-07-06T08:21:50Z",
        "updatedAt" : "2021-07-06T08:21:50Z",
        "lastEditedBy" : "1fde46ca-8fae-4b82-9978-f266fdae6ffe",
        "tags" : [
        ]
      },
      {
        "id" : "5a8a1110-e823-4f61-8db8-026a4ceb2623",
        "parentId" : "2c0a793a-f8d8-4efc-82d5-86a9fc2a0da8",
        "authorId" : "1fde46ca-8fae-4b82-9978-f266fdae6ffe",
        "body" : "hmm... I still need to loop it twice, since `defaultPluginSet.Enabled` is  a slice, this might be the easier way to fix it.",
        "createdAt" : "2021-07-06T09:57:51Z",
        "updatedAt" : "2021-07-06T09:57:52Z",
        "lastEditedBy" : "1fde46ca-8fae-4b82-9978-f266fdae6ffe",
        "tags" : [
        ]
      }
    ],
    "commit" : "9a5237ca63a5dbec81354e82e63fbb20f322b245",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +159,163 @@\t\tdisabledPlugins.Insert(disabledPlugin.Name)\n\t}\n\tfor index, enabledPlugin := range customPluginSet.Enabled {\n\t\tenabledCustomPlugins[enabledPlugin.Name] = pluginIndex{index, enabledPlugin}\n\t}"
  },
  {
    "id" : "6b771afc-4482-4c02-93e0-91287108bef4",
    "prId" : 99582,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/99582#pullrequestreview-700065818",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "cc50e59f-016d-42d8-8412-110ac86ea3f2",
        "parentId" : null,
        "authorId" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "body" : "only the first repetition?",
        "createdAt" : "2021-07-06T13:29:05Z",
        "updatedAt" : "2021-07-06T13:32:09Z",
        "lastEditedBy" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "tags" : [
        ]
      },
      {
        "id" : "72878410-e19f-4260-b6e2-2667e9c18ee2",
        "parentId" : "cc50e59f-016d-42d8-8412-110ac86ea3f2",
        "authorId" : "1fde46ca-8fae-4b82-9978-f266fdae6ffe",
        "body" : "true, seems like we'd better to validate this config to avoid the case of repetition, will fix it in my next day!",
        "createdAt" : "2021-07-06T14:19:01Z",
        "updatedAt" : "2021-07-06T14:19:01Z",
        "lastEditedBy" : "1fde46ca-8fae-4b82-9978-f266fdae6ffe",
        "tags" : [
        ]
      },
      {
        "id" : "87863cee-4dda-4dd9-8d70-166ef7b19a85",
        "parentId" : "cc50e59f-016d-42d8-8412-110ac86ea3f2",
        "authorId" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "body" : "recall that code freeze is on Thursday",
        "createdAt" : "2021-07-06T14:33:55Z",
        "updatedAt" : "2021-07-06T14:33:55Z",
        "lastEditedBy" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "tags" : [
        ]
      },
      {
        "id" : "ff21e481-46d7-497b-aaf4-f7621c3910dc",
        "parentId" : "cc50e59f-016d-42d8-8412-110ac86ea3f2",
        "authorId" : "1fde46ca-8fae-4b82-9978-f266fdae6ffe",
        "body" : "because `mergePlugins` is done before the validation, so the repetition here is still possible, I'd suggest to just log something here or revert to the original version, only the last repetition will be valid for either way.\r\nI am a little lost here, do you have any suggestion?",
        "createdAt" : "2021-07-06T14:51:37Z",
        "updatedAt" : "2021-07-06T14:51:38Z",
        "lastEditedBy" : "1fde46ca-8fae-4b82-9978-f266fdae6ffe",
        "tags" : [
        ]
      },
      {
        "id" : "73660f0b-646d-4c19-97a9-c1afc9ca4e64",
        "parentId" : "cc50e59f-016d-42d8-8412-110ac86ea3f2",
        "authorId" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "body" : "You can keep it like this, it doesn't really matter because more than one repetition will fail later.\r\n\r\nFix the types.go though",
        "createdAt" : "2021-07-06T15:01:49Z",
        "updatedAt" : "2021-07-06T15:01:49Z",
        "lastEditedBy" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "tags" : [
        ]
      }
    ],
    "commit" : "9a5237ca63a5dbec81354e82e63fbb20f322b245",
    "line" : 17,
    "diffHunk" : "@@ -1,1 +160,164 @@\t}\n\tfor index, enabledPlugin := range customPluginSet.Enabled {\n\t\tenabledCustomPlugins[enabledPlugin.Name] = pluginIndex{index, enabledPlugin}\n\t}\n\tvar enabledPlugins []v1beta2.Plugin"
  }
]