[
  {
    "id" : "87eaf374-1cad-400e-a61f-3e8d415fc8bd",
    "prId" : 77688,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/77688#pullrequestreview-246696229",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "633fd1f2-af36-4d37-ad1e-a30ca90da112",
        "parentId" : null,
        "authorId" : "224e1088-78fe-4bdd-99d1-31be3e464996",
        "body" : "does requested include the sum of all pods on the node, including the pod currently scheduled plus the pod being tried on this node ?",
        "createdAt" : "2019-06-06T07:41:49Z",
        "updatedAt" : "2019-08-27T17:42:32Z",
        "lastEditedBy" : "224e1088-78fe-4bdd-99d1-31be3e464996",
        "tags" : [
        ]
      },
      {
        "id" : "debee331-d16c-47af-b968-95a4ce0357e3",
        "parentId" : "633fd1f2-af36-4d37-ad1e-a30ca90da112",
        "authorId" : "27d64a5d-4f76-4c5a-8a7c-11f74a736576",
        "body" : "yes",
        "createdAt" : "2019-06-06T16:59:04Z",
        "updatedAt" : "2019-08-27T17:42:32Z",
        "lastEditedBy" : "27d64a5d-4f76-4c5a-8a7c-11f74a736576",
        "tags" : [
        ]
      }
    ],
    "commit" : "9ae505930c5b70dd0261c2defbb959ec9dabff18",
    "line" : 69,
    "diffHunk" : "@@ -1,1 +129,133 @@\t\tvar nodeScore, weightSum int64\n\t\tfor resource, weight := range resourceToWeightMap {\n\t\t\tresourceScore := resourceScoringFunction(requested[resource], allocable[resource])\n\t\t\tif resourceScore > 0 {\n\t\t\t\tnodeScore += resourceScore * weight"
  },
  {
    "id" : "45a73d47-f188-4c13-a5f5-731c8fcbb103",
    "prId" : 77688,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/77688#pullrequestreview-277890629",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "20216188-949f-4729-8806-7ab842074025",
        "parentId" : null,
        "authorId" : "570b631b-84a0-4888-a815-ca0e7934e412",
        "body" : "I think this is confusing, you are trying to initialize the resources map whenever it is nil (here and in PriorityMap function). Initialization should be done in one place, this function should only do one thing, verify that the provided resources are valid (by checking the weights and perhaps that the resource names are valid).",
        "createdAt" : "2019-06-21T14:14:06Z",
        "updatedAt" : "2019-08-27T17:42:32Z",
        "lastEditedBy" : "570b631b-84a0-4888-a815-ca0e7934e412",
        "tags" : [
        ]
      },
      {
        "id" : "b0e09ac9-8b89-44f3-b9c7-26f8d1dee91a",
        "parentId" : "20216188-949f-4729-8806-7ab842074025",
        "authorId" : "570b631b-84a0-4888-a815-ca0e7934e412",
        "body" : "just bringing your attention that this comment has not been addressed yet.",
        "createdAt" : "2019-07-02T13:23:17Z",
        "updatedAt" : "2019-08-27T17:42:32Z",
        "lastEditedBy" : "570b631b-84a0-4888-a815-ca0e7934e412",
        "tags" : [
        ]
      },
      {
        "id" : "37ec3b6c-7024-4ab4-bb93-33b6134d9beb",
        "parentId" : "20216188-949f-4729-8806-7ab842074025",
        "authorId" : "27d64a5d-4f76-4c5a-8a7c-11f74a736576",
        "body" : "As the old implementation of ResourceToCapacityRatio did not have a resourceToWeightMap for backward compatibility I was setting the default value. I have updated it to use defaultRequestedRatioResources instead of setting it again here. Also, the PriorityMap func is returning resource not found an error when it is nil.",
        "createdAt" : "2019-07-09T19:57:59Z",
        "updatedAt" : "2019-08-27T17:42:32Z",
        "lastEditedBy" : "27d64a5d-4f76-4c5a-8a7c-11f74a736576",
        "tags" : [
        ]
      },
      {
        "id" : "22145537-5c12-4cab-ac6c-48706e525dc1",
        "parentId" : "20216188-949f-4729-8806-7ab842074025",
        "authorId" : "570b631b-84a0-4888-a815-ca0e7934e412",
        "body" : "you are still returning some default value here, that I think we should not. Just return an error when resourceToWeightMap is empty (the correct place for initialization is what you are doing in line 110).",
        "createdAt" : "2019-07-29T17:55:07Z",
        "updatedAt" : "2019-08-27T17:42:32Z",
        "lastEditedBy" : "570b631b-84a0-4888-a815-ca0e7934e412",
        "tags" : [
        ]
      },
      {
        "id" : "aeab41bf-f34d-452d-890e-59ab084ee7c6",
        "parentId" : "20216188-949f-4729-8806-7ab842074025",
        "authorId" : "27d64a5d-4f76-4c5a-8a7c-11f74a736576",
        "body" : "I am using the defaultValue set above because the old function did not require these params to be set by the user. I  have made the resourceToWeight Parameter optional for backward compatibility.",
        "createdAt" : "2019-08-14T17:52:13Z",
        "updatedAt" : "2019-08-27T17:42:32Z",
        "lastEditedBy" : "27d64a5d-4f76-4c5a-8a7c-11f74a736576",
        "tags" : [
        ]
      },
      {
        "id" : "7eb2fc5d-ee66-4fc1-8119-1d154e26eb97",
        "parentId" : "20216188-949f-4729-8806-7ab842074025",
        "authorId" : "570b631b-84a0-4888-a815-ca0e7934e412",
        "body" : "Which old function? and why do we need to make it optional? can you point me to the case where buildRequestedToCapacityRatioScorerFunction is being called with a nil ResourceToWeightMap?",
        "createdAt" : "2019-08-21T15:43:03Z",
        "updatedAt" : "2019-08-27T17:42:32Z",
        "lastEditedBy" : "570b631b-84a0-4888-a815-ca0e7934e412",
        "tags" : [
        ]
      }
    ],
    "commit" : "9ae505930c5b70dd0261c2defbb959ec9dabff18",
    "line" : 19,
    "diffHunk" : "@@ -1,1 +89,93 @@\tif len(resourceToWeightMap) == 0 {\n\t\treturn fmt.Errorf(\"resourceToWeightMap cannot be nil\")\n\t}\n\n\tfor resource, weight := range resourceToWeightMap {"
  }
]