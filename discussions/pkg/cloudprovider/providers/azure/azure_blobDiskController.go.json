[
  {
    "id" : "db2ad877-9ad1-4a29-a166-a55429de2403",
    "prId" : 74191,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/74191#pullrequestreview-204634615",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "aae055cd-f162-4190-89b9-4db10f6b5925",
        "parentId" : null,
        "authorId" : "0df1da34-610c-4ce5-b0cf-bbda668bf9c1",
        "body" : "nit: add a const for the timeout instead of magic numbers.",
        "createdAt" : "2019-02-18T06:28:53Z",
        "updatedAt" : "2019-02-22T07:22:22Z",
        "lastEditedBy" : "0df1da34-610c-4ce5-b0cf-bbda668bf9c1",
        "tags" : [
        ]
      }
    ],
    "commit" : "8cd09bb143669a3dc21acac9964647d78f283c4e",
    "line" : 52,
    "diffHunk" : "@@ -1,1 +441,445 @@\nfunc (c *BlobDiskController) getAllStorageAccounts() (map[string]*storageAccountState, error) {\n\tctx, cancel := context.WithTimeout(context.Background(), 60*time.Second)\n\tdefer cancel()\n\taccountListResult, err := c.common.cloud.StorageAccountClient.ListByResourceGroup(ctx, c.common.resourceGroup)"
  },
  {
    "id" : "f9e7608c-278d-4859-8948-77edbbd4451a",
    "prId" : 74191,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/74191#pullrequestreview-205630701",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d4465e34-e39f-4482-b3d0-5733a7ec47c8",
        "parentId" : null,
        "authorId" : "772f23ac-180c-446c-8cfe-e5c2686f4673",
        "body" : "I haven't looked at the other BlobDisk operations (attach/detach/delete) but I'm assuming here that they cannot get called unless `CreateBlobDisk` was called",
        "createdAt" : "2019-02-19T16:32:32Z",
        "updatedAt" : "2019-02-22T07:22:22Z",
        "lastEditedBy" : "772f23ac-180c-446c-8cfe-e5c2686f4673",
        "tags" : [
        ]
      },
      {
        "id" : "1ed88b66-b771-49ab-a60b-c2a8b1b193ed",
        "parentId" : "d4465e34-e39f-4482-b3d0-5733a7ec47c8",
        "authorId" : "e0218e0a-9e55-43f5-8929-04673eea9015",
        "body" : "yes, only `CreateBlobDisk` func could invoke `getAllStorageAccounts`",
        "createdAt" : "2019-02-20T08:39:39Z",
        "updatedAt" : "2019-02-22T07:22:22Z",
        "lastEditedBy" : "e0218e0a-9e55-43f5-8929-04673eea9015",
        "tags" : [
        ]
      }
    ],
    "commit" : "8cd09bb143669a3dc21acac9964647d78f283c4e",
    "line" : 42,
    "diffHunk" : "@@ -1,1 +220,224 @@\tklog.V(4).Infof(\"azureDisk - creating blob data disk named:%s on StorageAccountType:%s\", dataDiskName, storageAccountType)\n\n\tc.initStorageAccounts()\n\n\tstorageAccountName, err := c.findSANameForDisk(storageAccountType)"
  },
  {
    "id" : "4768d85c-5070-483d-8338-5a9f1083fd42",
    "prId" : 74191,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/74191#pullrequestreview-205630701",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8b4655a3-2e08-4c43-a4ce-b405617f7783",
        "parentId" : null,
        "authorId" : "772f23ac-180c-446c-8cfe-e5c2686f4673",
        "body" : "I do not see the logic where the timeout was reduced to 1min, do we still want to keep the 10mins timeout (knowing that the initial issue was solved differently) I will leave that decision to you two :)",
        "createdAt" : "2019-02-19T16:33:31Z",
        "updatedAt" : "2019-02-22T07:22:22Z",
        "lastEditedBy" : "772f23ac-180c-446c-8cfe-e5c2686f4673",
        "tags" : [
        ]
      },
      {
        "id" : "2094da49-60d7-45aa-b70c-8284e3ec075b",
        "parentId" : "8b4655a3-2e08-4c43-a4ce-b405617f7783",
        "authorId" : "e0218e0a-9e55-43f5-8929-04673eea9015",
        "body" : "let's keep the original timeout, this issue is already resolved by moving `getAllStorageAccounts` to only invoked by `CreateBlobDisk`. ",
        "createdAt" : "2019-02-20T08:41:43Z",
        "updatedAt" : "2019-02-22T07:22:22Z",
        "lastEditedBy" : "e0218e0a-9e55-43f5-8929-04673eea9015",
        "tags" : [
        ]
      }
    ],
    "commit" : "8cd09bb143669a3dc21acac9964647d78f283c4e",
    "line" : 26,
    "diffHunk" : "@@ -1,1 +70,74 @@\tif c.accounts == nil {\n\t\t// get accounts\n\t\taccounts, err := c.getAllStorageAccounts()\n\t\tif err != nil {\n\t\t\tklog.Errorf(\"azureDisk - getAllStorageAccounts error: %v\", err)"
  },
  {
    "id" : "2155da93-7f42-46dc-897d-86b7e55fe0a4",
    "prId" : 74191,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/74191#pullrequestreview-205752924",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "43b788a1-1e5e-4268-9ffe-5646f6bacf7b",
        "parentId" : null,
        "authorId" : "0df1da34-610c-4ce5-b0cf-bbda668bf9c1",
        "body" : "Are there any race conditions for it? maybe hold the operations within a lock?",
        "createdAt" : "2019-02-20T12:59:41Z",
        "updatedAt" : "2019-02-22T07:22:22Z",
        "lastEditedBy" : "0df1da34-610c-4ce5-b0cf-bbda668bf9c1",
        "tags" : [
        ]
      },
      {
        "id" : "ad049bc0-1be8-4c35-9b1e-45120cc944d0",
        "parentId" : "43b788a1-1e5e-4268-9ffe-5646f6bacf7b",
        "authorId" : "e0218e0a-9e55-43f5-8929-04673eea9015",
        "body" : "@feiskyer good catch, while I think it does not matter since it's only get accounts(read), no write or update.",
        "createdAt" : "2019-02-20T13:04:33Z",
        "updatedAt" : "2019-02-22T07:22:22Z",
        "lastEditedBy" : "e0218e0a-9e55-43f5-8929-04673eea9015",
        "tags" : [
        ]
      },
      {
        "id" : "9dcf997e-1003-4e08-bfde-d675ac626f89",
        "parentId" : "43b788a1-1e5e-4268-9ffe-5646f6bacf7b",
        "authorId" : "0df1da34-610c-4ce5-b0cf-bbda668bf9c1",
        "body" : "Yep, but I think `c.accounts` may be called in different goroutines, so it's better to be held by a lock.",
        "createdAt" : "2019-02-20T13:08:00Z",
        "updatedAt" : "2019-02-22T07:22:22Z",
        "lastEditedBy" : "0df1da34-610c-4ce5-b0cf-bbda668bf9c1",
        "tags" : [
        ]
      },
      {
        "id" : "125a6454-e1df-4643-a33b-1388f35f3796",
        "parentId" : "43b788a1-1e5e-4268-9ffe-5646f6bacf7b",
        "authorId" : "e0218e0a-9e55-43f5-8929-04673eea9015",
        "body" : "ok, let me put a lock anyway for the sake of safety, thanks.",
        "createdAt" : "2019-02-20T13:11:11Z",
        "updatedAt" : "2019-02-22T07:22:22Z",
        "lastEditedBy" : "e0218e0a-9e55-43f5-8929-04673eea9015",
        "tags" : [
        ]
      },
      {
        "id" : "4e902f9a-87a6-4cbe-be45-f07b61d4cfe0",
        "parentId" : "43b788a1-1e5e-4268-9ffe-5646f6bacf7b",
        "authorId" : "e0218e0a-9e55-43f5-8929-04673eea9015",
        "body" : "@feiskyer it's been fixed in the new commit",
        "createdAt" : "2019-02-20T13:22:39Z",
        "updatedAt" : "2019-02-22T07:22:22Z",
        "lastEditedBy" : "e0218e0a-9e55-43f5-8929-04673eea9015",
        "tags" : [
        ]
      }
    ],
    "commit" : "8cd09bb143669a3dc21acac9964647d78f283c4e",
    "line" : 24,
    "diffHunk" : "@@ -1,1 +68,72 @@\tdefer accountsLock.Unlock()\n\n\tif c.accounts == nil {\n\t\t// get accounts\n\t\taccounts, err := c.getAllStorageAccounts()"
  },
  {
    "id" : "c3a8a436-f66a-40fa-b6dd-eea860eb9291",
    "prId" : 74191,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/74191#pullrequestreview-206681599",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "898e95e8-3c53-47e5-966b-7342c342a6a0",
        "parentId" : null,
        "authorId" : "0df1da34-610c-4ce5-b0cf-bbda668bf9c1",
        "body" : "Keep c.accouts as nil here? or else, it won't try again on errors.",
        "createdAt" : "2019-02-22T07:04:36Z",
        "updatedAt" : "2019-02-22T07:22:22Z",
        "lastEditedBy" : "0df1da34-610c-4ce5-b0cf-bbda668bf9c1",
        "tags" : [
        ]
      },
      {
        "id" : "f847c757-3837-4636-b867-7748e9cf4331",
        "parentId" : "898e95e8-3c53-47e5-966b-7342c342a6a0",
        "authorId" : "e0218e0a-9e55-43f5-8929-04673eea9015",
        "body" : "@feiskyer yes, won't try again on error, it would make new map and create new storage account(don't use existing accounts)",
        "createdAt" : "2019-02-22T07:10:27Z",
        "updatedAt" : "2019-02-22T07:25:19Z",
        "lastEditedBy" : "e0218e0a-9e55-43f5-8929-04673eea9015",
        "tags" : [
        ]
      }
    ],
    "commit" : "8cd09bb143669a3dc21acac9964647d78f283c4e",
    "line" : 29,
    "diffHunk" : "@@ -1,1 +73,77 @@\t\tif err != nil {\n\t\t\tklog.Errorf(\"azureDisk - getAllStorageAccounts error: %v\", err)\n\t\t\tc.accounts = make(map[string]*storageAccountState)\n\t\t}\n\t\tc.accounts = accounts"
  },
  {
    "id" : "229c5c90-29dc-4334-9cbd-8bc445c460b1",
    "prId" : 54687,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/54687#pullrequestreview-72495559",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b258c8fd-6086-4005-b841-623364b1f7bc",
        "parentId" : null,
        "authorId" : "a7f673a6-4b23-4df6-aa10-f123fa9dcd5f",
        "body" : "this can be fixed now?",
        "createdAt" : "2017-10-27T12:36:54Z",
        "updatedAt" : "2017-11-19T11:22:31Z",
        "lastEditedBy" : "a7f673a6-4b23-4df6-aa10-f123fa9dcd5f",
        "tags" : [
        ]
      },
      {
        "id" : "a006c6bf-dab8-4ed1-ade1-da2c49308b17",
        "parentId" : "b258c8fd-6086-4005-b841-623364b1f7bc",
        "authorId" : "e0218e0a-9e55-43f5-8929-04673eea9015",
        "body" : "yes, I would like to fix it in a new PR.",
        "createdAt" : "2017-10-27T12:57:19Z",
        "updatedAt" : "2017-11-19T11:22:31Z",
        "lastEditedBy" : "e0218e0a-9e55-43f5-8929-04673eea9015",
        "tags" : [
        ]
      }
    ],
    "commit" : "760cc6f78bb9c6b09726f93b8bc7063a20c9d799",
    "line" : 54,
    "diffHunk" : "@@ -1,1 +94,98 @@\t\taccounts, err = c.common.cloud.getStorageAccounts()\n\t\tif err != nil {\n\t\t\t// TODO: create a storage account and container\n\t\t\treturn \"\", \"\", 0, err\n\t\t}"
  }
]