[
  {
    "id" : "a4ba4b54-74fa-4ee0-ba1d-faf1e5e819b4",
    "prId" : 96600,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/96600#pullrequestreview-580866687",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "1b9fa1f5-ed2f-453f-b7b9-db5fc504f20f",
        "parentId" : null,
        "authorId" : "6dd71efb-88b1-4bb0-b30a-0df658362f14",
        "body" : "Can we add a unit test here similar to `TestFilterTopologyEndpoint`? ",
        "createdAt" : "2020-12-14T16:12:28Z",
        "updatedAt" : "2021-03-08T16:43:22Z",
        "lastEditedBy" : "6dd71efb-88b1-4bb0-b30a-0df658362f14",
        "tags" : [
        ]
      },
      {
        "id" : "5ec3ae9e-6bfc-49e9-9129-8cb503e2b228",
        "parentId" : "1b9fa1f5-ed2f-453f-b7b9-db5fc504f20f",
        "authorId" : "a2e00680-b383-4471-a78c-45fa5811f18b",
        "body" : "done",
        "createdAt" : "2021-02-01T23:42:00Z",
        "updatedAt" : "2021-03-08T16:43:22Z",
        "lastEditedBy" : "a2e00680-b383-4471-a78c-45fa5811f18b",
        "tags" : [
        ]
      }
    ],
    "commit" : "62804c1ae8762938e4f708f3d6e0408aa47d7020",
    "line" : 51,
    "diffHunk" : "@@ -1,1 +88,92 @@// endpoints slice.\n// Otherwise, if InternalTrafficPolicy is Local, only return the node local endpoints.\nfunc FilterLocalEndpoint(internalTrafficPolicy *v1.ServiceInternalTrafficPolicyType, endpoints []Endpoint) []Endpoint {\n\tif !utilfeature.DefaultFeatureGate.Enabled(features.ServiceInternalTrafficPolicy) {\n\t\treturn endpoints"
  },
  {
    "id" : "cb031dd9-1e28-4105-b9d2-eca6dea573b3",
    "prId" : 96600,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/96600#pullrequestreview-605669111",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "4afec5af-090e-4fb5-b5dd-76d086b72951",
        "parentId" : null,
        "authorId" : "f87fe7d3-581c-4cb6-b17e-b807c6f2c789",
        "body" : "need to check gate?",
        "createdAt" : "2021-03-05T06:12:38Z",
        "updatedAt" : "2021-03-08T16:43:23Z",
        "lastEditedBy" : "f87fe7d3-581c-4cb6-b17e-b807c6f2c789",
        "tags" : [
        ]
      },
      {
        "id" : "013d065e-d899-4a1f-b753-58721fd0c90b",
        "parentId" : "4afec5af-090e-4fb5-b5dd-76d086b72951",
        "authorId" : "a2e00680-b383-4471-a78c-45fa5811f18b",
        "body" : "added logic to return the original endpoints when gate is not on.",
        "createdAt" : "2021-03-05T22:49:54Z",
        "updatedAt" : "2021-03-08T16:43:23Z",
        "lastEditedBy" : "a2e00680-b383-4471-a78c-45fa5811f18b",
        "tags" : [
        ]
      }
    ],
    "commit" : "62804c1ae8762938e4f708f3d6e0408aa47d7020",
    "line" : 55,
    "diffHunk" : "@@ -1,1 +92,96 @@\t\treturn endpoints\n\t}\n\tif internalTrafficPolicy == nil || *internalTrafficPolicy == v1.ServiceInternalTrafficPolicyCluster {\n\t\treturn endpoints\n\t}"
  },
  {
    "id" : "0358c0ca-8f79-4e7b-8845-5243589c7ecf",
    "prId" : 72046,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/72046#pullrequestreview-276221521",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "4b9d324d-d47b-46f1-b076-724619ebbd41",
        "parentId" : null,
        "authorId" : "f87fe7d3-581c-4cb6-b17e-b807c6f2c789",
        "body" : "rename ok to \"found\" - it makes more sense",
        "createdAt" : "2019-08-14T21:19:46Z",
        "updatedAt" : "2019-11-15T06:38:02Z",
        "lastEditedBy" : "f87fe7d3-581c-4cb6-b17e-b807c6f2c789",
        "tags" : [
        ]
      },
      {
        "id" : "1edddfa7-bf98-4b9c-a859-3e3ddbea0afc",
        "parentId" : "4b9d324d-d47b-46f1-b076-724619ebbd41",
        "authorId" : "e379cdad-051b-485d-824f-1b14a8cc7dd0",
        "body" : "done",
        "createdAt" : "2019-08-17T03:36:25Z",
        "updatedAt" : "2019-11-15T06:38:02Z",
        "lastEditedBy" : "e379cdad-051b-485d-824f-1b14a8cc7dd0",
        "tags" : [
        ]
      }
    ],
    "commit" : "31d623b4d74ceadfad101d36a4710d4406fcf144",
    "line" : 66,
    "diffHunk" : "@@ -1,1 +64,68 @@\t\ttopologyValue, found := nodeLabels[key]\n\t\tif !found {\n\t\t\tcontinue\n\t\t}\n"
  },
  {
    "id" : "a6b0bb54-26fc-4073-859b-98b54e94a8a3",
    "prId" : 72046,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/72046#pullrequestreview-278868841",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8d0b2d11-82fc-4f7c-8881-b1bcd5fba1be",
        "parentId" : null,
        "authorId" : "6dd71efb-88b1-4bb0-b30a-0df658362f14",
        "body" : "I personally think this reads better if you put this check at the beginning of the topologyKeys for loop. ",
        "createdAt" : "2019-08-22T22:37:23Z",
        "updatedAt" : "2019-11-15T06:38:02Z",
        "lastEditedBy" : "6dd71efb-88b1-4bb0-b30a-0df658362f14",
        "tags" : [
        ]
      },
      {
        "id" : "133ff076-1456-42c6-a9ea-79bcc8aa4aff",
        "parentId" : "8d0b2d11-82fc-4f7c-8881-b1bcd5fba1be",
        "authorId" : "6dd71efb-88b1-4bb0-b30a-0df658362f14",
        "body" : "or maybe just \r\n\r\n```\r\nif len(filteredEndpoint) > 0 {\r\n    return filteredEndpoint\r\n}\r\n```",
        "createdAt" : "2019-08-22T22:38:39Z",
        "updatedAt" : "2019-11-15T06:38:02Z",
        "lastEditedBy" : "6dd71efb-88b1-4bb0-b30a-0df658362f14",
        "tags" : [
        ]
      },
      {
        "id" : "c5f91535-f82b-44bd-98fd-169a0f3d7919",
        "parentId" : "8d0b2d11-82fc-4f7c-8881-b1bcd5fba1be",
        "authorId" : "e379cdad-051b-485d-824f-1b14a8cc7dd0",
        "body" : "Let's just return `filteredEndpoint` when it's not empty.",
        "createdAt" : "2019-08-23T08:41:42Z",
        "updatedAt" : "2019-11-15T06:38:02Z",
        "lastEditedBy" : "e379cdad-051b-485d-824f-1b14a8cc7dd0",
        "tags" : [
        ]
      }
    ],
    "commit" : "31d623b4d74ceadfad101d36a4710d4406fcf144",
    "line" : 75,
    "diffHunk" : "@@ -1,1 +73,77 @@\t\t\t}\n\t\t}\n\t\tif len(filteredEndpoint) > 0 {\n\t\t\treturn filteredEndpoint\n\t\t}"
  },
  {
    "id" : "0f457fdb-1f52-4869-8805-da3d28c85136",
    "prId" : 72046,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/72046#pullrequestreview-312398828",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "4bc97cb6-aeb1-4ca4-b9d6-37b4c3baba8f",
        "parentId" : null,
        "authorId" : "e379cdad-051b-485d-824f-1b14a8cc7dd0",
        "body" : "The following cases will not filter endpoints (return all endpoints):\r\n1. Service without topology keys.\r\n2. Can not get current node labels which contains topology information (e.g. hostname is different with node name so we can not watch current node, or node was out of cluster, but still want to use kube-proxy to sync rule to visit cluster ip for some reason).\r\n",
        "createdAt" : "2019-11-06T12:39:26Z",
        "updatedAt" : "2019-11-15T06:38:02Z",
        "lastEditedBy" : "e379cdad-051b-485d-824f-1b14a8cc7dd0",
        "tags" : [
        ]
      }
    ],
    "commit" : "31d623b4d74ceadfad101d36a4710d4406fcf144",
    "line" : 44,
    "diffHunk" : "@@ -1,1 +42,46 @@\t// Do not filter endpoints if service has no topology keys.\n\tif len(topologyKeys) == 0 {\n\t\treturn endpoints\n\t}\n"
  }
]