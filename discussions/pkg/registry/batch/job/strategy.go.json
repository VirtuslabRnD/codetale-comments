[
  {
    "id" : "85ee6840-a1e4-4c7d-8739-ab9508434560",
    "prId" : 100188,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/100188#pullrequestreview-611060934",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "551d583a-569c-4573-bac4-c11182e45287",
        "parentId" : null,
        "authorId" : "521b6fc2-4b36-4594-8b5b-9d1e5bcc8759",
        "body" : "this would allow updating from NonIndexed->Indexed even when the feature gate is disabled, no?",
        "createdAt" : "2021-03-12T17:55:30Z",
        "updatedAt" : "2021-03-12T20:47:08Z",
        "lastEditedBy" : "521b6fc2-4b36-4594-8b5b-9d1e5bcc8759",
        "tags" : [
        ]
      },
      {
        "id" : "2271ec88-d23f-4972-ab55-fa8e39e76123",
        "parentId" : "551d583a-569c-4573-bac4-c11182e45287",
        "authorId" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "body" : "It would... but field is immutable (checked in `ValidateJobSpecUpdate`)\r\n\r\nAlso, the feature gate is, in a way, protecting the field to not be set, without caring about the value.",
        "createdAt" : "2021-03-12T18:52:05Z",
        "updatedAt" : "2021-03-12T20:47:08Z",
        "lastEditedBy" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "tags" : [
        ]
      }
    ],
    "commit" : "e6c3d7b34dff0324adb80591c00519b6f6a4a2e1",
    "line" : 29,
    "diffHunk" : "@@ -1,1 +116,120 @@\n\tif !utilfeature.DefaultFeatureGate.Enabled(features.IndexedJob) && oldJob.Spec.CompletionMode == nil {\n\t\tnewJob.Spec.CompletionMode = nil\n\t}\n"
  },
  {
    "id" : "df3f4c45-bac5-4c65-a62e-c31caad89fa7",
    "prId" : 98817,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/98817#pullrequestreview-692103495",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3b1a46ad-162b-4797-9c99-d0bb3521b5ff",
        "parentId" : null,
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "what happens if the annotation gets deleted on update by the client making the API request? does the controller go back to tracking by pod counts? does that work properly (or at least no worse than job completion calculation currently works)? is it tested?",
        "createdAt" : "2021-06-26T20:37:27Z",
        "updatedAt" : "2021-06-26T20:46:00Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "e091721f-6cd7-4680-8678-58ddf7f2b9d1",
        "parentId" : "3b1a46ad-162b-4797-9c99-d0bb3521b5ff",
        "authorId" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "body" : "Yes, it goes back by tracking by pod counts. It works properly as long as pods were not deleted by GC.\r\n\r\nThere is an integration test for disabling the feature gate, which is pretty much equivalent.",
        "createdAt" : "2021-06-28T13:31:24Z",
        "updatedAt" : "2021-06-28T14:26:25Z",
        "lastEditedBy" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "tags" : [
        ]
      }
    ],
    "commit" : "bb56a0bd04891ae0a4aebeaeb4d145b32d9ad2d9",
    "line" : 52,
    "diffHunk" : "@@ -1,1 +162,166 @@\t\tdropJobTrackingAnnotation(newJob)\n\t}\n\n\tpod.DropDisabledTemplateFields(&newJob.Spec.Template, &oldJob.Spec.Template)\n"
  },
  {
    "id" : "a675378d-6e52-4c2e-97e0-97345279dd38",
    "prId" : 98817,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/98817#pullrequestreview-695374386",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d14f99e4-1c81-445e-9234-efeece518c16",
        "parentId" : null,
        "authorId" : "695b6860-569c-4e63-a215-7342e2279a94",
        "body" : "can we remove `!utilfeature.DefaultFeatureGate.Enabled(features.JobTrackingWithFinalizers)`? Since we don't support migrating from a legacy tracking to the new tracking, shall we drop the annotation as long as the old job doesn't have the annotation? ",
        "createdAt" : "2021-06-28T20:58:05Z",
        "updatedAt" : "2021-06-28T21:00:48Z",
        "lastEditedBy" : "695b6860-569c-4e63-a215-7342e2279a94",
        "tags" : [
        ]
      },
      {
        "id" : "f93680c6-bbe5-437c-ad80-fe85c8818dbf",
        "parentId" : "d14f99e4-1c81-445e-9234-efeece518c16",
        "authorId" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "body" : "I think we shouldn't drop it. If the user tries to add it, and the feature is enabled, they should get an explicit validation error.",
        "createdAt" : "2021-06-29T14:26:28Z",
        "updatedAt" : "2021-06-29T17:54:08Z",
        "lastEditedBy" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "tags" : [
        ]
      },
      {
        "id" : "a8167a57-fd56-474e-b42e-addebf4456a0",
        "parentId" : "d14f99e4-1c81-445e-9234-efeece518c16",
        "authorId" : "695b6860-569c-4e63-a215-7342e2279a94",
        "body" : "sounds good. Why don't we also return an error when the feature is disabled?",
        "createdAt" : "2021-06-29T18:24:29Z",
        "updatedAt" : "2021-06-29T18:24:48Z",
        "lastEditedBy" : "695b6860-569c-4e63-a215-7342e2279a94",
        "tags" : [
        ]
      },
      {
        "id" : "98dc1a14-9220-49bb-8653-c94211b8a2a5",
        "parentId" : "d14f99e4-1c81-445e-9234-efeece518c16",
        "authorId" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "body" : "This is what we do for other gated fields.\r\n\r\nI believe the intent is that when the feature was enabled, users might have started to add the field to their spec. We don't want those specs do suddenly start failing when the feature is disabled.",
        "createdAt" : "2021-06-29T18:29:43Z",
        "updatedAt" : "2021-06-29T18:30:00Z",
        "lastEditedBy" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "tags" : [
        ]
      },
      {
        "id" : "da5bc8cb-7f1b-4ac7-839f-114ef946d256",
        "parentId" : "d14f99e4-1c81-445e-9234-efeece518c16",
        "authorId" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "body" : "That rationale doesn't apply for a Job that didn't have the the annotation before.",
        "createdAt" : "2021-06-29T18:31:22Z",
        "updatedAt" : "2021-06-29T18:31:24Z",
        "lastEditedBy" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "tags" : [
        ]
      }
    ],
    "commit" : "bb56a0bd04891ae0a4aebeaeb4d145b32d9ad2d9",
    "line" : 49,
    "diffHunk" : "@@ -1,1 +159,163 @@\t\t}\n\t}\n\tif !utilfeature.DefaultFeatureGate.Enabled(features.JobTrackingWithFinalizers) && !hasJobTrackingAnnotation(oldJob) {\n\t\tdropJobTrackingAnnotation(newJob)\n\t}"
  },
  {
    "id" : "b9b0bb31-348c-4710-8a5c-9f1bff3eeba7",
    "prId" : 66840,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/66840#pullrequestreview-152259379",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7c055abd-d5ec-4813-b91c-91ad098acd00",
        "parentId" : null,
        "authorId" : "392f7c7a-6820-4848-94e2-2b8e009fec9d",
        "body" : "Changes here are unnecessary, since they are caught in validation, right?",
        "createdAt" : "2018-09-04T20:35:08Z",
        "updatedAt" : "2018-09-04T21:21:33Z",
        "lastEditedBy" : "392f7c7a-6820-4848-94e2-2b8e009fec9d",
        "tags" : [
        ]
      },
      {
        "id" : "09cf9c73-dbd5-480f-8dd7-26dfffde696e",
        "parentId" : "7c055abd-d5ec-4813-b91c-91ad098acd00",
        "authorId" : "01c14569-b640-48af-98cc-aa9dd12da7b6",
        "body" : "It's required based on https://github.com/kubernetes/community/blob/master/contributors/devel/api_changes.md#alpha-field-in-existing-api-version; validation covers whatever might be missed here. ",
        "createdAt" : "2018-09-04T21:23:25Z",
        "updatedAt" : "2018-09-04T21:23:25Z",
        "lastEditedBy" : "01c14569-b640-48af-98cc-aa9dd12da7b6",
        "tags" : [
        ]
      }
    ],
    "commit" : "13b76d5fb4eb680a78eb9760f8bf0b2dd4d75d9c",
    "line" : 28,
    "diffHunk" : "@@ -1,1 +77,81 @@\tnewJob.Status = oldJob.Status\n\n\tif !utilfeature.DefaultFeatureGate.Enabled(features.TTLAfterFinished) {\n\t\tnewJob.Spec.TTLSecondsAfterFinished = nil\n\t\toldJob.Spec.TTLSecondsAfterFinished = nil"
  }
]