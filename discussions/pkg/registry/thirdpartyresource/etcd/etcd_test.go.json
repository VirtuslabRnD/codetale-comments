[
  {
    "id" : "e8e881b7-9051-4c7d-9392-61ed0f49891a",
    "prId" : 13201,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ad83d0d5-8e28-4b63-b830-d0acd4bc1043",
        "parentId" : null,
        "authorId" : "f2369046-26b1-4b8c-a8cd-5671ab22066c",
        "body" : "Everyone is passing the same 3 funcs to TestUpdate.\nSeems like they can just pass storage and fakeClient instead?\n",
        "createdAt" : "2015-08-28T02:21:57Z",
        "updatedAt" : "2015-08-28T13:47:59Z",
        "lastEditedBy" : "f2369046-26b1-4b8c-a8cd-5671ab22066c",
        "tags" : [
        ]
      },
      {
        "id" : "5cbd1633-5a66-492e-9daa-bd187c301051",
        "parentId" : "ad83d0d5-8e28-4b63-b830-d0acd4bc1043",
        "authorId" : "f2369046-26b1-4b8c-a8cd-5671ab22066c",
        "body" : "I guess we do that because we do not want resttest to depend on registrytest?\n",
        "createdAt" : "2015-08-28T04:41:08Z",
        "updatedAt" : "2015-08-28T13:47:59Z",
        "lastEditedBy" : "f2369046-26b1-4b8c-a8cd-5671ab22066c",
        "tags" : [
        ]
      },
      {
        "id" : "71d7334e-70d8-44d1-b0b9-61d9f11cd2f7",
        "parentId" : "ad83d0d5-8e28-4b63-b830-d0acd4bc1043",
        "authorId" : "f2369046-26b1-4b8c-a8cd-5671ab22066c",
        "body" : "Actually, why do we even need registrytest?\nWhat if resttest directly uses storage.(rest.Getter).Get instead of this getFn and similarly storage.(rest.Creater).Create instead of the setFn?\n",
        "createdAt" : "2015-08-28T06:21:23Z",
        "updatedAt" : "2015-08-28T13:47:59Z",
        "lastEditedBy" : "f2369046-26b1-4b8c-a8cd-5671ab22066c",
        "tags" : [
        ]
      },
      {
        "id" : "0f90edb3-7800-4c20-8fe9-87ae3c1cceee",
        "parentId" : "ad83d0d5-8e28-4b63-b830-d0acd4bc1043",
        "authorId" : "24302707-9254-48df-89a5-cbcc349462b8",
        "body" : "Yes - my goal was to resttest not depend on registrytest (or more general on etcd-specific implementation).\nWe may consider using Get() and Create(0 instead of those function, but in this approach we are explicitly testing database contents, which in my opinion gives some value.\n",
        "createdAt" : "2015-08-28T06:31:32Z",
        "updatedAt" : "2015-08-28T13:47:59Z",
        "lastEditedBy" : "24302707-9254-48df-89a5-cbcc349462b8",
        "tags" : [
        ]
      },
      {
        "id" : "f1e5073b-a38f-49c1-bfab-8094e6d74494",
        "parentId" : "ad83d0d5-8e28-4b63-b830-d0acd4bc1043",
        "authorId" : "24302707-9254-48df-89a5-cbcc349462b8",
        "body" : "In other words, I would prefer to leave as is for now and we can simplify more in the future (by getting rid of those functions where possible).\n",
        "createdAt" : "2015-08-28T07:49:43Z",
        "updatedAt" : "2015-08-28T13:47:59Z",
        "lastEditedBy" : "24302707-9254-48df-89a5-cbcc349462b8",
        "tags" : [
        ]
      },
      {
        "id" : "5b49ab37-b45d-4f71-8aee-bedb52f45777",
        "parentId" : "ad83d0d5-8e28-4b63-b830-d0acd4bc1043",
        "authorId" : "f2369046-26b1-4b8c-a8cd-5671ab22066c",
        "body" : "I discussed this with @lavalamp.\nWe cannot use Get() directly here since there could be write-only resources (which support Create(), but not Get()).\nBut we should not require etcd_tests to pass these get, set functions. The resttest framework itself can have these functions.\nThat will eliminate the boilerplate code of passing those functions in all our pkg/registry/*/etcd/etcd_tests.go files.\nWill try to come up with a PR with that change and we can see how it looks.\n",
        "createdAt" : "2015-08-28T21:39:25Z",
        "updatedAt" : "2015-08-28T21:39:25Z",
        "lastEditedBy" : "f2369046-26b1-4b8c-a8cd-5671ab22066c",
        "tags" : [
        ]
      },
      {
        "id" : "2c469e67-2f60-4dc3-ad72-4b05d093ce7f",
        "parentId" : "ad83d0d5-8e28-4b63-b830-d0acd4bc1043",
        "authorId" : "24302707-9254-48df-89a5-cbcc349462b8",
        "body" : "@nikhiljindal @lavalamp \nI was also thinking about it a bit during the weekend and I think that what we should do is to create \"registrytest\" framework, which will be just calling the methods from \"resttest\", but will be aware of all those methods that are specific for etcd. This will also eliminate a bunch of boilerplate for individual tests.\nI'm going to make a PR for it (unless you pick it up before me), but once I'm done with refactoring for watch & delete tests.\n",
        "createdAt" : "2015-08-31T06:37:50Z",
        "updatedAt" : "2015-08-31T06:37:50Z",
        "lastEditedBy" : "24302707-9254-48df-89a5-cbcc349462b8",
        "tags" : [
        ]
      },
      {
        "id" : "89171e1d-5b1d-4bd0-b7e3-ba64464fef4d",
        "parentId" : "ad83d0d5-8e28-4b63-b830-d0acd4bc1043",
        "authorId" : "f2369046-26b1-4b8c-a8cd-5671ab22066c",
        "body" : "Go for it.\n",
        "createdAt" : "2015-08-31T07:08:11Z",
        "updatedAt" : "2015-08-31T07:08:11Z",
        "lastEditedBy" : "f2369046-26b1-4b8c-a8cd-5671ab22066c",
        "tags" : [
        ]
      },
      {
        "id" : "60af9bb1-cc9e-46de-8e46-f01301e4e22b",
        "parentId" : "ad83d0d5-8e28-4b63-b830-d0acd4bc1043",
        "authorId" : "24302707-9254-48df-89a5-cbcc349462b8",
        "body" : "@nikhiljindal \nThe proof-of-concept PR (how I see it) is here:\nhttps://github.com/kubernetes/kubernetes/compare/master...wojtek-t:etcd_test_framework\n\nAny comments are welcome (I will finish this PR later this week).\n",
        "createdAt" : "2015-08-31T12:37:36Z",
        "updatedAt" : "2015-08-31T12:37:36Z",
        "lastEditedBy" : "24302707-9254-48df-89a5-cbcc349462b8",
        "tags" : [
        ]
      }
    ],
    "commit" : "836be0c43290d9e1086834b1f33d99691a5b9643",
    "line" : 26,
    "diffHunk" : "@@ -1,1 +84,88 @@\t\t// valid\n\t\tvalidNewThirdPartyResource(\"foo\"),\n\t\tfunc(ctx api.Context, obj runtime.Object) error {\n\t\t\treturn registrytest.SetObject(fakeClient, storage.KeyFunc, ctx, obj)\n\t\t},"
  }
]