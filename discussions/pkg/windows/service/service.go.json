[
  {
    "id" : "8b20b3ca-bd7c-41ef-996f-37f10a41e4bd",
    "prId" : 73292,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/73292#pullrequestreview-204038237",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "cc075eb8-bfd5-452a-ad16-75dd3f257a09",
        "parentId" : null,
        "authorId" : "881df817-68e6-43dd-b4ea-f0b973f7dc41",
        "body" : "Is there any way to explicitly flush or get an ack from the SCM, rather than just waiting for an arbitrary duration?",
        "createdAt" : "2019-02-12T21:22:00Z",
        "updatedAt" : "2019-02-12T21:22:00Z",
        "lastEditedBy" : "881df817-68e6-43dd-b4ea-f0b973f7dc41",
        "tags" : [
        ]
      },
      {
        "id" : "7585ae8e-aef6-4a1e-89e3-d63c3379a154",
        "parentId" : "cc075eb8-bfd5-452a-ad16-75dd3f257a09",
        "authorId" : "f65b2cff-a880-46ca-8bbb-29e019a5f8cb",
        "body" : "Not without effort, **you really don't want to be doing there** (and you'd have to be polling and doing windows API (=syscalls) manually here).\r\n\r\nAlso **1 second is really enough time**, we basically only need to make sure that the function that spawns this goroutine has exited, since then the relevant syscall is performed, which should only take a few hundred nanoseconds. \r\nAlso keep in mind **that this is the edge case** (for programs that do not support graceful shutdowns).\r\n",
        "createdAt" : "2019-02-13T08:30:31Z",
        "updatedAt" : "2019-02-13T08:30:32Z",
        "lastEditedBy" : "f65b2cff-a880-46ca-8bbb-29e019a5f8cb",
        "tags" : [
        ]
      },
      {
        "id" : "9ff03968-a2fc-41ea-a203-c1c3def939ac",
        "parentId" : "cc075eb8-bfd5-452a-ad16-75dd3f257a09",
        "authorId" : "a1a1c8af-e8d1-473f-b2b9-b14426320bcb",
        "body" : "the SCM doesn't have a way to ACK, it's the other direction. This is actually the kubelet's ack to the service control manager that the stop request was received, and is processing. If the service control manager doesn't get this pending state, it will assume the process is hung and forcefully kill it. If the process is still around after the wait (30 seconds, or more if we give it a hint when passing the stop pending status), the service control manager will poll this status again.",
        "createdAt" : "2019-02-15T00:34:33Z",
        "updatedAt" : "2019-02-15T00:34:33Z",
        "lastEditedBy" : "a1a1c8af-e8d1-473f-b2b9-b14426320bcb",
        "tags" : [
        ]
      }
    ],
    "commit" : "c2b771d5c46ca3b2f58f72595fe07a4e56a63762",
    "line" : 37,
    "diffHunk" : "@@ -1,1 +103,107 @@\t\t\t\t\t\t// Ensure the SCM was notified (The operation above (send to s) was received and communicated to the\n\t\t\t\t\t\t// service control manager - so it doesn't look like the service crashes)\n\t\t\t\t\t\ttime.Sleep(1 * time.Second)\n\t\t\t\t\t\tos.Exit(0)\n\t\t\t\t\t}()"
  }
]