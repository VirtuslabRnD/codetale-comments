[
  {
    "id" : "552fd5e5-358e-4c64-9a9d-8d155f683054",
    "prId" : 80681,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/80681#pullrequestreview-268118803",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "de5df4b6-fdda-4b53-9a57-05e2ec76ca6b",
        "parentId" : null,
        "authorId" : "b86e7e78-bb07-417f-8470-39407559c779",
        "body" : "I am pretty nervous about offering these options.\r\n1) it's now fairly easy to misconfigure and end up with multiple active controllers, which could be catastrophic (imagine thrashing over load balancers, for example)\r\n2) is it possible to change these flags one replica at a time in a HA configuration? How?",
        "createdAt" : "2019-07-29T19:38:25Z",
        "updatedAt" : "2019-08-03T03:47:02Z",
        "lastEditedBy" : "b86e7e78-bb07-417f-8470-39407559c779",
        "tags" : [
        ]
      },
      {
        "id" : "22ab712a-7028-4954-82e8-9ded1c3288da",
        "parentId" : "de5df4b6-fdda-4b53-9a57-05e2ec76ca6b",
        "authorId" : "20555cdb-65b0-41d0-aea2-5598a3439d50",
        "body" : "> 1. it's now fairly easy to misconfigure and end up with multiple active controllers, which could be catastrophic (imagine thrashing over load balancers, for example)\r\n\r\nIn most case, we needn't configure these options. We will configure them when we want to seperate some controllers out of kcm.\r\n> 2. is it possible to change these flags one replica at a time in a HA configuration? How?\r\n\r\nI don't understand why we want to change these flags for a inflight controller.\r\nIf we want to do it, firstly stop the standby kcms, change all kcm's flags, restart the active kcm, restart the standby kcms.",
        "createdAt" : "2019-07-30T00:26:48Z",
        "updatedAt" : "2019-08-03T03:47:02Z",
        "lastEditedBy" : "20555cdb-65b0-41d0-aea2-5598a3439d50",
        "tags" : [
        ]
      },
      {
        "id" : "280aa4b2-e657-4d82-9688-da6f3d22798c",
        "parentId" : "de5df4b6-fdda-4b53-9a57-05e2ec76ca6b",
        "authorId" : "20555cdb-65b0-41d0-aea2-5598a3439d50",
        "body" : "The scheduler provides these flags before, it's designed for multi-scheduler, clients will only configure these flags for the new scheduler, but not to the inflight scheduler.\r\nAnd now we just let kcm has the same ability.",
        "createdAt" : "2019-07-30T00:45:55Z",
        "updatedAt" : "2019-08-03T03:47:02Z",
        "lastEditedBy" : "20555cdb-65b0-41d0-aea2-5598a3439d50",
        "tags" : [
        ]
      },
      {
        "id" : "e0a45869-20a0-40d5-86dd-3724c377a220",
        "parentId" : "de5df4b6-fdda-4b53-9a57-05e2ec76ca6b",
        "authorId" : "7aca96c2-45d7-4567-99be-0323d7556c55",
        "body" : "Might be worth looking at https://github.com/kubernetes/enhancements/pull/979. Stopping standby KCMs can be problematic as component status (CS) is always the local KCM. So it will make the KAS appear unhealthy via CS requests. Depending on the users/CPs monitoring system that may cause problems. More importantly the set of safe mechanisms for migrating from 1 CM to multiple CMs is not documented anywhere.",
        "createdAt" : "2019-07-30T00:50:31Z",
        "updatedAt" : "2019-08-03T03:47:02Z",
        "lastEditedBy" : "7aca96c2-45d7-4567-99be-0323d7556c55",
        "tags" : [
        ]
      },
      {
        "id" : "7ce0d5c8-a5b6-4729-bbe1-e0cb3941c60f",
        "parentId" : "de5df4b6-fdda-4b53-9a57-05e2ec76ca6b",
        "authorId" : "20555cdb-65b0-41d0-aea2-5598a3439d50",
        "body" : "> Might be worth looking at [kubernetes/enhancements#979](https://github.com/kubernetes/enhancements/pull/979). Stopping standby KCMs can be problematic as component status (CS) is always the local KCM. So it will make the KAS appear unhealthy via CS requests. Depending on the users/CPs monitoring system that may cause problems. \r\n\r\nI think we'd better not to change leader election object in arbitrary for a inflight component. BTW these options are required for migrating multiple CMs.\r\n> More importantly the set of safe mechanisms for migrating from 1 CM to multiple CMs is not documented anywhere.\r\n\r\nI am glad to add a document about it in the next PR, and where should I put the document?",
        "createdAt" : "2019-07-30T01:30:10Z",
        "updatedAt" : "2019-08-03T03:47:02Z",
        "lastEditedBy" : "20555cdb-65b0-41d0-aea2-5598a3439d50",
        "tags" : [
        ]
      },
      {
        "id" : "25af1b83-ae4f-4595-ab69-ce24385d5eb3",
        "parentId" : "de5df4b6-fdda-4b53-9a57-05e2ec76ca6b",
        "authorId" : "20555cdb-65b0-41d0-aea2-5598a3439d50",
        "body" : "If we switch the resourceLock from endpoints to configmaps for a inflight CM, I think it is the same situation. It should be a new topic for migration lock of inflight CM. This PR doesn't add risk for clients.",
        "createdAt" : "2019-07-30T01:38:18Z",
        "updatedAt" : "2019-08-03T03:47:02Z",
        "lastEditedBy" : "20555cdb-65b0-41d0-aea2-5598a3439d50",
        "tags" : [
        ]
      }
    ],
    "commit" : "41a435a812690431f9f449f08fe28967a8aed582",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +44,48 @@\t\t\"The type of resource object that is used for locking during \"+\n\t\t\"leader election. Supported options are `endpoints` (default) and `configmaps`.\")\n\tfs.StringVar(&l.ResourceName, \"leader-elect-resource-name\", l.ResourceName, \"\"+\n\t\t\"The name of resource object that is used for locking during \"+\n\t\t\"leader election.\")"
  },
  {
    "id" : "bd3e1a45-61fc-4f01-89d0-2f6782d991b8",
    "prId" : 39173,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/39173#pullrequestreview-48763682",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0dae6b41-a354-417a-8c60-e882ef982843",
        "parentId" : null,
        "authorId" : "ca7e5a52-cab7-4f09-8ff8-da79f43339d4",
        "body" : "I left the componentconfig part in kubernetes. Other parts are moved to client-go.",
        "createdAt" : "2017-07-08T20:31:40Z",
        "updatedAt" : "2017-07-08T20:31:40Z",
        "lastEditedBy" : "ca7e5a52-cab7-4f09-8ff8-da79f43339d4",
        "tags" : [
        ]
      }
    ],
    "commit" : "65cedeeb433638a977ad8d1be9870c2567671f04",
    "line" : 34,
    "diffHunk" : "@@ -1,1 +32,36 @@)\n\nfunc DefaultLeaderElectionConfiguration() componentconfig.LeaderElectionConfiguration {\n\treturn componentconfig.LeaderElectionConfiguration{\n\t\tLeaderElect:   false,"
  }
]