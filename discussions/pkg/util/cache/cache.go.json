[
  {
    "id" : "6f69f33f-a6af-4a36-9b9a-e1841015f68e",
    "prId" : 24164,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ce070690-9198-4865-bc21-badb60aa4573",
        "parentId" : null,
        "authorId" : "b86e7e78-bb07-417f-8470-39407559c779",
        "body" : "You added this because it was making a size-0 shard, I guess? I think the better thing to do is to make the shard count not be fixed at 32, that seems really weird. I'm not sure what this cache is used for, though.\n",
        "createdAt" : "2016-04-12T22:19:49Z",
        "updatedAt" : "2016-04-13T14:30:39Z",
        "lastEditedBy" : "b86e7e78-bb07-417f-8470-39407559c779",
        "tags" : [
        ]
      },
      {
        "id" : "c0150f34-6856-4eac-bcce-571a0907b79e",
        "parentId" : "ce070690-9198-4865-bc21-badb60aa4573",
        "authorId" : "b86e7e78-bb07-417f-8470-39407559c779",
        "body" : "At any rate, silently returning nil here is not good, it will make the error show up as a crash and not as a construction error. Since no one is checking the result of this to see if it's nil.\n",
        "createdAt" : "2016-04-12T22:21:50Z",
        "updatedAt" : "2016-04-13T14:30:39Z",
        "lastEditedBy" : "b86e7e78-bb07-417f-8470-39407559c779",
        "tags" : [
        ]
      },
      {
        "id" : "68c6aa68-3061-4fbb-aa4e-f2fc0f0d4d0a",
        "parentId" : "ce070690-9198-4865-bc21-badb60aa4573",
        "authorId" : "24302707-9254-48df-89a5-cbcc349462b8",
        "body" : "I agree with @lavalamp here. What we should really do is to set number of shards to min(shardsCount, maxSize) here\n",
        "createdAt" : "2016-04-13T06:02:30Z",
        "updatedAt" : "2016-04-13T14:30:39Z",
        "lastEditedBy" : "24302707-9254-48df-89a5-cbcc349462b8",
        "tags" : [
        ]
      },
      {
        "id" : "dbe72149-869e-44e1-befa-9580bad60147",
        "parentId" : "ce070690-9198-4865-bc21-badb60aa4573",
        "authorId" : "24302707-9254-48df-89a5-cbcc349462b8",
        "body" : "@lavalamp - regarding why this cache exists. It was added before 1.0 release, where we didn't have \"cacher\" in apiserver, and thus we were unnecessary deserializing the same object multiple times (as it was send to different watchers). It's possible that currently it doesn't provide much value and we can remove it. We should evaluate it, but I would wait for protobufs to be in, to really confirm if it is useful (I guess it won't be at that point).\n",
        "createdAt" : "2016-04-13T06:04:29Z",
        "updatedAt" : "2016-04-13T14:30:39Z",
        "lastEditedBy" : "24302707-9254-48df-89a5-cbcc349462b8",
        "tags" : [
        ]
      }
    ],
    "commit" : "cf199dbdfac0502faf142e773361e6fca9a1178e",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +28,32 @@\nfunc NewCache(maxSize int) Cache {\n\tif maxSize < shardsCount {\n\t\tmaxSize = shardsCount\n\t}"
  },
  {
    "id" : "ccca68f8-c519-423f-8425-431f297a638f",
    "prId" : 24164,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "09e26dbb-75fd-447c-81d5-6f2ea81ab37e",
        "parentId" : null,
        "authorId" : "b86e7e78-bb07-417f-8470-39407559c779",
        "body" : "The change to this function looks good.\n",
        "createdAt" : "2016-04-12T22:22:51Z",
        "updatedAt" : "2016-04-13T14:30:39Z",
        "lastEditedBy" : "b86e7e78-bb07-417f-8470-39407559c779",
        "tags" : [
        ]
      }
    ],
    "commit" : "cf199dbdfac0502faf142e773361e6fca9a1178e",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +65,69 @@\tdefer s.Unlock()\n\t_, isOverwrite := s.items[index]\n\tif !isOverwrite && len(s.items) >= s.maxSize {\n\t\tvar randomKey uint64\n\t\tfor randomKey = range s.items {"
  },
  {
    "id" : "32838556-4804-4bd0-a91c-5cea97f9c675",
    "prId" : 24164,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9f2403c3-4268-4a55-a72d-43e370ac566f",
        "parentId" : null,
        "authorId" : "24302707-9254-48df-89a5-cbcc349462b8",
        "body" : "I thought about doing it the other direction, but this is also fine :)\n",
        "createdAt" : "2016-04-13T16:14:17Z",
        "updatedAt" : "2016-04-13T16:14:17Z",
        "lastEditedBy" : "24302707-9254-48df-89a5-cbcc349462b8",
        "tags" : [
        ]
      }
    ],
    "commit" : "cf199dbdfac0502faf142e773361e6fca9a1178e",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +29,33 @@func NewCache(maxSize int) Cache {\n\tif maxSize < shardsCount {\n\t\tmaxSize = shardsCount\n\t}\n\tcache := make(Cache, shardsCount)"
  }
]