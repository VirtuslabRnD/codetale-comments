[
  {
    "id" : "798966a0-991d-4ef0-8f5d-8fcf9d832448",
    "prId" : 74525,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/74525#pullrequestreview-305722075",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e9c57224-936e-427e-82be-0cdfcbaa31ec",
        "parentId" : null,
        "authorId" : "f87fe7d3-581c-4cb6-b17e-b807c6f2c789",
        "body" : "Why this copy?",
        "createdAt" : "2019-10-21T17:11:30Z",
        "updatedAt" : "2019-12-10T17:09:53Z",
        "lastEditedBy" : "f87fe7d3-581c-4cb6-b17e-b807c6f2c789",
        "tags" : [
        ]
      },
      {
        "id" : "ed2a128f-ba41-4366-831b-ee5eeb022df7",
        "parentId" : "e9c57224-936e-427e-82be-0cdfcbaa31ec",
        "authorId" : "afb638dd-5cee-447e-a73e-34c2f1d333df",
        "body" : "I copied the implementation from here:\r\nhttps://github.com/kubernetes/kubernetes/blob/master/pkg/apis/autoscaling/v1/conversion.go#L327\r\n\r\nOk, I'll not use it here.",
        "createdAt" : "2019-10-22T19:26:27Z",
        "updatedAt" : "2019-12-10T17:09:53Z",
        "lastEditedBy" : "afb638dd-5cee-447e-a73e-34c2f1d333df",
        "tags" : [
        ]
      },
      {
        "id" : "c2224286-ca1a-405c-9433-3a5732e58967",
        "parentId" : "e9c57224-936e-427e-82be-0cdfcbaa31ec",
        "authorId" : "afb638dd-5cee-447e-a73e-34c2f1d333df",
        "body" : "Sorry, I realized that I don't understand the question. Could you rephrase, please?\r\n",
        "createdAt" : "2019-10-22T19:28:59Z",
        "updatedAt" : "2019-12-10T17:09:53Z",
        "lastEditedBy" : "afb638dd-5cee-447e-a73e-34c2f1d333df",
        "tags" : [
        ]
      },
      {
        "id" : "7c027de3-2b9f-4062-8408-0e6dc8d1c09f",
        "parentId" : "e9c57224-936e-427e-82be-0cdfcbaa31ec",
        "authorId" : "35b74c0f-1e37-4ee0-81db-f5e9449774bc",
        "body" : "I think @thockin is referring to the statement `old := out.Annotations`. It actually does not copy the map but creates another pointer. Overall this `if` block seems superfluous and can be dropped. ",
        "createdAt" : "2019-10-23T06:45:18Z",
        "updatedAt" : "2019-12-10T17:09:53Z",
        "lastEditedBy" : "35b74c0f-1e37-4ee0-81db-f5e9449774bc",
        "tags" : [
        ]
      },
      {
        "id" : "affe5583-603c-4377-bb12-c8c86782b892",
        "parentId" : "e9c57224-936e-427e-82be-0cdfcbaa31ec",
        "authorId" : "afb638dd-5cee-447e-a73e-34c2f1d333df",
        "body" : "Fixed: https://github.com/kubernetes/kubernetes/pull/74525/commits/877d2ffeccb6d8fd1e47a12eab02de44b8bac07b",
        "createdAt" : "2019-10-23T08:42:57Z",
        "updatedAt" : "2019-12-10T17:09:53Z",
        "lastEditedBy" : "afb638dd-5cee-447e-a73e-34c2f1d333df",
        "tags" : [
        ]
      }
    ],
    "commit" : "8ab226263a18fa16afdb6fd14da63544095a8937",
    "line" : 19,
    "diffHunk" : "@@ -1,1 +266,270 @@\t}\n\tif in.Spec.Behavior != nil {\n\t\told := out.Annotations\n\t\tout.Annotations = make(map[string]string, len(old)+1)\n\t\tfor k, v := range old {"
  },
  {
    "id" : "3754c8cc-1d64-4208-8c58-98f98808c2da",
    "prId" : 74525,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/74525#pullrequestreview-310766715",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "19814d05-5ad4-4af6-807b-a4e1f4a35f49",
        "parentId" : null,
        "authorId" : "f87fe7d3-581c-4cb6-b17e-b807c6f2c789",
        "body" : "What if this annotation already existed?  This logic needs to handle every pathology you can think up.  It may be aceptable to nuke it (assume ownership), but please document that here.",
        "createdAt" : "2019-10-21T17:12:49Z",
        "updatedAt" : "2019-12-10T17:09:53Z",
        "lastEditedBy" : "f87fe7d3-581c-4cb6-b17e-b807c6f2c789",
        "tags" : [
        ]
      },
      {
        "id" : "9136d1e2-426a-4958-8767-47268e9966ba",
        "parentId" : "19814d05-5ad4-4af6-807b-a4e1f4a35f49",
        "authorId" : "afb638dd-5cee-447e-a73e-34c2f1d333df",
        "body" : "I'm not an expert in this \"conversion\" mechanics, but I doubt that this might cause any problem. I'd like to ask for a piece of advice here from an expert.\r\n1. Is it possible that this annotation exists? This is a conversion from the most recent \"HPA\" spec to the v2beta1 spec. The most recent spec contains behavior, and we don't have any code to generate the annotation with behavior in it.\r\n2. Even if the annotation for behavior exists, we will just rewrite it and increase the size of the \"out.Annotation\"  map.\r\n3. I repeated the \"Annotation\" generation from here: https://github.com/kubernetes/kubernetes/blob/master/pkg/apis/autoscaling/v1/conversion.go#L327",
        "createdAt" : "2019-10-22T19:41:26Z",
        "updatedAt" : "2019-12-10T17:09:53Z",
        "lastEditedBy" : "afb638dd-5cee-447e-a73e-34c2f1d333df",
        "tags" : [
        ]
      },
      {
        "id" : "2015d8db-bbe1-41fe-93c8-24e3c41f0631",
        "parentId" : "19814d05-5ad4-4af6-807b-a4e1f4a35f49",
        "authorId" : "afb638dd-5cee-447e-a73e-34c2f1d333df",
        "body" : "Added a comment about possible overwriting the annotation.",
        "createdAt" : "2019-11-01T15:01:59Z",
        "updatedAt" : "2019-12-10T17:09:53Z",
        "lastEditedBy" : "afb638dd-5cee-447e-a73e-34c2f1d333df",
        "tags" : [
        ]
      },
      {
        "id" : "fcb77f6d-2fe6-462b-8fb3-93de6057efd3",
        "parentId" : "19814d05-5ad4-4af6-807b-a4e1f4a35f49",
        "authorId" : "35b74c0f-1e37-4ee0-81db-f5e9449774bc",
        "body" : "Can you also mention it in the __User facing changes__ section of the PR description.",
        "createdAt" : "2019-11-02T11:24:46Z",
        "updatedAt" : "2019-12-10T17:09:53Z",
        "lastEditedBy" : "35b74c0f-1e37-4ee0-81db-f5e9449774bc",
        "tags" : [
        ]
      }
    ],
    "commit" : "8ab226263a18fa16afdb6fd14da63544095a8937",
    "line" : 30,
    "diffHunk" : "@@ -1,1 +277,281 @@\t\t}\n\t\t// Even if the annotation for behavior exists, we will just overwrite it\n\t\tout.Annotations[autoscaling.BehaviorSpecsAnnotation] = string(behaviorEnc)\n\t}\n"
  },
  {
    "id" : "c85f5528-d394-43d8-ab33-a9f552cb5200",
    "prId" : 74525,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/74525#pullrequestreview-314963614",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a938c168-ac4d-4abb-b1f9-c975b1cb3c59",
        "parentId" : null,
        "authorId" : "35b74c0f-1e37-4ee0-81db-f5e9449774bc",
        "body" : "This entire block of code is redundant. There are other places where similar code is used but it really adds nothing.",
        "createdAt" : "2019-11-02T11:23:45Z",
        "updatedAt" : "2019-12-10T17:09:53Z",
        "lastEditedBy" : "35b74c0f-1e37-4ee0-81db-f5e9449774bc",
        "tags" : [
        ]
      },
      {
        "id" : "da9f16d2-bbab-41f7-87d7-61a2a39cd8d2",
        "parentId" : "a938c168-ac4d-4abb-b1f9-c975b1cb3c59",
        "authorId" : "afb638dd-5cee-447e-a73e-34c2f1d333df",
        "body" : "@arjunrn : what block do you mean? lines 275-277? ",
        "createdAt" : "2019-11-11T15:19:25Z",
        "updatedAt" : "2019-12-10T17:09:53Z",
        "lastEditedBy" : "afb638dd-5cee-447e-a73e-34c2f1d333df",
        "tags" : [
        ]
      }
    ],
    "commit" : "8ab226263a18fa16afdb6fd14da63544095a8937",
    "line" : 28,
    "diffHunk" : "@@ -1,1 +275,279 @@\t\tif err != nil {\n\t\t\treturn err\n\t\t}\n\t\t// Even if the annotation for behavior exists, we will just overwrite it\n\t\tout.Annotations[autoscaling.BehaviorSpecsAnnotation] = string(behaviorEnc)"
  },
  {
    "id" : "54af9f4d-acfb-48e5-86b2-27e1ffae8161",
    "prId" : 71744,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/71744#pullrequestreview-181798506",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f713dbf1-2492-4323-b9ff-747ed5dd189e",
        "parentId" : null,
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "needs a test demonstrating the bug and that this fixes the issue",
        "createdAt" : "2018-12-05T14:57:51Z",
        "updatedAt" : "2018-12-05T15:53:24Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "0dd43c55-1d3b-478e-9d8d-b34f716ba1bd",
        "parentId" : "f713dbf1-2492-4323-b9ff-747ed5dd189e",
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "does this have the same issue:\r\n\r\nhttps://github.com/kubernetes/kubernetes/blob/a0c2788249ae1582d10089e7a34bb54fc6b3879d/pkg/apis/autoscaling/v2beta1/conversion.go#L188-L189",
        "createdAt" : "2018-12-05T14:58:54Z",
        "updatedAt" : "2018-12-05T15:53:24Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      }
    ],
    "commit" : "e85924e164feb19e90fadd9529b9c38d5abe9545",
    "line" : 19,
    "diffHunk" : "@@ -1,1 +250,254 @@\tout.MetricName = in.Metric.Name\n\tout.Selector = in.Metric.Selector\n\tif in.Current.AverageValue != nil {\n\t\tcurrentAverageValue := *in.Current.AverageValue\n\t\tout.AverageValue = &currentAverageValue"
  },
  {
    "id" : "94e0c2f3-de34-44cf-a230-bcff3d4ad234",
    "prId" : 64097,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/64097#pullrequestreview-124645938",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b1a5ebcb-8a79-47a8-9e61-76a8308dc8f4",
        "parentId" : null,
        "authorId" : "3a4b4830-dc71-4d7e-a7db-de2453284945",
        "body" : "why are these nil?  If they're not needed, don't implement them",
        "createdAt" : "2018-05-30T23:52:46Z",
        "updatedAt" : "2018-08-27T15:37:43Z",
        "lastEditedBy" : "3a4b4830-dc71-4d7e-a7db-de2453284945",
        "tags" : [
        ]
      },
      {
        "id" : "a7b3e7ac-e4c4-4fa9-83c7-c59a5a193026",
        "parentId" : "b1a5ebcb-8a79-47a8-9e61-76a8308dc8f4",
        "authorId" : "0e2b7889-1224-444e-a36d-475f9edd0703",
        "body" : "That's what I thought, but without them defined as nil they get generated for some reason:\r\n\r\n```\r\n# k8s.io/kubernetes/pkg/apis/autoscaling/v2beta1\r\npkg/apis/autoscaling/v2beta1/zz_generated.conversion.go:507:12: undefined: Convert_v2beta1_CrossVersionObjectReference_To_autoscaling_MetricTarget\r\npkg/apis/autoscaling/v2beta1/zz_generated.conversion.go:519:12: undefined: Convert_autoscaling_MetricTarget_To_v2beta1_CrossVersionObjectReference\r\n!!! [0530 21:24:29] Call tree:\r\n!!! [0530 21:24:29]  1: /home/mdame/go/src/k8s.io/kubernetes/hack/lib/golang.sh:595 kube::golang::build_binaries_for_platform(...)\r\n!!! [0530 21:24:29]  2: hack/make-rules/build.sh:27 kube::golang::build_binaries(...)\r\n!!! [0530 21:24:29] Call tree:\r\n!!! [0530 21:24:29]  1: hack/make-rules/build.sh:27 kube::golang::build_binaries(...)\r\n!!! [0530 21:24:29] Call tree:\r\n!!! [0530 21:24:29]  1: hack/make-rules/build.sh:27 kube::golang::build_binaries(...)\r\nmake: *** [Makefile:92: all] Error 1\r\n```\r\n(Output from just running `make` with those functions removed and `zz_generated.conversion` deleted)\r\n\r\nI think it has to do with the fact that `Target` in `v2beta1` is a `CrossVersionObjectReference`, but in `v2beta2` we renamed that to `DescribedObject` and created a *new* field called `Target` that is a `MetricTarget`. So it's seeing Target=Target and trying to auto-convert CrossVersionObjectReference->MetricTarget and telling me I need to manually convert it (which I can't)\r\n\r\nIf I'm wrong, or there's a way around that, I can make the change (or I can add a comment explaining these functions, which I probably should have done first)",
        "createdAt" : "2018-05-31T01:27:55Z",
        "updatedAt" : "2018-08-27T15:37:43Z",
        "lastEditedBy" : "0e2b7889-1224-444e-a36d-475f9edd0703",
        "tags" : [
        ]
      }
    ],
    "commit" : "dd7e81a8cdad29a7b9517008a32e112b5695db84",
    "line" : 62,
    "diffHunk" : "@@ -1,1 +60,64 @@}\n\nfunc Convert_autoscaling_MetricTarget_To_v2beta1_CrossVersionObjectReference(in *autoscaling.MetricTarget, out *autoscalingv2beta1.CrossVersionObjectReference, s conversion.Scope) error {\n\treturn nil\n}"
  },
  {
    "id" : "56c3ca8b-155f-4e23-b265-eeca04158511",
    "prId" : 64097,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/64097#pullrequestreview-125600732",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "58489b63-d048-498f-bd6f-15382105de23",
        "parentId" : null,
        "authorId" : "3a4b4830-dc71-4d7e-a7db-de2453284945",
        "body" : "you need to persist selector, too.",
        "createdAt" : "2018-05-30T23:53:24Z",
        "updatedAt" : "2018-08-27T15:37:43Z",
        "lastEditedBy" : "3a4b4830-dc71-4d7e-a7db-de2453284945",
        "tags" : [
        ]
      },
      {
        "id" : "b6f7bc95-8e80-447b-9b00-142c31f45463",
        "parentId" : "58489b63-d048-498f-bd6f-15382105de23",
        "authorId" : "0e2b7889-1224-444e-a36d-475f9edd0703",
        "body" : "`ResourceMetricSource` doesn't have a selector in the new version or v2beta1, was that overlooked?",
        "createdAt" : "2018-05-31T01:37:11Z",
        "updatedAt" : "2018-08-27T15:37:43Z",
        "lastEditedBy" : "0e2b7889-1224-444e-a36d-475f9edd0703",
        "tags" : [
        ]
      },
      {
        "id" : "35abeeee-c0be-4f0c-8e04-b4d23384f3e6",
        "parentId" : "58489b63-d048-498f-bd6f-15382105de23",
        "authorId" : "3a4b4830-dc71-4d7e-a7db-de2453284945",
        "body" : "Yeah, you'll need to add a selector field.  New API versions are weird.",
        "createdAt" : "2018-05-31T19:40:27Z",
        "updatedAt" : "2018-08-27T15:37:43Z",
        "lastEditedBy" : "3a4b4830-dc71-4d7e-a7db-de2453284945",
        "tags" : [
        ]
      },
      {
        "id" : "5b915367-78b5-4d1a-a7b4-cb64e1c42d4a",
        "parentId" : "58489b63-d048-498f-bd6f-15382105de23",
        "authorId" : "3a4b4830-dc71-4d7e-a7db-de2453284945",
        "body" : "(to the old version)",
        "createdAt" : "2018-05-31T19:41:23Z",
        "updatedAt" : "2018-08-27T15:37:43Z",
        "lastEditedBy" : "3a4b4830-dc71-4d7e-a7db-de2453284945",
        "tags" : [
        ]
      },
      {
        "id" : "b0fed5ec-89e6-44c3-8408-376be4222433",
        "parentId" : "58489b63-d048-498f-bd6f-15382105de23",
        "authorId" : "0e2b7889-1224-444e-a36d-475f9edd0703",
        "body" : "My point is, there isn't a selector field in the new version to persist to the old version. The KEP only adds `Target` to Resource metrics. I'm assuming that was intentional. Did you want to add metric selectors to Resource metrics as well?",
        "createdAt" : "2018-06-04T14:35:54Z",
        "updatedAt" : "2018-08-27T15:37:43Z",
        "lastEditedBy" : "0e2b7889-1224-444e-a36d-475f9edd0703",
        "tags" : [
        ]
      }
    ],
    "commit" : "dd7e81a8cdad29a7b9517008a32e112b5695db84",
    "line" : 112,
    "diffHunk" : "@@ -1,1 +110,114 @@\tout.Name = v1.ResourceName(in.Name)\n\tout.TargetAverageUtilization = in.Target.AverageUtilization\n\tout.TargetAverageValue = in.Target.AverageValue\n\treturn nil\n}"
  }
]