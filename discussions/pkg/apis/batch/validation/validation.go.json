[
  {
    "id" : "75effac5-c0b4-4f06-86c9-661df54817d6",
    "prId" : 101292,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/101292#pullrequestreview-654675469",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5ad36e43-e9fe-46e6-aa6c-3b30e52adade",
        "parentId" : null,
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "completions can be 0:\r\n\r\nhttps://github.com/kubernetes/kubernetes/blob/a5cf298a95b4a60789a6ba1caab931bdc980aa2d/pkg/apis/batch/validation/validation.go#L120-L122\r\n\r\nhttps://github.com/kubernetes/kubernetes/blob/a5cf298a95b4a60789a6ba1caab931bdc980aa2d/staging/src/k8s.io/apimachinery/pkg/api/validation/generic.go#L81-L88\r\n\r\nso completions - 1 would be -1?\r\n",
        "createdAt" : "2021-05-06T21:58:33Z",
        "updatedAt" : "2021-05-06T21:58:34Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "43be6f04-a7a1-4b12-a42c-2344c7fe2e5e",
        "parentId" : "5ad36e43-e9fe-46e6-aa6c-3b30e52adade",
        "authorId" : "df1239cd-0c05-4df2-8edb-2a21070d1cf0",
        "body" : "When the completions=0, there will be no pods created, thus no pod will have a hostname with index=-1 as suffix. \r\n\r\nBut yes, there is one case with different result after judging `completions>0`. When the job name > 60 characters, it will cause error here as the length exceeds 63 after appending `--1`.\r\n\r\nMaybe better to add restrict completions to be positive? (referred to https://kubernetes.io/docs/concepts/workloads/controllers/job/#parallel-jobs, there is a sentence â€œspecify a **non-zero positive** value for .spec.completions.â€) Besides, a job with `completions=0` seems useless.",
        "createdAt" : "2021-05-07T12:35:25Z",
        "updatedAt" : "2021-05-07T12:35:25Z",
        "lastEditedBy" : "df1239cd-0c05-4df2-8edb-2a21070d1cf0",
        "tags" : [
        ]
      },
      {
        "id" : "12e49ed2-26c1-4b92-831a-feebbae5ba48",
        "parentId" : "5ad36e43-e9fe-46e6-aa6c-3b30e52adade",
        "authorId" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "body" : "Since no pods will be created, you can just skip the check for completions = 0. But yes, I agree that completions=0 doesn't make sense. But that's not something we can change due to backwards compatibility.",
        "createdAt" : "2021-05-07T13:12:49Z",
        "updatedAt" : "2021-05-07T13:12:49Z",
        "lastEditedBy" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "tags" : [
        ]
      },
      {
        "id" : "0a584104-f46f-4ed5-b158-63a4f46d732d",
        "parentId" : "5ad36e43-e9fe-46e6-aa6c-3b30e52adade",
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "> When the completions=0, there will be no pods created, thus no pod will have a hostname with index=-1 as suffix.\r\n\r\nthen I'd either skip this check for completions=0 or set the minimum index we check length for to 0",
        "createdAt" : "2021-05-07T15:57:49Z",
        "updatedAt" : "2021-05-07T15:57:49Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "325f1d1c-a784-4e0e-8a77-60cb70d5e248",
        "parentId" : "5ad36e43-e9fe-46e6-aa6c-3b30e52adade",
        "authorId" : "df1239cd-0c05-4df2-8edb-2a21070d1cf0",
        "body" : "In the latest commit, this check is skipped when completions=0",
        "createdAt" : "2021-05-07T16:44:11Z",
        "updatedAt" : "2021-05-07T16:44:11Z",
        "lastEditedBy" : "df1239cd-0c05-4df2-8edb-2a21070d1cf0",
        "tags" : [
        ]
      }
    ],
    "commit" : "0c99f29f98f3c58957bbf8edef27c939bfdbfe3b",
    "line" : 9,
    "diffHunk" : "@@ -1,1 +94,98 @@\t\t// The index could be maximum `.spec.completions-1`\n\t\t// If we don't validate this here, the indexed job will fail to create pods later.\n\t\tmaximumPodHostname := fmt.Sprintf(\"%s-%d\", job.ObjectMeta.Name, *job.Spec.Completions-1)\n\t\tif errs := apimachineryvalidation.IsDNS1123Label(maximumPodHostname); len(errs) > 0 {\n\t\t\tallErrs = append(allErrs, field.Invalid(field.NewPath(\"metadata\").Child(\"name\"), job.ObjectMeta.Name, fmt.Sprintf(\"will not able to create pod with invalid DNS label: %s\", maximumPodHostname)))"
  },
  {
    "id" : "4f0eda23-42c0-4f35-ba67-acc5945a3c3d",
    "prId" : 98817,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/98817#pullrequestreview-695106931",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5021f562-707c-45a1-835d-faeb6f164010",
        "parentId" : null,
        "authorId" : "695b6860-569c-4e63-a215-7342e2279a94",
        "body" : "please document what AllowTrackingAnnotation means (see godoc in PodValidationOptions for example)",
        "createdAt" : "2021-06-28T20:44:36Z",
        "updatedAt" : "2021-06-28T21:00:48Z",
        "lastEditedBy" : "695b6860-569c-4e63-a215-7342e2279a94",
        "tags" : [
        ]
      },
      {
        "id" : "4e9e3b1f-b676-4a98-8003-dcf2993c7c02",
        "parentId" : "5021f562-707c-45a1-835d-faeb6f164010",
        "authorId" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "body" : "Done",
        "createdAt" : "2021-06-29T14:23:44Z",
        "updatedAt" : "2021-06-29T17:54:08Z",
        "lastEditedBy" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "tags" : [
        ]
      }
    ],
    "commit" : "bb56a0bd04891ae0a4aebeaeb4d145b32d9ad2d9",
    "line" : 100,
    "diffHunk" : "@@ -1,1 +346,350 @@\tapivalidation.PodValidationOptions\n\t// Allow Job to have the annotation batch.kubernetes.io/job-tracking\n\tAllowTrackingAnnotation bool\n}"
  },
  {
    "id" : "14059bc0-7e0f-4960-ba91-9444cb78fce0",
    "prId" : 98441,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/98441#pullrequestreview-581486574",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e655db69-9eca-4465-9eb0-e4f53ec35845",
        "parentId" : null,
        "authorId" : "570b631b-84a0-4888-a815-ca0e7934e412",
        "body" : "add a comment explaining why parallelism is now capped.",
        "createdAt" : "2021-02-02T15:23:45Z",
        "updatedAt" : "2021-03-03T15:16:45Z",
        "lastEditedBy" : "570b631b-84a0-4888-a815-ca0e7934e412",
        "tags" : [
        ]
      },
      {
        "id" : "37fd8dce-411f-47fa-b8d7-3e2bd1110075",
        "parentId" : "e655db69-9eca-4465-9eb0-e4f53ec35845",
        "authorId" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "body" : "Done",
        "createdAt" : "2021-02-02T15:55:07Z",
        "updatedAt" : "2021-03-03T15:16:45Z",
        "lastEditedBy" : "31fbce73-ef64-43f8-9faa-047479d8fc32",
        "tags" : [
        ]
      }
    ],
    "commit" : "a1a5868a5ae8c18df39b386d2424ff04c89826fb",
    "line" : 7,
    "diffHunk" : "@@ -1,1 +35,39 @@// is allowed to have. This threshold allows to cap the length of\n// .status.completedIndexes.\nconst maxParallelismForIndexedJob = 100000\n\n// ValidateGeneratedSelector validates that the generated selector on a controller object match the controller object"
  },
  {
    "id" : "145cc97d-f191-4c5c-9734-3aa3fcf639b1",
    "prId" : 85071,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/85071#pullrequestreview-314676421",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f00600ac-335a-4c56-b492-701f69842b9b",
        "parentId" : null,
        "authorId" : "9829b6c0-e54c-401b-8d97-73e5aa4e83c1",
        "body" : "What about this?\r\n\r\n```\r\n// ValidateGeneratedSelector validates that the generated selector on a controller object match the controller object\r\n// metadata, and the labels on the pod template are as generated.\t// metadata, and the labels on the pod template are as generated.\r\n//\r\n// TODO: generalize for other controller objects that will follow the same pattern, such as ReplicaSet and DaemonSet, and\r\n// move to new location.  Replace batch.Job with an interface.\t// move to new location.  Replace batch.Job with an interface.\r\n```\r\n",
        "createdAt" : "2019-11-11T02:25:30Z",
        "updatedAt" : "2019-11-11T03:04:04Z",
        "lastEditedBy" : "9829b6c0-e54c-401b-8d97-73e5aa4e83c1",
        "tags" : [
        ]
      },
      {
        "id" : "084b7264-7ceb-46a4-8783-e63c46a46cd0",
        "parentId" : "f00600ac-335a-4c56-b492-701f69842b9b",
        "authorId" : "29c55301-dcb8-4340-be6c-238e297e9479",
        "body" : "Thanks for the review @draveness! ðŸŽ‰ \r\nThat makes more sense. I updated it.",
        "createdAt" : "2019-11-11T03:05:02Z",
        "updatedAt" : "2019-11-11T03:05:02Z",
        "lastEditedBy" : "29c55301-dcb8-4340-be6c-238e297e9479",
        "tags" : [
        ]
      }
    ],
    "commit" : "896f84b652592e4f58a30174090df0376ca4c89a",
    "line" : 8,
    "diffHunk" : "@@ -1,1 +31,35 @@\n// ValidateGeneratedSelector validates that the generated selector on a controller object match the controller object\n// metadata, and the labels on the pod template are as generated.\n//\n// TODO: generalize for other controller objects that will follow the same pattern, such as ReplicaSet and DaemonSet, and"
  },
  {
    "id" : "9af44b13-2aa3-452a-bc83-c11455ab2036",
    "prId" : 52967,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/52967#pullrequestreview-89089672",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f021a11a-d44e-491f-8843-85ffee61316f",
        "parentId" : null,
        "authorId" : "b15d5707-82a8-4448-b49d-a2d6502b10f9",
        "body" : "Do we need to sunset this skip in a future release?",
        "createdAt" : "2017-09-25T16:01:36Z",
        "updatedAt" : "2017-09-25T16:01:36Z",
        "lastEditedBy" : "b15d5707-82a8-4448-b49d-a2d6502b10f9",
        "tags" : [
        ]
      },
      {
        "id" : "01bab1ed-2de7-4737-b950-b261dd7719d3",
        "parentId" : "f021a11a-d44e-491f-8843-85ffee61316f",
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "could, although the migrate strategy is pretty deployment-specific (ranging from \"not at all\" to \"every release\" to \"tools available but not auto-run\"), so it's unclear when we'd know they'd all been cleared out",
        "createdAt" : "2017-09-25T18:37:21Z",
        "updatedAt" : "2017-09-25T18:37:21Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "ce8b4c2b-1d82-4c53-b3b2-acbf17e7a878",
        "parentId" : "f021a11a-d44e-491f-8843-85ffee61316f",
        "authorId" : "b15d5707-82a8-4448-b49d-a2d6502b10f9",
        "body" : "Hopefully the resolution to #52185 is \"every release\", but I agree with you re the status quo.",
        "createdAt" : "2017-09-25T18:43:17Z",
        "updatedAt" : "2017-09-25T18:43:17Z",
        "lastEditedBy" : "b15d5707-82a8-4448-b49d-a2d6502b10f9",
        "tags" : [
        ]
      },
      {
        "id" : "5e0619dd-ab40-414a-821a-73ed6eb3ccb4",
        "parentId" : "f021a11a-d44e-491f-8843-85ffee61316f",
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "hope is a prereq for all my upgrades",
        "createdAt" : "2017-09-25T19:02:34Z",
        "updatedAt" : "2017-09-25T19:02:34Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "0dacae11-36e7-4603-a6a0-65028f0cbd03",
        "parentId" : "f021a11a-d44e-491f-8843-85ffee61316f",
        "authorId" : "b7d2a698-a6e1-4031-bb69-8b45505badb5",
        "body" : "@liggitt how long do we want to wait before \"fixing\" the update part entirely? Is 1.10 a good time frame or 1.11?",
        "createdAt" : "2018-01-16T13:11:34Z",
        "updatedAt" : "2018-01-16T13:11:34Z",
        "lastEditedBy" : "b7d2a698-a6e1-4031-bb69-8b45505badb5",
        "tags" : [
        ]
      }
    ],
    "commit" : "b8155e107c61311106ac7a83dd9e0f13be3193f4",
    "line" : 7,
    "diffHunk" : "@@ -1,1 +180,184 @@\tallErrs := apivalidation.ValidateObjectMetaUpdate(&job.ObjectMeta, &oldJob.ObjectMeta, field.NewPath(\"metadata\"))\n\tallErrs = append(allErrs, ValidateCronJobSpec(&job.Spec, field.NewPath(\"spec\"))...)\n\t// skip the 52-character name validation limit on update validation\n\t// to allow old cronjobs with names > 52 chars to be updated/deleted\n\treturn allErrs"
  },
  {
    "id" : "db8a114c-31fb-4007-a695-f401217776d8",
    "prId" : 52733,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/52733#pullrequestreview-64079285",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8929b21e-bb8e-484f-86b1-a0eb264d7ed5",
        "parentId" : null,
        "authorId" : "f87fe7d3-581c-4cb6-b17e-b807c6f2c789",
        "body" : "Job creates Pods which have further suffixes, right?  And Pod names also are limited in size.",
        "createdAt" : "2017-09-20T15:25:21Z",
        "updatedAt" : "2017-09-20T15:25:21Z",
        "lastEditedBy" : "f87fe7d3-581c-4cb6-b17e-b807c6f2c789",
        "tags" : [
        ]
      },
      {
        "id" : "0aab7350-c3a9-45c7-b368-fd54e67591f8",
        "parentId" : "8929b21e-bb8e-484f-86b1-a0eb264d7ed5",
        "authorId" : "2d2ea912-43c8-4a78-9c8b-7fb4f0eec36d",
        "body" : "Pod names' size limits are 255 characters, like most Kubernetes resources. As far as I can tell only job names have a size limit of 63 characters (because job names get copied in to a label, which have a lower size limit than Kubernetes resource names).",
        "createdAt" : "2017-09-20T18:51:39Z",
        "updatedAt" : "2017-09-20T18:51:39Z",
        "lastEditedBy" : "2d2ea912-43c8-4a78-9c8b-7fb4f0eec36d",
        "tags" : [
        ]
      }
    ],
    "commit" : "e30237b869b4b4a1b4cf60ed6301f31df1aa6901",
    "line" : 12,
    "diffHunk" : "@@ -1,1 +164,168 @@\tallErrs := apivalidation.ValidateObjectMeta(&scheduledJob.ObjectMeta, true, apivalidation.ValidateReplicationControllerName, field.NewPath(\"metadata\"))\n\tallErrs = append(allErrs, ValidateCronJobSpec(&scheduledJob.Spec, field.NewPath(\"spec\"))...)\n\tif len(scheduledJob.ObjectMeta.Name) > apimachineryvalidation.DNS1035LabelMaxLength-11 {\n\t\t// The cronjob controller appends a 11-character suffix to the cronjob (`-$TIMESTAMP`) when\n\t\t// creating a job. The job name length limit is 63 characters."
  },
  {
    "id" : "beb04cd5-56a2-478c-9a63-116b3319de80",
    "prId" : 52733,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/52733#pullrequestreview-64726952",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "aa4ec9b3-b2d1-4597-ab37-767cf8ba3e8e",
        "parentId" : null,
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "Does this prevent updating an existing cronjob? That can block addition/removal of finalizers during deletion",
        "createdAt" : "2017-09-23T00:55:34Z",
        "updatedAt" : "2017-09-23T00:55:34Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      }
    ],
    "commit" : "e30237b869b4b4a1b4cf60ed6301f31df1aa6901",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +168,172 @@\t\t// creating a job. The job name length limit is 63 characters.\n\t\t// Therefore cronjob names must have length <= 63-11=52. If we don't validate this here,\n\t\t// then job creation will fail later.\n\t\tallErrs = append(allErrs, field.Invalid(field.NewPath(\"metadata\").Child(\"name\"), scheduledJob.ObjectMeta.Name, \"must be no more than 52 characters\"))\n\t}"
  },
  {
    "id" : "0e4b806c-45ec-4dab-bae4-0f3d62880db2",
    "prId" : 25475,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ea20883e-9e32-45e0-b5ed-3c211dabdea8",
        "parentId" : null,
        "authorId" : "020e031c-c298-4e7e-a533-9a04439c203c",
        "body" : "@lavalamp @bgrant0607 is there a limit to how complex of parser we want to include in validation?  At some point, is it up to the controller to react to errors in complex fields?   In this case, a third-party library is used to parse a cronspec, which is pretty complex.  Not a performance issue, I don't think, but maybe a dependency issue.\n",
        "createdAt" : "2016-05-11T16:37:58Z",
        "updatedAt" : "2016-05-21T14:31:22Z",
        "lastEditedBy" : "020e031c-c298-4e7e-a533-9a04439c203c",
        "tags" : [
        ]
      },
      {
        "id" : "41fc427b-7e6b-4c73-a849-dc6fe3890571",
        "parentId" : "ea20883e-9e32-45e0-b5ed-3c211dabdea8",
        "authorId" : "020e031c-c298-4e7e-a533-9a04439c203c",
        "body" : "@soltysh I think adding godep for robfig/cron is fine in this PR.  the only thing I am unsure about is whether validation should call Parse, or whether that should be left to the controller to parse, and then raise an event or set a condition if there is an error in the format.\n",
        "createdAt" : "2016-05-11T16:39:22Z",
        "updatedAt" : "2016-05-21T14:31:22Z",
        "lastEditedBy" : "020e031c-c298-4e7e-a533-9a04439c203c",
        "tags" : [
        ]
      },
      {
        "id" : "2b42f66c-2b67-4b7e-9a40-0bbf1674aa38",
        "parentId" : "ea20883e-9e32-45e0-b5ed-3c211dabdea8",
        "authorId" : "b7d2a698-a6e1-4031-bb69-8b45505badb5",
        "body" : "Personally, I'd prefer to know the cron format is wrong at validation and not when the controller will actually try to run it. Although a complex, it's one of those things I'd expect validation to take care. \n",
        "createdAt" : "2016-05-11T20:08:39Z",
        "updatedAt" : "2016-05-21T14:31:22Z",
        "lastEditedBy" : "b7d2a698-a6e1-4031-bb69-8b45505badb5",
        "tags" : [
        ]
      }
    ],
    "commit" : "6510eb54d897700ad79892f781b1cea205a75be6",
    "line" : 55,
    "diffHunk" : "@@ -1,1 +200,204 @@func validateScheduleFormat(schedule string, fldPath *field.Path) field.ErrorList {\n\tallErrs := field.ErrorList{}\n\t_, err := cron.Parse(schedule)\n\tif err != nil {\n\t\tallErrs = append(allErrs, field.Invalid(fldPath, schedule, err.Error()))"
  }
]