[
  {
    "id" : "5a26a56b-67e3-4882-b5ad-10801c42ab2a",
    "prId" : 96048,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/96048#pullrequestreview-520695586",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2a11f7ae-49fd-4c55-95e3-69a1ba0711c2",
        "parentId" : null,
        "authorId" : "3eccedfc-5c53-4555-94cb-69f2b56e485c",
        "body" : "m.server.Serve(sock) will block, so other forms of synchronization would be tricky.",
        "createdAt" : "2020-10-30T14:00:43Z",
        "updatedAt" : "2020-10-30T16:42:23Z",
        "lastEditedBy" : "3eccedfc-5c53-4555-94cb-69f2b56e485c",
        "tags" : [
        ]
      }
    ],
    "commit" : "4fdfbc718cfd854178c037e0609a1917b4647841",
    "line" : 10,
    "diffHunk" : "@@ -1,1 +123,127 @@\tgo func() {\n\t\tdefer m.wg.Done()\n\t\tm.server.Serve(sock)\n\t}()\n"
  },
  {
    "id" : "3a3affe4-af0b-43ec-9949-0ba58adaef11",
    "prId" : 60034,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/60034#pullrequestreview-101051368",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0c96d687-2dc0-4333-bfee-38a5f3ebe66e",
        "parentId" : null,
        "authorId" : "ac146833-f0d6-4680-968a-749269c0d55d",
        "body" : "You still need to close the stop chan even if the server is nil",
        "createdAt" : "2018-02-28T11:33:44Z",
        "updatedAt" : "2018-04-12T16:00:22Z",
        "lastEditedBy" : "ac146833-f0d6-4680-968a-749269c0d55d",
        "tags" : [
        ]
      },
      {
        "id" : "7b31416b-0f41-436d-a1a8-e831d0eaa216",
        "parentId" : "0c96d687-2dc0-4333-bfee-38a5f3ebe66e",
        "authorId" : "ba0b9c6e-ec4c-4d1b-832e-751e6109bf38",
        "body" : "Fixed in the current revision.\r\n\r\nClosing a closed channel panics, so now Stop() sets m.stop to nil and checks for that, to keep Stop() idempotent.",
        "createdAt" : "2018-02-28T13:10:38Z",
        "updatedAt" : "2018-04-12T16:00:22Z",
        "lastEditedBy" : "ba0b9c6e-ec4c-4d1b-832e-751e6109bf38",
        "tags" : [
        ]
      },
      {
        "id" : "122d5dc0-6156-4fb3-89c6-48e8bac6ac31",
        "parentId" : "0c96d687-2dc0-4333-bfee-38a5f3ebe66e",
        "authorId" : "ba0b9c6e-ec4c-4d1b-832e-751e6109bf38",
        "body" : "Hmm, that turned out to be more complicated than anticipated. Setting it to nil was flagged as a race condition. I had to introduced a separate boolean stopIsOpen to track whether m.stop still needs to be closed, because there is no \"Closed()\" method.",
        "createdAt" : "2018-02-28T13:28:33Z",
        "updatedAt" : "2018-04-12T16:00:22Z",
        "lastEditedBy" : "ba0b9c6e-ec4c-4d1b-832e-751e6109bf38",
        "tags" : [
        ]
      },
      {
        "id" : "5b435b79-8d5c-4b1a-9715-2676ee95bb9b",
        "parentId" : "0c96d687-2dc0-4333-bfee-38a5f3ebe66e",
        "authorId" : "ac146833-f0d6-4680-968a-749269c0d55d",
        "body" : "Actually, sorry for making you close that channel.\r\nTurns out you don't need to do it as go channels are garbage collected and closing the channel is a control signal on the channel indicating that no more data follows.\r\n\r\nDo you mind reverting that change?",
        "createdAt" : "2018-03-04T23:15:54Z",
        "updatedAt" : "2018-04-12T16:00:22Z",
        "lastEditedBy" : "ac146833-f0d6-4680-968a-749269c0d55d",
        "tags" : [
        ]
      },
      {
        "id" : "6085d911-e91a-479b-a0e7-726f8ff622d2",
        "parentId" : "0c96d687-2dc0-4333-bfee-38a5f3ebe66e",
        "authorId" : "51f59c69-efc0-451a-bd8f-d9fa2c281fd3",
        "body" : "I had this garbage collection thing in mind tbh :) ",
        "createdAt" : "2018-03-05T05:25:41Z",
        "updatedAt" : "2018-04-12T16:00:22Z",
        "lastEditedBy" : "51f59c69-efc0-451a-bd8f-d9fa2c281fd3",
        "tags" : [
        ]
      }
    ],
    "commit" : "fcbb64b93dfb633f880bad9ed1771201843b8e7e",
    "line" : 58,
    "diffHunk" : "@@ -1,1 +114,118 @@\tm.wg.Wait()\n\tm.server = nil\n\tclose(m.stop) // This prevents re-starting the server.\n\n\treturn m.cleanup()"
  },
  {
    "id" : "f6dc6bda-a307-425d-abb1-6ca085a1eac3",
    "prId" : 60034,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/60034#pullrequestreview-100158938",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c5de131c-7aa2-46aa-bd87-51a9f00447ad",
        "parentId" : null,
        "authorId" : "611b3189-700b-4eda-8a2a-2c4280218d7c",
        "body" : "If Start is not called, do we still need to call Stop? If we make sure Stop is only called if Start has been called, can we remove stopIsOpen?",
        "createdAt" : "2018-02-28T17:40:28Z",
        "updatedAt" : "2018-04-12T16:00:22Z",
        "lastEditedBy" : "611b3189-700b-4eda-8a2a-2c4280218d7c",
        "tags" : [
        ]
      }
    ],
    "commit" : "fcbb64b93dfb633f880bad9ed1771201843b8e7e",
    "line" : 48,
    "diffHunk" : "@@ -1,1 +105,109 @@\n// Stop stops the gRPC server. Can be called without a prior Start\n// and more than once. Not safe to be called concurrently by different\n// goroutines!\nfunc (m *Stub) Stop() error {"
  }
]