[
  {
    "id" : "bafb25bb-8ce5-48be-981e-e86ed5cf151a",
    "prId" : 5400,
    "prUrl" : "https://github.com/apache/airflow/pull/5400#pullrequestreview-247572649",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b4775b46-8559-470f-b620-652edcea6157",
        "parentId" : null,
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "I thought `BASH_SOURCE` was only for when you did `source myscript` not `./myscript` - am I mis-remembering?\r\n\r\n(BTW `git` has `git rev-parse --show-toplevel` which will print the abs-path to the root of the repo.)",
        "createdAt" : "2019-06-10T11:25:23Z",
        "updatedAt" : "2019-06-10T11:49:54Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "a15117f9-7421-4956-bfe3-2c7c391358fb",
        "parentId" : "b4775b46-8559-470f-b620-652edcea6157",
        "authorId" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "body" : "Not only - BASH_SOURCE array contains all bash scripts that were used. I always use this construct in all the bash scripts I run - this way I get them independent from where they are run.\r\n\r\nSee here for example: https://stackoverflow.com/questions/59895/get-the-source-directory-of-a-bash-script-from-within-the-script-itself\r\n\r\nThe problem with git is that not everywhere you have .git directory. For example we've learned that Dockerhub does not have the whole .git repo while building image. It's very similar in case of cloud build - there is no guarantee you have .git repo around. Of course in our case we know we have the repo in Travis, but not relying on it if we can is a better strategy IMHO.",
        "createdAt" : "2019-06-10T11:34:09Z",
        "updatedAt" : "2019-06-10T11:52:34Z",
        "lastEditedBy" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "tags" : [
        ]
      },
      {
        "id" : "b40dd0bd-266a-47ae-be67-408bc49dbb16",
        "parentId" : "b4775b46-8559-470f-b620-652edcea6157",
        "authorId" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "body" : "Just to backup my statement on cloud build: https://github.com/GoogleCloudPlatform/cloud-builders/issues/236",
        "createdAt" : "2019-06-10T11:44:13Z",
        "updatedAt" : "2019-06-10T11:49:54Z",
        "lastEditedBy" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "tags" : [
        ]
      }
    ],
    "commit" : "1905c9e82fbc123df12e948026061db3f1f0d0cc",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +26,30 @@# set -x\n\nMY_DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n\npushd ${MY_DIR}/../../ || exit 1"
  },
  {
    "id" : "a25626c3-ca9d-4ed0-9e41-b0a417669550",
    "prId" : 5400,
    "prUrl" : "https://github.com/apache/airflow/pull/5400#pullrequestreview-248354414",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "06879b5a-2552-41d8-af22-895dc86dcc77",
        "parentId" : null,
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "`git ls-files airflow/ | grep '.py'` ?",
        "createdAt" : "2019-06-10T11:25:58Z",
        "updatedAt" : "2019-06-10T11:49:54Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "af9053ec-a9ac-4326-baf0-ea6485e0f83a",
        "parentId" : "06879b5a-2552-41d8-af22-895dc86dcc77",
        "authorId" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "body" : "I like this, but again I have concerns that in some cases we might not have .git around. Do you think it is worth it to rely on .git dir @ashb ?",
        "createdAt" : "2019-06-10T11:39:45Z",
        "updatedAt" : "2019-06-10T11:49:54Z",
        "lastEditedBy" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "tags" : [
        ]
      },
      {
        "id" : "8a64cae1-da78-4753-9d34-0efc91a5d082",
        "parentId" : "06879b5a-2552-41d8-af22-895dc86dcc77",
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "I can't see a case we'd want to run Pylint without a checkout as it's very much a CI-only thing. (I'm guessing we will volume mount in a checkout under the docker-based CI you will be working on?)",
        "createdAt" : "2019-06-10T11:42:54Z",
        "updatedAt" : "2019-06-10T11:49:54Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "d6754a79-706b-4b14-8412-b665cee5514d",
        "parentId" : "06879b5a-2552-41d8-af22-895dc86dcc77",
        "authorId" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "body" : "Here is the case explained: https://github.com/GoogleCloudPlatform/cloud-builders/issues/236 - the more \"modern\" CIs (such as cloud buid) work exclusively as Docker-first and usually they will ignore .git repo because otherwise it has to be passed as context to within Docker. That might slow-down the process a lot for big repositories as context is often sent to remote Docker  server. \r\n\r\nI am not saying we are going to do this, but I think building in a dependency on .git might not be future-proof as we know some CIs are already going in this direction.",
        "createdAt" : "2019-06-10T11:49:34Z",
        "updatedAt" : "2019-06-10T11:50:22Z",
        "lastEditedBy" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "tags" : [
        ]
      },
      {
        "id" : "1bec1dac-c9ce-4f25-84d8-099691a2104b",
        "parentId" : "06879b5a-2552-41d8-af22-895dc86dcc77",
        "authorId" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "body" : "This is exactly what happens in Dockerhub, so this is not an isolated cloud-build case only.",
        "createdAt" : "2019-06-10T11:51:22Z",
        "updatedAt" : "2019-06-10T11:51:23Z",
        "lastEditedBy" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "tags" : [
        ]
      },
      {
        "id" : "2357d488-42cd-4a90-a835-7807b20bcaf9",
        "parentId" : "06879b5a-2552-41d8-af22-895dc86dcc77",
        "authorId" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "body" : "I use airflow-breeze to run Airflow, but I do small modification in my environment. I use a [git worktree](https://git-scm.com/docs/git-worktree) to eliminate the need to have multiple copies of the same repository in multiple workspace.  In this case, the git does not work properly. Not relying on git is a very good idea.",
        "createdAt" : "2019-06-11T18:16:44Z",
        "updatedAt" : "2019-06-11T18:19:40Z",
        "lastEditedBy" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "tags" : [
        ]
      }
    ],
    "commit" : "1905c9e82fbc123df12e948026061db3f1f0d0cc",
    "line" : 31,
    "diffHunk" : "@@ -1,1 +43,47 @@-not -path \"./airflow/_vendor/*\" \\\n-not -path \"./build/*\" \\\n-not -path \"./tests/*\" \\\n-not -name 'webserver_config.py' | grep -vFf scripts/ci/pylint_todo.txt | xargs pylint --output-format=colorized\nRES_MAIN=$?"
  }
]