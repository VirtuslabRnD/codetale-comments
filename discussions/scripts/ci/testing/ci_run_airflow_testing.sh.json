[
  {
    "id" : "de742ec5-ede4-49d6-a022-8d4ff2804346",
    "prId" : 14915,
    "prUrl" : "https://github.com/apache/airflow/pull/14915#pullrequestreview-616929165",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a9341958-1ada-4432-a2dd-93804b101839",
        "parentId" : null,
        "authorId" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "body" : "Have you tested it on macOS? I am afraid that this command may not have all the necessary options on this system.",
        "createdAt" : "2021-03-20T16:04:26Z",
        "updatedAt" : "2021-03-22T21:11:21Z",
        "lastEditedBy" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "tags" : [
        ]
      },
      {
        "id" : "8887b2d6-4bec-4ea9-838d-b2891387bee0",
        "parentId" : "a9341958-1ada-4432-a2dd-93804b101839",
        "authorId" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "body" : "There is no built-in parallel command on MacOS. This script is mainly for CI and having it run on MacOS is a nice-to-have (though useful). \r\n\r\nHowever I have taken care of it  and tested parallels coming from brew on MacOS (In the scripts I made sure to install GNU Parallel from brew). do not use MacOS with Airflow - but if you do and you could double-check if this command works for MacOS, I would really appreciate.\r\n\r\n```\r\nfunction parallel::make_sure_gnu_parallel_is_installed() {\r\n    start_end::group_start \"Making sure GNU Parallels is installed\"\r\n    echo\r\n    echo \"Making sure you have GNU parallel installed\"\r\n    echo\r\n    echo \"You might need to provide root password if you do not have it\"\r\n    echo\r\n    (command -v parallel || apt install parallel || sudo apt install parallel || brew install parallel) >/dev/null\r\n    start_end::group_end \"Making sure GNU Parallels is installed\"\r\n}\r\n```",
        "createdAt" : "2021-03-20T16:20:12Z",
        "updatedAt" : "2021-03-22T21:11:21Z",
        "lastEditedBy" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "tags" : [
        ]
      },
      {
        "id" : "04a13d20-a522-4709-8319-c56d41749afe",
        "parentId" : "a9341958-1ada-4432-a2dd-93804b101839",
        "authorId" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "body" : "Ok. I decided to take My Mac  to a spin and it was all surprisingly easy and straightforward. When  I gave my 64GB Mac - 40GB Memory + 8 CPUs it took 581 second (10 minutes) to run full suite of tests (!)\r\n\r\nParallel was not a problem, but I had to remove old commands where I checked memory and disk on host (which is not needed). I remove those and the script works flawlessly on Mac as well.",
        "createdAt" : "2021-03-20T17:21:09Z",
        "updatedAt" : "2021-03-22T21:11:21Z",
        "lastEditedBy" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "tags" : [
        ]
      }
    ],
    "commit" : "b971cac42f21f54f91d290955b1299fe4f68c716",
    "line" : 210,
    "diffHunk" : "@@ -1,1 +159,163 @@        export PARALLEL_JOB_STATUS=\"${PARALLEL_MONITORED_DIR}/${SEMAPHORE_NAME}/${TEST_TYPE}/status\"\n        # shellcheck disable=SC2086\n        parallel --ungroup --bg --semaphore --semaphorename \"${SEMAPHORE_NAME}\" \\\n            --jobs \"${MAX_PARALLEL_TEST_JOBS}\" \\\n            \"$( dirname \"${BASH_SOURCE[0]}\" )/ci_run_single_airflow_test_in_docker.sh\" \"${@}\" >${JOB_LOG} 2>&1"
  }
]