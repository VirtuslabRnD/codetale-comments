[
  {
    "id" : "ce2633dd-3d44-426b-851c-d88f91343293",
    "prId" : 749,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "74474235-999f-4f2a-a45f-6d13de39f52b",
        "parentId" : null,
        "authorId" : "7a428a65-3bd3-41f2-b899-b42dc7177963",
        "body" : "do not think we need this file checked in. we just need a Jake target, say \"Jake spec\" that would build this script and run it on the latest word doc to generate the .md file.\n",
        "createdAt" : "2014-09-25T18:42:06Z",
        "updatedAt" : "2014-09-25T20:27:08Z",
        "lastEditedBy" : "7a428a65-3bd3-41f2-b899-b42dc7177963",
        "tags" : [
        ]
      },
      {
        "id" : "c22f518b-8d03-44c3-abc4-2e74f2a07d51",
        "parentId" : "74474235-999f-4f2a-a45f-6d13de39f52b",
        "authorId" : "bdee90d3-fa06-43ed-8bf1-d381c3d69e0b",
        "body" : "Agreed, we probably don't need the .js file. I wasn't sure how to modify the jakefile, but once I figure it out I can make it an automated step.\n",
        "createdAt" : "2014-09-25T18:48:57Z",
        "updatedAt" : "2014-09-25T20:27:08Z",
        "lastEditedBy" : "bdee90d3-fa06-43ed-8bf1-d381c3d69e0b",
        "tags" : [
        ]
      },
      {
        "id" : "3f8e7d94-d373-42f4-b0da-3f22b3c0a81d",
        "parentId" : "74474235-999f-4f2a-a45f-6d13de39f52b",
        "authorId" : "7a428a65-3bd3-41f2-b899-b42dc7177963",
        "body" : "task generate-diagnostics should be a lot like this work. you will need to first compile scripts\\word2md.ts, then run.\n\nhere is a sample.. I did not try to run it though :)\n\n``` JavaScript\nvar docDirectory = \"doc/\";\n\nvar word2MDJS = path.join(scriptsDirectory, \"word2md.js\");\nvar word2MDTS = path.join(scriptsDirectory, \"word2md.ts\");\nvar specWord = path.join(docDirectory, \"TypeScript Language Specification.docx\");\nvar specMD = path.join(docDirectory, \"spec.ms\");\n\nfile(processDiagnosticMessagesTs)\n\n// processDiagnosticMessages script\ncompileFile(word2MDJS,\n            [word2MDTS],\n            [word2MDJS],\n            [],\n            false);\n\n// The generated diagnostics map; built for the compiler and for the 'generate-diagnostics' task\nfile(specMD, [word2MDJS, specWord], function () {\n    var cmd = \"node \" + word2MDJS + \" \"  + specWord;\n    console.log(cmd);\n    var ex = jake.createExec([cmd]);\n    // Add listeners for output and error\n    ex.addListener(\"stdout\", function(output) {\n        process.stdout.write(output);\n    });\n    ex.addListener(\"stderr\", function(error) {\n        process.stderr.write(error);\n    });\n    ex.addListener(\"cmdEnd\", function() {\n        complete();\n    });\n    ex.run();    \n}, {async: true})\n\n\ndesc(\"Generates a markdown version of the language specificiation\");\ntask(\"generate-spec\", [specMD])\n```\n",
        "createdAt" : "2014-09-25T19:10:23Z",
        "updatedAt" : "2014-09-25T20:27:08Z",
        "lastEditedBy" : "7a428a65-3bd3-41f2-b899-b42dc7177963",
        "tags" : [
        ]
      },
      {
        "id" : "579b1ee9-252f-40f5-b1de-8a8d28f17ed3",
        "parentId" : "74474235-999f-4f2a-a45f-6d13de39f52b",
        "authorId" : "bdee90d3-fa06-43ed-8bf1-d381c3d69e0b",
        "body" : "The word2md tool has to run with cscript.exe and requires Word to be installed on the target machine (it uses the Word Automation APIs). Are we ok with those requirements in the jakefile?\n",
        "createdAt" : "2014-09-25T20:32:52Z",
        "updatedAt" : "2014-09-25T20:32:52Z",
        "lastEditedBy" : "bdee90d3-fa06-43ed-8bf1-d381c3d69e0b",
        "tags" : [
        ]
      },
      {
        "id" : "f1a3737c-fe2f-4019-9064-f92237cb37f1",
        "parentId" : "74474235-999f-4f2a-a45f-6d13de39f52b",
        "authorId" : "7a428a65-3bd3-41f2-b899-b42dc7177963",
        "body" : "I think so. it is not needed as part of the normal build targets (jake local, jake runtests).\n",
        "createdAt" : "2014-09-25T20:48:10Z",
        "updatedAt" : "2014-09-25T20:48:10Z",
        "lastEditedBy" : "7a428a65-3bd3-41f2-b899-b42dc7177963",
        "tags" : [
        ]
      }
    ],
    "commit" : "a8514dac6c7a5dc0cb349af4cd0ee00282bf545b",
    "line" : 1,
    "diffHunk" : "@@ -1,1 +-1,3 @@// word2md - Word to Markdown conversion tool\n//\n// word2md converts a Microsoft Word document to Markdown formatted text. The tool uses the"
  }
]