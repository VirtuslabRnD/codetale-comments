[
  {
    "id" : "9859b7b4-d3bc-4ea4-8fa7-f35a2cad9b96",
    "prId" : 86627,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/86627#pullrequestreview-337001240",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c092c5a2-c667-4b6b-96de-f9097ba60423",
        "parentId" : null,
        "authorId" : "d7870cae-47b0-4c8e-8527-be8fc4be86de",
        "body" : "Nit: This comment says `JobController` will throttle up to 6 minutes between restarts, while the above comment says the Kubelet will throttle up to 5 minutes before restarts. Is one of these more accurate that the other?",
        "createdAt" : "2019-12-27T15:37:56Z",
        "updatedAt" : "2020-01-10T08:06:21Z",
        "lastEditedBy" : "d7870cae-47b0-4c8e-8527-be8fc4be86de",
        "tags" : [
        ]
      },
      {
        "id" : "b554c1f8-87ef-4c26-a72d-5a7e954cfcaf",
        "parentId" : "c092c5a2-c667-4b6b-96de-f9097ba60423",
        "authorId" : "f8030d76-6069-40c7-9c21-93f9f4b262ad",
        "body" : "The above \"local restarts\" test set `restartPolicy` as `OnFailure` so it's kubelet that recreates the failed **container**, its max backoff period is indeed 5 minutes:\r\nhttps://github.com/kubernetes/kubernetes/blob/429ad7db4f9e5a645d562548f514be94cd717c6c/pkg/kubelet/kubelet.go#L137\r\n\r\nThe \"no local restarts\" test set `restartPolicy` as `Never` so it's `JobController` that recreates the failed **Pod** of a given Job, its max backoff period is 6 minutes:\r\nhttps://kubernetes.io/docs/concepts/workloads/controllers/jobs-run-to-completion/#pod-backoff-failure-policy\r\nhttps://github.com/kubernetes/kubernetes/blob/429ad7db4f9e5a645d562548f514be94cd717c6c/pkg/controller/job/job_controller.go#L60",
        "createdAt" : "2019-12-27T16:35:32Z",
        "updatedAt" : "2020-01-10T08:06:21Z",
        "lastEditedBy" : "f8030d76-6069-40c7-9c21-93f9f4b262ad",
        "tags" : [
        ]
      },
      {
        "id" : "369d0bb7-0f02-4c33-b040-f78047b0058a",
        "parentId" : "c092c5a2-c667-4b6b-96de-f9097ba60423",
        "authorId" : "d7870cae-47b0-4c8e-8527-be8fc4be86de",
        "body" : "Ah gotcha! This is great info - let's add it to the comment?",
        "createdAt" : "2019-12-28T14:36:24Z",
        "updatedAt" : "2020-01-10T08:06:21Z",
        "lastEditedBy" : "d7870cae-47b0-4c8e-8527-be8fc4be86de",
        "tags" : [
        ]
      },
      {
        "id" : "dee3bf1f-8a88-411d-9c65-8eef69540de9",
        "parentId" : "c092c5a2-c667-4b6b-96de-f9097ba60423",
        "authorId" : "f8030d76-6069-40c7-9c21-93f9f4b262ad",
        "body" : "Sorry, what info did you mean to add? The comment has included \"kubelet will ... 5 minutes, JobController will ... 6 minutes\", did you mean more details?",
        "createdAt" : "2019-12-30T05:14:03Z",
        "updatedAt" : "2020-01-10T08:06:21Z",
        "lastEditedBy" : "f8030d76-6069-40c7-9c21-93f9f4b262ad",
        "tags" : [
        ]
      }
    ],
    "commit" : "c84a371f3d475f20fc85819edc03475d6b5b3c9c",
    "line" : 32,
    "diffHunk" : "@@ -1,1 +114,118 @@\t\t// We can't use the random failure approach, because JobController\n\t\t// will throttle frequently failing Pods of a given Job, ramping\n\t\t// up to 6 minutes between restarts, making test timeout due to\n\t\t// successive failures.\n\t\t// Instead, we force the Job's Pods to be scheduled to a single Node"
  },
  {
    "id" : "9a7299c9-110d-4333-91ac-18b2f919a606",
    "prId" : 86627,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/86627#pullrequestreview-336831742",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7e02f0ca-8afe-470b-b6a0-0ba1a6f4eb78",
        "parentId" : null,
        "authorId" : "d7870cae-47b0-4c8e-8527-be8fc4be86de",
        "body" : "I just want to confirm that making this change doesn't violate the spirit of the test:\r\n\r\nThe test description says `\"it should run a job to completion when tasks sometimes fail and are not locally restarted.\"` Am I understanding correctly that the `not locally restarted` component refers to the `v1.RestartPolicyNever`? Or does `not locally restarted` mean that we want to ensure the pod is actually running on different nodes?\r\n\r\nIf the former is true, I agree with the approach you've taken. However, if the later is true, I worry that the changes made here may be violating the spirit of the test.",
        "createdAt" : "2019-12-27T15:40:48Z",
        "updatedAt" : "2020-01-10T08:06:21Z",
        "lastEditedBy" : "d7870cae-47b0-4c8e-8527-be8fc4be86de",
        "tags" : [
        ]
      },
      {
        "id" : "821166e1-f748-4750-a742-4be6707b3282",
        "parentId" : "7e02f0ca-8afe-470b-b6a0-0ba1a6f4eb78",
        "authorId" : "f8030d76-6069-40c7-9c21-93f9f4b262ad",
        "body" : "According to the difference of the two tests that only `RestartPolicy` is changed, I think it's the former, I guess \"locally restart\" here means kubelet recreates the failed containers of the Pod locally:\r\n`should run a job to completion when tasks sometimes fail and are locally restarted`\r\n`should run a job to completion when tasks sometimes fail and are not locally restarted`\r\n\r\nIf my understanding is wrong, I guess we will have to use the http approach to conduct the Pod succeed and fail like my first approach did, but it looks not clear like the current one @liggitt suggested.",
        "createdAt" : "2019-12-27T16:40:38Z",
        "updatedAt" : "2020-01-10T08:06:21Z",
        "lastEditedBy" : "f8030d76-6069-40c7-9c21-93f9f4b262ad",
        "tags" : [
        ]
      },
      {
        "id" : "fbea59dd-683c-4cb6-8d44-f9c3d4496930",
        "parentId" : "7e02f0ca-8afe-470b-b6a0-0ba1a6f4eb78",
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "the containers are not locally restarted, they fail and drive completely new pods/containers",
        "createdAt" : "2019-12-27T17:44:36Z",
        "updatedAt" : "2020-01-10T08:06:21Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      }
    ],
    "commit" : "c84a371f3d475f20fc85819edc03475d6b5b3c9c",
    "line" : 34,
    "diffHunk" : "@@ -1,1 +116,120 @@\t\t// up to 6 minutes between restarts, making test timeout due to\n\t\t// successive failures.\n\t\t// Instead, we force the Job's Pods to be scheduled to a single Node\n\t\t// and use a hostPath volume to persist data across new Pods.\n\t\tginkgo.By(\"Looking for a node to schedule job pod\")"
  },
  {
    "id" : "9e7af045-b116-4980-be7a-bf00cd3989fd",
    "prId" : 53380,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/53380#pullrequestreview-68851010",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2aab858c-0e0e-474c-ac18-8c93faae08c4",
        "parentId" : null,
        "authorId" : "01c14569-b640-48af-98cc-aa9dd12da7b6",
        "body" : "Should this worst case analysis be updated?",
        "createdAt" : "2017-10-03T23:20:00Z",
        "updatedAt" : "2017-10-03T23:20:01Z",
        "lastEditedBy" : "01c14569-b640-48af-98cc-aa9dd12da7b6",
        "tags" : [
        ]
      },
      {
        "id" : "39f7521c-740d-4a58-91ba-35fe788af654",
        "parentId" : "2aab858c-0e0e-474c-ac18-8c93faae08c4",
        "authorId" : "b7d2a698-a6e1-4031-bb69-8b45505badb5",
        "body" : "No, that part stays as it was. ",
        "createdAt" : "2017-10-04T10:58:51Z",
        "updatedAt" : "2017-10-04T10:58:51Z",
        "lastEditedBy" : "b7d2a698-a6e1-4031-bb69-8b45505badb5",
        "tags" : [
        ]
      },
      {
        "id" : "007b802b-e48a-4c0d-a883-865d023f7f89",
        "parentId" : "2aab858c-0e0e-474c-ac18-8c93faae08c4",
        "authorId" : "01c14569-b640-48af-98cc-aa9dd12da7b6",
        "body" : "Is this for test execution time or test flakiness? The \"should be very rare\" statement does not hold true given the test flakes we saw. ",
        "createdAt" : "2017-10-04T21:24:33Z",
        "updatedAt" : "2017-10-04T21:24:33Z",
        "lastEditedBy" : "01c14569-b640-48af-98cc-aa9dd12da7b6",
        "tags" : [
        ]
      },
      {
        "id" : "fe198837-5906-48cf-a159-1c5711d9a315",
        "parentId" : "2aab858c-0e0e-474c-ac18-8c93faae08c4",
        "authorId" : "b7d2a698-a6e1-4031-bb69-8b45505badb5",
        "body" : "\"should be very rare\" is still true, given that the failure limit is high. Otherwise we'll hit it too soon and that's the reason the flakiness rate recently. It started only after we've added that limit with default 6. ",
        "createdAt" : "2017-10-12T08:36:10Z",
        "updatedAt" : "2017-10-12T08:36:10Z",
        "lastEditedBy" : "b7d2a698-a6e1-4031-bb69-8b45505badb5",
        "tags" : [
        ]
      }
    ],
    "commit" : "9991a88870a8b6674e46e64e5d91f5bc9ea720b8",
    "line" : 3,
    "diffHunk" : "@@ -1,1 +77,81 @@\t\t// Worst case analysis: 15 failures, each taking 1 minute to\n\t\t// run due to some slowness, 1 in 2^15 chance of happening,\n\t\t// causing test flake.  Should be very rare.\n\t\tjob := framework.NewTestJob(\"randomlySucceedOrFail\", \"rand-non-local\", v1.RestartPolicyNever, parallelism, completions, nil, 999)\n\t\tjob, err := framework.CreateJob(f.ClientSet, f.Namespace.Name, job)"
  },
  {
    "id" : "d3a7adef-aa69-4c05-9e92-7217c1de040d",
    "prId" : 49289,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/49289#pullrequestreview-51315957",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f6854b4b-15d9-4cd0-9f1b-c1ac1ff88cc1",
        "parentId" : null,
        "authorId" : "a5ac91f3-1cbc-4fd9-af85-741ee28dd9c8",
        "body" : "Golint comments: should have a package comment, unless it's in another file for this package. [More info](https://golang.org/wiki/CodeReviewComments#package-comments). <!-- golint -->",
        "createdAt" : "2017-07-20T20:09:06Z",
        "updatedAt" : "2017-07-22T10:43:51Z",
        "lastEditedBy" : "a5ac91f3-1cbc-4fd9-af85-741ee28dd9c8",
        "tags" : [
        ]
      }
    ],
    "commit" : "5e93ed27bd90728dc840b9bfd67b5c4c35affe48",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +15,19 @@*/\n\npackage apps\n\nimport ("
  }
]