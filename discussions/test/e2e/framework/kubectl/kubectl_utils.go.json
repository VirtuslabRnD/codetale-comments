[
  {
    "id" : "6e9abb88-bb49-460c-bc13-43d600304fac",
    "prId" : 100377,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/100377#pullrequestreview-637227925",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "40740233-11a0-400b-a744-0ee37637fc38",
        "parentId" : null,
        "authorId" : "209ee091-cf29-4efa-8a1b-a98334ea3f9a",
        "body" : "does Windows not have a sync functionality? The reason why we added a sync call is because there were a lot of test flakes due to the data not getting flushed to disk.",
        "createdAt" : "2021-04-15T20:22:47Z",
        "updatedAt" : "2021-04-16T00:01:50Z",
        "lastEditedBy" : "209ee091-cf29-4efa-8a1b-a98334ea3f9a",
        "tags" : [
        ]
      },
      {
        "id" : "17026785-719b-441e-b82c-9462783741c7",
        "parentId" : "40740233-11a0-400b-a744-0ee37637fc38",
        "authorId" : "87fae8a2-4751-4356-ba8a-ce265708b853",
        "body" : "yeah, I remember discussing this with @jingxu97 and exploring the option of adding https://docs.microsoft.com/en-us/sysinternals/downloads/sync to agnhost, I forgot to do that but you're right, @jingxu97 also mentioned the flakiness and suggested adding the solution in https://github.com/kubernetes/kubernetes/pull/100057",
        "createdAt" : "2021-04-15T20:51:30Z",
        "updatedAt" : "2021-04-16T00:01:50Z",
        "lastEditedBy" : "87fae8a2-4751-4356-ba8a-ce265708b853",
        "tags" : [
        ]
      },
      {
        "id" : "cf0373f8-80b8-417e-86a5-9e1e3d74f0d8",
        "parentId" : "40740233-11a0-400b-a744-0ee37637fc38",
        "authorId" : "44594ff0-8fbc-44a7-84f9-654ffd54270f",
        "body" : "there is no easy way for Windows to sync on file (needs extra tools etc.). So we want to give it a try for now. If it flake, we can add logic similar to #100057",
        "createdAt" : "2021-04-15T21:03:14Z",
        "updatedAt" : "2021-04-16T00:01:50Z",
        "lastEditedBy" : "44594ff0-8fbc-44a7-84f9-654ffd54270f",
        "tags" : [
        ]
      },
      {
        "id" : "0b67d58d-c611-4d65-a17c-00d6634627b0",
        "parentId" : "40740233-11a0-400b-a744-0ee37637fc38",
        "authorId" : "209ee091-cf29-4efa-8a1b-a98334ea3f9a",
        "body" : "I don't think that workaround is going to work in all cases, especially for tests that want to test multiple pods sharing the volume on the same node.",
        "createdAt" : "2021-04-15T21:45:40Z",
        "updatedAt" : "2021-04-16T00:01:50Z",
        "lastEditedBy" : "209ee091-cf29-4efa-8a1b-a98334ea3f9a",
        "tags" : [
        ]
      },
      {
        "id" : "650fca55-2b9d-4de6-9a71-0f7bf2ae6971",
        "parentId" : "40740233-11a0-400b-a744-0ee37637fc38",
        "authorId" : "209ee091-cf29-4efa-8a1b-a98334ea3f9a",
        "body" : "Can you add a TODO here and open an issue to track adding sync support to the test image?\r\n",
        "createdAt" : "2021-04-15T23:03:22Z",
        "updatedAt" : "2021-04-16T00:01:50Z",
        "lastEditedBy" : "209ee091-cf29-4efa-8a1b-a98334ea3f9a",
        "tags" : [
        ]
      },
      {
        "id" : "076dcdea-2807-45cb-af54-cd6e9e3b5399",
        "parentId" : "40740233-11a0-400b-a744-0ee37637fc38",
        "authorId" : "87fae8a2-4751-4356-ba8a-ce265708b853",
        "body" : "Done, tracked in https://github.com/kubernetes/kubernetes/issues/101172",
        "createdAt" : "2021-04-16T00:02:10Z",
        "updatedAt" : "2021-04-16T00:02:11Z",
        "lastEditedBy" : "87fae8a2-4751-4356-ba8a-ce265708b853",
        "tags" : [
        ]
      }
    ],
    "commit" : "eaf2954ad8711fabe4374c8273e960b9d8972072",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +145,149 @@\t// TODO(mauriciopoppe): remove this statement once we add `sync` to the test image, ref #101172\n\tif e2epod.NodeOSDistroIs(\"windows\") {\n\t\tcommand = fmt.Sprintf(\"echo '%s' > '%s';\", contents, path)\n\t}\n\tstdout, stderr, err := tk.kubectlExecWithRetry(tk.Namespace, podName, containerName, \"--\", \"/bin/sh\", \"-c\", command)"
  }
]