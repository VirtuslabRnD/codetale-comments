[
  {
    "id" : "f2b44b6b-4f3a-480e-b78b-a425e37e3c50",
    "prId" : 103409,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/103409#pullrequestreview-698529511",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "690a65ee-596c-45a5-804c-607692c6ca17",
        "parentId" : null,
        "authorId" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "body" : "```suggestion\r\n\tpollErr := wait.PollImmediate(interval, timeout, func() (bool, error) {\r\n\t\tstdout, err = framework.RunHostCmd(sourcePod.Namespace, sourcePod.Name, cmd)\r\n\t\tif err != nil {\r\n\t\t\tframework.Logf(\"got err: %v, retry until timeout\", err)\r\n\t\t\treturn false, nil\r\n\t\t}\r\n\t\tif strings.TrimSpace(stdout) == targetHostname {\r\n\t\t\treturn true, nil\r\n\t\t}\r\n\t\tframework.Logf(\"expected %s got %s:\" targetHostname, strings.TrimSpace(stdout))\r\n\t\treturn false, nil\r\n\t\t})\r\n\t\tframework.ExpectNoError(pollErr)\r\n```\r\n\r\nthis is aligned with the rest of the tests, same functionality though",
        "createdAt" : "2021-07-02T15:44:58Z",
        "updatedAt" : "2021-07-02T15:44:59Z",
        "lastEditedBy" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "tags" : [
        ]
      },
      {
        "id" : "0caaf06b-1dc4-451e-9810-e2ef34aacbcc",
        "parentId" : "690a65ee-596c-45a5-804c-607692c6ca17",
        "authorId" : "6dd71efb-88b1-4bb0-b30a-0df658362f14",
        "body" : "I agree this code is better, but this was following same code structure as execSourceIP above, should we update both?",
        "createdAt" : "2021-07-02T17:45:08Z",
        "updatedAt" : "2021-07-02T17:45:08Z",
        "lastEditedBy" : "6dd71efb-88b1-4bb0-b30a-0df658362f14",
        "tags" : [
        ]
      },
      {
        "id" : "20079956-9042-48d7-af79-754362665864",
        "parentId" : "690a65ee-596c-45a5-804c-607692c6ca17",
        "authorId" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "body" : "Landmines everywhere :) , my experience on the old code is better not touch it as drive in pr",
        "createdAt" : "2021-07-02T18:19:42Z",
        "updatedAt" : "2021-07-02T18:19:42Z",
        "lastEditedBy" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "tags" : [
        ]
      },
      {
        "id" : "59387514-53d7-43fa-8aca-c0ba096f7420",
        "parentId" : "690a65ee-596c-45a5-804c-607692c6ca17",
        "authorId" : "6dd71efb-88b1-4bb0-b30a-0df658362f14",
        "body" : "I tend to agree, but I'll add a note to maybe revisit this along with other functions here",
        "createdAt" : "2021-07-02T18:28:04Z",
        "updatedAt" : "2021-07-02T18:28:04Z",
        "lastEditedBy" : "6dd71efb-88b1-4bb0-b30a-0df658362f14",
        "tags" : [
        ]
      },
      {
        "id" : "235a9885-d895-47b3-94df-52448843f285",
        "parentId" : "690a65ee-596c-45a5-804c-607692c6ca17",
        "authorId" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "body" : "we need to revisit, there are some tests that are not needed and a lot of duplicate funcions, break down the file per features, it is 3k lines now, ... but before code freeze is not the best moment :)",
        "createdAt" : "2021-07-02T22:41:23Z",
        "updatedAt" : "2021-07-02T22:41:23Z",
        "lastEditedBy" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "tags" : [
        ]
      }
    ],
    "commit" : "04d59ff2df37d381080f792ea5410a5b221ff884",
    "line" : 30,
    "diffHunk" : "@@ -1,1 +168,172 @@\n\tframework.ExpectNoError(err)\n\tframework.ExpectEqual(strings.TrimSpace(stdout), targetHostname)\n}\n"
  },
  {
    "id" : "dbf2ab65-6b72-4a4c-b11d-15b14e1d79dd",
    "prId" : 93557,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/93557#pullrequestreview-459310480",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0dceba73-dcff-4fb1-808f-705ad4cf0650",
        "parentId" : null,
        "authorId" : "6dd71efb-88b1-4bb0-b30a-0df658362f14",
        "body" : "\r\n\r\nI suspect this test may fail in some scenarios with v6 cause of the `[ ]` :thinking: \r\n\r\nSomething to watch out for in the future.\r\n",
        "createdAt" : "2020-07-31T15:58:34Z",
        "updatedAt" : "2020-07-31T16:53:18Z",
        "lastEditedBy" : "6dd71efb-88b1-4bb0-b30a-0df658362f14",
        "tags" : [
        ]
      },
      {
        "id" : "02ba341c-7031-412d-916d-25c1b11b9156",
        "parentId" : "0dceba73-dcff-4fb1-808f-705ad4cf0650",
        "authorId" : "9e6ce3ed-e2f7-40ea-b6d7-b1b04fc48f70",
        "body" : "looks like `net.SplitHostPort` would strip the brackets: https://play.golang.org/p/YoTX6bnpXas",
        "createdAt" : "2020-07-31T16:36:02Z",
        "updatedAt" : "2020-07-31T16:53:18Z",
        "lastEditedBy" : "9e6ce3ed-e2f7-40ea-b6d7-b1b04fc48f70",
        "tags" : [
        ]
      },
      {
        "id" : "7909669f-3388-43d6-bf96-f77f064e5efb",
        "parentId" : "0dceba73-dcff-4fb1-808f-705ad4cf0650",
        "authorId" : "6dd71efb-88b1-4bb0-b30a-0df658362f14",
        "body" : "good to know!",
        "createdAt" : "2020-07-31T16:38:14Z",
        "updatedAt" : "2020-07-31T16:53:18Z",
        "lastEditedBy" : "6dd71efb-88b1-4bb0-b30a-0df658362f14",
        "tags" : [
        ]
      }
    ],
    "commit" : "7b07b33094c476758fb31049ac18d0e49da16982",
    "line" : 40,
    "diffHunk" : "@@ -1,1 +155,159 @@\tframework.ExpectNoError(err)\n\n\t// The stdout return from RunHostCmd is in this format: x.x.x.x:port or [xx:xx:xx::x]:port\n\thost, _, err := net.SplitHostPort(stdout)\n\tif err != nil {"
  },
  {
    "id" : "c0fd7b81-8f00-448e-9230-5e55cdb93ffd",
    "prId" : 88196,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/88196#pullrequestreview-369069585",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c699b701-4159-49eb-b802-9ccb6e48a550",
        "parentId" : null,
        "authorId" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "body" : "this will return once it finds an sctp module loaded on one node and will not continue iterating over all the nodes.\r\nIt also may happen that the first nodes doesn't have the sctp module enabled and the last one does , and it will return true",
        "createdAt" : "2020-03-03T22:34:09Z",
        "updatedAt" : "2020-05-28T19:54:55Z",
        "lastEditedBy" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "tags" : [
        ]
      },
      {
        "id" : "53786055-d6a4-48fd-bd4c-e45add205930",
        "parentId" : "c699b701-4159-49eb-b802-9ccb6e48a550",
        "authorId" : "c490e441-2b9f-41f2-8559-d47be0ea8836",
        "body" : "While there are some tests where it would be interesting to check specific nodes, the goal of the check is mostly \"if *no* nodes have the SCTP module loaded before the test, then no nodes should have the SCTP module loaded after the test\".",
        "createdAt" : "2020-03-04T13:53:28Z",
        "updatedAt" : "2020-05-28T19:54:55Z",
        "lastEditedBy" : "c490e441-2b9f-41f2-8559-d47be0ea8836",
        "tags" : [
        ]
      },
      {
        "id" : "d1ececfe-957c-44b9-8a47-f650cc66997e",
        "parentId" : "c699b701-4159-49eb-b802-9ccb6e48a550",
        "authorId" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "body" : "yeah, but the current implementation is not doing that, is it?\r\nit returns true on the first hit",
        "createdAt" : "2020-03-04T14:21:56Z",
        "updatedAt" : "2020-05-28T19:54:55Z",
        "lastEditedBy" : "203dfb85-d185-4057-88b3-a1b4f09fd1fd",
        "tags" : [
        ]
      },
      {
        "id" : "2ad61626-172e-494a-831c-90cfe85e8686",
        "parentId" : "c699b701-4159-49eb-b802-9ccb6e48a550",
        "authorId" : "435e54ad-c154-4dc4-ba5a-0c4cb43addc5",
        "body" : "Now I updated the implementation. I collect the nodes with SCTP at the beginning, and then after the test, too. I compare the two lists and if there is a new node with SCTP after the test the test fails.\r\nAs it is not necessarily a 100% stable environment I had to do something with the cases when the interrogation of a node fails for any reason. The new logic works so, that if a node has SCTP module after the test, but the interrogation of that node failed before the test, then it is not considered as a new node with SCTP.\r\nPlease tell me if this logic is wrong.",
        "createdAt" : "2020-03-04T14:26:30Z",
        "updatedAt" : "2020-05-28T19:54:55Z",
        "lastEditedBy" : "435e54ad-c154-4dc4-ba5a-0c4cb43addc5",
        "tags" : [
        ]
      },
      {
        "id" : "ef336b11-e2e2-4ab4-a037-366bb96b3473",
        "parentId" : "c699b701-4159-49eb-b802-9ccb6e48a550",
        "authorId" : "c490e441-2b9f-41f2-8559-d47be0ea8836",
        "body" : "> yeah, but the current implementation is not doing that, is it?\r\n> it returns true on the first hit\r\n\r\nRight... because if any node has the module loaded, then that means that it is not the case that no node has the module loaded",
        "createdAt" : "2020-03-04T19:10:47Z",
        "updatedAt" : "2020-05-28T19:54:55Z",
        "lastEditedBy" : "c490e441-2b9f-41f2-8559-d47be0ea8836",
        "tags" : [
        ]
      },
      {
        "id" : "9ce34f46-5fcd-49bd-ac98-64fd4631f49b",
        "parentId" : "c699b701-4159-49eb-b802-9ccb6e48a550",
        "authorId" : "c490e441-2b9f-41f2-8559-d47be0ea8836",
        "body" : "There is a very strong expectation that no node in the test environment will have the sctp module loaded. It's not worth adding a lot of complexity to deal with the case where some nodes do and some don't. Just require that if no node has the module loaded before the test, then no node has the module loaded after the test. (If at least one node has the module loaded before the test then it doesn't matter what the state after the test is.)",
        "createdAt" : "2020-03-04T19:13:12Z",
        "updatedAt" : "2020-05-28T19:54:55Z",
        "lastEditedBy" : "c490e441-2b9f-41f2-8559-d47be0ea8836",
        "tags" : [
        ]
      },
      {
        "id" : "8224f722-0056-4965-9655-3d2be55ea4b6",
        "parentId" : "c699b701-4159-49eb-b802-9ccb6e48a550",
        "authorId" : "435e54ad-c154-4dc4-ba5a-0c4cb43addc5",
        "body" : "OK, I reverted to the simpler solution.",
        "createdAt" : "2020-03-04T19:43:36Z",
        "updatedAt" : "2020-05-28T19:54:55Z",
        "lastEditedBy" : "435e54ad-c154-4dc4-ba5a-0c4cb43addc5",
        "tags" : [
        ]
      }
    ],
    "commit" : "3ce43a1c96e631c3ce95453c083c193ba8528d9d",
    "line" : 42,
    "diffHunk" : "@@ -1,1 +100,104 @@\t\t\tif found := re.Find([]byte(line)); found != nil {\n\t\t\t\tframework.Logf(\"the sctp module is loaded on node: %v\", node.Name)\n\t\t\t\treturn true\n\t\t\t}\n\t\t}"
  },
  {
    "id" : "d06e1ebb-f612-4cb0-b87d-920406451eba",
    "prId" : 88196,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/88196#pullrequestreview-397948397",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c721ea6b-6712-4d3c-b51d-254cd7310e53",
        "parentId" : null,
        "authorId" : "c490e441-2b9f-41f2-8559-d47be0ea8836",
        "body" : "This is probably also a good place to document *why* we are doing this:\r\n\r\n    // For security reasons, and also to allow clusters to use userspace SCTP implementations,\r\n    // we require that just creating an SCTP Pod/Service/NetworkPolicy must not do anything\r\n    // that would cause the sctp kernel module to be loaded.\r\n",
        "createdAt" : "2020-04-21T14:26:30Z",
        "updatedAt" : "2020-05-28T19:54:55Z",
        "lastEditedBy" : "c490e441-2b9f-41f2-8559-d47be0ea8836",
        "tags" : [
        ]
      },
      {
        "id" : "1bf4abfd-45e6-43b4-9e4f-df5ff24f4e47",
        "parentId" : "c721ea6b-6712-4d3c-b51d-254cd7310e53",
        "authorId" : "435e54ad-c154-4dc4-ba5a-0c4cb43addc5",
        "body" : "Fixed.",
        "createdAt" : "2020-04-22T08:14:25Z",
        "updatedAt" : "2020-05-28T19:54:55Z",
        "lastEditedBy" : "435e54ad-c154-4dc4-ba5a-0c4cb43addc5",
        "tags" : [
        ]
      }
    ],
    "commit" : "3ce43a1c96e631c3ce95453c083c193ba8528d9d",
    "line" : 24,
    "diffHunk" : "@@ -1,1 +82,86 @@\n// CheckSCTPModuleLoadedOnNodes checks whether any node on the list has the\n// sctp.ko module loaded\n// For security reasons, and also to allow clusters to use userspace SCTP implementations,\n// we require that just creating an SCTP Pod/Service/NetworkPolicy must not do anything"
  }
]