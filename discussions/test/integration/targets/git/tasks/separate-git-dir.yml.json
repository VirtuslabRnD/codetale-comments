[
  {
    "id" : "6c7779ab-deb9-4104-88f7-fddd8646d07f",
    "prId" : 38016,
    "prUrl" : "https://github.com/ansible/ansible/pull/38016#pullrequestreview-118009404",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d0e0d94c-54a2-4de8-873b-968645cfd3d7",
        "parentId" : null,
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "Also don't forget to clean-up dirs after testing (tear down stage)",
        "createdAt" : "2018-05-07T14:07:45Z",
        "updatedAt" : "2018-05-21T19:16:31Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      }
    ],
    "commit" : "59d07dc721ae9909f4fe15a5bcdb45e20649d261",
    "line" : 20,
    "diffHunk" : "@@ -1,1 +45,49 @@  git:\n    repo: \"{{ repo_format1 }}\"\n    dest: \"{{ checkout_dir }}\"\n  ignore_errors: yes\n  register: result"
  },
  {
    "id" : "8a3d12db-4090-475b-bf64-f98260036f39",
    "prId" : 38016,
    "prUrl" : "https://github.com/ansible/ansible/pull/38016#pullrequestreview-120238330",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "4f77d343-d37b-492a-9347-9cb5416e8d84",
        "parentId" : null,
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "We also need to test the case where `gitdir: ...` is on the other line.",
        "createdAt" : "2018-05-15T11:47:16Z",
        "updatedAt" : "2018-05-21T19:16:31Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      },
      {
        "id" : "211fe242-fef1-4fa7-bc96-ab145bd8fbcf",
        "parentId" : "4f77d343-d37b-492a-9347-9cb5416e8d84",
        "authorId" : "421ffd2f-6e48-44c2-b9a9-70bf5e988db9",
        "body" : "Like this https://github.com/ansible/ansible/pull/38016/commits/82430f6c2d0c80475177cbb2dbae0857606abeeb ?",
        "createdAt" : "2018-05-15T13:27:28Z",
        "updatedAt" : "2018-05-21T19:16:31Z",
        "lastEditedBy" : "421ffd2f-6e48-44c2-b9a9-70bf5e988db9",
        "tags" : [
        ]
      },
      {
        "id" : "8639c07b-604c-46dd-b51b-54f56ab45067",
        "parentId" : "4f77d343-d37b-492a-9347-9cb5416e8d84",
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "Except it should succeed",
        "createdAt" : "2018-05-15T13:29:54Z",
        "updatedAt" : "2018-05-21T19:16:31Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      },
      {
        "id" : "3129f755-73ac-4a7e-be57-a50d0b3fb6ac",
        "parentId" : "4f77d343-d37b-492a-9347-9cb5416e8d84",
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "That's why I asked you to reuse existing code: https://github.com/ansible/ansible/pull/38016#issuecomment-387800545",
        "createdAt" : "2018-05-15T13:30:52Z",
        "updatedAt" : "2018-05-21T19:16:31Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      },
      {
        "id" : "b68d55a2-d800-4dcb-9db5-729f91553d9f",
        "parentId" : "4f77d343-d37b-492a-9347-9cb5416e8d84",
        "authorId" : "421ffd2f-6e48-44c2-b9a9-70bf5e988db9",
        "body" : "Okay",
        "createdAt" : "2018-05-15T13:33:11Z",
        "updatedAt" : "2018-05-21T19:16:31Z",
        "lastEditedBy" : "421ffd2f-6e48-44c2-b9a9-70bf5e988db9",
        "tags" : [
        ]
      },
      {
        "id" : "c064b6aa-dcf5-4229-82a1-95b7e1ac1962",
        "parentId" : "4f77d343-d37b-492a-9347-9cb5416e8d84",
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "To be clear: don't copy-paste blindly, merge the best parts of the approaches ;)",
        "createdAt" : "2018-05-15T13:42:35Z",
        "updatedAt" : "2018-05-21T19:16:31Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      }
    ],
    "commit" : "59d07dc721ae9909f4fe15a5bcdb45e20649d261",
    "line" : 23,
    "diffHunk" : "@@ -1,1 +21,25 @@\n- name: SEPARATE-GIT-DIR | set git dir to non-existent dir\n  shell: \"echo gitdir: /dev/null/non-existent-dir > .git\"\n  args:\n    chdir: \"{{ checkout_dir }}\""
  },
  {
    "id" : "24f5f9dd-91a5-463c-9701-464b2fbdebe8",
    "prId" : 38016,
    "prUrl" : "https://github.com/ansible/ansible/pull/38016#pullrequestreview-120325697",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9393b6f8-c8fe-4292-8709-39508ad6f605",
        "parentId" : null,
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "it should not fails if `.gitdir` contains a list of `key: value`",
        "createdAt" : "2018-05-15T13:29:23Z",
        "updatedAt" : "2018-05-21T19:16:31Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      },
      {
        "id" : "29ab7d5a-4ea7-453c-b1c3-837ffb9f8f8e",
        "parentId" : "9393b6f8-c8fe-4292-8709-39508ad6f605",
        "authorId" : "421ffd2f-6e48-44c2-b9a9-70bf5e988db9",
        "body" : "I can't find any reference that proves that. Git documentation [says](https://git-scm.com/docs/gitrepository-layout#_description):\r\n>  Also you can have a plain text file .git at the root of your working tree, containing gitdir: <path> to point at the real directory that has the repository.\r\n\r\nAnd no information about the key-value list.\r\n\r\nI also tried a few examples, including\r\n```\r\nkey: value\r\ngitdir: ...path\r\n```\r\nand (with newline at the front):\r\n```\r\n\r\ngitdir: ...path\r\n```\r\n\r\nAnd all of the examples fail at the repository update stage with the message from git: `fatal: Invalid gitfile format: .git`. Can you please provide any correct examples of key-value lists for the `.git` file which will work with Git?",
        "createdAt" : "2018-05-15T14:54:54Z",
        "updatedAt" : "2018-05-21T19:16:31Z",
        "lastEditedBy" : "421ffd2f-6e48-44c2-b9a9-70bf5e988db9",
        "tags" : [
        ]
      },
      {
        "id" : "c71c3524-acfe-41fa-8309-bfa941befa45",
        "parentId" : "9393b6f8-c8fe-4292-8709-39508ad6f605",
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "Not really, but since that other snippet loops through key-value lines there must be something working this way. I'll try investigating this.",
        "createdAt" : "2018-05-15T16:30:49Z",
        "updatedAt" : "2018-05-21T19:16:31Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      },
      {
        "id" : "65da1f12-024b-4df8-bff7-f1eb16b1ba1c",
        "parentId" : "9393b6f8-c8fe-4292-8709-39508ad6f605",
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "It looks like the best way of checking integrity of the repo is [`git-fsck`](https://git-scm.com/docs/git-fsck), but I don't thing that it's needed here now.",
        "createdAt" : "2018-05-15T16:56:17Z",
        "updatedAt" : "2018-05-21T19:16:31Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      },
      {
        "id" : "ae169c82-3195-4858-b875-8fece6d8ff46",
        "parentId" : "9393b6f8-c8fe-4292-8709-39508ad6f605",
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "But you are right, it does contain a validation for a file immediately starting with `gitdir: `: https://github.com/git/git/blob/master/setup.c#L592",
        "createdAt" : "2018-05-15T16:57:09Z",
        "updatedAt" : "2018-05-21T19:16:31Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      },
      {
        "id" : "200188d4-4827-4d38-8d68-cf5cb5d75933",
        "parentId" : "9393b6f8-c8fe-4292-8709-39508ad6f605",
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "So now we know that it should only contain `gitdir: ...path` and nothing more in that file. Trailing EOLs are being stripped off by git.",
        "createdAt" : "2018-05-15T16:59:32Z",
        "updatedAt" : "2018-05-21T19:16:31Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      }
    ],
    "commit" : "59d07dc721ae9909f4fe15a5bcdb45e20649d261",
    "line" : 37,
    "diffHunk" : "@@ -1,1 +35,39 @@  assert:\n    that:\n      - result is failed\n\n- name: SEPARATE-GIT-DIR | set .git file to bad format"
  }
]