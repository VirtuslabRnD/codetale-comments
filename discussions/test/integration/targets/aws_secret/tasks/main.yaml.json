[
  {
    "id" : "3550c3c9-7ea9-48df-a15d-9e06295a3c3e",
    "prId" : 48486,
    "prUrl" : "https://github.com/ansible/ansible/pull/48486#pullrequestreview-206508819",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b5f36c47-02f1-475e-9a76-74027fafac0e",
        "parentId" : null,
        "authorId" : "6b7e4265-ae86-4269-9bd7-f8ffa9085df6",
        "body" : "Maybe a module bug - this task is making changes so the assert below fails.",
        "createdAt" : "2018-11-13T15:09:08Z",
        "updatedAt" : "2019-02-25T19:09:57Z",
        "lastEditedBy" : "6b7e4265-ae86-4269-9bd7-f8ffa9085df6",
        "tags" : [
        ]
      },
      {
        "id" : "1bfee20e-1887-4bca-9abd-29187750402c",
        "parentId" : "b5f36c47-02f1-475e-9a76-74027fafac0e",
        "authorId" : "2ff77e92-4a73-4433-b311-af40c7d9dcdb",
        "body" : "Noob question:\r\nWhat is the ansible-test command that allow me to run the integration test just for aws_secret ?\r\n\r\nI'm a bit cheating locally and I guess it will be a source of differences in the result...",
        "createdAt" : "2018-11-20T18:35:20Z",
        "updatedAt" : "2019-02-25T19:09:57Z",
        "lastEditedBy" : "2ff77e92-4a73-4433-b311-af40c7d9dcdb",
        "tags" : [
        ]
      },
      {
        "id" : "ad2af7c9-ac1a-4e10-a467-9218ee30cb37",
        "parentId" : "b5f36c47-02f1-475e-9a76-74027fafac0e",
        "authorId" : "380aef6a-3fbb-41ad-819b-bada96e05807",
        "body" : "`ansible-test integration aws_secret -v`",
        "createdAt" : "2018-11-26T19:46:52Z",
        "updatedAt" : "2019-02-25T19:09:57Z",
        "lastEditedBy" : "380aef6a-3fbb-41ad-819b-bada96e05807",
        "tags" : [
        ]
      },
      {
        "id" : "b857cd7b-4705-43f8-8ebe-324851aea5e2",
        "parentId" : "b5f36c47-02f1-475e-9a76-74027fafac0e",
        "authorId" : "6b7e4265-ae86-4269-9bd7-f8ffa9085df6",
        "body" : "@rrey This one is still making changes to the secret so the tests fail. Looks like an idempotence issue with the module. My PR restructuring things for CI has been merged and once your tests are completing rather than failing here the PR adding the permissions and this can be merged. Here's the output from testing on the dev server:\r\n```\r\nTASK [aws_secret : add secret to AWS Secrets Manager] **************************\r\nchanged: [testhost] => {\"changed\": true, \"secret\": {\"arn\": \"arn:aws:secretsmanager:us-east-1:966509639900:secret:test-secret-string-ansible-test-macbook-pro-44-50736924-4CXvRp\", \"last_changed_date\": \"2019-02-21T19:44:25.772000+00:00\", \"name\": \"test-secret-string-ansible-test-shertel-50736924\", \"version_ids_to_stages\": {\"26d43df3-84a1-43eb-803e-40f0f0c65d1d\": [\"AWSCURRENT\"]}}}\r\n\r\nTASK [aws_secret : assert correct keys are returned] ***************************\r\nok: [testhost] => {\r\n    \"changed\": false,\r\n    \"msg\": \"All assertions passed\"\r\n}\r\n\r\nTASK [aws_secret : no changes to secret] ***************************************\r\nchanged: [testhost] => {\"changed\": true, \"secret\": {\"arn\": \"arn:aws:secretsmanager:us-east-1:966509639900:secret:test-secret-string-ansible-test-shertel-50736924-4CXvRp\", \"last_accessed_date\": \"2019-02-21T00:00:00+00:00\", \"last_changed_date\": \"2019-02-21T19:44:26.995000+00:00\", \"name\": \"test-secret-string-ansible-test-shertel-50736924\", \"version_ids_to_stages\": {\"26d43df3-84a1-43eb-803e-40f0f0c65d1d\": [\"AWSPREVIOUS\"], \"6ad8339b-27a9-4606-938e-8d2f0c5979eb\": [\"AWSCURRENT\"]}}}\r\n\r\nTASK [aws_secret : assert correct keys are returned] ***************************\r\nfatal: [testhost]: FAILED! => {\r\n    \"assertion\": \"not result.changed\",\r\n    \"changed\": false,\r\n    \"evaluated_to\": false,\r\n    \"msg\": \"Assertion failed\"\r\n}\r\n```",
        "createdAt" : "2019-02-21T19:52:21Z",
        "updatedAt" : "2019-02-25T19:09:57Z",
        "lastEditedBy" : "6b7e4265-ae86-4269-9bd7-f8ffa9085df6",
        "tags" : [
        ]
      }
    ],
    "commit" : "e4241257e383b6c06a32171572ad68bb31a5eed3",
    "line" : 105,
    "diffHunk" : "@@ -1,1 +103,107 @@        - result.version_ids_to_stages is not none\n\n  - name: no changes to secret\n    aws_secret:\n      <<: *aws_connection_info"
  }
]