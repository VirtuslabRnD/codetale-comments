[
  {
    "id" : "9aab8be5-e7c8-42be-b84d-c078ccdd3429",
    "prId" : 42169,
    "prUrl" : "https://github.com/ansible/ansible/pull/42169#pullrequestreview-153422781",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0c51be95-74f7-4016-a67c-647e7c91b7cd",
        "parentId" : null,
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "@mattclay could you please check whether these tests are getting into CI correctly?",
        "createdAt" : "2018-09-01T22:56:43Z",
        "updatedAt" : "2018-09-01T22:56:43Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      },
      {
        "id" : "f007d802-7e18-4e05-bfe2-51a3e7a40542",
        "parentId" : "0c51be95-74f7-4016-a67c-647e7c91b7cd",
        "authorId" : "a03febe7-856e-477d-9467-a6a22b40242f",
        "body" : "From what I understand, the tests will not be run during normal CI runs triggered by pushes.\r\n\r\nThe reason for that I have chosen this is me being cautious: The tests depend on an external repository (Flathub) and on Ubuntu additionally on an external PPA (Flatpak). I am not sure how to evaluate the reliability of these resources from an automated CI perspective. I would not want to be responsible for the CI runs failing regularly because of Flathub answering slowly or the like. Not that I have experienced availability problems with Flathub or Launchpad.\r\n\r\nOf course, the tests would deliver more value when being run automatically, so if you guys think the reliability bit is fine, I would be happy to have that changed.",
        "createdAt" : "2018-09-02T07:44:13Z",
        "updatedAt" : "2018-09-02T07:44:13Z",
        "lastEditedBy" : "a03febe7-856e-477d-9467-a6a22b40242f",
        "tags" : [
        ]
      },
      {
        "id" : "d098b1c9-2007-4c83-88e7-c23f70fd46cc",
        "parentId" : "0c51be95-74f7-4016-a67c-647e7c91b7cd",
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "One way to do it is to use a local stub of the repos so that it'd hit them in CI.\r\nHere's how we implemented a fake `deb` repo for `apt` module: #37639 + #38090.\r\nSame for rpm: https://github.com/ansible/ansible/tree/devel/test/integration/targets/setup_rpm_repo\r\n\r\nI believe you could try implementing something similar for your module. Makes sense?",
        "createdAt" : "2018-09-02T11:43:36Z",
        "updatedAt" : "2018-09-02T11:43:36Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      },
      {
        "id" : "3dbd1ff9-9f1d-4475-aa6f-11efe515ae6d",
        "parentId" : "0c51be95-74f7-4016-a67c-647e7c91b7cd",
        "authorId" : "a03febe7-856e-477d-9467-a6a22b40242f",
        "body" : "Sorry for the delay, I was at a conference this week.\r\n\r\nThank you for the suggestion and the links! I agree, this would be the best way to do this. I dug into into how to set up flatpak repos, it's doable, but I will need to add some functionality to the modules to turn off some features to support the dummy repo, like gpg-checking and dependency runtime installation. This could take some time (also because I will be travelling a whole month during autumn).\r\n\r\nUnfortunately, right now we already feel the effect of not having any integration tests at all: Bugfix #44835 fixed Python 3 compatibility while breaking Python 2 compatibility. Something I now need to fix now asap.\r\nIf the current tests were available but unsupported, at least I could tell contributors how to easily run these to verify their contributions against regressions right now.\r\n\r\nDo you think it would be reasonable to merge the integration tests as unsupported right now, giving me some leeway to properly implement integration tests with a dummy repository?",
        "createdAt" : "2018-09-07T13:40:30Z",
        "updatedAt" : "2018-09-07T13:40:30Z",
        "lastEditedBy" : "a03febe7-856e-477d-9467-a6a22b40242f",
        "tags" : [
        ]
      },
      {
        "id" : "e99cb78b-a0dd-48d7-b335-e2943814bdb1",
        "parentId" : "0c51be95-74f7-4016-a67c-647e7c91b7cd",
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "I'm fine with whatever you decide. From the Core perspective, we don't care about this _too much_, because it's community-supported, but I still wanted to inform you about the options, because I know that it might be useful for you.",
        "createdAt" : "2018-09-07T15:48:37Z",
        "updatedAt" : "2018-09-07T15:48:37Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      },
      {
        "id" : "1b88f47e-e3d4-4e2e-b2d9-9ff7cfd74760",
        "parentId" : "0c51be95-74f7-4016-a67c-647e7c91b7cd",
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "@oolongbrothers I've merged this, so that it won't be hanging for undefined period of time and you could proceed with improvements whenever you have time :)",
        "createdAt" : "2018-09-07T15:50:39Z",
        "updatedAt" : "2018-09-07T15:50:40Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      },
      {
        "id" : "a7b9d418-c351-4f34-ba07-e5a17f9aa1a8",
        "parentId" : "0c51be95-74f7-4016-a67c-647e7c91b7cd",
        "authorId" : "a03febe7-856e-477d-9467-a6a22b40242f",
        "body" : "That's great. Thanks, @webknjaz !\r\n\r\nI'm indeed very thankful for your pointers towards using dummy repositories for testing. Once I get it implemented, it this will make the tests a lot faster and more reliable.\r\n\r\nCould you also please merge #42315 which contains the integration tests for the sibling module `flatpak_remote`?",
        "createdAt" : "2018-09-07T16:52:45Z",
        "updatedAt" : "2018-09-07T16:52:45Z",
        "lastEditedBy" : "a03febe7-856e-477d-9467-a6a22b40242f",
        "tags" : [
        ]
      }
    ],
    "commit" : "6dcba1ee34d223b0f5c6b11d9c89e6bf1aeca3c4",
    "line" : 1,
    "diffHunk" : "@@ -1,1 +-1,3 @@unsupported\ndestructive\nskip/freebsd"
  }
]