[
  {
    "id" : "6151caaf-19a3-4271-93a4-1f0bd8a642e4",
    "prId" : 50212,
    "prUrl" : "https://github.com/ansible/ansible/pull/50212#pullrequestreview-187497146",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d0db25f4-183d-495a-bbad-0968cafbd017",
        "parentId" : null,
        "authorId" : "380aef6a-3fbb-41ad-819b-bada96e05807",
        "body" : "CI failure in integration tests due to:\r\n\r\n> 11:18 ./runme.sh: line 51: USER: unbound variable\r\n",
        "createdAt" : "2018-12-21T07:03:02Z",
        "updatedAt" : "2019-01-09T16:21:55Z",
        "lastEditedBy" : "380aef6a-3fbb-41ad-819b-bada96e05807",
        "tags" : [
        ]
      },
      {
        "id" : "151c953c-4494-4512-a3ed-86931fc2baa1",
        "parentId" : "d0db25f4-183d-495a-bbad-0968cafbd017",
        "authorId" : "30fc1801-f8f1-4cc4-9690-e31e203f4f6d",
        "body" : "@mattclay if USER is not being set, i consider this a bug in the environment",
        "createdAt" : "2018-12-21T14:17:46Z",
        "updatedAt" : "2019-01-09T16:21:55Z",
        "lastEditedBy" : "30fc1801-f8f1-4cc4-9690-e31e203f4f6d",
        "tags" : [
        ]
      },
      {
        "id" : "1ce95917-bf73-445b-849c-ddec358784db",
        "parentId" : "d0db25f4-183d-495a-bbad-0968cafbd017",
        "authorId" : "30fc1801-f8f1-4cc4-9690-e31e203f4f6d",
        "body" : "we actually rely on it in our connection code",
        "createdAt" : "2018-12-21T14:18:22Z",
        "updatedAt" : "2019-01-09T16:21:55Z",
        "lastEditedBy" : "30fc1801-f8f1-4cc4-9690-e31e203f4f6d",
        "tags" : [
        ]
      },
      {
        "id" : "9b8c9f20-9a2e-4a6e-81bd-a4bf796b31ab",
        "parentId" : "d0db25f4-183d-495a-bbad-0968cafbd017",
        "authorId" : "380aef6a-3fbb-41ad-819b-bada96e05807",
        "body" : "Perhaps we shouldn't rely on the `USER` variable being set. It's not available in all environments. For example, it doesn't seem to be present in Docker by default:\r\n\r\n```bash\r\n$ docker run -it centos:7 env\r\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\nHOSTNAME=d817fab2e123\r\nTERM=xterm\r\nHOME=/root\r\n```\r\n\r\nSimilar results (without `USER`) occur for `fedora:29` and `ubuntu:16.04` containers, as well as when running `/bin/bash` interactively first in those containers.\r\n",
        "createdAt" : "2018-12-21T17:29:54Z",
        "updatedAt" : "2019-01-09T16:21:55Z",
        "lastEditedBy" : "380aef6a-3fbb-41ad-819b-bada96e05807",
        "tags" : [
        ]
      },
      {
        "id" : "e138b950-36e6-4992-a092-9d23082c416e",
        "parentId" : "d0db25f4-183d-495a-bbad-0968cafbd017",
        "authorId" : "30fc1801-f8f1-4cc4-9690-e31e203f4f6d",
        "body" : "i'll update test, but that still seems like there is something wrong with those environments",
        "createdAt" : "2018-12-21T18:37:34Z",
        "updatedAt" : "2019-01-09T16:21:55Z",
        "lastEditedBy" : "30fc1801-f8f1-4cc4-9690-e31e203f4f6d",
        "tags" : [
        ]
      }
    ],
    "commit" : "37159fc7b4ccdb034c62934a616dc6de532946aa",
    "line" : 46,
    "diffHunk" : "@@ -1,1 +50,54 @@PASSWORD='test'\nUSER=${USER:-'broken_docker'}\nJSON_EXTRA_ARGS='{\"docker_registries_login\": [{ \"docker_password\": \"'\"${PASSWORD}\"'\", \"docker_username\": \"'\"${USER}\"'\", \"docker_registry_url\":\"repository-manager.company.com:5001\"}], \"docker_registries_logout\": [{ \"docker_password\": \"'\"${PASSWORD}\"'\", \"docker_username\": \"'\"${USER}\"'\", \"docker_registry_url\":\"repository-manager.company.com:5001\"}] }'\n\nANSIBLE_CONFIG='' ansible-pull -d \"${pull_dir}\" -U \"${repo_dir}\" -e \"${JSON_EXTRA_ARGS}\" \"$@\" | tee \"${temp_log}\""
  }
]