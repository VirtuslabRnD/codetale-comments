[
  {
    "id" : "000f2095-b5ac-48ec-a2fc-25e26cfa74be",
    "prId" : 54576,
    "prUrl" : "https://github.com/ansible/ansible/pull/54576#pullrequestreview-220490993",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ce70a60c-d050-4f2f-9aa4-6919610a8d91",
        "parentId" : null,
        "authorId" : "4eab8c18-153b-451b-aabd-78dd41738e08",
        "body" : "As I understand from this test, the IP range is created by default to a physical network (which one?) when the 'network' parameter is undefined. Right?\r\nI'm wondering if one of the parameters `network` or `physical_network` should not be specified explicitly to avoid confusion.\r\n\r\nAny thoughts?",
        "createdAt" : "2019-03-29T09:11:25Z",
        "updatedAt" : "2019-03-29T11:45:40Z",
        "lastEditedBy" : "4eab8c18-153b-451b-aabd-78dd41738e08",
        "tags" : [
        ]
      },
      {
        "id" : "0086fcbe-744d-498b-88aa-06954b77b344",
        "parentId" : "ce70a60c-d050-4f2f-9aa4-6919610a8d91",
        "authorId" : "eb6c40cc-7ad5-4e08-a6c6-ea43d9411d80",
        "body" : "It can but it doesn't have to. This the[ CloudStack code](https://github.com/apache/cloudstack/blob/master/server/src/main/java/com/cloud/configuration/ConfigurationManagerImpl.java#L3071) that is responsible for this situation:\r\n```java\r\nif (forVirtualNetwork) {\r\n                    // default physical network with public traffic in the zone\r\n                    physicalNetworkId = _networkModel.getDefaultPhysicalNetworkByZoneAndTrafficType(zoneId, TrafficType.Public).getId();\r\n                }\r\n```\r\nIf no physical network or virtual network is specified then it will search for a Physical Network with a public traffic type.\r\n\r\nIn my implementation, I was merely using the fact that this is handled on CloudStack's end.",
        "createdAt" : "2019-03-29T09:39:22Z",
        "updatedAt" : "2019-03-29T11:45:40Z",
        "lastEditedBy" : "eb6c40cc-7ad5-4e08-a6c6-ea43d9411d80",
        "tags" : [
        ]
      },
      {
        "id" : "8b4ec6b7-8a04-4c5e-bec1-a007d4f7d79a",
        "parentId" : "ce70a60c-d050-4f2f-9aa4-6919610a8d91",
        "authorId" : "4eab8c18-153b-451b-aabd-78dd41738e08",
        "body" : "Ok, I'm fine with it. Could you please explicit this behavior in the documentation?",
        "createdAt" : "2019-03-29T10:17:31Z",
        "updatedAt" : "2019-03-29T11:45:40Z",
        "lastEditedBy" : "4eab8c18-153b-451b-aabd-78dd41738e08",
        "tags" : [
        ]
      },
      {
        "id" : "732c7e85-fa58-4c9c-80b9-2e3b2df99579",
        "parentId" : "ce70a60c-d050-4f2f-9aa4-6919610a8d91",
        "authorId" : "eb6c40cc-7ad5-4e08-a6c6-ea43d9411d80",
        "body" : "Something like this?\r\n\r\n```diff\r\ndiff --git a/lib/ansible/modules/cloud/cloudstack/cs_vlan_ip_range.py b/lib/ansible/modules/cloud/cloudstack/cs_vlan_ip_range.py\r\nindex 24b5f4a70a..967daec440 100644\r\n--- a/lib/ansible/modules/cloud/cloudstack/cs_vlan_ip_range.py\r\n+++ b/lib/ansible/modules/cloud/cloudstack/cs_vlan_ip_range.py\r\n@@ -87,6 +87,7 @@ options:\r\n   for_virtual_network:\r\n     description:\r\n       - true if VLAN is of Virtual type, false if Direct.\r\n+      - If set to C(true) but neither I(physical_network) or I(network) is set CloudStack will try to add the VLAN range to the Physical Network with a Public traffic type.\r\n     type: bool\r\n     default: false\r\n extends_documentation_fragment: cloudstack\r\n```\r\n(I figured it would be easier to verify this in the discussion than push & launch tests over a documentation line)",
        "createdAt" : "2019-03-29T10:28:51Z",
        "updatedAt" : "2019-03-29T11:45:40Z",
        "lastEditedBy" : "eb6c40cc-7ad5-4e08-a6c6-ea43d9411d80",
        "tags" : [
        ]
      },
      {
        "id" : "98399dc1-47e0-452f-8765-60b8234b7e57",
        "parentId" : "ce70a60c-d050-4f2f-9aa4-6919610a8d91",
        "authorId" : "4eab8c18-153b-451b-aabd-78dd41738e08",
        "body" : "Good! (perhaps split the line). I just realized that this behavior did not apply to direct vlan creation. If it's the case, I would suggest an additionnal line in the descption of the `network` parameter to indicate that it is required if I(for_virtual_network) and I(physical_network) are not set..",
        "createdAt" : "2019-03-29T11:08:15Z",
        "updatedAt" : "2019-03-29T11:45:40Z",
        "lastEditedBy" : "4eab8c18-153b-451b-aabd-78dd41738e08",
        "tags" : [
        ]
      },
      {
        "id" : "208624b6-8f29-48bb-a8d5-33b4835df061",
        "parentId" : "ce70a60c-d050-4f2f-9aa4-6919610a8d91",
        "authorId" : "eb6c40cc-7ad5-4e08-a6c6-ea43d9411d80",
        "body" : "Done.",
        "createdAt" : "2019-03-29T11:28:24Z",
        "updatedAt" : "2019-03-29T11:45:40Z",
        "lastEditedBy" : "eb6c40cc-7ad5-4e08-a6c6-ea43d9411d80",
        "tags" : [
        ]
      }
    ],
    "commit" : "d4eac26f2c1ae12edbe1a6865b2eae7e79b7c923",
    "line" : 35,
    "diffHunk" : "@@ -1,1 +401,405 @@    zone: \"{{ public_network.zone }}\"\n\n- name: test adding a public IP range\n  cs_vlan_ip_range:\n    end_ip: 10.0.3.250"
  }
]