[
  {
    "id" : "01007c1e-359e-4d32-bf8d-fbcf36f21e29",
    "prId" : 63770,
    "prUrl" : "https://github.com/ansible/ansible/pull/63770#pullrequestreview-306148993",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d49e359c-d3b8-4556-ade2-8832ea83715a",
        "parentId" : null,
        "authorId" : "87bf94e6-6a9f-420a-b644-aac039f6409f",
        "body" : "It would be nice to check that the state is running or pending here as well (like you do in the next start task further down).  You could even add a `wait: yes` to the previous task to validate that the waiter function does the right thing, and then only assert on `running`.",
        "createdAt" : "2019-10-22T21:04:59Z",
        "updatedAt" : "2019-11-15T01:50:03Z",
        "lastEditedBy" : "87bf94e6-6a9f-420a-b644-aac039f6409f",
        "tags" : [
        ]
      },
      {
        "id" : "02c17ffe-a579-4fff-94f3-6d0865f33995",
        "parentId" : "d49e359c-d3b8-4556-ade2-8832ea83715a",
        "authorId" : "8f8ddfeb-347a-4231-bc82-79d362fd33a9",
        "body" : "okay, I will add the `wait: yes`. ðŸ‘ ",
        "createdAt" : "2019-10-22T21:23:22Z",
        "updatedAt" : "2019-11-15T01:50:03Z",
        "lastEditedBy" : "8f8ddfeb-347a-4231-bc82-79d362fd33a9",
        "tags" : [
        ]
      },
      {
        "id" : "a9d959b5-fce5-4a98-9698-d22889b42304",
        "parentId" : "d49e359c-d3b8-4556-ade2-8832ea83715a",
        "authorId" : "8f8ddfeb-347a-4231-bc82-79d362fd33a9",
        "body" : "I don't think the `wait` option is working as one would expect. The `wait` option defaults to `yes` for this module. I ran a task to create instance with `wait: yes`, but the module returned with `state=pending`.\r\nLooking at the [code](https://github.com/ansible/ansible/blob/devel/lib/ansible/modules/cloud/amazon/lightsail.py#L316), wait is being used to let the instance come out of a transient state (pending, stopping).  The `create_instance` function is not looking at `wait` at all.",
        "createdAt" : "2019-10-23T01:53:25Z",
        "updatedAt" : "2019-11-15T01:50:03Z",
        "lastEditedBy" : "8f8ddfeb-347a-4231-bc82-79d362fd33a9",
        "tags" : [
        ]
      },
      {
        "id" : "25afdb49-8693-43f0-81ae-023ff1423f14",
        "parentId" : "d49e359c-d3b8-4556-ade2-8832ea83715a",
        "authorId" : "8f8ddfeb-347a-4231-bc82-79d362fd33a9",
        "body" : "So should I add a failing test or should I add it and comment it out for now?",
        "createdAt" : "2019-10-23T01:54:08Z",
        "updatedAt" : "2019-11-15T01:50:03Z",
        "lastEditedBy" : "8f8ddfeb-347a-4231-bc82-79d362fd33a9",
        "tags" : [
        ]
      },
      {
        "id" : "dd981822-ea12-4535-a802-98752247c6a6",
        "parentId" : "d49e359c-d3b8-4556-ade2-8832ea83715a",
        "authorId" : "8f8ddfeb-347a-4231-bc82-79d362fd33a9",
        "body" : "The description for the `wait` option in the module documentation is also incorrect. It says -\r\n\r\n> Wait for the instance to be in state 'running' before returning. If wait is \"no\" an ip_address may not be returned\r\n\r\nBut that is not the case. I ran a task to create instance and it returned this as the state -\r\n`        \"state\": {\r\n            \"code\": 0,\r\n            \"name\": \"pending\"\r\n        },\r\n`",
        "createdAt" : "2019-10-23T02:16:17Z",
        "updatedAt" : "2019-11-15T01:50:03Z",
        "lastEditedBy" : "8f8ddfeb-347a-4231-bc82-79d362fd33a9",
        "tags" : [
        ]
      },
      {
        "id" : "a96ffd93-c16c-444d-b430-358cf9dca6ec",
        "parentId" : "d49e359c-d3b8-4556-ade2-8832ea83715a",
        "authorId" : "87bf94e6-6a9f-420a-b644-aac039f6409f",
        "body" : "Ah apologies, I naively trusted the module docs.  For now let's just assert that the instance is in ['pending', 'running'].  I've opened #63869 about the lack of wait support for create actions.",
        "createdAt" : "2019-10-23T16:32:41Z",
        "updatedAt" : "2019-11-15T01:50:03Z",
        "lastEditedBy" : "87bf94e6-6a9f-420a-b644-aac039f6409f",
        "tags" : [
        ]
      },
      {
        "id" : "28d0d44f-7802-4b85-9c48-f488e025677a",
        "parentId" : "d49e359c-d3b8-4556-ade2-8832ea83715a",
        "authorId" : "8f8ddfeb-347a-4231-bc82-79d362fd33a9",
        "body" : "I have added the test case to check the instance state is in ['pending', 'running'].\r\n\r\n",
        "createdAt" : "2019-10-23T19:53:29Z",
        "updatedAt" : "2019-11-15T01:50:03Z",
        "lastEditedBy" : "8f8ddfeb-347a-4231-bc82-79d362fd33a9",
        "tags" : [
        ]
      }
    ],
    "commit" : "19873cfe1cddab77880bb32412cc5ebb6a539d90",
    "line" : 54,
    "diffHunk" : "@@ -1,1 +52,56 @@    - assert:\n        that:\n          - result.changed == False\n\n    - name: Stop the instance"
  }
]