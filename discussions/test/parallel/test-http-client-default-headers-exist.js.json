[
  {
    "id" : "86e0b5b9-2e12-43af-827a-a6dbf75474d1",
    "prId" : 32493,
    "prUrl" : "https://github.com/nodejs/node/pull/32493#pullrequestreview-382495439",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "31a38860-f5e7-45a3-be01-b3bfa4162dee",
        "parentId" : null,
        "authorId" : "d10ccdef-08de-4320-917e-16a9175dedcf",
        "body" : "It's not an issue with this particular test, but keep in mind that changing all of these to use Promises is changing the timing of these tests... rather than executing the countdown cleanup logic synchronously it is being deferred to the microtask queue. That could end up causing the test to miss issues that may exist when closing things down synchronously so worth watching... also, keep [this issue](https://github.com/nodejs/node/issues/32431) in mind also when refactoring these :-) .. as I said, not an issue on this particular test but there are some where it may be relevant.",
        "createdAt" : "2020-03-26T13:22:54Z",
        "updatedAt" : "2020-03-27T23:59:24Z",
        "lastEditedBy" : "d10ccdef-08de-4320-917e-16a9175dedcf",
        "tags" : [
        ]
      },
      {
        "id" : "6f372fd5-c363-4fb9-8fe4-bd928ce36fa4",
        "parentId" : "31a38860-f5e7-45a3-be01-b3bfa4162dee",
        "authorId" : "84392f84-0848-409d-9e1e-0627d211cf90",
        "body" : "I want to make sure I understand your point about the cleanup code and the microtask queue. Are you saying that with `countdown`, the callback that checks things executes synchronously whenever the pertinent `.dec()` call happens, whereas with Promise.all(), it is whenever the microtask queue runs the resolve callback in the `.then()` call, so it might execute at a different time and with things in a different state than `countdown`?\r\n\r\nIf so: That's something I hadn't considered and worth watching out for. Thanks for pointing it out! (And thanks for making me take a few minutes to re-learn about the microtask queue, which is something I almost never think about!)",
        "createdAt" : "2020-03-26T23:47:55Z",
        "updatedAt" : "2020-03-27T23:59:24Z",
        "lastEditedBy" : "84392f84-0848-409d-9e1e-0627d211cf90",
        "tags" : [
        ]
      }
    ],
    "commit" : "436c71db6656b6b48b8a3771c382d093c79e4d1a",
    "line" : 43,
    "diffHunk" : "@@ -1,1 +61,65 @@\nserver.listen(0, common.mustCall(() => {\n  Promise.all(expectedMethods.map(async (method) => {\n    const request = http.request({\n      method: method,"
  }
]