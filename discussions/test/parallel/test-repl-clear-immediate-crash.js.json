[
  {
    "id" : "a71d6d84-78ae-4e29-ba2f-4b5cf35ab645",
    "prId" : 37824,
    "prUrl" : "https://github.com/nodejs/node/pull/37824#pullrequestreview-616875188",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8f045838-e813-4f57-853e-83e6b68d2cd8",
        "parentId" : null,
        "authorId" : "4e9ef6b4-9a31-4818-a54f-a2b732308657",
        "body" : "This test is not really required, since it was just caused by the crash but it does not hurt either.",
        "createdAt" : "2021-03-20T02:14:54Z",
        "updatedAt" : "2021-03-28T17:21:30Z",
        "lastEditedBy" : "4e9ef6b4-9a31-4818-a54f-a2b732308657",
        "tags" : [
        ]
      },
      {
        "id" : "d2a6ef0f-9c08-4546-8593-122abf1736d9",
        "parentId" : "8f045838-e813-4f57-853e-83e6b68d2cd8",
        "authorId" : "af81501b-2414-48e7-be86-74427773dffa",
        "body" : "The issue, I think, was a bit different (if by \"the crash\" you mean that NRE for this._idleNext). The REPL crash was caused because an `undefined` `async_id` was given to `emitDestroy`, and this caused an error in `emitDestroyScript` (as the check there only checks `<= 0` and undefined is not `<= 0`).",
        "createdAt" : "2021-03-20T02:19:23Z",
        "updatedAt" : "2021-03-28T17:21:30Z",
        "lastEditedBy" : "af81501b-2414-48e7-be86-74427773dffa",
        "tags" : [
        ]
      },
      {
        "id" : "08f06fa3-576b-49a1-8e74-60e7cb396dfc",
        "parentId" : "8f045838-e813-4f57-853e-83e6b68d2cd8",
        "authorId" : "af81501b-2414-48e7-be86-74427773dffa",
        "body" : "Maybe a better fix would've been to actually change the code there (in `async_hooks.js`) to check for `hasHooks(kDestroy) && asyncId > 0` instead of an early return - but that's probably out of scope for this minor issue, and maybe a crash there is better than \"swallowing\" bad async_ids which might cover errors elsewhere.",
        "createdAt" : "2021-03-20T02:25:37Z",
        "updatedAt" : "2021-03-28T17:21:30Z",
        "lastEditedBy" : "af81501b-2414-48e7-be86-74427773dffa",
        "tags" : [
        ]
      }
    ],
    "commit" : "fcc934f3d011928b89bd731b53b1a0ca54a80788",
    "line" : 12,
    "diffHunk" : "@@ -1,1 +10,14 @@  assert.strictEqual(code, 0);\n}));\nproc.stdin.write('clearImmediate({});\\n.exit\\n');"
  }
]