[
  {
    "id" : "e07d5d1a-a0fa-4511-aa22-715455e4e4f7",
    "prId" : 89771,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/89771#pullrequestreview-387542340",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "4a898cce-4afd-467a-abd4-90fc93e191b6",
        "parentId" : null,
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "can't deployment be nil?",
        "createdAt" : "2020-04-02T15:12:39Z",
        "updatedAt" : "2020-04-07T12:37:18Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "89c337b1-98f3-4fed-9cb0-3c64cc4e3d6e",
        "parentId" : "4a898cce-4afd-467a-abd4-90fc93e191b6",
        "authorId" : "bd04f755-e62f-45fb-8771-4cc2b5db49d4",
        "body" : "i can add that check as well. ",
        "createdAt" : "2020-04-03T19:57:52Z",
        "updatedAt" : "2020-04-07T12:37:18Z",
        "lastEditedBy" : "bd04f755-e62f-45fb-8771-4cc2b5db49d4",
        "tags" : [
        ]
      }
    ],
    "commit" : "f7e762139592555bd17f6aaa64ba31b38f702853",
    "line" : 17,
    "diffHunk" : "@@ -1,1 +205,209 @@\t\t}\n\t\tdeploymentImage := \"\"\n\t\tif len(deployment.Spec.Template.Spec.Containers) > 0 {\n\t\t\tdeploymentImage = deployment.Spec.Template.Spec.Containers[0].Image\n\t\t}"
  },
  {
    "id" : "3430a71d-067d-43db-8abc-a4e91db2b842",
    "prId" : 89771,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/89771#pullrequestreview-389234602",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a8612bc6-daea-4490-8ef2-a1f4c5380dcb",
        "parentId" : null,
        "authorId" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "body" : "the deployment == nil check should be before the err != nil\r\n\r\n```\r\n...\r\nif newRS == nil {\r\n\treturn fmt.Errorf(\"deployment %q failed to create new replica set\", deploymentName)\r\n}\r\nif deployment == nil {\r\n\treturn fmt.Errorf(\"could not get deployment %q\", deploymentName)\r\n}\r\nif err != nil {\r\n...\r\n```\r\n\r\nanother improvement would be to expose the underlying error from the poll.\r\n",
        "createdAt" : "2020-04-03T20:17:57Z",
        "updatedAt" : "2020-04-07T12:37:18Z",
        "lastEditedBy" : "2ce2b44c-9841-49e7-983e-fb7696974908",
        "tags" : [
        ]
      },
      {
        "id" : "d7ecfe24-daf6-4136-b9f6-32d1dbe15aea",
        "parentId" : "a8612bc6-daea-4490-8ef2-a1f4c5380dcb",
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "newRS.Name is still accessed directly and could NPE",
        "createdAt" : "2020-04-03T20:38:31Z",
        "updatedAt" : "2020-04-07T12:37:18Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "578fb59d-848f-477c-963b-9d426d77d76c",
        "parentId" : "a8612bc6-daea-4490-8ef2-a1f4c5380dcb",
        "authorId" : "bd04f755-e62f-45fb-8771-4cc2b5db49d4",
        "body" : "fixed.",
        "createdAt" : "2020-04-07T12:37:29Z",
        "updatedAt" : "2020-04-07T12:37:29Z",
        "lastEditedBy" : "bd04f755-e62f-45fb-8771-4cc2b5db49d4",
        "tags" : [
        ]
      },
      {
        "id" : "29ae9733-4549-4bf6-8429-10165088d44a",
        "parentId" : "a8612bc6-daea-4490-8ef2-a1f4c5380dcb",
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "are you sure? I still see it here:\r\n\r\nreturn fmt.Errorf(\"error waiting for deployment %q (got %s / %s) and new replica set %q (got %s / %s) revision and image to match expectation (expected %s / %s): %v\", deploymentName, deployment.Annotations[deploymentutil.RevisionAnnotation], deploymentImage, **newRS.Name**, newRS.Annotations[deploymentutil.RevisionAnnotation], newRSImage, revision, image, err)",
        "createdAt" : "2020-04-07T14:13:42Z",
        "updatedAt" : "2020-04-07T14:13:42Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      },
      {
        "id" : "2aac0638-478c-40d6-9c8b-e3045a925022",
        "parentId" : "a8612bc6-daea-4490-8ef2-a1f4c5380dcb",
        "authorId" : "bd04f755-e62f-45fb-8771-4cc2b5db49d4",
        "body" : "@liggitt we bail out in line 199 i think `newRS == nil`",
        "createdAt" : "2020-04-07T14:36:26Z",
        "updatedAt" : "2020-04-07T14:36:26Z",
        "lastEditedBy" : "bd04f755-e62f-45fb-8771-4cc2b5db49d4",
        "tags" : [
        ]
      },
      {
        "id" : "cff4d754-2445-4394-a898-30cd5cfa44c3",
        "parentId" : "a8612bc6-daea-4490-8ef2-a1f4c5380dcb",
        "authorId" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "body" : "ah, got it",
        "createdAt" : "2020-04-07T15:30:35Z",
        "updatedAt" : "2020-04-07T15:30:35Z",
        "lastEditedBy" : "8be927c4-cfb4-4077-b355-f4f3d84849b8",
        "tags" : [
        ]
      }
    ],
    "commit" : "f7e762139592555bd17f6aaa64ba31b38f702853",
    "line" : 24,
    "diffHunk" : "@@ -1,1 +212,216 @@\t\t\tnewRSImage = newRS.Spec.Template.Spec.Containers[0].Image\n\t\t}\n\t\treturn fmt.Errorf(\"error waiting for deployment %q (got %s / %s) and new replica set %q (got %s / %s) revision and image to match expectation (expected %s / %s): %v\", deploymentName, deployment.Annotations[deploymentutil.RevisionAnnotation], deploymentImage, newRS.Name, newRS.Annotations[deploymentutil.RevisionAnnotation], newRSImage, revision, image, err)\n\t}\n\treturn nil"
  }
]