[
  {
    "id" : "1219c07c-fe57-479d-968b-398223978b5f",
    "prId" : 72497,
    "prUrl" : "https://github.com/ansible/ansible/pull/72497#pullrequestreview-589800416",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "10779cda-d0be-4778-a811-71c4920ffff7",
        "parentId" : null,
        "authorId" : "380aef6a-3fbb-41ad-819b-bada96e05807",
        "body" : "Why is this needed?",
        "createdAt" : "2021-02-12T17:42:49Z",
        "updatedAt" : "2021-02-12T21:10:18Z",
        "lastEditedBy" : "380aef6a-3fbb-41ad-819b-bada96e05807",
        "tags" : [
        ]
      },
      {
        "id" : "64177b1c-2d4c-44ef-b8ca-f2214714a5bc",
        "parentId" : "10779cda-d0be-4778-a811-71c4920ffff7",
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "The plugin loader inserts itself at the beginning of `sys.meta_path`, which causes the importer test to report `report_message(path, 0, 0, 'metapath', 'changes to sys.meta_path[0] are not permitted', messages)` (three lines below). The `_remove()` call makes the collection loader clean up (and remove itself from `sys.meta_path`).",
        "createdAt" : "2021-02-12T19:49:29Z",
        "updatedAt" : "2021-02-12T21:10:18Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      },
      {
        "id" : "e95c5261-f60a-4b9c-998c-3f9d53ce83ad",
        "parentId" : "10779cda-d0be-4778-a811-71c4920ffff7",
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "Without the above, the following will happen:\r\n```\r\nERROR: lib/ansible/plugins/action/__init__.py:0:0: metapath: changes to sys.meta_path[0] are not permitted\r\nERROR: lib/ansible/plugins/action/add_host.py:0:0: traceback: ValueError: unable to locate collection ansible.builtin (at lib/ansible/utils/collection_loader/_collection_finder.py:1054:0)\r\nERROR: lib/ansible/plugins/action/assemble.py:0:0: traceback: ValueError: unable to locate collection ansible.builtin (at lib/ansible/utils/collection_loader/_collection_finder.py:1054:0)\r\nERROR: lib/ansible/plugins/action/assert.py:0:0: traceback: ValueError: unable to locate collection ansible.builtin (at lib/ansible/utils/collection_loader/_collection_finder.py:1054:0)\r\nERROR: lib/ansible/plugins/action/async_status.py:0:0: traceback: ValueError: unable to locate collection ansible.builtin (at lib/ansible/utils/collection_loader/_collection_finder.py:1054:0)\r\nERROR: lib/ansible/plugins/action/command.py:0:0: traceback: ValueError: unable to locate collection ansible.builtin (at lib/ansible/utils/collection_loader/_collection_finder.py:1054:0)\r\nERROR: lib/ansible/plugins/action/copy.py:0:0: traceback: ValueError: unable to locate collection ansible.builtin (at lib/ansible/utils/collection_loader/_collection_finder.py:1054:0)\r\n```\r\n(repeats for every file processed afterwards)",
        "createdAt" : "2021-02-12T20:06:14Z",
        "updatedAt" : "2021-02-12T21:10:18Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      }
    ],
    "commit" : "9fb8a8176b73a16c3a440d35e343c7e08fc62704",
    "line" : 135,
    "diffHunk" : "@@ -1,1 +428,432 @@                from ansible.utils.collection_loader._collection_finder import _AnsibleCollectionFinder\n                _AnsibleCollectionFinder._remove()  # pylint: disable=protected-access\n\n            if sys.meta_path[0] != restricted_loader:\n                report_message(path, 0, 0, 'metapath', 'changes to sys.meta_path[0] are not permitted', messages)"
  },
  {
    "id" : "517fe898-3dea-49d3-b7c1-82d01734da39",
    "prId" : 74608,
    "prUrl" : "https://github.com/ansible/ansible/pull/74608#pullrequestreview-654601413",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a01682df-d4c5-4b4c-a365-88c2dc7d1d04",
        "parentId" : null,
        "authorId" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "body" : "nit: I'd also narrow this down with a module name where this is allowed to happen + exception type",
        "createdAt" : "2021-05-07T15:24:45Z",
        "updatedAt" : "2021-05-07T15:24:45Z",
        "lastEditedBy" : "4ffac6b8-d7eb-449a-8c43-463d9fd5587a",
        "tags" : [
        ]
      }
    ],
    "commit" : "574c810dc10564a75e58cd99c22c36b3efec3cf8",
    "line" : 27,
    "diffHunk" : "@@ -1,1 +498,502 @@                warnings.filterwarnings(\n                    \"ignore\",\n                    r\"main\\.<locals>\\.RestrictedModuleLoader\\.find_spec\\(\\) not found; falling back to find_module\\(\\)\",\n                )\n"
  },
  {
    "id" : "db796a41-937c-40ad-99a4-7c12271363da",
    "prId" : 74644,
    "prUrl" : "https://github.com/ansible/ansible/pull/74644#pullrequestreview-655979145",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9c7012f9-9604-4c89-9350-ab69464e9ec3",
        "parentId" : null,
        "authorId" : "4b69a0b5-ac6f-45e9-9507-dd1385182f29",
        "body" : "I cannot remove this filter currently, since `packaging.tags` imports `distutils.util`.  The call order is:\r\n\r\n`ansible.plugins.loader` -> `packaging.specifiers` -> `packaging.utils` -> `packaging.tags` -> `distutils.util`\r\n\r\nPackaging removed use of `distutils.util` in https://github.com/pypa/packaging/commit/c8008265eac83ebf2c3b3c314a682abd4c101de2 and no release contains this change yet.\r\n\r\nWe may need to wait even longer, since there are many deps we don't control that could surface this warning in collections as well.",
        "createdAt" : "2021-05-10T18:44:27Z",
        "updatedAt" : "2021-05-11T13:54:18Z",
        "lastEditedBy" : "4b69a0b5-ac6f-45e9-9507-dd1385182f29",
        "tags" : [
        ]
      },
      {
        "id" : "6e16ce85-58c3-4d17-b396-1649e002bd18",
        "parentId" : "9c7012f9-9604-4c89-9350-ab69464e9ec3",
        "authorId" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "body" : "I was literally about to paste a link to that commit here. Jinx!",
        "createdAt" : "2021-05-10T18:45:17Z",
        "updatedAt" : "2021-05-11T13:54:18Z",
        "lastEditedBy" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "tags" : [
        ]
      },
      {
        "id" : "28a05017-0c00-482d-9d16-387de924ade0",
        "parentId" : "9c7012f9-9604-4c89-9350-ab69464e9ec3",
        "authorId" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "body" : "> We may need to wait even longer, since there are many deps we don't control that could surface this warning in collections as well.\r\n\r\nI was going to look at our other deps to see if they have similar problems. Maybe we'll get lucky.",
        "createdAt" : "2021-05-10T18:46:40Z",
        "updatedAt" : "2021-05-11T13:54:18Z",
        "lastEditedBy" : "2f8132dc-12f8-44dc-8b97-1cf4c1616b68",
        "tags" : [
        ]
      }
    ],
    "commit" : "5cdc347986e83427c4040e6228f49f63c7014275",
    "line" : 7,
    "diffHunk" : "@@ -1,1 +536,540 @@                # The warning text is: The distutils package is deprecated and slated for removal in Python 3.12.\n                # Use setuptools or check PEP 632 for potential alternatives\n                warnings.filterwarnings(\n                    \"ignore\",\n                    r\"The distutils package is deprecated and slated for removal in Python 3\\.12\\. .*\","
  }
]