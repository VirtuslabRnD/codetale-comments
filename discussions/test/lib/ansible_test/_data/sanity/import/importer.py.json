[
  {
    "id" : "1219c07c-fe57-479d-968b-398223978b5f",
    "prId" : 72497,
    "prUrl" : "https://github.com/ansible/ansible/pull/72497#pullrequestreview-589800416",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "10779cda-d0be-4778-a811-71c4920ffff7",
        "parentId" : null,
        "authorId" : "380aef6a-3fbb-41ad-819b-bada96e05807",
        "body" : "Why is this needed?",
        "createdAt" : "2021-02-12T17:42:49Z",
        "updatedAt" : "2021-02-12T21:10:18Z",
        "lastEditedBy" : "380aef6a-3fbb-41ad-819b-bada96e05807",
        "tags" : [
        ]
      },
      {
        "id" : "64177b1c-2d4c-44ef-b8ca-f2214714a5bc",
        "parentId" : "10779cda-d0be-4778-a811-71c4920ffff7",
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "The plugin loader inserts itself at the beginning of `sys.meta_path`, which causes the importer test to report `report_message(path, 0, 0, 'metapath', 'changes to sys.meta_path[0] are not permitted', messages)` (three lines below). The `_remove()` call makes the collection loader clean up (and remove itself from `sys.meta_path`).",
        "createdAt" : "2021-02-12T19:49:29Z",
        "updatedAt" : "2021-02-12T21:10:18Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      },
      {
        "id" : "e95c5261-f60a-4b9c-998c-3f9d53ce83ad",
        "parentId" : "10779cda-d0be-4778-a811-71c4920ffff7",
        "authorId" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "body" : "Without the above, the following will happen:\r\n```\r\nERROR: lib/ansible/plugins/action/__init__.py:0:0: metapath: changes to sys.meta_path[0] are not permitted\r\nERROR: lib/ansible/plugins/action/add_host.py:0:0: traceback: ValueError: unable to locate collection ansible.builtin (at lib/ansible/utils/collection_loader/_collection_finder.py:1054:0)\r\nERROR: lib/ansible/plugins/action/assemble.py:0:0: traceback: ValueError: unable to locate collection ansible.builtin (at lib/ansible/utils/collection_loader/_collection_finder.py:1054:0)\r\nERROR: lib/ansible/plugins/action/assert.py:0:0: traceback: ValueError: unable to locate collection ansible.builtin (at lib/ansible/utils/collection_loader/_collection_finder.py:1054:0)\r\nERROR: lib/ansible/plugins/action/async_status.py:0:0: traceback: ValueError: unable to locate collection ansible.builtin (at lib/ansible/utils/collection_loader/_collection_finder.py:1054:0)\r\nERROR: lib/ansible/plugins/action/command.py:0:0: traceback: ValueError: unable to locate collection ansible.builtin (at lib/ansible/utils/collection_loader/_collection_finder.py:1054:0)\r\nERROR: lib/ansible/plugins/action/copy.py:0:0: traceback: ValueError: unable to locate collection ansible.builtin (at lib/ansible/utils/collection_loader/_collection_finder.py:1054:0)\r\n```\r\n(repeats for every file processed afterwards)",
        "createdAt" : "2021-02-12T20:06:14Z",
        "updatedAt" : "2021-02-12T21:10:18Z",
        "lastEditedBy" : "d10c46ef-3d4c-4766-bd09-d27ec4674a84",
        "tags" : [
        ]
      }
    ],
    "commit" : "9fb8a8176b73a16c3a440d35e343c7e08fc62704",
    "line" : 135,
    "diffHunk" : "@@ -1,1 +428,432 @@                from ansible.utils.collection_loader._collection_finder import _AnsibleCollectionFinder\n                _AnsibleCollectionFinder._remove()  # pylint: disable=protected-access\n\n            if sys.meta_path[0] != restricted_loader:\n                report_message(path, 0, 0, 'metapath', 'changes to sys.meta_path[0] are not permitted', messages)"
  }
]