[
  {
    "id" : "f89a46fb-b408-48ab-a775-c4e7650b7e45",
    "prId" : 10271,
    "prUrl" : "https://github.com/apache/kafka/pull/10271#pullrequestreview-649547514",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7768f0da-55d2-4791-b9e9-7eda794cc001",
        "parentId" : null,
        "authorId" : "b4f52e78-c19e-46b4-b486-6da86e32e687",
        "body" : "Does this class have unit test coverage?",
        "createdAt" : "2021-04-28T08:43:21Z",
        "updatedAt" : "2021-05-04T04:53:22Z",
        "lastEditedBy" : "b4f52e78-c19e-46b4-b486-6da86e32e687",
        "tags" : [
        ]
      },
      {
        "id" : "bb6afb4d-e0c8-41c1-90b7-cf02f58a32e5",
        "parentId" : "7768f0da-55d2-4791-b9e9-7eda794cc001",
        "authorId" : "403b8bdd-d152-4255-86a7-0bdb3d2b40a5",
        "body" : "They were indirectly covered through `RemoteLogMetadataSerdeTest` but I added individual unit tests in the latest commit https://github.com/apache/kafka/pull/10271/commits/46e0597f17e03ac751dc320e0401ae50213bf8e0",
        "createdAt" : "2021-04-30T10:18:52Z",
        "updatedAt" : "2021-05-04T04:53:22Z",
        "lastEditedBy" : "403b8bdd-d152-4255-86a7-0bdb3d2b40a5",
        "tags" : [
        ]
      },
      {
        "id" : "29f8d107-1fce-4f1c-a64f-94110102cb69",
        "parentId" : "7768f0da-55d2-4791-b9e9-7eda794cc001",
        "authorId" : "b4f52e78-c19e-46b4-b486-6da86e32e687",
        "body" : "Sounds good, I'll take a look.",
        "createdAt" : "2021-04-30T19:18:35Z",
        "updatedAt" : "2021-05-04T04:53:22Z",
        "lastEditedBy" : "b4f52e78-c19e-46b4-b486-6da86e32e687",
        "tags" : [
        ]
      }
    ],
    "commit" : "b39e10877ba10d6805e6ba3a9b94e636eaa1777b",
    "line" : 33,
    "diffHunk" : "@@ -1,1 +31,35 @@import java.util.stream.Collectors;\n\npublic class RemoteLogSegmentMetadataTransform implements RemoteLogMetadataTransform<RemoteLogSegmentMetadata> {\n\n    public ApiMessageAndVersion toApiMessageAndVersion(RemoteLogSegmentMetadata segmentMetadata) {"
  },
  {
    "id" : "cfca694d-8a88-42f1-9bcd-7d90cb80fd5f",
    "prId" : 10271,
    "prUrl" : "https://github.com/apache/kafka/pull/10271#pullrequestreview-648503350",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6ccc30a4-731d-4896-af28-600b227cb607",
        "parentId" : null,
        "authorId" : "b4f52e78-c19e-46b4-b486-6da86e32e687",
        "body" : "Instead of introducing this separate class, why not have `RemoteLogSegmentMetadata` implement the `RemoteLogMetadataTransform< RemoteLogSegmentMetadata>` interface directly? ",
        "createdAt" : "2021-04-28T22:23:39Z",
        "updatedAt" : "2021-05-04T04:53:22Z",
        "lastEditedBy" : "b4f52e78-c19e-46b4-b486-6da86e32e687",
        "tags" : [
        ]
      },
      {
        "id" : "ea179a5b-ad67-416c-93aa-f9959e040864",
        "parentId" : "6ccc30a4-731d-4896-af28-600b227cb607",
        "authorId" : "403b8bdd-d152-4255-86a7-0bdb3d2b40a5",
        "body" : "`RemoteLogSegmentMetadata` is a public API and we do not want to add any specific serialization implementation details into that. ",
        "createdAt" : "2021-04-29T06:32:29Z",
        "updatedAt" : "2021-05-04T04:53:22Z",
        "lastEditedBy" : "403b8bdd-d152-4255-86a7-0bdb3d2b40a5",
        "tags" : [
        ]
      },
      {
        "id" : "12301f2c-7fcd-4d58-9ae6-a85a78b4747c",
        "parentId" : "6ccc30a4-731d-4896-af28-600b227cb607",
        "authorId" : "b4f52e78-c19e-46b4-b486-6da86e32e687",
        "body" : "@satishd interesting, so are you saying `RemoteLogSegmentMetadata` being public means it could be used outside the Broker binary? If so, where?",
        "createdAt" : "2021-04-29T07:07:58Z",
        "updatedAt" : "2021-05-04T04:53:22Z",
        "lastEditedBy" : "b4f52e78-c19e-46b4-b486-6da86e32e687",
        "tags" : [
        ]
      },
      {
        "id" : "980154da-b415-4e9c-8855-1c87d21d46bf",
        "parentId" : "6ccc30a4-731d-4896-af28-600b227cb607",
        "authorId" : "442b5138-0781-4001-8ac5-0593f2136d1c",
        "body" : "I think what Satish means is that `RemoteLogSegmentMetadata` will be used in any remote storage plugin implementation. So, we want to be a bit careful about the public methods exposed there. Public facing methods are harder to evolve and we don't want to expose unnecessary public methods.",
        "createdAt" : "2021-04-29T17:30:16Z",
        "updatedAt" : "2021-05-04T04:53:22Z",
        "lastEditedBy" : "442b5138-0781-4001-8ac5-0593f2136d1c",
        "tags" : [
        ]
      },
      {
        "id" : "39c69abe-3efe-4525-b734-edb449e89ef7",
        "parentId" : "6ccc30a4-731d-4896-af28-600b227cb607",
        "authorId" : "b4f52e78-c19e-46b4-b486-6da86e32e687",
        "body" : "Sounds good.",
        "createdAt" : "2021-04-29T18:04:21Z",
        "updatedAt" : "2021-05-04T04:53:22Z",
        "lastEditedBy" : "b4f52e78-c19e-46b4-b486-6da86e32e687",
        "tags" : [
        ]
      }
    ],
    "commit" : "b39e10877ba10d6805e6ba3a9b94e636eaa1777b",
    "line" : 33,
    "diffHunk" : "@@ -1,1 +31,35 @@import java.util.stream.Collectors;\n\npublic class RemoteLogSegmentMetadataTransform implements RemoteLogMetadataTransform<RemoteLogSegmentMetadata> {\n\n    public ApiMessageAndVersion toApiMessageAndVersion(RemoteLogSegmentMetadata segmentMetadata) {"
  },
  {
    "id" : "2ad25180-d474-4e78-a2d1-b6ef96644aa0",
    "prId" : 10271,
    "prUrl" : "https://github.com/apache/kafka/pull/10271#pullrequestreview-651976246",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ee02c108-4451-4cb1-bc87-e951f8bf93ef",
        "parentId" : null,
        "authorId" : "b4f52e78-c19e-46b4-b486-6da86e32e687",
        "body" : "Maybe I'm missing something, but there seems to be a `RemoteLogSegmentMetadata` constructor overload that also allows you to pass the `RemoteLogSegmentState` as one of the parameters: https://github.com/apache/kafka/blob/trunk/storage/api/src/main/java/org/apache/kafka/server/log/remote/storage/RemoteLogSegmentMetadata.java#L99\r\n\r\nIf we use the overloaded version, do we still need to apply the `RemoteLogSegmentMetadataUpdate` here?",
        "createdAt" : "2021-05-03T23:14:03Z",
        "updatedAt" : "2021-05-04T04:53:22Z",
        "lastEditedBy" : "b4f52e78-c19e-46b4-b486-6da86e32e687",
        "tags" : [
        ]
      },
      {
        "id" : "283ce529-c6c4-4db1-aca8-f3d962e4b148",
        "parentId" : "ee02c108-4451-4cb1-bc87-e951f8bf93ef",
        "authorId" : "403b8bdd-d152-4255-86a7-0bdb3d2b40a5",
        "body" : "That constructor is kept private and wanted to control what fields can be changed on the existing instance with `RemoteLogSegmentMetadataUpdate`.",
        "createdAt" : "2021-05-04T04:59:28Z",
        "updatedAt" : "2021-05-04T04:59:29Z",
        "lastEditedBy" : "403b8bdd-d152-4255-86a7-0bdb3d2b40a5",
        "tags" : [
        ]
      },
      {
        "id" : "327f0163-478b-4f01-8db3-a29bf0f4ba8a",
        "parentId" : "ee02c108-4451-4cb1-bc87-e951f8bf93ef",
        "authorId" : "b4f52e78-c19e-46b4-b486-6da86e32e687",
        "body" : "Makes sense.",
        "createdAt" : "2021-05-05T06:55:03Z",
        "updatedAt" : "2021-05-05T06:55:04Z",
        "lastEditedBy" : "b4f52e78-c19e-46b4-b486-6da86e32e687",
        "tags" : [
        ]
      }
    ],
    "commit" : "b39e10877ba10d6805e6ba3a9b94e636eaa1777b",
    "line" : 83,
    "diffHunk" : "@@ -1,1 +81,85 @@                                             record.eventTimestampMs(), record.segmentSizeInBytes(),\n                                             segmentLeaderEpochs);\n        RemoteLogSegmentMetadataUpdate rlsmUpdate\n                = new RemoteLogSegmentMetadataUpdate(remoteLogSegmentId, record.eventTimestampMs(),\n                                                     RemoteLogSegmentState.forId(record.remoteLogSegmentState()),"
  }
]