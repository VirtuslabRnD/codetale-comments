[
  {
    "id" : "af955a8c-645f-42d3-a6f7-b01f6ac94386",
    "prId" : 34376,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/34376#pullrequestreview-3579162",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "cade6ed6-5b10-458e-9621-4e77aa899bdc",
        "parentId" : null,
        "authorId" : "6e2b5eda-1533-4798-a56c-432faaf38480",
        "body" : "Is this really a critical problem?  If supporting more log drivers in docker is important, we can always support that.\n",
        "createdAt" : "2016-10-08T14:27:37Z",
        "updatedAt" : "2016-11-21T23:42:00Z",
        "lastEditedBy" : "6e2b5eda-1533-4798-a56c-432faaf38480",
        "tags" : [
        ]
      },
      {
        "id" : "590f73ec-693a-46c7-aeb6-e9540a50a547",
        "parentId" : "cade6ed6-5b10-458e-9621-4e77aa899bdc",
        "authorId" : "1bd2d65a-7c93-4c22-b408-c7794d037dc5",
        "body" : "This is just to point out that runtime support for log drivers are far from perfect today, and it's not good enough to simply say \"runtime already supports log drivers, why can we reuse that?\"\n",
        "createdAt" : "2016-10-10T22:39:57Z",
        "updatedAt" : "2016-11-21T23:42:00Z",
        "lastEditedBy" : "1bd2d65a-7c93-4c22-b408-c7794d037dc5",
        "tags" : [
        ]
      }
    ],
    "commit" : "7e5c03a0e840c5505d628165b6336ba503426bff",
    "line" : 245,
    "diffHunk" : "@@ -1,1 +243,247 @@various logging formats. Unfortunately, this is not true for existing runtimes\nsuch as docker, which supports log retrieval only for a very limited number of\nlog drivers [2]. On the other hand, the downside is that we would be enforcing\nmore requirements on the runtime through log storage location on the host, and\na potentially premature logging API that may change as the disk management"
  },
  {
    "id" : "01f55d29-3a18-493f-aa80-2ad803468565",
    "prId" : 34376,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/34376#pullrequestreview-3579162",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "12f1595e-eb9f-477b-8034-49f3429f94b8",
        "parentId" : null,
        "authorId" : "6e2b5eda-1533-4798-a56c-432faaf38480",
        "body" : "I'm not sure that this proposal makes a really strong argument against this (which I would consider the \"default\" path because it leverages the existing runtime support).\n",
        "createdAt" : "2016-10-08T14:28:47Z",
        "updatedAt" : "2016-11-21T23:42:00Z",
        "lastEditedBy" : "6e2b5eda-1533-4798-a56c-432faaf38480",
        "tags" : [
        ]
      },
      {
        "id" : "d6dde7c1-15b0-465d-ae44-595b5f1c213a",
        "parentId" : "12f1595e-eb9f-477b-8034-49f3429f94b8",
        "authorId" : "2fa5a4c6-e0a7-4dbe-a80e-7770a5dc92a1",
        "body" : "There are a few other things to consider:\n1. Log collection should not require going through a daemon - A process like fluentd should be able to collect logs without having to rely on another daemon being up. This implies that logs must be a set of files at a known location in a format known to log aggregators.\n2. Rotation policies might vary by containers -- I don't think there are any runtimes now that support log rotation at any reasonable granularity, each runtime would have to independently develop that feature\n3. Logs persisting and being rotated after the container is removed - If a runtime is specifically only a container runtime, decoupling the lifetime of container+logs while having the runtime manage it will result in either the runtime having to have a firstclass concept of logs separate from containers (I don't think any do), or in the shim having to manage the logs itself... if the shim has to do it, then it might as well be kubelet.\n\nI originally was in favor of having the runtimes manage everything, but if we add all of the above requirements, I think it's a good argument against it. We can question how much we actually need most of those requirements still though, since several of them are quite forward-looking.\n",
        "createdAt" : "2016-10-10T16:49:35Z",
        "updatedAt" : "2016-11-21T23:42:00Z",
        "lastEditedBy" : "2fa5a4c6-e0a7-4dbe-a80e-7770a5dc92a1",
        "tags" : [
        ]
      },
      {
        "id" : "5bd771d5-7c1c-4c4e-87d7-2d07fb988268",
        "parentId" : "12f1595e-eb9f-477b-8034-49f3429f94b8",
        "authorId" : "1bd2d65a-7c93-4c22-b408-c7794d037dc5",
        "body" : "+1 to @euank's comment, which explains more clearly than the statement in the proposal. \n\nTBH, I am not completely against leveraging runtime for various log operations. However, \n1. We are not sure what we want yet, since disk management is still in its early stages. \n2. Container runtimes such as docker also does not provide good support of logging yet. Even if we were to improve that (or hack docker internals in the shim), it'd take a longer time.\n\nInstead of committing resources to do this right now, I think the current proposal gives us room to figure things out without having to develop and commit to a premature api.\n",
        "createdAt" : "2016-10-10T22:18:31Z",
        "updatedAt" : "2016-11-21T23:42:00Z",
        "lastEditedBy" : "1bd2d65a-7c93-4c22-b408-c7794d037dc5",
        "tags" : [
        ]
      },
      {
        "id" : "99273c8e-6a05-4b68-8100-7aa6ffd17002",
        "parentId" : "12f1595e-eb9f-477b-8034-49f3429f94b8",
        "authorId" : "1bd2d65a-7c93-4c22-b408-c7794d037dc5",
        "body" : "> We can question how much we actually need most of those requirements still though, since several of them are quite forward-looking.\n\nI think I did this on purpose. I wanted to see if we can try finding a solution that addresses all requirements first. If, instead, sig-node thinks that some requirements can be dropped, it's perfectly reasonable to question the requirements themselves, and convince people who are in favor of the requirements. \n",
        "createdAt" : "2016-10-10T22:34:56Z",
        "updatedAt" : "2016-11-21T23:42:00Z",
        "lastEditedBy" : "1bd2d65a-7c93-4c22-b408-c7794d037dc5",
        "tags" : [
        ]
      }
    ],
    "commit" : "7e5c03a0e840c5505d628165b6336ba503426bff",
    "line" : 239,
    "diffHunk" : "@@ -1,1 +237,241 @@\nThere are also possibilities to implement the current proposal by imposing the\nlog file paths, while leveraging the runtime to access and/or manage logs. This\nrequires the runtime to expose knobs in CRI to retrieve, remove, and examine\nthe disk usage of logs. The upside of this approach is that kubelet needs not"
  },
  {
    "id" : "4b783860-13ff-42ee-9941-fe66578d9d2c",
    "prId" : 34376,
    "prUrl" : "https://github.com/kubernetes/kubernetes/pull/34376#pullrequestreview-4151489",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3530fd67-c1c4-4a2c-a76a-f9f5c54da7bf",
        "parentId" : null,
        "authorId" : "2fa5a4c6-e0a7-4dbe-a80e-7770a5dc92a1",
        "body" : "This also implies the kubelet must be able to rotate logs, and thus must be able to work with the given format.\n",
        "createdAt" : "2016-10-10T16:30:59Z",
        "updatedAt" : "2016-11-21T23:42:00Z",
        "lastEditedBy" : "2fa5a4c6-e0a7-4dbe-a80e-7770a5dc92a1",
        "tags" : [
        ]
      },
      {
        "id" : "0a386e56-bbd0-4552-81dd-615ee73557da",
        "parentId" : "3530fd67-c1c4-4a2c-a76a-f9f5c54da7bf",
        "authorId" : "1bd2d65a-7c93-4c22-b408-c7794d037dc5",
        "body" : "Another component can be set up to rotate the log if needed. I think the proposal discusses more about the logging formats later. Let me know if you find that insufficient. \n",
        "createdAt" : "2016-10-10T21:49:31Z",
        "updatedAt" : "2016-11-21T23:42:00Z",
        "lastEditedBy" : "1bd2d65a-7c93-4c22-b408-c7794d037dc5",
        "tags" : [
        ]
      },
      {
        "id" : "0bf285b3-0ca6-4288-9b34-cbe82ccdeaeb",
        "parentId" : "3530fd67-c1c4-4a2c-a76a-f9f5c54da7bf",
        "authorId" : "f81960f6-a033-4403-bebf-c8ebb484e444",
        "body" : "I think this is an orthogonal concern... So long as it's not strict control. \n",
        "createdAt" : "2016-10-13T19:52:53Z",
        "updatedAt" : "2016-11-21T23:42:00Z",
        "lastEditedBy" : "f81960f6-a033-4403-bebf-c8ebb484e444",
        "tags" : [
        ]
      }
    ],
    "commit" : "7e5c03a0e840c5505d628165b6336ba503426bff",
    "line" : null,
    "diffHunk" : "@@ -1,1 +116,120 @@\n   2. **Allow kubelet to manage the lifecycle of the logs to pave the way for\n        better disk management in the future.** This implies that the lifecycle\n        of containers and their logs need to be decoupled.\n"
  }
]