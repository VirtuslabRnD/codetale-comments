[
  {
    "id" : "a888a6a5-383a-4b5d-8850-6d3859cce333",
    "prId" : 3389,
    "prUrl" : "https://github.com/zio/zio/pull/3389#pullrequestreview-394882054",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5602e7db-5ea8-4a8c-a730-114b0f5d4bdd",
        "parentId" : null,
        "authorId" : "e51a12a9-b5b7-4e30-a51d-293206825c6f",
        "body" : "Is this correct? I thought there was an issue that if the second effect retries then we only retry the second effect instead of both effects?",
        "createdAt" : "2020-04-16T17:39:36Z",
        "updatedAt" : "2020-04-16T18:26:16Z",
        "lastEditedBy" : "e51a12a9-b5b7-4e30-a51d-293206825c6f",
        "tags" : [
        ]
      },
      {
        "id" : "a614fe42-f661-401e-82a1-d07ceaeeefdc",
        "parentId" : "5602e7db-5ea8-4a8c-a730-114b0f5d4bdd",
        "authorId" : "49e435d8-1c12-40af-9c6a-bed372dacce5",
        "body" : "Hmm, I was expecting the same semantics as the [STM paper](https://simonmar.github.io/bib/papers/stm.pdf) (Section 3.4) as they say that both `s1` and `s2` should be retried if `s1` is retried and `s2` is retried.\r\n\r\nIs this how ZIO's implementation is working?",
        "createdAt" : "2020-04-16T18:03:41Z",
        "updatedAt" : "2020-04-16T18:26:16Z",
        "lastEditedBy" : "49e435d8-1c12-40af-9c6a-bed372dacce5",
        "tags" : [
        ]
      },
      {
        "id" : "f854e763-8949-43f5-b331-e451e583768b",
        "parentId" : "5602e7db-5ea8-4a8c-a730-114b0f5d4bdd",
        "authorId" : "6080cd8f-e671-4d49-a54c-b6159456ac0e",
        "body" : "I would the docs as they are, as this is the desired behavior. I will double check its behavior for any issues. @adamgfraser could you please paste the link to the issue? ",
        "createdAt" : "2020-04-16T18:11:34Z",
        "updatedAt" : "2020-04-16T18:26:16Z",
        "lastEditedBy" : "6080cd8f-e671-4d49-a54c-b6159456ac0e",
        "tags" : [
        ]
      }
    ],
    "commit" : "871232b527e51c417b7acde263d6a16e9ad6daed",
    "line" : 113,
    "diffHunk" : "@@ -1,1 +111,115 @@we have two STM effects `sA` and `sB`, you can express that you would like to compose the two using `sA orElse sB`. The\ntransaction would first attempt to run `sA` and if it retries then `sA` is abandoned with no effect and then `sB` runs.\nNow if `sB` also retries then the entire call retries. However, it waits for the transactional data structures to change \nthat are involved in either `sA` or `sB`. Using `orElse` is an elegant technique that can be used to determine whether \nor not an STM transaction needs to block. For example, we can take `transferMoneyNoMatterWhat` and turn it into an "
  },
  {
    "id" : "be09a539-c4a2-408f-beca-d822e22c63f8",
    "prId" : 3389,
    "prUrl" : "https://github.com/zio/zio/pull/3389#pullrequestreview-394885572",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8ebf27fe-5684-4717-9c6f-d9b4c2be0050",
        "parentId" : null,
        "authorId" : "6080cd8f-e671-4d49-a54c-b6159456ac0e",
        "body" : "Nowadays it also includes an environment - ZSTM[R, E, A]. ",
        "createdAt" : "2020-04-16T17:40:16Z",
        "updatedAt" : "2020-04-16T18:26:16Z",
        "lastEditedBy" : "6080cd8f-e671-4d49-a54c-b6159456ac0e",
        "tags" : [
        ]
      },
      {
        "id" : "f0592fbf-bc36-48cc-9ab7-85825f928276",
        "parentId" : "8ebf27fe-5684-4717-9c6f-d9b4c2be0050",
        "authorId" : "49e435d8-1c12-40af-9c6a-bed372dacce5",
        "body" : "Mentioned :)",
        "createdAt" : "2020-04-16T18:15:22Z",
        "updatedAt" : "2020-04-16T18:26:16Z",
        "lastEditedBy" : "49e435d8-1c12-40af-9c6a-bed372dacce5",
        "tags" : [
        ]
      },
      {
        "id" : "0ec112ba-603a-443a-b5eb-7f12a9b6e15b",
        "parentId" : "8ebf27fe-5684-4717-9c6f-d9b4c2be0050",
        "authorId" : "49e435d8-1c12-40af-9c6a-bed372dacce5",
        "body" : "done :)",
        "createdAt" : "2020-04-16T18:16:33Z",
        "updatedAt" : "2020-04-16T18:26:16Z",
        "lastEditedBy" : "49e435d8-1c12-40af-9c6a-bed372dacce5",
        "tags" : [
        ]
      }
    ],
    "commit" : "871232b527e51c417b7acde263d6a16e9ad6daed",
    "line" : 41,
    "diffHunk" : "@@ -1,1 +39,43 @@## The STM datatype\n\nAn `STM[E, A]` represents an effect that can be performed transactionally resulting in a failure `E` or a success `A`.\nThere is a more powerful variant `ZSTM[R, E, A]` which supports an environment type `R` like `ZIO[R, E, A]`. The `STM` \n(and `ZSTM` variant) data-type is _not_ as powerful as the `ZIO[R, E, A]` datatype as it does not allow you to perform "
  },
  {
    "id" : "1c5f44a7-ed8a-4f29-b5df-6b72024d0c10",
    "prId" : 3389,
    "prUrl" : "https://github.com/zio/zio/pull/3389#pullrequestreview-394885925",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "45633483-1ca5-45c0-aab7-2a17075d5fb4",
        "parentId" : null,
        "authorId" : "6080cd8f-e671-4d49-a54c-b6159456ac0e",
        "body" : "There is retryWhile nowadays.\n\nEdit: this might be nice to show retries though. ",
        "createdAt" : "2020-04-16T17:43:54Z",
        "updatedAt" : "2020-04-16T18:26:16Z",
        "lastEditedBy" : "6080cd8f-e671-4d49-a54c-b6159456ac0e",
        "tags" : [
        ]
      },
      {
        "id" : "8c7f6f9a-7cc1-432c-a25f-72845175b43c",
        "parentId" : "45633483-1ca5-45c0-aab7-2a17075d5fb4",
        "authorId" : "49e435d8-1c12-40af-9c6a-bed372dacce5",
        "body" : "I think you meant `STM.check`? I will mention it :D",
        "createdAt" : "2020-04-16T18:09:35Z",
        "updatedAt" : "2020-04-16T18:26:16Z",
        "lastEditedBy" : "49e435d8-1c12-40af-9c6a-bed372dacce5",
        "tags" : [
        ]
      },
      {
        "id" : "4f25de9b-69aa-44d7-b61b-a6aa7cee55d1",
        "parentId" : "45633483-1ca5-45c0-aab7-2a17075d5fb4",
        "authorId" : "6080cd8f-e671-4d49-a54c-b6159456ac0e",
        "body" : "That one is even better fit :). ",
        "createdAt" : "2020-04-16T18:17:04Z",
        "updatedAt" : "2020-04-16T18:26:16Z",
        "lastEditedBy" : "6080cd8f-e671-4d49-a54c-b6159456ac0e",
        "tags" : [
        ]
      }
    ],
    "commit" : "871232b527e51c417b7acde263d6a16e9ad6daed",
    "line" : 95,
    "diffHunk" : "@@ -1,1 +93,97 @@  for {\n    senderBal <- from.get\n    _         <- if (senderBal < amount) STM.retry else STM.unit\n    _         <- from.update(existing => existing - amount)\n    _         <- to.update(existing => existing + amount)"
  }
]