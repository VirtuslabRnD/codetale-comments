[
  {
    "id" : "7a70c306-5d4a-487f-a4a5-f6f678f3e086",
    "prId" : 9418,
    "prUrl" : "https://github.com/apache/kafka/pull/9418#pullrequestreview-517909888",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6c83b249-16a2-465c-afc1-a6398c8e6343",
        "parentId" : null,
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "nit: can we consolidate this class with the existing one (of course, it needs to be generalized on T record) than creating a new class? Ditto for BatchAccumulator and BatchMemoryPool.",
        "createdAt" : "2020-10-21T00:50:52Z",
        "updatedAt" : "2020-10-27T03:04:10Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      },
      {
        "id" : "770a24f6-f415-495a-be89-4113bdfb4139",
        "parentId" : "6c83b249-16a2-465c-afc1-a6398c8e6343",
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "I am not sure I follow. Are you suggesting making `BatchBuilder` a nested class? I think what it's doing is complex enough that I wanted a separate class that could be tested in isolation.",
        "createdAt" : "2020-10-21T21:44:41Z",
        "updatedAt" : "2020-10-27T03:04:10Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      },
      {
        "id" : "c0d8ca38-507c-4131-9816-6cd000a1a516",
        "parentId" : "6c83b249-16a2-465c-afc1-a6398c8e6343",
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "I think the pairs of those classes:\r\n\r\n1) BatchAccumulator and RecordAccumulator\r\n2) BatchMemoryPool and BufferPool\r\n3) BatchBuilder and MemoryRecordsBuilder\r\n\r\nare similar can maybe can be consolidated to a single class each.",
        "createdAt" : "2020-10-27T03:09:12Z",
        "updatedAt" : "2020-10-27T03:09:12Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      },
      {
        "id" : "9a08c442-a24f-48e8-94d5-9c83ec18d1ce",
        "parentId" : "6c83b249-16a2-465c-afc1-a6398c8e6343",
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "Yes, that is fair. Initially I had planned to reuse as much as possible, but the existing classes had too much baggage. I wanted implementations which were simple and efficient for the needs of the raft layer. ",
        "createdAt" : "2020-10-27T16:34:08Z",
        "updatedAt" : "2020-10-27T16:34:09Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      }
    ],
    "commit" : "fac5c0a9507f9f40f99dac017242d12500a97d5d",
    "line" : 46,
    "diffHunk" : "@@ -1,1 +44,48 @@ * @param <T> record type indicated by {@link RecordSerde} passed in constructor\n */\npublic class BatchBuilder<T> {\n    private final ByteBuffer initialBuffer;\n    private final CompressionType compressionType;"
  },
  {
    "id" : "a216a56f-b20e-423e-907a-5a5130b21f20",
    "prId" : 9418,
    "prUrl" : "https://github.com/apache/kafka/pull/9418#pullrequestreview-517120276",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "60704fe8-8ec0-44fe-895e-2cd48cb2ec49",
        "parentId" : null,
        "authorId" : "4a7c311c-0954-4671-a0d2-266cb67437ad",
        "body" : "I think it would be good to have a description of what this type is doing and how to use it. Reading the code and seeing how the buffer is shared, I am under the impression that this type should not be reused after the `build` method is called. Is that correct?\r\n\r\nIf this is correct, I think all of the public methods should check that they are not being called after `build` is called.",
        "createdAt" : "2020-10-23T20:08:20Z",
        "updatedAt" : "2020-10-27T03:04:10Z",
        "lastEditedBy" : "4a7c311c-0954-4671-a0d2-266cb67437ad",
        "tags" : [
        ]
      },
      {
        "id" : "2e072d7d-694d-4212-9156-536f7176fba9",
        "parentId" : "60704fe8-8ec0-44fe-895e-2cd48cb2ec49",
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "Sure, we can do that. I was being a bit looser with API validation since this is bound for internal use only.",
        "createdAt" : "2020-10-26T19:46:21Z",
        "updatedAt" : "2020-10-27T03:04:10Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      }
    ],
    "commit" : "fac5c0a9507f9f40f99dac017242d12500a97d5d",
    "line" : 46,
    "diffHunk" : "@@ -1,1 +44,48 @@ * @param <T> record type indicated by {@link RecordSerde} passed in constructor\n */\npublic class BatchBuilder<T> {\n    private final ByteBuffer initialBuffer;\n    private final CompressionType compressionType;"
  }
]