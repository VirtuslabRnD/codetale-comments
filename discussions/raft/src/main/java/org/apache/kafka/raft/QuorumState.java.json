[
  {
    "id" : "b0d593b8-73c7-4e23-852d-ea34e87efcad",
    "prId" : 9531,
    "prUrl" : "https://github.com/apache/kafka/pull/9531#pullrequestreview-526526605",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e7593198-60eb-42d1-82f5-d35373536ddf",
        "parentId" : null,
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "Makes me thinking: if we have an even number sized quorum (say 2N), and the leader is resigning. Then before the leader shutdown we need N+1 votes, while after the leader shutdown, the quorum size shrink to 2N-1 and we would only need N votes. So if the resigning leader gives it a vote to a candidate and then shutdown, while the candidates thinks they only need N votes, would that potentially result in two candidates claiming victory --- somehow this sounds quite close to the real world :P --- each with N votes while one of them has the vote from the resigned leader?",
        "createdAt" : "2020-11-09T04:50:50Z",
        "updatedAt" : "2020-11-09T17:28:47Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      },
      {
        "id" : "1c741850-db3c-4f0b-b941-8a698ddac64d",
        "parentId" : "e7593198-60eb-42d1-82f5-d35373536ddf",
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "Hmm.. The quorum size does not change because a leader resigns. If there are 2N nodes in the cluster, then we always need N + 1 votes, so I don't think this case is possible.",
        "createdAt" : "2020-11-09T16:53:06Z",
        "updatedAt" : "2020-11-09T17:28:47Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      },
      {
        "id" : "7bd76178-a109-4231-81f8-80b7ffc177a4",
        "parentId" : "e7593198-60eb-42d1-82f5-d35373536ddf",
        "authorId" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "body" : "In the future, when we have reassignment, we will still have to protect every quorum change with a majority of the current nodes. The proposal we had previously only allowed single-node changes, which meant that any majority was a majority before and after the state was applied.",
        "createdAt" : "2020-11-09T16:56:53Z",
        "updatedAt" : "2020-11-09T17:28:47Z",
        "lastEditedBy" : "5c21df64-97d8-46ab-9722-a7e9ba1d7c49",
        "tags" : [
        ]
      },
      {
        "id" : "dba0020d-2a9d-4a10-8f2c-6887b8be4b49",
        "parentId" : "e7593198-60eb-42d1-82f5-d35373536ddf",
        "authorId" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "body" : "Okay now I remembered what we discussed before.\r\n\r\nWhat I was wondering is, say with quorum size 6, we would need 4 votes to elect leader; if the current leader shutdown and before it is restarted, the quorum size is 5 so logically we only need 3 votes --- but as long as we require that during this transition we still require 4 votes even with 5 alive quorum members we are fine.",
        "createdAt" : "2020-11-09T18:17:00Z",
        "updatedAt" : "2020-11-09T18:17:00Z",
        "lastEditedBy" : "eba565e8-e1d5-4749-9c9a-5d117de6c96c",
        "tags" : [
        ]
      }
    ],
    "commit" : "631ba91121a26b0171ab490c92991e628ce3658c",
    "line" : 21,
    "diffHunk" : "@@ -1,1 +36,40 @@ * how they are triggered:\n *\n * Unattached|Resigned =>\n *    Unattached: After learning of a new election with a higher epoch\n *    Voted: After granting a vote to a candidate"
  }
]