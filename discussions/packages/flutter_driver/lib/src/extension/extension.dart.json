[
  {
    "id" : "cb088851-28a7-496f-907d-7f37cdc07d49",
    "prId" : 19047,
    "prUrl" : "https://github.com/flutter/flutter/pull/19047#pullrequestreview-135589090",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "4e4dbebc-07ac-4b46-932d-cf58c3f87e64",
        "parentId" : null,
        "authorId" : "d61ab95a-0bf0-4571-9098-19991dd821ca",
        "body" : "Just to be sure: It's guaranteed that drive tests always run with asserts enabled? Otherwise debugSemantics would be null even when semantics are enabled.",
        "createdAt" : "2018-07-09T17:49:18Z",
        "updatedAt" : "2018-07-09T20:55:48Z",
        "lastEditedBy" : "d61ab95a-0bf0-4571-9098-19991dd821ca",
        "tags" : [
        ]
      },
      {
        "id" : "f95953a7-0649-4181-b511-621bb25f989b",
        "parentId" : "4e4dbebc-07ac-4b46-932d-cf58c3f87e64",
        "authorId" : "e73873df-c6ef-4dd5-ad17-dc7a574dcf0b",
        "body" : "Not always (microbenchmarks), but for these integration tests we'll always be using a debug build.  Added doc comment to the command.",
        "createdAt" : "2018-07-09T20:55:58Z",
        "updatedAt" : "2018-07-09T20:55:59Z",
        "lastEditedBy" : "e73873df-c6ef-4dd5-ad17-dc7a574dcf0b",
        "tags" : [
        ]
      }
    ],
    "commit" : "8ee8d9a3bf89cfd011989aeb5445b04dc6ec453c",
    "line" : 35,
    "diffHunk" : "@@ -1,1 +309,313 @@    SemanticsNode node;\n    while (renderObject != null && node == null) {\n      node = renderObject.debugSemantics;\n      renderObject = renderObject.parent;\n    }"
  },
  {
    "id" : "de6aa1ae-6c3e-466d-ab9b-468291bdd0a3",
    "prId" : 34440,
    "prUrl" : "https://github.com/flutter/flutter/pull/34440#pullrequestreview-250000935",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0c6d6b52-4def-4fc5-8ffb-f4854e46672b",
        "parentId" : null,
        "authorId" : "db47316c-0a85-441a-8891-3b84e8bfe474",
        "body" : "Should this be `DiagnosticsType.element` then?  And the associated method called `getElementDiagnostics`?",
        "createdAt" : "2019-06-14T15:09:06Z",
        "updatedAt" : "2019-06-18T22:59:31Z",
        "lastEditedBy" : "db47316c-0a85-441a-8891-3b84e8bfe474",
        "tags" : [
        ]
      },
      {
        "id" : "d58919dc-d307-499a-9be1-99fecc48f165",
        "parentId" : "0c6d6b52-4def-4fc5-8ffb-f4854e46672b",
        "authorId" : "d61ab95a-0bf0-4571-9098-19991dd821ca",
        "body" : "This is consistent with the terminology we use in the Widget Inspector for these two trees.",
        "createdAt" : "2019-06-14T16:28:04Z",
        "updatedAt" : "2019-06-18T22:59:31Z",
        "lastEditedBy" : "d61ab95a-0bf0-4571-9098-19991dd821ca",
        "tags" : [
        ]
      }
    ],
    "commit" : "19ceaa3eed030f515b4e1d3d8c0ad112b8a47298",
    "line" : 38,
    "diffHunk" : "@@ -1,1 +422,426 @@        break;\n      case DiagnosticsType.widget:\n        diagnosticsNode = element.toDiagnosticsNode();\n        break;\n    }"
  },
  {
    "id" : "a903432d-9e9e-48bf-8c06-702a75f5dff9",
    "prId" : 36334,
    "prUrl" : "https://github.com/flutter/flutter/pull/36334#pullrequestreview-263837484",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d2ed9fd8-6682-4801-9a57-6e38058d2e75",
        "parentId" : null,
        "authorId" : "db47316c-0a85-441a-8891-3b84e8bfe474",
        "body" : "This will never return if there are ongoing animations, correct?  E.g. there's an indeterminate progress indicator, or blinking cursors are being allowed in the test for some reason.",
        "createdAt" : "2019-07-17T21:55:55Z",
        "updatedAt" : "2019-07-18T20:26:33Z",
        "lastEditedBy" : "db47316c-0a85-441a-8891-3b84e8bfe474",
        "tags" : [
        ]
      },
      {
        "id" : "5dbe591c-381d-465d-810c-1f52ca23d3f4",
        "parentId" : "d2ed9fd8-6682-4801-9a57-6e38058d2e75",
        "authorId" : "db47316c-0a85-441a-8891-3b84e8bfe474",
        "body" : "Another concern here is that by the time we get a response, this might no longer be true - I'm not sure if there's any way around that, but it seems like it would be a source of flakiness.",
        "createdAt" : "2019-07-17T21:56:58Z",
        "updatedAt" : "2019-07-18T20:26:33Z",
        "lastEditedBy" : "db47316c-0a85-441a-8891-3b84e8bfe474",
        "tags" : [
        ]
      },
      {
        "id" : "ad095fd8-aa8e-4a8f-810b-e8b082ce4209",
        "parentId" : "d2ed9fd8-6682-4801-9a57-6e38058d2e75",
        "authorId" : "191b853a-2a89-4c2f-ad5d-09a244d276dc",
        "body" : "Thanks for the review, Dan!\r\n\r\nTo your first question, I believe this method will never return if there are ongoing animations, but there's a [_frameSync](https://github.com/flutter/flutter/blob/c60063b72ded6215c0e7cde5f68f57d1972ef389/packages/flutter_driver/lib/src/extension/extension.dart#L167) flag that users can turn this off. And I also believe the current frame sync check [here](https://github.com/flutter/flutter/blob/c60063b72ded6215c0e7cde5f68f57d1972ef389/packages/flutter_driver/lib/src/extension/extension.dart#L239) probably should include this hasScheduledFrame check as well, but it seems not working well with the widgetTester's pump implementation today. On the other hand, in today's Espresso tests for Android native apps,  we disable animation by default and if users turn animation on, Espresso reports the app never goes idle. So it somewhat aligns with users' expectation, unless Flutter apps use animation heavily.\r\n\r\nTo your second question, Espresso talks to the driver extension API cross-process, so it's hard to keep truly synchronized, but I would think adding this API doesn't make things worse though :). If we could have this check closer to when we looking for an element [here](https://github.com/flutter/flutter/blob/c60063b72ded6215c0e7cde5f68f57d1972ef389/packages/flutter_driver/lib/src/extension/extension.dart#L239), probably would help reduce flakiness.",
        "createdAt" : "2019-07-17T22:18:21Z",
        "updatedAt" : "2019-07-18T20:26:33Z",
        "lastEditedBy" : "191b853a-2a89-4c2f-ad5d-09a244d276dc",
        "tags" : [
        ]
      },
      {
        "id" : "e99a2372-03d5-4b3f-a41c-4c7ed98cb82f",
        "parentId" : "d2ed9fd8-6682-4801-9a57-6e38058d2e75",
        "authorId" : "db47316c-0a85-441a-8891-3b84e8bfe474",
        "body" : "Thanks for the explanation.  Maybe we could have a comment around this explaining some of that?",
        "createdAt" : "2019-07-17T22:53:05Z",
        "updatedAt" : "2019-07-18T20:26:33Z",
        "lastEditedBy" : "db47316c-0a85-441a-8891-3b84e8bfe474",
        "tags" : [
        ]
      },
      {
        "id" : "1031ca7c-1418-4f54-8d08-e3a80d6514d6",
        "parentId" : "d2ed9fd8-6682-4801-9a57-6e38058d2e75",
        "authorId" : "191b853a-2a89-4c2f-ad5d-09a244d276dc",
        "body" : "Done. PTAL.",
        "createdAt" : "2019-07-18T00:02:52Z",
        "updatedAt" : "2019-07-18T20:26:33Z",
        "lastEditedBy" : "191b853a-2a89-4c2f-ad5d-09a244d276dc",
        "tags" : [
        ]
      },
      {
        "id" : "30b01c55-2486-407d-aba9-9e9f454451c0",
        "parentId" : "d2ed9fd8-6682-4801-9a57-6e38058d2e75",
        "authorId" : "db47316c-0a85-441a-8891-3b84e8bfe474",
        "body" : "```\r\nIf interacting\r\n  /// with the app during animation is desirable, do NOT call this method. At\r\n  /// the same time, you might also want to call the 'set_frame_sync' method to\r\n  /// disable the frame sync while looking for UI elements.`\r\n```\r\nIt might be better to replace this with the something like the prose from `runUnsynchronized` in driver.dart.  We could consider making that a template, or just borrowing a bit from it that makes sense here.  We also probably want to have a `See also` that links to `[FlutterDriver.runUnsynchronized]`.\r\n\r\nSomething like:\r\n\r\n```\r\n  /// This method relies on a Flutter Driver mechanism is called \"frame sync\", which\r\n  /// waits for transient animations to finish. Persistent animations will cause this to\r\n  /// wait forever.\r\n  ///\r\n  /// If a test needs to interact with the app, it should avoid this method and instead\r\n  /// disable the frame sync using `set_frame_sync` method. See \r\n  /// [FlutterDriver.runUnsynchronized] for more details on how to do this.\r\n  ///\r\n  /// Disabling frame sync will require the test author to use some other method to\r\n  /// avoid flakiness.\r\n```",
        "createdAt" : "2019-07-18T03:59:09Z",
        "updatedAt" : "2019-07-18T20:26:33Z",
        "lastEditedBy" : "db47316c-0a85-441a-8891-3b84e8bfe474",
        "tags" : [
        ]
      },
      {
        "id" : "9eb50bf4-7fcb-4429-a4d7-355b3cc00f57",
        "parentId" : "d2ed9fd8-6682-4801-9a57-6e38058d2e75",
        "authorId" : "191b853a-2a89-4c2f-ad5d-09a244d276dc",
        "body" : "Thanks! Reads way better :). PTAL.",
        "createdAt" : "2019-07-18T18:38:59Z",
        "updatedAt" : "2019-07-18T20:26:33Z",
        "lastEditedBy" : "191b853a-2a89-4c2f-ad5d-09a244d276dc",
        "tags" : [
        ]
      }
    ],
    "commit" : "d99739dd5222b3c348a1b2c40e4ecd44f6465592",
    "line" : 40,
    "diffHunk" : "@@ -1,1 +392,396 @@    await _waitUntilFrame(() {\n      return SchedulerBinding.instance.transientCallbackCount == 0\n          && !SchedulerBinding.instance.hasScheduledFrame;\n    });\n    return null;"
  },
  {
    "id" : "f5322e2f-dfc7-4715-9b17-4cdd67c8f1d1",
    "prId" : 36334,
    "prUrl" : "https://github.com/flutter/flutter/pull/36334#pullrequestreview-263886439",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "069e5afd-8683-4db9-a621-56599dd6e767",
        "parentId" : null,
        "authorId" : "db47316c-0a85-441a-8891-3b84e8bfe474",
        "body" : "nit: add a blank line",
        "createdAt" : "2019-07-18T19:29:49Z",
        "updatedAt" : "2019-07-18T20:26:33Z",
        "lastEditedBy" : "db47316c-0a85-441a-8891-3b84e8bfe474",
        "tags" : [
        ]
      },
      {
        "id" : "51aabec2-949e-4a23-8fd5-d37acb84184f",
        "parentId" : "069e5afd-8683-4db9-a621-56599dd6e767",
        "authorId" : "191b853a-2a89-4c2f-ad5d-09a244d276dc",
        "body" : "Done.",
        "createdAt" : "2019-07-18T20:21:38Z",
        "updatedAt" : "2019-07-18T20:26:33Z",
        "lastEditedBy" : "191b853a-2a89-4c2f-ad5d-09a244d276dc",
        "tags" : [
        ]
      }
    ],
    "commit" : "d99739dd5222b3c348a1b2c40e4ecd44f6465592",
    "line" : 26,
    "diffHunk" : "@@ -1,1 +378,382 @@  /// * Whether there's no pending request for scheduling a new frame.\n  ///\n  /// We consider the frame is synced when both conditions are met.\n  ///\n  /// This method relies on a Flutter Driver mechanism called \"frame sync\","
  },
  {
    "id" : "d987fca8-2e7d-408e-b766-cdd75d0da403",
    "prId" : 37736,
    "prUrl" : "https://github.com/flutter/flutter/pull/37736#pullrequestreview-275197951",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "12cce19e-b416-42da-8961-824ac19980fe",
        "parentId" : null,
        "authorId" : "db47316c-0a85-441a-8891-3b84e8bfe474",
        "body" : "Instead of using the deprecated method here, can we just use the new method(s)? This will leave less to do when we eventually remove the deprecated version.",
        "createdAt" : "2019-08-14T23:16:39Z",
        "updatedAt" : "2019-08-16T17:42:31Z",
        "lastEditedBy" : "db47316c-0a85-441a-8891-3b84e8bfe474",
        "tags" : [
        ]
      }
    ],
    "commit" : "36adaf7da2d2733eabf156156ce7b5cfe68f69f9",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +115,119 @@      'waitForAbsent': _waitForAbsent,\n      'waitForCondition': _waitForCondition,\n      'waitUntilNoTransientCallbacks': _waitUntilNoTransientCallbacks, // ignore: deprecated_member_use_from_same_package\n      'waitUntilNoPendingFrame': _waitUntilNoPendingFrame, // ignore: deprecated_member_use_from_same_package\n      'waitUntilFirstFrameRasterized': _waitUntilFirstFrameRasterized, // ignore: deprecated_member_use_from_same_package"
  },
  {
    "id" : "0069ab77-386c-4e35-9fe6-c965decdb147",
    "prId" : 37736,
    "prUrl" : "https://github.com/flutter/flutter/pull/37736#pullrequestreview-275209160",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d8f697e8-40db-4b66-abcf-724f3231a0d9",
        "parentId" : null,
        "authorId" : "db47316c-0a85-441a-8891-3b84e8bfe474",
        "body" : "Ditto on deprecation question",
        "createdAt" : "2019-08-14T23:16:53Z",
        "updatedAt" : "2019-08-16T17:42:31Z",
        "lastEditedBy" : "db47316c-0a85-441a-8891-3b84e8bfe474",
        "tags" : [
        ]
      },
      {
        "id" : "ab97eb6c-bdfd-4e17-96fe-c49239fbdce6",
        "parentId" : "d8f697e8-40db-4b66-abcf-724f3231a0d9",
        "authorId" : "191b853a-2a89-4c2f-ad5d-09a244d276dc",
        "body" : "If we replace the wait APIs like `waitUntilNoTransientCallbacks` with `waitForCondition`, this is going to be a hard-breaking change, as the JSON-RPC command for `waitUntilNoTransientCallbacks` is something like `{command: waitUntilNoTransientCallbacks}` and only the `WaitUntilNoTransientCallbacks` command class can understand/deserialize it.\r\n\r\nFlutter Driver is updated to send the new `waitForCondition` command to this extension API, but we'll need to update Espresso/EarlGrey to use the new API before we remove it.",
        "createdAt" : "2019-08-14T23:58:14Z",
        "updatedAt" : "2019-08-16T17:42:31Z",
        "lastEditedBy" : "191b853a-2a89-4c2f-ad5d-09a244d276dc",
        "tags" : [
        ]
      }
    ],
    "commit" : "36adaf7da2d2733eabf156156ce7b5cfe68f69f9",
    "line" : 30,
    "diffHunk" : "@@ -1,1 +138,142 @@      'waitForAbsent': (Map<String, String> params) => WaitForAbsent.deserialize(params),\n      'waitForCondition': (Map<String, String> params) => WaitForCondition.deserialize(params),\n      'waitUntilNoTransientCallbacks': (Map<String, String> params) => WaitUntilNoTransientCallbacks.deserialize(params), // ignore: deprecated_member_use_from_same_package\n      'waitUntilNoPendingFrame': (Map<String, String> params) => WaitUntilNoPendingFrame.deserialize(params), // ignore: deprecated_member_use_from_same_package\n      'waitUntilFirstFrameRasterized': (Map<String, String> params) => WaitUntilFirstFrameRasterized.deserialize(params), // ignore: deprecated_member_use_from_same_package"
  },
  {
    "id" : "9e000797-c36a-4c08-9586-5cd923485bb2",
    "prId" : 37736,
    "prUrl" : "https://github.com/flutter/flutter/pull/37736#pullrequestreview-275197951",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d3c0aa81-5d16-4789-9b9e-524675832e15",
        "parentId" : null,
        "authorId" : "db47316c-0a85-441a-8891-3b84e8bfe474",
        "body" : "Needs null check.",
        "createdAt" : "2019-08-14T23:17:14Z",
        "updatedAt" : "2019-08-16T17:42:31Z",
        "lastEditedBy" : "db47316c-0a85-441a-8891-3b84e8bfe474",
        "tags" : [
        ]
      }
    ],
    "commit" : "36adaf7da2d2733eabf156156ce7b5cfe68f69f9",
    "line" : 50,
    "diffHunk" : "@@ -1,1 +380,384 @@  Future<Result> _waitForCondition(Command command) async {\n    assert(command != null);\n    final WaitForCondition waitForConditionCommand = command;\n    await waitForConditionCommand.condition.wait();\n    return null;"
  }
]