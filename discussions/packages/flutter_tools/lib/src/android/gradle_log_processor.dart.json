[
  {
    "id" : "1e27af39-0f99-4d98-abdf-d0b750b9d847",
    "prId" : 71499,
    "prUrl" : "https://github.com/flutter/flutter/pull/71499#pullrequestreview-542400764",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "4a0cad8e-17a0-468e-9ea6-b8f8a1371d9d",
        "parentId" : null,
        "authorId" : "5acfd23a-9807-467c-8f5c-9b4c4052927b",
        "body" : "Is there any way split on output that we control instead of a line from gradle? Like could the tool emit a known line from the recursive call?",
        "createdAt" : "2020-12-01T21:38:32Z",
        "updatedAt" : "2020-12-01T23:11:17Z",
        "lastEditedBy" : "5acfd23a-9807-467c-8f5c-9b4c4052927b",
        "tags" : [
        ]
      },
      {
        "id" : "46261371-4a9c-4816-9c09-6c5eeb07ef62",
        "parentId" : "4a0cad8e-17a0-468e-9ea6-b8f8a1371d9d",
        "authorId" : "e73873df-c6ef-4dd5-ad17-dc7a574dcf0b",
        "body" : "Can you elaborate a bit on what that would be used for?",
        "createdAt" : "2020-12-01T21:53:57Z",
        "updatedAt" : "2020-12-01T23:11:17Z",
        "lastEditedBy" : "e73873df-c6ef-4dd5-ad17-dc7a574dcf0b",
        "tags" : [
        ]
      },
      {
        "id" : "21caf763-4694-4a7a-a0c6-014787e13eeb",
        "parentId" : "4a0cad8e-17a0-468e-9ea6-b8f8a1371d9d",
        "authorId" : "5acfd23a-9807-467c-8f5c-9b4c4052927b",
        "body" : "Sure, just taking a possibly naive look at the example 'before' output in the PR description, we have:\r\n```\r\n[lines emitted by the tool or the Dart compiler]\r\nFAILURE: Build failed with an exception. [First line emitted by gradle?]\r\n[more lines emitted by gradle]\r\n[more lines emitted by the tool]\r\n```\r\nInstead of detecting gradle output using the first line emitted by gradle, which we don't control, the idea would be to detect gradle output using the last line of `[lines emitted by the tool or the Dart compiler]`, which we do control, adding a new sentinel line there if needed.",
        "createdAt" : "2020-12-01T22:05:00Z",
        "updatedAt" : "2020-12-01T23:11:17Z",
        "lastEditedBy" : "5acfd23a-9807-467c-8f5c-9b4c4052927b",
        "tags" : [
        ]
      },
      {
        "id" : "220c1e2f-364e-41fc-a897-b2aebab8dd82",
        "parentId" : "4a0cad8e-17a0-468e-9ea6-b8f8a1371d9d",
        "authorId" : "e73873df-c6ef-4dd5-ad17-dc7a574dcf0b",
        "body" : "We can't hide all Gradle output though. For example, a compilation error in the users Java code:\r\n\r\n```\r\nIf you are deploying the app to the Play Store, it's recommended to use app bundles or split the APK to reduce the APK size.\r\n    To generate an app bundle, run:\r\n        flutter build appbundle --target-platform android-arm,android-arm64,android-x64\r\n        Learn more: https://developer.android.com/guide/app-bundle\r\n    To split the APKs per ABI, run:\r\n        flutter build apk --target-platform android-arm,android-arm64,android-x64 --split-per-abi\r\n        Learn more: https://developer.android.com/studio/build/configure-apk-splits#configure-abi-split\r\n/Users/jonahwilliams/Documents/flutter/dev/integration_tests/flutter_gallery/android/app/src/main/java/io/flutter/demo/gallery/MainActivity.java:11: error: '{' expected\r\npublic class MainActivity extends FlutterActivity                       \r\n                                                 ^                      \r\n1 error                                                                 \r\n                                                                        \r\nFAILURE: Build failed with an exception.                                \r\n                                                                        \r\n* What went wrong:                                                      \r\nExecution failed for task ':app:compileReleaseJavaWithJavac'.           \r\n> Compilation failed; see the compiler error output for details.        \r\n                                                                        \r\n* Try:                                                                  \r\nRun with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output. Run with --scan to get full insights.\r\n                                                                        \r\n* Get more help at https://help.gradle.org                              \r\n                                                                        \r\nBUILD FAILED in 55s                  \r\n```\r\n\r\nWe still want to chop off the footer since it is wrong, but we need to show the output from the javac task\r\n\r\n",
        "createdAt" : "2020-12-01T22:19:03Z",
        "updatedAt" : "2020-12-01T23:11:17Z",
        "lastEditedBy" : "e73873df-c6ef-4dd5-ad17-dc7a574dcf0b",
        "tags" : [
        ]
      },
      {
        "id" : "1b475d6f-e761-486c-ac0e-380de5cec325",
        "parentId" : "4a0cad8e-17a0-468e-9ea6-b8f8a1371d9d",
        "authorId" : "5acfd23a-9807-467c-8f5c-9b4c4052927b",
        "body" : "Ah, okay. Got it. Thanks.",
        "createdAt" : "2020-12-02T00:12:55Z",
        "updatedAt" : "2020-12-02T00:12:55Z",
        "lastEditedBy" : "5acfd23a-9807-467c-8f5c-9b4c4052927b",
        "tags" : [
        ]
      }
    ],
    "commit" : "3ec56d2c3a72feab634238e43074d5840d1e4f35",
    "line" : 23,
    "diffHunk" : "@@ -1,1 +21,25 @@    // irrelevant information for a flutter build, along with misleading advice to\n    // run with --stacktrace (which does not exist for the flutter CLI). remove this.\n    if (!verbose && (line.startsWith('FAILURE: Build failed with an exception.') || atFailureFooter)) {\n      atFailureFooter = true;\n      return null;"
  }
]