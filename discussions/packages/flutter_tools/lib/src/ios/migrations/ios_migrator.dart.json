[
  {
    "id" : "194c0328-295f-4f34-aa2c-aa381a3bd713",
    "prId" : 51453,
    "prUrl" : "https://github.com/flutter/flutter/pull/51453#pullrequestreview-368405204",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a50d9146-ac49-4cb6-8b46-7ecfdf695500",
        "parentId" : null,
        "authorId" : "5acfd23a-9807-467c-8f5c-9b4c4052927b",
        "body" : "This would be a bit more idiomatic as an abstract base class\r\n```dart\r\nabstract class IOSMigrator {\r\n  final Logger logger;\r\n\r\n  bool migrate();\r\n\r\n  String processLine(String line);\r\n\r\n  void processFileLines(File file)  {\r\n    // as before.\r\n  }\r\n}\r\n\r\n// You can chain them together:\r\nclass IOSMigration {\r\n  IOSMigration(this.migrators);\r\n\r\n  final List<IOSMigrator> migrators;\r\n\r\n  void run() {\r\n    for (final IOSMigrator migrator in migrators) {\r\n      if (!migrator.migrate()) {\r\n        // This class would encapsulate logic for aborting/rolling-back the transaction.\r\n      }\r\n    } \r\n  }\r\n}\r\n```",
        "createdAt" : "2020-03-03T21:48:03Z",
        "updatedAt" : "2020-03-03T21:48:23Z",
        "lastEditedBy" : "5acfd23a-9807-467c-8f5c-9b4c4052927b",
        "tags" : [
        ]
      },
      {
        "id" : "d1019478-29d1-4a1a-9081-a3a8ad117182",
        "parentId" : "a50d9146-ac49-4cb6-8b46-7ecfdf695500",
        "authorId" : "7aa08a6b-0a3c-421c-b2e6-22899e9af9e4",
        "body" : "Followup in https://github.com/flutter/flutter/pull/51879.",
        "createdAt" : "2020-03-03T23:38:25Z",
        "updatedAt" : "2020-03-03T23:38:26Z",
        "lastEditedBy" : "7aa08a6b-0a3c-421c-b2e6-22899e9af9e4",
        "tags" : [
        ]
      }
    ],
    "commit" : "5cf1e59f91b7d14900bb505e94912a385feff5b5",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +11,15 @@/// Sometimes (due to behavior changes in Xcode, CocoaPods, etc) these files need to be altered\n/// from the original template.\nclass IOSMigrator {\n  IOSMigrator(this.logger);\n"
  },
  {
    "id" : "ca452ca1-7860-4e4e-825d-df9d4327a47a",
    "prId" : 51879,
    "prUrl" : "https://github.com/flutter/flutter/pull/51879#pullrequestreview-369142838",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f904cddf-4766-4fd5-958b-fe8e3c425fdc",
        "parentId" : null,
        "authorId" : "5acfd23a-9807-467c-8f5c-9b4c4052927b",
        "body" : "Why does `processFileLines` need to take a callback? Could it call an abstract method provided by the subclasses?",
        "createdAt" : "2020-03-04T16:43:49Z",
        "updatedAt" : "2020-03-06T18:58:44Z",
        "lastEditedBy" : "5acfd23a-9807-467c-8f5c-9b4c4052927b",
        "tags" : [
        ]
      },
      {
        "id" : "581631bf-9608-41a7-a1d7-7a1dffb356d6",
        "parentId" : "f904cddf-4766-4fd5-958b-fe8e3c425fdc",
        "authorId" : "7aa08a6b-0a3c-421c-b2e6-22899e9af9e4",
        "body" : "The migration can handle multiple files with different pattern matching per file:\r\n\r\n```dart\r\n  void run() {\r\n    _migrateXcodeProjectInfoFile();\r\n    _migratePodfile();\r\n  }\r\n void _migrateXcodeProjectInfoFile() {\r\n    _processFileLines(_xcodeProjectInfoFile, (String line) {\r\n      if (line.contains('3B80C3941E831B6300D905FE')) {\r\n        return null;\r\n      }\r\n...\r\n    });\r\n  }\r\n\r\n  void _migratePodfile() {\r\n    _processFileLines(_podfile, (String line) {\r\n      if (line.contains('Prevent Cocoapods from embedding a second Flutter framework and causing an error with the new Xcode build system.')) {\r\n        return null;\r\n      }\r\n...\r\n    });\r\n  }\r\n```\r\nOriginal version of `RemoveFrameworkLinkAndEmbeddingMigration` (Podfile migration since deleted):\r\nhttps://github.com/jmagman/flutter/blob/e70ed529c41b1dbfe6392c45f84b6cfb165fb419/packages/flutter_tools/lib/src/ios/ios_project_migration.dart",
        "createdAt" : "2020-03-04T21:39:49Z",
        "updatedAt" : "2020-03-06T18:58:44Z",
        "lastEditedBy" : "7aa08a6b-0a3c-421c-b2e6-22899e9af9e4",
        "tags" : [
        ]
      }
    ],
    "commit" : "208e8518192ef138f64e20cb4cfb2a3ac90684bc",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +11,15 @@/// Sometimes (due to behavior changes in Xcode, CocoaPods, etc) these files need to be altered\n/// from the original template.\nabstract class IOSMigrator {\n  IOSMigrator(this.logger);\n"
  },
  {
    "id" : "cfe5f455-9ad8-4236-8a3e-301f5fe44fa4",
    "prId" : 51879,
    "prUrl" : "https://github.com/flutter/flutter/pull/51879#pullrequestreview-368942622",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5905f290-d488-4a86-b7d4-943808522aff",
        "parentId" : null,
        "authorId" : "5acfd23a-9807-467c-8f5c-9b4c4052927b",
        "body" : "Especially for a migration that might touch multiple files, this will have to be treated like a database transaction. We don't want to leave a tree in a partially migrated state, for example. Not for this PR (unless we already have multi-file migrations), but maybe add a TODO and file an issue.",
        "createdAt" : "2020-03-04T16:49:31Z",
        "updatedAt" : "2020-03-06T18:58:44Z",
        "lastEditedBy" : "5acfd23a-9807-467c-8f5c-9b4c4052927b",
        "tags" : [
        ]
      }
    ],
    "commit" : "208e8518192ef138f64e20cb4cfb2a3ac90684bc",
    "line" : 41,
    "diffHunk" : "@@ -1,1 +56,60 @@}\n\nclass IOSMigration {\n  IOSMigration(this.migrators);\n"
  },
  {
    "id" : "f48f1bf6-3d5b-452f-9435-24d115482aaf",
    "prId" : 51879,
    "prUrl" : "https://github.com/flutter/flutter/pull/51879#pullrequestreview-368942622",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "38ec34bd-1d82-43a6-bb3e-300eeda24014",
        "parentId" : null,
        "authorId" : "5acfd23a-9807-467c-8f5c-9b4c4052927b",
        "body" : "How should this code handle exceptions from `migrator.migrate()`",
        "createdAt" : "2020-03-04T16:54:30Z",
        "updatedAt" : "2020-03-06T18:58:44Z",
        "lastEditedBy" : "5acfd23a-9807-467c-8f5c-9b4c4052927b",
        "tags" : [
        ]
      }
    ],
    "commit" : "208e8518192ef138f64e20cb4cfb2a3ac90684bc",
    "line" : 48,
    "diffHunk" : "@@ -1,1 +63,67 @@  bool run() {\n    for (final IOSMigrator migrator in migrators) {\n      if (!migrator.migrate()) {\n        // Migration failures should be more robust, with transactions and fallbacks.\n        // See https://github.com/flutter/flutter/issues/12573 and"
  }
]