[
  {
    "id" : "69b9c97f-dc92-4949-b5b9-ed86de32965c",
    "prId" : 11525,
    "prUrl" : "https://github.com/RocketChat/Rocket.Chat/pull/11525#pullrequestreview-197017960",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2201547a-0566-4565-8862-d07c57ce958a",
        "parentId" : null,
        "authorId" : "61ddb048-36d3-4039-ab51-6db005c8c855",
        "body" : "why do you update records here instead of upadating/inserting it on the [upsert](https://github.com/RocketChat/Rocket.Chat/pull/11525/files#diff-391ef8ba5639084906847ad4e9579ab8R393) above?",
        "createdAt" : "2019-01-27T01:32:48Z",
        "updatedAt" : "2019-01-28T17:12:33Z",
        "lastEditedBy" : "61ddb048-36d3-4039-ab51-6db005c8c855",
        "tags" : [
        ]
      },
      {
        "id" : "197d8bfa-bb95-4085-b2be-6b2f5096c2ad",
        "parentId" : "2201547a-0566-4565-8862-d07c57ce958a",
        "authorId" : "6b2de464-07b6-478f-bdd0-b8707d59c1c1",
        "body" : "@sampaiodiego cuz the query above returns only the aggregated records, not all records read by the aggregation. Here we update all records affected by the aggretation match to change the type and prevent being processed again.",
        "createdAt" : "2019-01-28T11:19:59Z",
        "updatedAt" : "2019-01-28T17:12:33Z",
        "lastEditedBy" : "6b2de464-07b6-478f-bdd0-b8707d59c1c1",
        "tags" : [
        ]
      },
      {
        "id" : "d945c4f8-f613-42f5-a983-c5d8e6b8c937",
        "parentId" : "2201547a-0566-4565-8862-d07c57ce958a",
        "authorId" : "61ddb048-36d3-4039-ab51-6db005c8c855",
        "body" : "got it.. my only concern is that the `update` action _might_ update different records then the first query/aggregate.. not sure this is a problem as well",
        "createdAt" : "2019-01-28T11:55:01Z",
        "updatedAt" : "2019-01-28T17:12:33Z",
        "lastEditedBy" : "61ddb048-36d3-4039-ab51-6db005c8c855",
        "tags" : [
        ]
      },
      {
        "id" : "c1db3add-7808-419a-8de8-70ba68377623",
        "parentId" : "2201547a-0566-4565-8862-d07c57ce958a",
        "authorId" : "6b2de464-07b6-478f-bdd0-b8707d59c1c1",
        "body" : "Will be difficult to update different records since we are filtering by records of yesterday",
        "createdAt" : "2019-01-28T12:46:35Z",
        "updatedAt" : "2019-01-28T17:12:33Z",
        "lastEditedBy" : "6b2de464-07b6-478f-bdd0-b8707d59c1c1",
        "tags" : [
        ]
      }
    ],
    "commit" : "97112cdf6847478ac3955230466653b5d21f7924",
    "line" : 375,
    "diffHunk" : "@@ -1,1 +373,377 @@\t\t}));\n\n\t\tSessions.update(match, {\n\t\t\t$set: {\n\t\t\t\ttype: 'computed-session',"
  },
  {
    "id" : "0050fe42-7bb9-4c2a-b3b3-8b60d88fcfdf",
    "prId" : 11525,
    "prUrl" : "https://github.com/RocketChat/Rocket.Chat/pull/11525#pullrequestreview-197154310",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f80a2cd0-69f0-4218-8472-68d3c07d27e2",
        "parentId" : null,
        "authorId" : "61ddb048-36d3-4039-ab51-6db005c8c855",
        "body" : "any reason to have this `started` state? I haven't found anything stopping it. and from what I saw there is nothing trying to start it multiple times as well.",
        "createdAt" : "2019-01-28T12:11:58Z",
        "updatedAt" : "2019-01-28T17:12:33Z",
        "lastEditedBy" : "61ddb048-36d3-4039-ab51-6db005c8c855",
        "tags" : [
        ]
      },
      {
        "id" : "7c1fb041-b68a-45cf-87ee-b3463b45e0be",
        "parentId" : "f80a2cd0-69f0-4218-8472-68d3c07d27e2",
        "authorId" : "6b2de464-07b6-478f-bdd0-b8707d59c1c1",
        "body" : "This is just a precaution I guess",
        "createdAt" : "2019-01-28T17:10:49Z",
        "updatedAt" : "2019-01-28T17:12:33Z",
        "lastEditedBy" : "6b2de464-07b6-478f-bdd0-b8707d59c1c1",
        "tags" : [
        ]
      }
    ],
    "commit" : "97112cdf6847478ac3955230466653b5d21f7924",
    "line" : 24,
    "diffHunk" : "@@ -1,1 +22,26 @@export class SAUMonitorClass {\n\tconstructor() {\n\t\tthis._started = false;\n\t\tthis._monitorTime = 60000;\n\t\tthis._timer = null;"
  }
]