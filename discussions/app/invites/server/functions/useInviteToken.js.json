[
  {
    "id" : "522ed414-17d6-4dc7-a5ef-6cd11bdfaf51",
    "prId" : 16176,
    "prUrl" : "https://github.com/RocketChat/Rocket.Chat/pull/16176#pullrequestreview-349582918",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "80c8ed9c-7706-4e1b-8684-0ea6e3a9b393",
        "parentId" : null,
        "authorId" : "6b2de464-07b6-478f-bdd0-b8707d59c1c1",
        "body" : "Rather than save the token id in the user, could add a list of room's ids in the user, grab that info [here](https://github.com/RocketChat/Rocket.Chat/blob/3a5e86400d73896fe4dd5e1eb12101b6448cf17a/app/lib/server/functions/addUserToDefaultChannels.js#L6) merging that rooms with the default ones.",
        "createdAt" : "2020-01-10T22:08:11Z",
        "updatedAt" : "2020-01-28T17:35:09Z",
        "lastEditedBy" : "6b2de464-07b6-478f-bdd0-b8707d59c1c1",
        "tags" : [
        ]
      },
      {
        "id" : "50133246-30cc-483a-bbf5-b66088ad6a18",
        "parentId" : "80c8ed9c-7706-4e1b-8684-0ea6e3a9b393",
        "authorId" : "61ddb048-36d3-4039-ab51-6db005c8c855",
        "body" : "what about if the list of default channels change in the meantime of user register and set his username? I think it is safer to keep just the invite token and It is also less information to be saved. this also helps identifying how the user was registered.",
        "createdAt" : "2020-01-13T12:56:12Z",
        "updatedAt" : "2020-01-28T17:35:09Z",
        "lastEditedBy" : "61ddb048-36d3-4039-ab51-6db005c8c855",
        "tags" : [
        ]
      },
      {
        "id" : "4c872fa5-cf89-45e4-a9bd-ed6ebd4f7d35",
        "parentId" : "80c8ed9c-7706-4e1b-8684-0ea6e3a9b393",
        "authorId" : "6b2de464-07b6-478f-bdd0-b8707d59c1c1",
        "body" : "I was not meaning to save all the channels, but extra channels to be added, in this case always one, but be a list to be prepared.",
        "createdAt" : "2020-01-14T22:55:51Z",
        "updatedAt" : "2020-01-28T17:35:09Z",
        "lastEditedBy" : "6b2de464-07b6-478f-bdd0-b8707d59c1c1",
        "tags" : [
        ]
      },
      {
        "id" : "7a359667-4256-4c08-9383-c3c9814ce788",
        "parentId" : "80c8ed9c-7706-4e1b-8684-0ea6e3a9b393",
        "authorId" : "61ddb048-36d3-4039-ab51-6db005c8c855",
        "body" : "we'll evaluate this again in the future",
        "createdAt" : "2020-01-28T17:56:49Z",
        "updatedAt" : "2020-01-28T17:56:49Z",
        "lastEditedBy" : "61ddb048-36d3-4039-ab51-6db005c8c855",
        "tags" : [
        ]
      }
    ],
    "commit" : "8109b311ac771e6dbd44b8ee2d4a574bc845e952",
    "line" : 12,
    "diffHunk" : "@@ -1,1 +17,21 @@\n\tconst user = Users.findOneById(userId);\n\tUsers.updateInviteToken(user._id, token);\n\n\tInvites.increaseUsageById(inviteData._id);"
  },
  {
    "id" : "d2146cff-549d-45fd-a79c-985cac64fbd4",
    "prId" : 16176,
    "prUrl" : "https://github.com/RocketChat/Rocket.Chat/pull/16176#pullrequestreview-341874424",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3ce32216-824c-4407-803e-881b7708d12f",
        "parentId" : null,
        "authorId" : "6b2de464-07b6-478f-bdd0-b8707d59c1c1",
        "body" : "Only need to save the token in the user (or add a list of rooms to join as my previous suggestion) on else here.",
        "createdAt" : "2020-01-10T22:09:20Z",
        "updatedAt" : "2020-01-28T17:35:09Z",
        "lastEditedBy" : "6b2de464-07b6-478f-bdd0-b8707d59c1c1",
        "tags" : [
        ]
      },
      {
        "id" : "83ba6636-4f0c-433d-bcdf-48623b926804",
        "parentId" : "3ce32216-824c-4407-803e-881b7708d12f",
        "authorId" : "ee641223-e33e-44d0-b778-4ca93f51e302",
        "body" : "We thought this could be useful information for statistics at some point, so I'm storing the token to  every registered user.",
        "createdAt" : "2020-01-13T14:19:06Z",
        "updatedAt" : "2020-01-28T17:35:09Z",
        "lastEditedBy" : "ee641223-e33e-44d0-b778-4ca93f51e302",
        "tags" : [
        ]
      }
    ],
    "commit" : "8109b311ac771e6dbd44b8ee2d4a574bc845e952",
    "line" : 25,
    "diffHunk" : "@@ -1,1 +24,28 @@\t// If no username is set yet, then the the join will happen on the setUsername method\n\tif (user.username) {\n\t\taddUserToRoom(room._id, user);\n\t}\n"
  }
]