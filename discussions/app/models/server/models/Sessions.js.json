[
  {
    "id" : "fae13ecf-925e-4024-bf62-8098e661b669",
    "prId" : 19657,
    "prUrl" : "https://github.com/RocketChat/Rocket.Chat/pull/19657#pullrequestreview-538088037",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ed92722b-8cae-4f7c-b193-7b52d2c5210e",
        "parentId" : null,
        "authorId" : "61ddb048-36d3-4039-ab51-6db005c8c855",
        "body" : "by using `$first` it might not respect the rule of \"most important role\" right? I was thinking in a way to solve this and one solution I came up with was adding \"scores\" to roles and saving them on this collection along with the role name, this way we could use `$max` (or `$min`) instead of `$first`.. wdyt?\r\n\r\nmaybe the amount of times this can happen might not be as relevant for such complex change.",
        "createdAt" : "2020-11-24T19:38:51Z",
        "updatedAt" : "2020-11-24T22:10:48Z",
        "lastEditedBy" : "61ddb048-36d3-4039-ab51-6db005c8c855",
        "tags" : [
        ]
      },
      {
        "id" : "2665f73b-bcb4-4b20-bb2f-95b406fb4d4d",
        "parentId" : "ed92722b-8cae-4f7c-b193-7b52d2c5210e",
        "authorId" : "6b2de464-07b6-478f-bdd0-b8707d59c1c1",
        "body" : "@sampaiodiego since it's grouped by user it will be always the same value, will change only if the user changed his role during the day, and then we are considering the first record of the day, I don't see a problem, what do you think?",
        "createdAt" : "2020-11-24T22:12:49Z",
        "updatedAt" : "2020-11-24T22:12:50Z",
        "lastEditedBy" : "6b2de464-07b6-478f-bdd0-b8707d59c1c1",
        "tags" : [
        ]
      },
      {
        "id" : "46548581-a13d-4b65-bea1-35fd8b0cf947",
        "parentId" : "ed92722b-8cae-4f7c-b193-7b52d2c5210e",
        "authorId" : "61ddb048-36d3-4039-ab51-6db005c8c855",
        "body" : "> will change only if the user changed his role during the day\r\n\r\nI was considering this exactly scenario.. but indeed I don't think it is a big problem not consider the \"most important role\" only on that day, for that user.",
        "createdAt" : "2020-11-25T01:19:41Z",
        "updatedAt" : "2020-11-25T01:19:41Z",
        "lastEditedBy" : "61ddb048-36d3-4039-ab51-6db005c8c855",
        "tags" : [
        ]
      }
    ],
    "commit" : "8e1623650508fc6682465dcb66df383ad1d1c7ff",
    "line" : 20,
    "diffHunk" : "@@ -1,1 +48,52 @@\t\t\t\t\tyear: '$year',\n\t\t\t\t},\n\t\t\t\tmostImportantRole: { $first: '$mostImportantRole' },\n\t\t\t\ttime: { $sum: '$time' },\n\t\t\t\tsessions: { $sum: 1 },"
  },
  {
    "id" : "49f3882f-af13-4668-862e-dd3b14c8b3c1",
    "prId" : 14418,
    "prUrl" : "https://github.com/RocketChat/Rocket.Chat/pull/14418#pullrequestreview-235657584",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "619faf00-4434-4585-8438-3cb302a050b1",
        "parentId" : null,
        "authorId" : "61ddb048-36d3-4039-ab51-6db005c8c855",
        "body" : "any reason to export a whole object instead of individual functions?",
        "createdAt" : "2019-05-09T14:15:26Z",
        "updatedAt" : "2019-05-09T14:44:40Z",
        "lastEditedBy" : "61ddb048-36d3-4039-ab51-6db005c8c855",
        "tags" : [
        ]
      },
      {
        "id" : "264e0f61-1f6c-4f72-b658-53f80a327e7f",
        "parentId" : "619faf00-4434-4585-8438-3cb302a050b1",
        "authorId" : "6b2de464-07b6-478f-bdd0-b8707d59c1c1",
        "body" : "Just to be more organized and clear about what the methods does",
        "createdAt" : "2019-05-09T14:45:39Z",
        "updatedAt" : "2019-05-09T14:45:39Z",
        "lastEditedBy" : "6b2de464-07b6-478f-bdd0-b8707d59c1c1",
        "tags" : [
        ]
      },
      {
        "id" : "0f7aa29b-579b-4dd5-aa2e-166ca78af1fd",
        "parentId" : "619faf00-4434-4585-8438-3cb302a050b1",
        "authorId" : "61ddb048-36d3-4039-ab51-6db005c8c855",
        "body" : "IMO it is more organized when you export individual functions.. function names should be clear enough for explanation =) \r\n\r\nor should they be static methods of the `Sessions` class? idk.",
        "createdAt" : "2019-05-09T15:23:06Z",
        "updatedAt" : "2019-05-09T15:23:06Z",
        "lastEditedBy" : "61ddb048-36d3-4039-ab51-6db005c8c855",
        "tags" : [
        ]
      }
    ],
    "commit" : "91b760ba1170e7cf5fd8fbe815d86a2a923e8ad7",
    "line" : 3,
    "diffHunk" : "@@ -1,1 +1,5 @@import { Base } from './_Base';\n\nexport const aggregates = {\n\tdailySessionsOfYesterday(collection, { year, month, day }) {\n\t\treturn collection.aggregate([{"
  }
]