[
  {
    "id" : "5ff88c61-e343-4b27-b4c5-1f0bbca297f3",
    "prId" : 25092,
    "prUrl" : "https://github.com/pandas-dev/pandas/pull/25092#pullrequestreview-202513443",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "01f1c85f-e997-4a0a-9b19-66694183ce3d",
        "parentId" : null,
        "authorId" : "5e8c5ef2-940b-436e-9c5f-98ae5460128c",
        "body" : "What was the requirement for this change?",
        "createdAt" : "2019-02-11T22:20:13Z",
        "updatedAt" : "2019-06-28T14:48:45Z",
        "lastEditedBy" : "5e8c5ef2-940b-436e-9c5f-98ae5460128c",
        "tags" : [
        ]
      },
      {
        "id" : "94dd1324-4a7c-4fe9-ad72-b2e298bf6445",
        "parentId" : "01f1c85f-e997-4a0a-9b19-66694183ce3d",
        "authorId" : "e56d2a4d-ce5a-4b87-90bb-9f43725365df",
        "body" : "sheet.nrows is an abstraction leakage of xlrd, an openpyxl sheet does not have this attribute. I think checking for if there is data is more explicit end general.",
        "createdAt" : "2019-02-12T07:21:34Z",
        "updatedAt" : "2019-06-28T14:48:45Z",
        "lastEditedBy" : "e56d2a4d-ce5a-4b87-90bb-9f43725365df",
        "tags" : [
        ]
      }
    ],
    "commit" : "dddc8c5aee1ab2d4529b30e516a86fe3db750c12",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +423,427 @@            usecols = _maybe_convert_usecols(usecols)\n\n            if not data:\n                output[asheetname] = DataFrame()\n                continue"
  },
  {
    "id" : "ca511b23-b911-48d7-a418-fa39b793eadd",
    "prId" : 25153,
    "prUrl" : "https://github.com/pandas-dev/pandas/pull/25153#pullrequestreview-199914659",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d74100a9-33a3-435c-9550-b46b86e5a07a",
        "parentId" : null,
        "authorId" : "5e8c5ef2-940b-436e-9c5f-98ae5460128c",
        "body" : "Had to move this into the class as it would be a circular reference otherwise, though ideally this shouldn't be required at all in the base class",
        "createdAt" : "2019-02-05T04:50:33Z",
        "updatedAt" : "2019-02-11T00:59:28Z",
        "lastEditedBy" : "5e8c5ef2-940b-436e-9c5f-98ae5460128c",
        "tags" : [
        ]
      }
    ],
    "commit" : "85f2fe8d2f4c7c39f4744e442fecbbe3e538b1d5",
    "line" : 752,
    "diffHunk" : "@@ -1,1 +750,754 @@    \"\"\"\n\n    from pandas.io.excel._xlrd import _XlrdReader\n\n    _engines = {"
  },
  {
    "id" : "3710d751-b4b9-44d7-9874-06b7294498ad",
    "prId" : 25153,
    "prUrl" : "https://github.com/pandas-dev/pandas/pull/25153#pullrequestreview-200888051",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6ca16b0b-3ae8-459d-9312-7f23730ef013",
        "parentId" : null,
        "authorId" : "51189123-86a2-400a-9762-6816882b6f12",
        "body" : "Why do we need to create this `error` variable?",
        "createdAt" : "2019-02-07T01:28:31Z",
        "updatedAt" : "2019-02-11T00:59:28Z",
        "lastEditedBy" : "51189123-86a2-400a-9762-6816882b6f12",
        "tags" : [
        ]
      }
    ],
    "commit" : "85f2fe8d2f4c7c39f4744e442fecbbe3e538b1d5",
    "line" : 595,
    "diffHunk" : "@@ -1,1 +593,597 @@                    error = ValueError(\"No engine for filetype: '{ext}'\"\n                                       .format(ext=ext))\n                    raise error\n            cls = get_writer(engine)\n"
  },
  {
    "id" : "0bb908e6-e6ed-4820-9b1f-0454d793cb57",
    "prId" : 26553,
    "prUrl" : "https://github.com/pandas-dev/pandas/pull/26553#pullrequestreview-243042409",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2782085f-d49a-42dd-877a-7547d925a642",
        "parentId" : null,
        "authorId" : "5e8c5ef2-940b-436e-9c5f-98ae5460128c",
        "body" : "This isn't a user-facing bug but trying to import any of the ExcelWriter subclasses would exhibit rather surprising behavior which causes a test failure when getting rid of the subclassing. For instance:\r\n\r\n```python\r\n>>> from pandas.io.excel._openpyxl import _OpenpyxlWriter\r\n>>> writer = _OpenpyxlWriter('foo.xlsx')\r\n>>> type(writer)\r\n<class 'pandas.io.excel._xlsxwriter._XlsxWriter'>\r\n```\r\n\r\nFrom the comment directly preceding this it appears this condition was backwards, so changed as such",
        "createdAt" : "2019-05-29T05:20:00Z",
        "updatedAt" : "2019-05-29T05:21:24Z",
        "lastEditedBy" : "5e8c5ef2-940b-436e-9c5f-98ae5460128c",
        "tags" : [
        ]
      }
    ],
    "commit" : "39e4d4e37dca818ce73ed06924a1a79c323bd797",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +592,596 @@        # only switch class if generic(ExcelWriter)\n\n        if cls is ExcelWriter:\n            if engine is None or (isinstance(engine, str) and\n                                  engine == 'auto'):"
  },
  {
    "id" : "bd5b24ca-7e27-4726-85a2-2180246eb19d",
    "prId" : 26736,
    "prUrl" : "https://github.com/pandas-dev/pandas/pull/26736#pullrequestreview-247385968",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "782167e6-02fe-4069-b4df-84239fe36fa7",
        "parentId" : null,
        "authorId" : "5e8c5ef2-940b-436e-9c5f-98ae5460128c",
        "body" : "Is `io.engine` ever None? Coverage here might be a little suspect for cases like:\r\n\r\n```python\r\nread_excel(ExcelFile(), engine='xlrd')\r\n```\r\n\r\nwhich I suppose should work fine (assuming xlrd is default) but may not be covered here explicitly",
        "createdAt" : "2019-06-08T16:20:21Z",
        "updatedAt" : "2019-06-10T20:55:11Z",
        "lastEditedBy" : "5e8c5ef2-940b-436e-9c5f-98ae5460128c",
        "tags" : [
        ]
      },
      {
        "id" : "e8e22e16-ae32-4e08-994c-64857240f0cb",
        "parentId" : "782167e6-02fe-4069-b4df-84239fe36fa7",
        "authorId" : "ebd948a0-48ff-4dbe-a0c8-476953d697fa",
        "body" : "Current behaviour is `io.engine` in this line will default to 'xlrd' since that's in the ExcelFile constuctor -> added a test case to make this more explicit.",
        "createdAt" : "2019-06-09T00:20:24Z",
        "updatedAt" : "2019-06-10T20:55:11Z",
        "lastEditedBy" : "ebd948a0-48ff-4dbe-a0c8-476953d697fa",
        "tags" : [
        ]
      }
    ],
    "commit" : "f52a53aa8bfc9b2a8576bfd1a694743ea133f4af",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +290,294 @@    if not isinstance(io, ExcelFile):\n        io = ExcelFile(io, engine=engine)\n    elif engine and engine != io.engine:\n        raise ValueError(\"Engine should not be specified when passing \"\n                         \"an ExcelFile - ExcelFile already has the engine set\")"
  },
  {
    "id" : "5daadaf2-c36e-4be5-a80c-a4013bcfdfa5",
    "prId" : 30519,
    "prUrl" : "https://github.com/pandas-dev/pandas/pull/30519#pullrequestreview-338026893",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "1f3fb0ca-db28-43ca-ba01-7bcc4474360e",
        "parentId" : null,
        "authorId" : "5e8c5ef2-940b-436e-9c5f-98ae5460128c",
        "body" : "Is BytesIO absolutely required here? Seems like we could treat str / bytes more consistently",
        "createdAt" : "2020-01-03T00:58:11Z",
        "updatedAt" : "2020-01-03T11:16:23Z",
        "lastEditedBy" : "5e8c5ef2-940b-436e-9c5f-98ae5460128c",
        "tags" : [
        ]
      },
      {
        "id" : "dd429b80-725a-4181-870a-8c573d3401e9",
        "parentId" : "1f3fb0ca-db28-43ca-ba01-7bcc4474360e",
        "authorId" : "51189123-86a2-400a-9762-6816882b6f12",
        "body" : "> Seems like we could treat str / bytes more consistently\r\n\r\n@WillAyd : Consistently how?\r\n\r\nI could see some refactoring of this logic (there's a lot of duplicate `load_workbook` code), but in general, I think this addition makes sense.",
        "createdAt" : "2020-01-03T01:34:20Z",
        "updatedAt" : "2020-01-03T11:16:23Z",
        "lastEditedBy" : "51189123-86a2-400a-9762-6816882b6f12",
        "tags" : [
        ]
      },
      {
        "id" : "48dcd472-1842-4895-b7d8-64e052069d09",
        "parentId" : "1f3fb0ca-db28-43ca-ba01-7bcc4474360e",
        "authorId" : "5e8c5ef2-940b-436e-9c5f-98ae5460128c",
        "body" : "We aren't wrapping str with an IO object so asking if that's really required for bytes",
        "createdAt" : "2020-01-03T01:35:33Z",
        "updatedAt" : "2020-01-03T11:16:23Z",
        "lastEditedBy" : "5e8c5ef2-940b-436e-9c5f-98ae5460128c",
        "tags" : [
        ]
      },
      {
        "id" : "aca0fef7-3b79-40b4-b11b-5b3d2efe2226",
        "parentId" : "1f3fb0ca-db28-43ca-ba01-7bcc4474360e",
        "authorId" : "51189123-86a2-400a-9762-6816882b6f12",
        "body" : "Gotcha.  Thanks for clarifying!\r\n\r\n@ftruzzi : Can you confirm if `BytesIO` is needed or not?\r\n\r\nI suspect the answer is yes, but makes sense to double check for future reference.",
        "createdAt" : "2020-01-03T02:04:58Z",
        "updatedAt" : "2020-01-03T11:16:23Z",
        "lastEditedBy" : "51189123-86a2-400a-9762-6816882b6f12",
        "tags" : [
        ]
      },
      {
        "id" : "eefec2b3-c807-443b-b8a0-4190374d4a58",
        "parentId" : "1f3fb0ca-db28-43ca-ba01-7bcc4474360e",
        "authorId" : "53234afb-349b-4fe3-8dbe-64f563e84041",
        "body" : "Yes I think it is needed. Probably `str` works just for filenames and not for stringified objects?\r\n\r\nI had tried to treat `str` and `buffer` the same way, which could work with xlrd by passing the file contents to the `file_contents` kwarg in `xlrd.open_workbook` but I found no way to do the same thing in openpyxl and other engines.\r\n\r\nAnd just by skipping `BytesIO`, engines complain as they try to open the thing as if it was a file:\r\n```\r\nFile \"...\\xlrd\\__init__.py\", line 111, in open_workbook\r\n    with open(filename, \"rb\") as f:\r\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0x91 in position 14: invalid start byte\r\n```\r\nand\r\n```\r\nopenpyxl.utils.exceptions.InvalidFileException: openpyxl does not support b'.relspk\\x05\\x06\\x00\\x00\\x00\\x00\\x1d\\x00\\x1d\\x00\\xe1\\x07\\x00\\x00\\x8f\\xa9\\x0e\\x00\\x00\\x00' file format, please check you can open it with Excel first. Supported formats are: .xlsx,.xlsm,.xltx,.xltm\r\n```",
        "createdAt" : "2020-01-03T10:42:37Z",
        "updatedAt" : "2020-01-03T11:16:23Z",
        "lastEditedBy" : "53234afb-349b-4fe3-8dbe-64f563e84041",
        "tags" : [
        ]
      }
    ],
    "commit" : "1ab35b2672e2e5b134f63d370a27ec9e90c79850",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +352,356 @@            self.book = self.load_workbook(filepath_or_buffer)\n        elif isinstance(filepath_or_buffer, bytes):\n            self.book = self.load_workbook(BytesIO(filepath_or_buffer))\n        else:\n            raise ValueError("
  },
  {
    "id" : "2e1a12e3-bf1c-4bd7-9bc4-4bcc47276f80",
    "prId" : 32544,
    "prUrl" : "https://github.com/pandas-dev/pandas/pull/32544#pullrequestreview-372827916",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7b83f4b0-8ad8-492e-9e28-b13b383c6c5e",
        "parentId" : null,
        "authorId" : "b0c8ea7f-389d-4305-8e0a-a1a394b9fcc2",
        "body" : "Would it make sense to make this an abstract method, and make child classes be explicit on how the close is performed (including when no close is performed)?",
        "createdAt" : "2020-03-11T12:50:07Z",
        "updatedAt" : "2020-03-12T02:29:39Z",
        "lastEditedBy" : "b0c8ea7f-389d-4305-8e0a-a1a394b9fcc2",
        "tags" : [
        ]
      },
      {
        "id" : "deba416f-c80b-4d92-8e0c-1bb3a34d3041",
        "parentId" : "7b83f4b0-8ad8-492e-9e28-b13b383c6c5e",
        "authorId" : "92af78be-4738-4bc6-b40e-4ef15a6e8b70",
        "body" : "In an earlier version of this PR, this was an abstract method, but the powers that be preferred this.",
        "createdAt" : "2020-03-11T14:35:07Z",
        "updatedAt" : "2020-03-12T02:29:39Z",
        "lastEditedBy" : "92af78be-4738-4bc6-b40e-4ef15a6e8b70",
        "tags" : [
        ]
      },
      {
        "id" : "c2b35fec-9632-41e4-b6c4-671439f0912c",
        "parentId" : "7b83f4b0-8ad8-492e-9e28-b13b383c6c5e",
        "authorId" : "21b82015-4bfc-4f74-bfca-586973dad2cd",
        "body" : "We can't make a new abstract method in a bugfix release. Any child not implementing it would fail when the class is instantiated.",
        "createdAt" : "2020-03-11T14:46:36Z",
        "updatedAt" : "2020-03-12T02:29:39Z",
        "lastEditedBy" : "21b82015-4bfc-4f74-bfca-586973dad2cd",
        "tags" : [
        ]
      }
    ],
    "commit" : "a8ea7bbe38ee21bf685ef7a5cfc7a96817a56cc1",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +367,371 @@        pass\n\n    def close(self):\n        pass\n"
  }
]