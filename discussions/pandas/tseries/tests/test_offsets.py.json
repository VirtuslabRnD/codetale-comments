[
  {
    "id" : "ce64af89-48a7-4faf-8043-0206c4fd0331",
    "prId" : 4614,
    "prUrl" : null,
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "38b90891-dd77-4333-be66-5eba9d7695b2",
        "parentId" : null,
        "authorId" : "7086d5c0-382b-4c41-b70d-144a07643f71",
        "body" : "do these fail before the change?\n",
        "createdAt" : "2013-08-20T13:21:39Z",
        "updatedAt" : "2013-08-22T22:55:07Z",
        "lastEditedBy" : "7086d5c0-382b-4c41-b70d-144a07643f71",
        "tags" : [
        ]
      },
      {
        "id" : "2d2818ac-fa96-48bc-904f-e523ae01ba4d",
        "parentId" : "38b90891-dd77-4333-be66-5eba9d7695b2",
        "authorId" : "a29d5616-bdfa-4811-b650-6808742d3435",
        "body" : "One test fails and one passes.\nOn Aug 20, 2013 9:22 AM, \"jreback\" notifications@github.com wrote:\n\n> In pandas/tseries/tests/test_offsets.py:\n> \n> > @@ -1790,6 +1791,13 @@ def test_freq_offsets():\n> >      off = BDay(1, offset=timedelta(0, -1800))\n> >      assert(off.freqstr == 'B-30Min')\n> > \n> > +class TestCaching(unittest.TestCase):\n> \n> do these fail before the change?\n> \n> â€”\n> Reply to this email directly or view it on GitHubhttps://github.com/pydata/pandas/pull/4614/files#r5867897\n> .\n",
        "createdAt" : "2013-08-20T13:24:53Z",
        "updatedAt" : "2013-08-22T22:55:07Z",
        "lastEditedBy" : "a29d5616-bdfa-4811-b650-6808742d3435",
        "tags" : [
        ]
      },
      {
        "id" : "a50a674d-260b-497d-97f0-efa0a1dbbb1a",
        "parentId" : "38b90891-dd77-4333-be66-5eba9d7695b2",
        "authorId" : "7086d5c0-382b-4c41-b70d-144a07643f71",
        "body" : "what did this _affect_ meaning, was there a user visible something that wasn't working ?\n",
        "createdAt" : "2013-08-20T13:33:17Z",
        "updatedAt" : "2013-08-22T22:55:07Z",
        "lastEditedBy" : "7086d5c0-382b-4c41-b70d-144a07643f71",
        "tags" : [
        ]
      },
      {
        "id" : "9af81089-e801-41ce-94cf-f05264cce5bb",
        "parentId" : "38b90891-dd77-4333-be66-5eba9d7695b2",
        "authorId" : "a29d5616-bdfa-4811-b650-6808742d3435",
        "body" : "The check as to whether a range is cacheable would have failed, so likely the visible results would be the same but certain ranges would not be cached even when they could be. See the logic I factored out here: https://github.com/cancan101/pandas/commit/f0fa116df21b3ce675a8c3a63f077c5899928e1e for where CacheableOffset is used.\n",
        "createdAt" : "2013-08-20T14:02:17Z",
        "updatedAt" : "2013-08-22T22:55:07Z",
        "lastEditedBy" : "a29d5616-bdfa-4811-b650-6808742d3435",
        "tags" : [
        ]
      },
      {
        "id" : "6cfeb4c1-da5d-4b46-aba6-c5cf84b1806d",
        "parentId" : "38b90891-dd77-4333-be66-5eba9d7695b2",
        "authorId" : "7086d5c0-382b-4c41-b70d-144a07643f71",
        "body" : "can you add a test for that, e.g. create a range that is cachable and test whether it actually is? (which should fail in the prior version)\n",
        "createdAt" : "2013-08-20T14:23:25Z",
        "updatedAt" : "2013-08-22T22:55:07Z",
        "lastEditedBy" : "7086d5c0-382b-4c41-b70d-144a07643f71",
        "tags" : [
        ]
      },
      {
        "id" : "7135bff1-f308-43a0-827b-5bb332f09392",
        "parentId" : "38b90891-dd77-4333-be66-5eba9d7695b2",
        "authorId" : "a29d5616-bdfa-4811-b650-6808742d3435",
        "body" : "Do you think unit test of `_use_cached_range` would be sufficient?\n",
        "createdAt" : "2013-08-20T14:36:59Z",
        "updatedAt" : "2013-08-22T22:55:07Z",
        "lastEditedBy" : "a29d5616-bdfa-4811-b650-6808742d3435",
        "tags" : [
        ]
      },
      {
        "id" : "63c6b7e8-b9b8-455d-be79-436695d43af5",
        "parentId" : "38b90891-dd77-4333-be66-5eba9d7695b2",
        "authorId" : "7086d5c0-382b-4c41-b70d-144a07643f71",
        "body" : "just create a range and test it, should be simple no?\n",
        "createdAt" : "2013-08-20T14:40:50Z",
        "updatedAt" : "2013-08-22T22:55:07Z",
        "lastEditedBy" : "7086d5c0-382b-4c41-b70d-144a07643f71",
        "tags" : [
        ]
      },
      {
        "id" : "b4d9cdcf-f79e-4e2b-8376-056d76204828",
        "parentId" : "38b90891-dd77-4333-be66-5eba9d7695b2",
        "authorId" : "a29d5616-bdfa-4811-b650-6808742d3435",
        "body" : "What exactly do you mean here? I tried the following:\n\n```\n        range1 = DatetimeIndex(start=datetime(2013,1,31), end=datetime(2013,3,29), freq=BusinessMonthEnd(), normalize=True)\n        range2 = DatetimeIndex(start=datetime(2013,1,31), end=datetime(2013,3,29), freq=BusinessMonthEnd(), normalize=True)\n        self.assertIs(range1, range2)\n```\n\nbut apparently even when caching works, it not ensure referential equality.\n\nI can test the new function I created, `_use_cached_range(offset, _normalized, start, end)` but I am not sure how interesting of a test that would be.\n\nAnother option is to inspect the `_daterange_cache` and see that an entry has been added, which when the `CacheableOffset` is used incorrectly does not get added, but after fixing, does.\n",
        "createdAt" : "2013-08-21T12:27:39Z",
        "updatedAt" : "2013-08-22T22:55:07Z",
        "lastEditedBy" : "a29d5616-bdfa-4811-b650-6808742d3435",
        "tags" : [
        ]
      },
      {
        "id" : "9dfe0d65-4a51-43c0-abf5-767023f1b086",
        "parentId" : "38b90891-dd77-4333-be66-5eba9d7695b2",
        "authorId" : "7086d5c0-382b-4c41-b70d-144a07643f71",
        "body" : "maybe 2nd soln is way to go....I have found that we spent lots of time making caches (which is good), but then don't subsequently test them so that some change down the line causes the caching not to happen! Just want a test to ensure future changes will be able to catch this\n",
        "createdAt" : "2013-08-21T13:10:07Z",
        "updatedAt" : "2013-08-22T22:55:07Z",
        "lastEditedBy" : "7086d5c0-382b-4c41-b70d-144a07643f71",
        "tags" : [
        ]
      },
      {
        "id" : "ba26217c-1f16-41a8-ac93-019406b176db",
        "parentId" : "38b90891-dd77-4333-be66-5eba9d7695b2",
        "authorId" : "a29d5616-bdfa-4811-b650-6808742d3435",
        "body" : "@jreback: I did have one more idea for testing (I haven't looked to see if this works yet): check the referential equality of the items in `DatetimeIndex` rather than the index itself.\n",
        "createdAt" : "2013-08-21T13:18:26Z",
        "updatedAt" : "2013-08-22T22:55:07Z",
        "lastEditedBy" : "a29d5616-bdfa-4811-b650-6808742d3435",
        "tags" : [
        ]
      },
      {
        "id" : "9c608312-a7d7-4e98-8270-1007a2fb1cf2",
        "parentId" : "38b90891-dd77-4333-be66-5eba9d7695b2",
        "authorId" : "a29d5616-bdfa-4811-b650-6808742d3435",
        "body" : "Okay. So that other idea does not work. TBH, I am not sure I even understand what this instance of caching is trying to save/ accomplish. The following does not even hold:\n\n```\nf = pd.DatetimeIndex(start=\"2013-01\", end=\"2013-03\", freq=\"M\")\nassert f[0] is f[0]\n```\n\nso when i tried this, it also failed:\n\n```\n        range1 = DatetimeIndex(start=datetime(2013,1,31), end=datetime(2013,3,29), freq=BusinessMonthEnd(), normalize=True)\n        range2 = DatetimeIndex(start=datetime(2013,1,31), end=datetime(2013,3,29), freq=BusinessMonthEnd(), normalize=True)\n        self.assertIs(range1[0], range2[0])\n```\n\nAt this point, I think I will just assert that the cache is not empty.\n",
        "createdAt" : "2013-08-22T00:32:58Z",
        "updatedAt" : "2013-08-22T22:55:07Z",
        "lastEditedBy" : "a29d5616-bdfa-4811-b650-6808742d3435",
        "tags" : [
        ]
      },
      {
        "id" : "1b57c5ed-cd14-48ee-9d5e-c520c7e46178",
        "parentId" : "38b90891-dd77-4333-be66-5eba9d7695b2",
        "authorId" : "a29d5616-bdfa-4811-b650-6808742d3435",
        "body" : "Is this supposed be true:\n\n```\nf = pd.DatetimeIndex(start=\"2013-01\", end=\"2013-03\", freq=\"M\")\nassert f[0] is f[0]\n```\n\n? Otherwise I am not sure what the caching is trying to avoid.\n",
        "createdAt" : "2013-08-22T15:24:44Z",
        "updatedAt" : "2013-08-22T22:55:07Z",
        "lastEditedBy" : "a29d5616-bdfa-4811-b650-6808742d3435",
        "tags" : [
        ]
      }
    ],
    "commit" : "25cfcaf3c81b59e44225a752cd347e06a5c63993",
    "line" : null,
    "diffHunk" : "@@ -1,1 +1800,1804 @@    return ret\n\nclass TestCaching(unittest.TestCase):    \n    def test_should_cache_month_end(self):\n        self.assertTrue(MonthEnd()._should_cache())"
  }
]