[
  {
    "id" : "4ba16234-6071-4a40-8587-0b9971f3d061",
    "prId" : 16663,
    "prUrl" : "https://github.com/pandas-dev/pandas/pull/16663#pullrequestreview-43335618",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "29dd6543-b8a1-4d8e-aff0-67edd42c92f9",
        "parentId" : null,
        "authorId" : "7086d5c0-382b-4c41-b70d-144a07643f71",
        "body" : "does this only read min(bytes left, nbytes)?",
        "createdAt" : "2017-06-11T15:51:30Z",
        "updatedAt" : "2017-06-11T19:29:01Z",
        "lastEditedBy" : "7086d5c0-382b-4c41-b70d-144a07643f71",
        "tags" : [
        ]
      },
      {
        "id" : "02004445-0437-4d25-a188-42a692d9d2a5",
        "parentId" : "29dd6543-b8a1-4d8e-aff0-67edd42c92f9",
        "authorId" : "51189123-86a2-400a-9762-6816882b6f12",
        "body" : "Yes, that is correct.",
        "createdAt" : "2017-06-11T18:22:10Z",
        "updatedAt" : "2017-06-11T19:29:01Z",
        "lastEditedBy" : "51189123-86a2-400a-9762-6816882b6f12",
        "tags" : [
        ]
      },
      {
        "id" : "b2d612b8-bfe7-4909-9a0c-4fad730a843c",
        "parentId" : "29dd6543-b8a1-4d8e-aff0-67edd42c92f9",
        "authorId" : "48974eb0-1c60-4cb3-9d9f-441b419802dc",
        "body" : "no, `fread()` will put up to sizeof(char) * nbytes into the buffer at src->buffer. if nbytes is greater than fs->size, then this will overflow. the rest of pandas may limit nbytes to fs->size before passing it to `buffer_file_bytes()`, but id argue that makes reading or auditing this code harder.",
        "createdAt" : "2017-06-12T01:21:54Z",
        "updatedAt" : "2017-06-12T01:21:54Z",
        "lastEditedBy" : "48974eb0-1c60-4cb3-9d9f-441b419802dc",
        "tags" : [
        ]
      },
      {
        "id" : "2e585386-3741-4b02-8ff3-5f1ed49c46b9",
        "parentId" : "29dd6543-b8a1-4d8e-aff0-67edd42c92f9",
        "authorId" : "51189123-86a2-400a-9762-6816882b6f12",
        "body" : "I'm pretty sure we'll hit end-of-file first, and it will terminate then, no?",
        "createdAt" : "2017-06-12T01:39:13Z",
        "updatedAt" : "2017-06-12T01:39:42Z",
        "lastEditedBy" : "51189123-86a2-400a-9762-6816882b6f12",
        "tags" : [
        ]
      },
      {
        "id" : "7f8b204e-7718-4d12-9c96-b1bb167ca508",
        "parentId" : "29dd6543-b8a1-4d8e-aff0-67edd42c92f9",
        "authorId" : "48974eb0-1c60-4cb3-9d9f-441b419802dc",
        "body" : "if the file or the remainder of the file is shorter than fs->size, yes. that isn't the only situation `buffer_file_bytes()` is called in though.\r\n\r\nsay you have a 1MB file, and `new_file_source()` is called with 1000 as the buffer_size argument, then fs->size will be 1000 bytes long. if `buffer_file_bytes()` is called with nbytes as 2000, then you will read 2000 bytes into a 1000 byte long buffer because there at least that much data available in the file.",
        "createdAt" : "2017-06-12T01:43:18Z",
        "updatedAt" : "2017-06-12T01:43:18Z",
        "lastEditedBy" : "48974eb0-1c60-4cb3-9d9f-441b419802dc",
        "tags" : [
        ]
      },
      {
        "id" : "1abc8bca-ebd6-46c2-a050-0b4acdef6fbc",
        "parentId" : "29dd6543-b8a1-4d8e-aff0-67edd42c92f9",
        "authorId" : "51189123-86a2-400a-9762-6816882b6f12",
        "body" : "Okay, got it.  I'll add that to my follow-up PR then.",
        "createdAt" : "2017-06-12T01:47:30Z",
        "updatedAt" : "2017-06-12T01:47:30Z",
        "lastEditedBy" : "51189123-86a2-400a-9762-6816882b6f12",
        "tags" : [
        ]
      }
    ],
    "commit" : "69a4ad001b579af5fbdd5eb7775deabfd0c452f1",
    "line" : 78,
    "diffHunk" : "@@ -1,1 +86,90 @@    file_source *src = FS(source);\n\n    *bytes_read = fread((void *)src->buffer, sizeof(char), nbytes, src->fp);\n\n    if (*bytes_read == 0) {"
  },
  {
    "id" : "1a130d0d-0726-4d3f-b08a-b7f6e2031d75",
    "prId" : 16663,
    "prUrl" : "https://github.com/pandas-dev/pandas/pull/16663#pullrequestreview-43332195",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2dc3d0f5-98ea-4fb4-a10d-6e1961383c43",
        "parentId" : null,
        "authorId" : "7086d5c0-382b-4c41-b70d-144a07643f71",
        "body" : "shouldn't just return NULL here?",
        "createdAt" : "2017-06-11T23:06:57Z",
        "updatedAt" : "2017-06-11T23:08:05Z",
        "lastEditedBy" : "7086d5c0-382b-4c41-b70d-144a07643f71",
        "tags" : [
        ]
      },
      {
        "id" : "6a46b151-0385-499a-bff8-d5350e0bb3ce",
        "parentId" : "2dc3d0f5-98ea-4fb4-a10d-6e1961383c43",
        "authorId" : "51189123-86a2-400a-9762-6816882b6f12",
        "body" : "Yeah, you can just return `NULL` here IINM.",
        "createdAt" : "2017-06-12T00:03:04Z",
        "updatedAt" : "2017-06-12T00:03:09Z",
        "lastEditedBy" : "51189123-86a2-400a-9762-6816882b6f12",
        "tags" : [
        ]
      }
    ],
    "commit" : "69a4ad001b579af5fbdd5eb7775deabfd0c452f1",
    "line" : 161,
    "diffHunk" : "@@ -1,1 +188,192 @@        fprintf(stderr, \"new_file_buffer: mmap() failed.\\n\");\n        free(mm);\n        mm = NULL;\n    }\n"
  }
]