[
  {
    "id" : "d1766611-7edf-4f4a-98e1-86fef9dd9778",
    "prId" : 13516,
    "prUrl" : "https://github.com/numpy/numpy/pull/13516#pullrequestreview-409426447",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "26edff17-c410-48a4-a961-cc0b597d95e9",
        "parentId" : null,
        "authorId" : "23ffb2ec-0278-4386-95f5-84cc15ce2cfd",
        "body" : "last discovered one hopefully.\r\nwe have another issue here with parallel compiling, each dispatched target requires variant flags so I had to call `compile()` multiple times since it doesn't provide an argument to specify flags for each source.\r\n\r\nI have two ways to take in order to fix this issue :\r\n\r\n- by patching the custom `compile()` that defined in `ccompiler.py` to allow non-block calls\r\n   through callable argument.\r\n- by handel parallel compiling internally though threads in here.\r\n\r\n@mattip, @rgommers, any ideas?",
        "createdAt" : "2020-05-08T21:12:47Z",
        "updatedAt" : "2020-06-16T16:44:58Z",
        "lastEditedBy" : "23ffb2ec-0278-4386-95f5-84cc15ce2cfd",
        "tags" : [
        ]
      },
      {
        "id" : "4fc1eff4-5572-44a0-b94a-ce4c46a46a4b",
        "parentId" : "26edff17-c410-48a4-a961-cc0b597d95e9",
        "authorId" : "23ffb2ec-0278-4386-95f5-84cc15ce2cfd",
        "body" : "/cc, @juliantaylor",
        "createdAt" : "2020-05-09T00:51:06Z",
        "updatedAt" : "2020-06-16T16:44:58Z",
        "lastEditedBy" : "23ffb2ec-0278-4386-95f5-84cc15ce2cfd",
        "tags" : [
        ]
      },
      {
        "id" : "5bf18e0a-03de-4e11-9038-51960ae0d86a",
        "parentId" : "26edff17-c410-48a4-a961-cc0b597d95e9",
        "authorId" : "8ffdfffb-d8d9-40f6-9de3-dd0dee381149",
        "body" : "> we have another issue here with parallel compiling, each dispatched target requires variant flags so I had to call `compile()` multiple times since it doesn't provide an argument to specify flags for each source.\r\n\r\nNo way around that indeed.\r\n\r\n\r\n\r\n>     * by patching the custom `compile()` that defined in `ccompiler.py` to allow non-block calls\r\n>       through callable argument.\r\n\r\nHmm that doesn't sound attractive, I wouldn't want to monkeypatch `distutils` for some potential speed gain.\r\n\r\n> by handel parallel compiling internally though threads in here.\r\n\r\nDoesn't seem worth it either to be honest. We recently detected a bug in the Fortran support for `--parallel`, that stuff is a bit painful to get right. Let's not worry about compile speed of this for now - first get the patch in, worry about possible compile speedups later.",
        "createdAt" : "2020-05-09T19:20:33Z",
        "updatedAt" : "2020-06-16T16:44:58Z",
        "lastEditedBy" : "8ffdfffb-d8d9-40f6-9de3-dd0dee381149",
        "tags" : [
        ]
      },
      {
        "id" : "397777de-f045-4744-90a5-8d3123ab06c5",
        "parentId" : "26edff17-c410-48a4-a961-cc0b597d95e9",
        "authorId" : "23ffb2ec-0278-4386-95f5-84cc15ce2cfd",
        "body" : "I feel it worth it in the near future since we will have a lot of dispatch-able sources, but it's okay for now.",
        "createdAt" : "2020-05-11T18:33:15Z",
        "updatedAt" : "2020-06-16T16:44:58Z",
        "lastEditedBy" : "23ffb2ec-0278-4386-95f5-84cc15ce2cfd",
        "tags" : [
        ]
      }
    ],
    "commit" : "e72653810f470415f4d78c8a9ea874370a526126",
    "line" : 531,
    "diffHunk" : "@@ -1,1 +529,533 @@\n    def dist_compile(self, sources, flags, **kwargs):\n        \"\"\"Wrap CCompiler.compile()\"\"\"\n        assert(isinstance(sources, list))\n        assert(isinstance(flags, list))"
  },
  {
    "id" : "b54de7dd-97a0-4361-8c20-fa938cc9ecee",
    "prId" : 13516,
    "prUrl" : "https://github.com/numpy/numpy/pull/13516#pullrequestreview-430264652",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a431a8a1-857a-4a53-b456-cb3dd2ba5eee",
        "parentId" : null,
        "authorId" : "23ffb2ec-0278-4386-95f5-84cc15ce2cfd",
        "body" : "@mattip, @rgommers, I reduced the effect of slow compilation due to not taking advantage of parallel compiling by gathering generated sources(wrapped sources) that belong to each required optimization together and then compiling it as a group.\r\nNot a radical solution but will be effective enough when we have many dispatch-able sources.\r\n",
        "createdAt" : "2020-06-15T00:10:02Z",
        "updatedAt" : "2020-06-16T16:44:58Z",
        "lastEditedBy" : "23ffb2ec-0278-4386-95f5-84cc15ce2cfd",
        "tags" : [
        ]
      }
    ],
    "commit" : "e72653810f470415f4d78c8a9ea874370a526126",
    "line" : 2139,
    "diffHunk" : "@@ -1,1 +2137,2141 @@        # - To generate all config headers of the dispatchable sources,\n        #   before the compilation in case if there are dependency relationships\n        #   among them.\n        objects = []\n        for flags, srcs in to_compile.items():"
  },
  {
    "id" : "212922e8-2210-49ba-b9e1-23df11f53933",
    "prId" : 13516,
    "prUrl" : "https://github.com/numpy/numpy/pull/13516#pullrequestreview-444893871",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ad0f7ce4-d366-444d-9db3-f48f5dd5127a",
        "parentId" : null,
        "authorId" : "23ffb2ec-0278-4386-95f5-84cc15ce2cfd",
        "body" : "@mattip, @charris, we can suppress errors from here. if it's necessary I can add support for verbose levels.",
        "createdAt" : "2020-07-08T15:41:50Z",
        "updatedAt" : "2020-07-08T15:41:50Z",
        "lastEditedBy" : "23ffb2ec-0278-4386-95f5-84cc15ce2cfd",
        "tags" : [
        ]
      }
    ],
    "commit" : "e72653810f470415f4d78c8a9ea874370a526126",
    "line" : 681,
    "diffHunk" : "@@ -1,1 +679,683 @@    )\n    @staticmethod\n    def _dist_test_spawn(cmd, display=None):\n        from distutils.errors import CompileError\n        try:"
  }
]