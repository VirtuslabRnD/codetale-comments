[
  {
    "id" : "5e4f39e4-ed09-440d-90e6-3123cbee7e7a",
    "prId" : 9998,
    "prUrl" : "https://github.com/numpy/numpy/pull/9998#pullrequestreview-114184162",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "aeddbb0a-e557-445f-8765-d816f19a3d76",
        "parentId" : null,
        "authorId" : "ab55dc5f-f626-43b1-ba83-3d8843d79a45",
        "body" : "The comment above this line is no longer correct, right?",
        "createdAt" : "2018-04-21T21:31:57Z",
        "updatedAt" : "2018-04-21T21:31:57Z",
        "lastEditedBy" : "ab55dc5f-f626-43b1-ba83-3d8843d79a45",
        "tags" : [
        ]
      },
      {
        "id" : "7289646d-09bc-45b5-b187-aacfece8202f",
        "parentId" : "aeddbb0a-e557-445f-8765-d816f19a3d76",
        "authorId" : "919d650d-5f9e-4069-90f7-968e2cf7bb16",
        "body" : "fixed",
        "createdAt" : "2018-04-21T21:53:56Z",
        "updatedAt" : "2018-04-21T21:53:56Z",
        "lastEditedBy" : "919d650d-5f9e-4069-90f7-968e2cf7bb16",
        "tags" : [
        ]
      }
    ],
    "commit" : "fa9a74165479142e2c1671f871fe7c860146cd52",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +30,34 @@    char started, finished;\n    /* iter must used as a context manager if writebackifcopy semantics used */\n    char managed;\n    /* Child to update for nested iteration */\n    NewNpyArrayIterObject *nested_child;"
  },
  {
    "id" : "7af78a99-aa1b-46d0-ad60-6c455f3d650f",
    "prId" : 9998,
    "prUrl" : "https://github.com/numpy/numpy/pull/9998#pullrequestreview-114184995",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "474b4df6-4550-4cb8-b2a3-861233cc4128",
        "parentId" : null,
        "authorId" : "ab55dc5f-f626-43b1-ba83-3d8843d79a45",
        "body" : "Should probably also check that you're not re-entering the iterator",
        "createdAt" : "2018-04-21T21:33:04Z",
        "updatedAt" : "2018-04-21T21:33:04Z",
        "lastEditedBy" : "ab55dc5f-f626-43b1-ba83-3d8843d79a45",
        "tags" : [
        ]
      },
      {
        "id" : "06f38756-30c6-4671-91ca-499e854c9789",
        "parentId" : "474b4df6-4550-4cb8-b2a3-861233cc4128",
        "authorId" : "ab55dc5f-f626-43b1-ba83-3d8843d79a45",
        "body" : "Either that, or allow re-entrant `with`s, but only cleanup on the outermost one.",
        "createdAt" : "2018-04-21T21:35:28Z",
        "updatedAt" : "2018-04-21T21:35:28Z",
        "lastEditedBy" : "ab55dc5f-f626-43b1-ba83-3d8843d79a45",
        "tags" : [
        ]
      },
      {
        "id" : "6b44f61a-d6cd-4352-9786-bc1f0d7eb475",
        "parentId" : "474b4df6-4550-4cb8-b2a3-861233cc4128",
        "authorId" : "919d650d-5f9e-4069-90f7-968e2cf7bb16",
        "body" : "Reentrant is OK (test added), multiple cleanups are harmless. Once the cleanup is finished, we set `self->managed = CONTEXT_EXITED` so reentering a closed nditer fails (there is a test for that in `test_nditer.py`, line 2847",
        "createdAt" : "2018-04-21T21:43:28Z",
        "updatedAt" : "2018-04-21T21:43:28Z",
        "lastEditedBy" : "919d650d-5f9e-4069-90f7-968e2cf7bb16",
        "tags" : [
        ]
      },
      {
        "id" : "b400c283-27b8-4333-9d1d-eebbd7231928",
        "parentId" : "474b4df6-4550-4cb8-b2a3-861233cc4128",
        "authorId" : "ab55dc5f-f626-43b1-ba83-3d8843d79a45",
        "body" : "I guess the question is, is this the behavior we expect?\r\n```\r\nwith it:\r\n    with it:\r\n        do_stuff_with_it()  # ok\r\n    do_stuff_with(it)  # error: already closed\r\n```\r\n\r\nIt does seem to match how `contextlib.closing` works, so I suppose is consistent.",
        "createdAt" : "2018-04-21T22:37:41Z",
        "updatedAt" : "2018-04-21T22:37:41Z",
        "lastEditedBy" : "ab55dc5f-f626-43b1-ba83-3d8843d79a45",
        "tags" : [
        ]
      }
    ],
    "commit" : "fa9a74165479142e2c1671f871fe7c860146cd52",
    "line" : 178,
    "diffHunk" : "@@ -1,1 +2407,2411 @@        return NULL;\n    }\n    self->managed = CONTEXT_INSIDE;\n    Py_INCREF(self);\n    return (PyObject *)self;"
  },
  {
    "id" : "370d86b9-0b9e-40f7-8233-fc9f31a60382",
    "prId" : 9998,
    "prUrl" : "https://github.com/numpy/numpy/pull/9998#pullrequestreview-114185462",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7342fac1-5aa0-415c-88b9-fbf11724e73d",
        "parentId" : null,
        "authorId" : "ab55dc5f-f626-43b1-ba83-3d8843d79a45",
        "body" : "Shouldn't this happen after `.close()` is called, not just after `__exit__` is called?",
        "createdAt" : "2018-04-21T22:55:59Z",
        "updatedAt" : "2018-04-21T22:55:59Z",
        "lastEditedBy" : "ab55dc5f-f626-43b1-ba83-3d8843d79a45",
        "tags" : [
        ]
      },
      {
        "id" : "6d6b97c0-1dc5-44b4-b6db-51f4c70ce551",
        "parentId" : "7342fac1-5aa0-415c-88b9-fbf11724e73d",
        "authorId" : "919d650d-5f9e-4069-90f7-968e2cf7bb16",
        "body" : "yes, see new PR for issue #10950",
        "createdAt" : "2018-04-21T23:08:44Z",
        "updatedAt" : "2018-04-21T23:08:44Z",
        "lastEditedBy" : "919d650d-5f9e-4069-90f7-968e2cf7bb16",
        "tags" : [
        ]
      }
    ],
    "commit" : "fa9a74165479142e2c1671f871fe7c860146cd52",
    "line" : 65,
    "diffHunk" : "@@ -1,1 +1492,1496 @@    if (self->managed == CONTEXT_EXITED) {\n        PyErr_SetString(PyExc_ValueError,\n                \"Iterator is closed\");\n        return NULL;\n    }"
  }
]