[
  {
    "id" : "1a360507-4ba3-4a98-bb89-da8587397a7b",
    "prId" : 12915,
    "prUrl" : "https://github.com/numpy/numpy/pull/12915#pullrequestreview-199631803",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "55962805-1972-4db8-a8e8-c57e4b10d680",
        "parentId" : null,
        "authorId" : "ab55dc5f-f626-43b1-ba83-3d8843d79a45",
        "body" : "I wonder if it would be better to leverage `numpy.compat.os_fspath` and `numpy.compat.os_PathLike` here. That would look something like the followin\r\n```C\r\nstatic PyObject *os_PathLike = NULL;\r\nstatic PyObject *os_fspath = NULL;\r\n\r\nnpy_cache_import(\"numpy.compat\", \"os_PathLike\", &os_PathLike);\r\nif (os_PathLike == NULL) {\r\n    return NULL;\r\n}\r\nnpy_cache_import(\"numpy.compat\", \"os_fspath\", &os_fspath);\r\nif (os_fspath == NULL) {\r\n    return NULL;\r\n}\r\n\r\nif (!PyObject_IsSubclass(file, os_PathLike)) {\r\n    // assume this is a file handle or a string\r\n    return file;\r\n}\r\nreturn PyObject_CallFunctionObjArgs(os_fspath, file, NULL);\r\n```",
        "createdAt" : "2019-02-04T00:59:34Z",
        "updatedAt" : "2019-06-04T03:02:02Z",
        "lastEditedBy" : "ab55dc5f-f626-43b1-ba83-3d8843d79a45",
        "tags" : [
        ]
      },
      {
        "id" : "814f9bda-17a6-4602-b110-37b16b05b4ce",
        "parentId" : "55962805-1972-4db8-a8e8-c57e4b10d680",
        "authorId" : "907b0c41-3019-4a49-bd46-ac93a0159dca",
        "body" : "That seems reasonable. I was not aware of numpy.compat :)",
        "createdAt" : "2019-02-04T15:06:48Z",
        "updatedAt" : "2019-06-04T03:02:02Z",
        "lastEditedBy" : "907b0c41-3019-4a49-bd46-ac93a0159dca",
        "tags" : [
        ]
      }
    ],
    "commit" : "3c618a3b5cff29e84353bbdd6886e0732eb232a5",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +11,15 @@/* Pathlib support */\nstatic inline PyObject *\nNpyPath_PathlikeToFspath(PyObject *file)\n{\n    static PyObject *os_PathLike = NULL;"
  },
  {
    "id" : "d1f800c8-2e6d-4f63-89a5-737c1e9bc121",
    "prId" : 12915,
    "prUrl" : "https://github.com/numpy/numpy/pull/12915#pullrequestreview-199920715",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ee6e73d1-6df0-482d-a2ae-268f62eaa001",
        "parentId" : null,
        "authorId" : "ab55dc5f-f626-43b1-ba83-3d8843d79a45",
        "body" : "Ditto here - if `os_fspath` is null, you should `return NULL`, because it means something is very wrong.",
        "createdAt" : "2019-02-05T05:37:03Z",
        "updatedAt" : "2019-06-04T03:02:02Z",
        "lastEditedBy" : "ab55dc5f-f626-43b1-ba83-3d8843d79a45",
        "tags" : [
        ]
      }
    ],
    "commit" : "3c618a3b5cff29e84353bbdd6886e0732eb232a5",
    "line" : 21,
    "diffHunk" : "@@ -1,1 +19,23 @@        return NULL;\n    }\n    npy_cache_import(\"numpy.compat\", \"os_fspath\", &os_fspath);\n    if (os_fspath == NULL) {\n        return NULL;"
  }
]