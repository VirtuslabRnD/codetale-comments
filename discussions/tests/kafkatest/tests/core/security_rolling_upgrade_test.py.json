[
  {
    "id" : "4c3d8893-4a7c-4a55-8d1c-47ddc3a757b8",
    "prId" : 8403,
    "prUrl" : "https://github.com/apache/kafka/pull/8403#pullrequestreview-385783124",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8f9969d1-3b7b-45f8-9347-1e398f0d80aa",
        "parentId" : null,
        "authorId" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "body" : "Can you elaborate why we added the two lines above?",
        "createdAt" : "2020-04-01T13:25:06Z",
        "updatedAt" : "2020-04-01T13:25:07Z",
        "lastEditedBy" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "tags" : [
        ]
      },
      {
        "id" : "a2c84b50-459b-4dfa-bce3-da2b5cda168b",
        "parentId" : "8f9969d1-3b7b-45f8-9347-1e398f0d80aa",
        "authorId" : "b4936a15-698a-496e-85a1-b1e229b4986b",
        "body" : "The Kafka service used for system test starts up a client listener and an inter-broker listener and doesn't properly support other listeners. The security protocol and SASL mechanism used for the listeners is derived from the security protocol and the mechanism specified for client/inter-broker. The two lines above work around that limitation by overriding the security protocol and SASL mechanism to allow broker to start up a listener before using it as the inter-broker listener. It would be a much larger change to add proper support for additional listeners to the Kafka service, so I just updated this test which fails very frequently at the moment.",
        "createdAt" : "2020-04-01T14:59:17Z",
        "updatedAt" : "2020-04-01T14:59:17Z",
        "lastEditedBy" : "b4936a15-698a-496e-85a1-b1e229b4986b",
        "tags" : [
        ]
      },
      {
        "id" : "b7e0a984-06ae-4d0c-99a4-c8e1d772802b",
        "parentId" : "8f9969d1-3b7b-45f8-9347-1e398f0d80aa",
        "authorId" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "body" : "Thanks for the explanation. Makes sense. What is the reason why the test started failing frequently?",
        "createdAt" : "2020-04-01T15:51:50Z",
        "updatedAt" : "2020-04-01T15:51:51Z",
        "lastEditedBy" : "d8c7cf80-a55a-474c-a4f4-f60a9efda52c",
        "tags" : [
        ]
      },
      {
        "id" : "ec30cb0e-9eb9-430c-aa23-5ff344a62a07",
        "parentId" : "8f9969d1-3b7b-45f8-9347-1e398f0d80aa",
        "authorId" : "b4936a15-698a-496e-85a1-b1e229b4986b",
        "body" : "Test seems to have been failing since Jan 15th. Not sure if it was more stable before that. Consumer was timing out in the logs I looked at. Will investigate more to see if there is any other issue causing the failures now.",
        "createdAt" : "2020-04-01T17:07:40Z",
        "updatedAt" : "2020-04-01T17:07:40Z",
        "lastEditedBy" : "b4936a15-698a-496e-85a1-b1e229b4986b",
        "tags" : [
        ]
      }
    ],
    "commit" : "4f223d787543ceaab3f88ebf3b54ff2f9c86c6ef",
    "line" : 7,
    "diffHunk" : "@@ -1,1 +100,104 @@        self.kafka.open_port(self.kafka.INTERBROKER_LISTENER_NAME)\n        self.kafka.port_mappings[self.kafka.INTERBROKER_LISTENER_NAME].security_protocol = broker_security_protocol\n        self.kafka.client_sasl_mechanism = broker_sasl_mechanism\n        self.bounce()\n"
  },
  {
    "id" : "711d8da4-ca5c-404e-ad59-e07672ce2df8",
    "prId" : 10694,
    "prUrl" : "https://github.com/apache/kafka/pull/10694#pullrequestreview-660898100",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e3e4d444-623a-43f7-85d9-28d7358b4b77",
        "parentId" : null,
        "authorId" : "e0554c25-f6f3-4e49-a325-bcc5d4dc5fb2",
        "body" : "We can't rely on the client SASL mechanism here with the KRaft-related changes that were made in https://github.com/apache/kafka/pull/10199/ because those KRaft changes made the code very explicit about which SASL mechanisms to add: if the client security protocol is PLAINTEXT then the client SASL mechanism isn't listed as an enabled mechanism.  And in fact for this test the client security protocol is PLAINTEXT.  So we need another way to transmit the SASL mechanism, and that's what the new optional `sas_mechanism` on the KafkaListener in the port mapping is for.",
        "createdAt" : "2021-05-17T12:19:56Z",
        "updatedAt" : "2021-05-17T12:19:56Z",
        "lastEditedBy" : "e0554c25-f6f3-4e49-a325-bcc5d4dc5fb2",
        "tags" : [
        ]
      }
    ],
    "commit" : "ee1d0e44558dff289ec696d2fecb9b24d0803eb7",
    "line" : 20,
    "diffHunk" : "@@ -1,1 +104,108 @@        self.kafka.open_port(self.kafka.INTERBROKER_LISTENER_NAME)\n        self.kafka.port_mappings[self.kafka.INTERBROKER_LISTENER_NAME].security_protocol = broker_security_protocol\n        self.kafka.port_mappings[self.kafka.INTERBROKER_LISTENER_NAME].sasl_mechanism = broker_sasl_mechanism\n        self.bounce()\n"
  }
]