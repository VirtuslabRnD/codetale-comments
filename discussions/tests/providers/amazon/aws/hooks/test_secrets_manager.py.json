[
  {
    "id" : "26365b2e-0f2a-4b12-822c-5747dbfc21a3",
    "prId" : 15051,
    "prUrl" : "https://github.com/apache/airflow/pull/15051#pullrequestreview-622685516",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c7ebd4a4-e378-4132-a3e6-2ed4143cc79d",
        "parentId" : null,
        "authorId" : "e8f8cb6c-db3f-4950-867a-71d1cfa95d74",
        "body" : "Background info on why this change is necessary: AWS will throw an error if you call `put_secret_value` on a secret that hasn't been explicitly created first. Moto now follows that behaviour, as of 2.x.\r\n\r\nIf you want to simplify these tests: there's no need to both create and update the secret. It works by just creating the secret:\r\n```\r\nsecret_name = \"db_cluster-YYYYYYY\"  # no need for this to be an ARN (anymore)\r\nparam = {\r\n            'Name': secret_name,\r\n            'SecretString': secret_value_binary,\r\n        }\r\n\r\n        hook.get_conn().create_secret(**param)\r\n```\r\nThe three tests all pass on moto>=2 with this pattern.\r\n",
        "createdAt" : "2021-03-27T16:21:07Z",
        "updatedAt" : "2021-03-27T18:41:33Z",
        "lastEditedBy" : "e8f8cb6c-db3f-4950-867a-71d1cfa95d74",
        "tags" : [
        ]
      },
      {
        "id" : "88d725fd-1251-49b4-b5e3-3ae1a3c27561",
        "parentId" : "c7ebd4a4-e378-4132-a3e6-2ed4143cc79d",
        "authorId" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "body" : "Nice. But the whole point of those tests is to test \"put_secret_value\" method really, not the \"create_secret\" one :). If we simplify it, we will test different things.",
        "createdAt" : "2021-03-27T16:33:05Z",
        "updatedAt" : "2021-03-27T18:41:33Z",
        "lastEditedBy" : "e8563344-32ea-4c07-9731-a2fed8d2edf2",
        "tags" : [
        ]
      },
      {
        "id" : "087c7401-ce8b-42bc-ad54-a5e8440f99e6",
        "parentId" : "c7ebd4a4-e378-4132-a3e6-2ed4143cc79d",
        "authorId" : "e8f8cb6c-db3f-4950-867a-71d1cfa95d74",
        "body" : "Gotcha, my bad. My assumption was that the point was to test the creation/retrieval flow in general. ",
        "createdAt" : "2021-03-27T16:54:02Z",
        "updatedAt" : "2021-03-27T18:41:33Z",
        "lastEditedBy" : "e8f8cb6c-db3f-4950-867a-71d1cfa95d74",
        "tags" : [
        ]
      }
    ],
    "commit" : "99dec86ef4d28b33b30067daca13546fda7c6581",
    "line" : 15,
    "diffHunk" : "@@ -1,1 +53,57 @@        }\n\n        hook.get_conn().create_secret(**create_param)\n        hook.get_conn().put_secret_value(**put_param)\n"
  }
]