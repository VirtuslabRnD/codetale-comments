[
  {
    "id" : "04bde9a1-6592-4978-acb1-66b2ca4da211",
    "prId" : 16241,
    "prUrl" : "https://github.com/apache/airflow/pull/16241#pullrequestreview-677659880",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9da27cab-b627-4971-80a5-9c16f2876faa",
        "parentId" : null,
        "authorId" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "body" : "here we have access to the query, so we can drop of invoking private methods and compare this value. Thus, this test will still check implementations, but will depend less on the internal details. ",
        "createdAt" : "2021-06-06T12:16:39Z",
        "updatedAt" : "2021-06-06T12:16:39Z",
        "lastEditedBy" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "tags" : [
        ]
      },
      {
        "id" : "cacb07de-ff17-4bea-a406-19210d019561",
        "parentId" : "9da27cab-b627-4971-80a5-9c16f2876faa",
        "authorId" : "5f1d29dc-668b-45d1-a551-8a690d6acd5c",
        "body" : "Thanks for the comment @mik-laj ;)\r\nSo would it be nicer to check execution with plain text rather than invoking private method `op._build_copy_query`  like this? \r\n\r\nFrom checking execution by invoking private method\r\n```python\r\n        copy_query = op._build_copy_query(credentials_block, copy_options)\r\n        expected_copy_query = '''\r\n                                COPY schema.table\r\n                                FROM 's3://bucket/key'\r\n                                with credentials\r\n                                'aws_access_key_id=aws_access_key_id;aws_secret_access_key=aws_secret_access_key'\r\n                                ;\r\n                             '''\r\n        assert_equal_ignore_multiple_spaces(self, expected_copy_query, copy_query)\r\n\r\n        assert mock_run.call_count == 1\r\n        assert access_key in copy_query\r\n        assert secret_key in copy_query\r\n        assert_equal_ignore_multiple_spaces(self, mock_run.call_args[0][0], copy_query)\r\n```\r\nTo checking execution by plain text\r\n```python\r\n        copy_query = '''\r\n                        COPY schema.table\r\n                        FROM 's3://bucket/key'\r\n                        with credentials\r\n                        'aws_access_key_id=aws_access_key_id;aws_secret_access_key=aws_secret_access_key'\r\n                        ;\r\n                     '''\r\n        assert mock_run.call_count == 1\r\n        assert_equal_ignore_multiple_spaces(self, mock_run.call_args[0][0], copy_query)\r\n```\r\n",
        "createdAt" : "2021-06-06T13:04:46Z",
        "updatedAt" : "2021-06-07T14:33:32Z",
        "lastEditedBy" : "5f1d29dc-668b-45d1-a551-8a690d6acd5c",
        "tags" : [
        ]
      },
      {
        "id" : "a74b18aa-9ef6-4a06-88c1-e000d6dbad14",
        "parentId" : "9da27cab-b627-4971-80a5-9c16f2876faa",
        "authorId" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "body" : "Yes. Exactly. We should only check the places where the class is connecting to another class, not its internal details.",
        "createdAt" : "2021-06-07T14:38:58Z",
        "updatedAt" : "2021-06-07T14:38:58Z",
        "lastEditedBy" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "tags" : [
        ]
      },
      {
        "id" : "64a8c52b-0b05-4da3-b41c-368922a89bd4",
        "parentId" : "9da27cab-b627-4971-80a5-9c16f2876faa",
        "authorId" : "5f1d29dc-668b-45d1-a551-8a690d6acd5c",
        "body" : "Done :) \r\nChanged all copy_query to plain text\r\nThanks for all the comment @mik-laj ",
        "createdAt" : "2021-06-07T16:49:52Z",
        "updatedAt" : "2021-06-07T16:49:52Z",
        "lastEditedBy" : "5f1d29dc-668b-45d1-a551-8a690d6acd5c",
        "tags" : [
        ]
      }
    ],
    "commit" : "c7a3cb0de1f2de38337ba61b2917fe4de43e63e6",
    "line" : 22,
    "diffHunk" : "@@ -1,1 +66,70 @@        assert access_key in copy_query\n        assert secret_key in copy_query\n        assert_equal_ignore_multiple_spaces(self, mock_run.call_args[0][0], copy_query)\n\n    @mock.patch(\"boto3.session.Session\")"
  }
]