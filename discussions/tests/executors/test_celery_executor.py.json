[
  {
    "id" : "a5e8a06d-04ca-4f2f-ae4d-aeb417b056a0",
    "prId" : 3773,
    "prUrl" : "https://github.com/apache/airflow/pull/3773#pullrequestreview-147879217",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "90becfb8-2342-4b07-a961-be1e0c8673cc",
        "parentId" : null,
        "authorId" : "59d531be-9d1e-478d-99a0-6e20963d3e21",
        "body" : "This test case change is for `potential bug-1` only.",
        "createdAt" : "2018-08-21T01:39:19Z",
        "updatedAt" : "2018-08-21T01:39:19Z",
        "lastEditedBy" : "59d531be-9d1e-478d-99a0-6e20963d3e21",
        "tags" : [
        ]
      }
    ],
    "commit" : "e62f9b1780d5676826aa2be43aa297d16750b23d",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +56,60 @@\n        self.assertNotIn('success', executor.last_state)\n        self.assertNotIn('fail', executor.last_state)\n\nif __name__ == '__main__':"
  },
  {
    "id" : "ecf81c73-5426-41fc-9f3b-536aeb5198a2",
    "prId" : 3830,
    "prUrl" : "https://github.com/apache/airflow/pull/3830#pullrequestreview-152305561",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c2fccd7b-c9d3-45dd-b15f-73a4f4ccebc3",
        "parentId" : null,
        "authorId" : "38d80383-47b9-439a-9efe-9282f79f8b2f",
        "body" : "I think another good test is to check celery tasks are evenly distributed and picked up by different sync threads.",
        "createdAt" : "2018-09-04T22:58:52Z",
        "updatedAt" : "2018-09-10T19:30:41Z",
        "lastEditedBy" : "38d80383-47b9-439a-9efe-9282f79f8b2f",
        "tags" : [
        ]
      },
      {
        "id" : "1763952c-2d52-4068-a291-7e5068ac7d92",
        "parentId" : "c2fccd7b-c9d3-45dd-b15f-73a4f4ccebc3",
        "authorId" : "a3c64a30-509c-4788-80d1-4f17cb3b5530",
        "body" : "I think that is to test the chunksize parameter of multiprocessing.Pool(), which should be trusted.",
        "createdAt" : "2018-09-05T01:10:51Z",
        "updatedAt" : "2018-09-10T19:30:41Z",
        "lastEditedBy" : "a3c64a30-509c-4788-80d1-4f17cb3b5530",
        "tags" : [
        ]
      }
    ],
    "commit" : "b0b5b980e697ec8dde5beb043338e01a4ef8b7c6",
    "line" : 17,
    "diffHunk" : "@@ -1,1 +60,64 @@        self.assertNotIn('fail', executor.last_state)\n\n    def test_exception_propagation(self):\n        @app.task\n        def fake_celery_task():"
  },
  {
    "id" : "d37d54c4-f0f8-430a-9355-88cacfd56b03",
    "prId" : 4207,
    "prUrl" : "https://github.com/apache/airflow/pull/4207#pullrequestreview-180576552",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "01284c98-46e6-4c31-a523-c052df19c53b",
        "parentId" : null,
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "This looks good, thanks!.\r\n\r\nOne small improvment I'd like you to try:\r\n\r\n```\r\nimport unittest2 as unittest\r\n```\r\n\r\nand then here:\r\n\r\n```\r\nwith self.subTest(broker_url=broker_url):\r\n    yield test_app\r\n```\r\n\r\nThat (should) then provide extra context about which broker has failed when things go wrong.",
        "createdAt" : "2018-12-01T19:11:56Z",
        "updatedAt" : "2018-12-01T19:11:57Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "e863560d-976f-4554-b51d-8a82904cb58e",
        "parentId" : "01284c98-46e6-4c31-a523-c052df19c53b",
        "authorId" : "9a5e8348-c065-464c-a412-d4070cbed6ea",
        "body" : "Let me know if I'm misunderstanding, but I don't *think* we need to use sub-tests here. We're already using `parameterized`, so we get different tests with different names for each broker, which I think is the behavior you're describing: https://travis-ci.org/apache/incubator-airflow/jobs/461875817#L2983-L2984. If not, or if you prefer `subTest` to `parameterized`, I'll go ahead and make the change.",
        "createdAt" : "2018-12-02T02:47:04Z",
        "updatedAt" : "2018-12-02T02:47:05Z",
        "lastEditedBy" : "9a5e8348-c065-464c-a412-d4070cbed6ea",
        "tags" : [
        ]
      },
      {
        "id" : "53ea5c5c-dc7a-4d96-9dcf-bbe69d97055a",
        "parentId" : "01284c98-46e6-4c31-a523-c052df19c53b",
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "Ah so it does. I wasn't familiar with how parameterized works.\r\n\r\nLooks good as it is",
        "createdAt" : "2018-12-02T20:34:17Z",
        "updatedAt" : "2018-12-02T20:34:17Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      }
    ],
    "commit" : "6f7c5cffdff48c12dfffb7fda5221bca16a1bee7",
    "line" : 58,
    "diffHunk" : "@@ -1,1 +66,70 @@        with patch_app, patch_execute:\n            try:\n                yield test_app\n            finally:\n                # Clear event loop to tear down each celery instance"
  },
  {
    "id" : "c3ef9450-8125-4449-a736-3d39a06c6f44",
    "prId" : 8909,
    "prUrl" : "https://github.com/apache/airflow/pull/8909#pullrequestreview-414304175",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a4f79a76-0476-4437-b518-31ae15b6b895",
        "parentId" : null,
        "authorId" : "c25957e2-1132-4c48-a536-3824307fd862",
        "body" : "Does this issue only occur for tests and not likely to occur in the actual code / Airflow deployment?",
        "createdAt" : "2020-05-19T10:13:42Z",
        "updatedAt" : "2020-05-19T11:30:27Z",
        "lastEditedBy" : "c25957e2-1132-4c48-a536-3824307fd862",
        "tags" : [
        ]
      },
      {
        "id" : "939a90f8-925c-46e9-bcea-ad76b2c7d67d",
        "parentId" : "a4f79a76-0476-4437-b518-31ae15b6b895",
        "authorId" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "body" : "This is unlikely to happen in a real environment, because there is a very small chance that all processes/deployment will synchronize. The database is also not created many times in a production environment.",
        "createdAt" : "2020-05-19T10:18:08Z",
        "updatedAt" : "2020-05-19T11:30:27Z",
        "lastEditedBy" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "tags" : [
        ]
      }
    ],
    "commit" : "3902f4d6c90a291aecf1bab302b0e5bc2e08b430",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +76,80 @@    patch_execute = mock.patch('airflow.executors.celery_executor.execute_command', test_execute)\n\n    backend = test_app.backend\n\n    if hasattr(backend, 'ResultSession'):"
  },
  {
    "id" : "316ea15b-ddaa-4323-8a8b-3f06fd8fabc1",
    "prId" : 8909,
    "prUrl" : "https://github.com/apache/airflow/pull/8909#pullrequestreview-414304301",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "052d8d84-84af-474d-a54a-6f36a5385377",
        "parentId" : null,
        "authorId" : "0d4fd7c4-f8ab-4371-acfe-b9cca6decaf5",
        "body" : "Is this check necessary? ",
        "createdAt" : "2020-05-19T10:14:20Z",
        "updatedAt" : "2020-05-19T11:30:27Z",
        "lastEditedBy" : "0d4fd7c4-f8ab-4371-acfe-b9cca6decaf5",
        "tags" : [
        ]
      },
      {
        "id" : "dab6eee6-7265-4372-9699-c794f9bb27d5",
        "parentId" : "052d8d84-84af-474d-a54a-6f36a5385377",
        "authorId" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "body" : "Yes. We can also keep this data in non-DatabaaseBackend.\r\nhttps://github.com/celery/celery/tree/master/celery/backends",
        "createdAt" : "2020-05-19T10:15:49Z",
        "updatedAt" : "2020-05-19T11:30:27Z",
        "lastEditedBy" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "tags" : [
        ]
      },
      {
        "id" : "9f85efcf-c790-4621-b8b0-8abf07b3aae8",
        "parentId" : "052d8d84-84af-474d-a54a-6f36a5385377",
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "Yeah, exactly. We only currently test DB backends in our tests, but I felt better to future proof this for the sake of a single `if`.",
        "createdAt" : "2020-05-19T10:18:19Z",
        "updatedAt" : "2020-05-19T11:30:27Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      }
    ],
    "commit" : "3902f4d6c90a291aecf1bab302b0e5bc2e08b430",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +78,82 @@    backend = test_app.backend\n\n    if hasattr(backend, 'ResultSession'):\n        # Pre-create the database tables now, otherwise SQLA vis Celery has a\n        # race condition where it one of the subprocesses can die with \"Table"
  },
  {
    "id" : "4ebb84d3-51ba-433a-9430-0eca117027dc",
    "prId" : 8909,
    "prUrl" : "https://github.com/apache/airflow/pull/8909#pullrequestreview-414358745",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "dd6fa6a5-564d-48c1-b52f-eb74eaa8a18b",
        "parentId" : null,
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "Curious, in the SQLite tests this is failing with `KeyError: backend`\r\n\r\n@auvipy @mik-laj Any idea how it's possible for the app to _not_ have a backend from here? https://github.com/apache/airflow/blob/5c3248cc4c57be34d868482cf1034fb1d6bfd0bf/tests/executors/test_celery_executor.py#L179-L189",
        "createdAt" : "2020-05-19T11:05:18Z",
        "updatedAt" : "2020-05-19T11:30:27Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "9d35e03d-f536-4708-8b36-58476c2891a3",
        "parentId" : "dd6fa6a5-564d-48c1-b52f-eb74eaa8a18b",
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "Ah okay, I know what's gone on. \r\n\r\nLooking closer at the logs in CI I see \r\n\r\n> E   ModuleNotFoundError: No module named '# overridden by startup scripts'\r\n\r\nPreviously we weren't ever actually creating a backend, so it didn't matter. I think the fix here is to limit this test to mysql+postgres backends only\r\n\r\nSorry for the ping @auvipy for what was (clearly) going to be something we've done.",
        "createdAt" : "2020-05-19T11:28:34Z",
        "updatedAt" : "2020-05-19T11:30:27Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "0cafb777-3879-4fb9-95ee-17a4b73472e5",
        "parentId" : "dd6fa6a5-564d-48c1-b52f-eb74eaa8a18b",
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "Fixed by https://github.com/apache/airflow/pull/8909/files#diff-6342f2098d57976d779e20623d3ff4d5R179-R181\r\n\r\nHappy with that change @mik-laj?",
        "createdAt" : "2020-05-19T11:31:32Z",
        "updatedAt" : "2020-05-19T11:31:32Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "2be2d1f5-c868-4452-8947-81c38001a241",
        "parentId" : "dd6fa6a5-564d-48c1-b52f-eb74eaa8a18b",
        "authorId" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "body" : "It looks good. SQLite is not a good backend for testing distributed applications.",
        "createdAt" : "2020-05-19T11:39:20Z",
        "updatedAt" : "2020-05-19T11:39:20Z",
        "lastEditedBy" : "07638d17-cc8b-40a4-abdc-7b39759362ab",
        "tags" : [
        ]
      }
    ],
    "commit" : "3902f4d6c90a291aecf1bab302b0e5bc2e08b430",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +76,80 @@    patch_execute = mock.patch('airflow.executors.celery_executor.execute_command', test_execute)\n\n    backend = test_app.backend\n\n    if hasattr(backend, 'ResultSession'):"
  }
]