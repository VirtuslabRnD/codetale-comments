[
  {
    "id" : "24a3769b-331e-4e33-9d9f-dc952d9f9a99",
    "prId" : 7835,
    "prUrl" : "https://github.com/lampepfl/dotty/pull/7835#pullrequestreview-336930802",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "df14b9cf-3a14-4cab-85fa-8b5b6b783756",
        "parentId" : null,
        "authorId" : "98bdc06d-7937-462c-9d62-1f850e7819aa",
        "body" : "I would add some more tests:\r\n```scala\r\n   flip(0): 1\r\n   flip(1): 0\r\n\r\n   flip(if ??? then 0 else 1)\r\n   val n: 0 | 1 = if ??? then 0 else 1\r\n   flip(n)\r\n\r\n   val m: n.type match { case 0 => 1 case 1 => 0 } = flip(n)\r\n```\r\n\r\nBut I noticed a strange thing: a match type is apparently not a subtype of the union of it branches. So adding `flip(m)` or `flip(flip(n))` for instance does not work:\r\n\r\n```scala\r\n-- [E007] Type Mismatch Error: tests/pos/i7807.scala:15:8 --------------------------------------------------------------\r\n15 |   flip(m)\r\n   |        ^\r\n   |        Found:    (Test.m :\r\n   |          (Test.n : (0 : Int) | (1 : Int)) match {\r\n   |            case (0 : Int) => (1 : Int)\r\n   |            case (1 : Int) => (0 : Int)\r\n   |          }\r\n   |        )\r\n   |        Required: (0 : Int) | (1 : Int)\r\n```\r\n\r\nShould an issue be opened about this? Though it seems the current spec does not say this should work, I find it surprising that it does not.\r\n",
        "createdAt" : "2019-12-27T20:34:03Z",
        "updatedAt" : "2020-01-06T16:19:24Z",
        "lastEditedBy" : "98bdc06d-7937-462c-9d62-1f850e7819aa",
        "tags" : [
        ]
      },
      {
        "id" : "1288cc06-d06b-4e08-9cc3-e98c2cd7de44",
        "parentId" : "df14b9cf-3a14-4cab-85fa-8b5b6b783756",
        "authorId" : "d08d2c4a-dc79-4be6-96b0-506d21e90d1d",
        "body" : "I am not sure it should work. Generally, match types are on a thin line between expressiveness and soundness. So generally demanding they do more than they do would have to come with an algorithm that shows how to do it and an argument why this would not break soundness. \r\n",
        "createdAt" : "2019-12-28T21:15:35Z",
        "updatedAt" : "2020-01-06T16:19:24Z",
        "lastEditedBy" : "d08d2c4a-dc79-4be6-96b0-506d21e90d1d",
        "tags" : [
        ]
      }
    ],
    "commit" : "2662cdc02c093712da61311c6ada9120e4dc8871",
    "line" : 3,
    "diffHunk" : "@@ -1,1 +1,5 @@object Test with\n\n  def flip: (x: 0 | 1) => x.type match { case 0 => 1 case 1 => 0 } = ???\n\n  flip(0): 1"
  }
]