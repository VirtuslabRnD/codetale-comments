[
  {
    "id" : "2523f1a6-ee3e-4074-8d2e-b1153d27d8e0",
    "prId" : 12816,
    "prUrl" : "https://github.com/apache/airflow/pull/12816#pullrequestreview-545293802",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "fae3e651-28d3-4442-b9b8-f9f38d38b7e1",
        "parentId" : null,
        "authorId" : "59d531be-9d1e-478d-99a0-6e20963d3e21",
        "body" : "Shall we have one more assert between `test_conf.getsection('non_existing_section')` and an empty OrderedDict?",
        "createdAt" : "2020-12-04T19:05:34Z",
        "updatedAt" : "2020-12-04T19:16:50Z",
        "lastEditedBy" : "59d531be-9d1e-478d-99a0-6e20963d3e21",
        "tags" : [
        ]
      },
      {
        "id" : "ac49f881-58ec-4eb4-8c4f-0a292ffc7d59",
        "parentId" : "fae3e651-28d3-4442-b9b8-f9f38d38b7e1",
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "Good idea",
        "createdAt" : "2020-12-04T19:12:40Z",
        "updatedAt" : "2020-12-04T19:16:50Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "3277b8d1-3786-4e43-81fa-3dd93c5419f2",
        "parentId" : "fae3e651-28d3-4442-b9b8-f9f38d38b7e1",
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "Returns None it turns out, but yet lets test it.",
        "createdAt" : "2020-12-04T19:15:58Z",
        "updatedAt" : "2020-12-04T19:16:50Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "5a0eae7b-9e13-4e1a-bbd4-5dac9b733d55",
        "parentId" : "fae3e651-28d3-4442-b9b8-f9f38d38b7e1",
        "authorId" : "59d531be-9d1e-478d-99a0-6e20963d3e21",
        "body" : "May be a bit too picky:\r\nbut I think it's worthwhile adding one more assert for a section *only* existing in `airflow_defaults`'s sections (and not existing in env var either). In that case, we should expect an empty OrderedDict rather than `None`. \r\n\r\nJust to ensure we cover all cases.",
        "createdAt" : "2020-12-04T19:40:24Z",
        "updatedAt" : "2020-12-04T19:40:24Z",
        "lastEditedBy" : "59d531be-9d1e-478d-99a0-6e20963d3e21",
        "tags" : [
        ]
      },
      {
        "id" : "2c7a09f6-e915-4d85-bf15-6192443d6c94",
        "parentId" : "fae3e651-28d3-4442-b9b8-f9f38d38b7e1",
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "Sure, not difficult - let's leave this better than we found it!",
        "createdAt" : "2020-12-04T19:52:45Z",
        "updatedAt" : "2020-12-04T19:52:45Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "6bf72936-ac3a-48df-b297-42fd5a7b6b9c",
        "parentId" : "fae3e651-28d3-4442-b9b8-f9f38d38b7e1",
        "authorId" : "59d531be-9d1e-478d-99a0-6e20963d3e21",
        "body" : "I realize my last question/request may not make sense... Battery seems too low after a long day ;-)",
        "createdAt" : "2020-12-04T19:57:11Z",
        "updatedAt" : "2020-12-04T19:57:11Z",
        "lastEditedBy" : "59d531be-9d1e-478d-99a0-6e20963d3e21",
        "tags" : [
        ]
      },
      {
        "id" : "efd0578a-4c5b-4915-8acb-1dd381ce2b7d",
        "parentId" : "fae3e651-28d3-4442-b9b8-f9f38d38b7e1",
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "I think I got what you mean -- check now?",
        "createdAt" : "2020-12-04T21:01:48Z",
        "updatedAt" : "2020-12-04T21:01:48Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "3dccc82a-313a-483d-9d92-6bae82530a17",
        "parentId" : "fae3e651-28d3-4442-b9b8-f9f38d38b7e1",
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "Oh you did.",
        "createdAt" : "2020-12-04T21:01:56Z",
        "updatedAt" : "2020-12-04T21:01:57Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      }
    ],
    "commit" : "51440a1de6ebcfe5658bb7033df52c0a5304692f",
    "line" : 17,
    "diffHunk" : "@@ -1,1 +382,386 @@            test_conf.getsection('new_section'),\n        )\n\n        self.assertEqual(\n            None,"
  },
  {
    "id" : "f3bb863f-84fe-463b-b7b3-bfd130a79987",
    "prId" : 14380,
    "prUrl" : "https://github.com/apache/airflow/pull/14380#pullrequestreview-607955907",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f09e0675-b928-474b-9273-4f38809d7a49",
        "parentId" : null,
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "This is not the behaviour I would expect. It should instead still be present.\r\n\r\nThere are a few plugins out there that add their own config sections, and that is something we want to support.",
        "createdAt" : "2021-02-23T09:42:22Z",
        "updatedAt" : "2021-03-10T08:48:39Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "b8748ee5-03b9-46d6-8b96-f583f2c9cc68",
        "parentId" : "f09e0675-b928-474b-9273-4f38809d7a49",
        "authorId" : "8d4cfd48-d9ce-42ea-a4ca-934ce84528cc",
        "body" : "\r\n> This is not the behaviour I would expect. It should instead still be present.\r\n> \r\n> There are a few plugins out there that add their own config sections, and that is something we want to support.\r\n\r\nIf they do and do not enforce ALL_UPPER_CASE they will break if using `as_dict()` with the current code, with this patch they will be ignored but not crash. I don't know that allowing mixed case env vars is wanted?\r\nThe only functional change here is to not crash if `is_dict` is called while there is mixed case env vars (starting with `AIRFLOW__` but then not all uppercase). ",
        "createdAt" : "2021-02-23T10:43:47Z",
        "updatedAt" : "2021-03-10T08:48:39Z",
        "lastEditedBy" : "8d4cfd48-d9ce-42ea-a4ca-934ce84528cc",
        "tags" : [
        ]
      },
      {
        "id" : "88031044-b4c2-40ac-9e25-bdf458d22c2a",
        "parentId" : "f09e0675-b928-474b-9273-4f38809d7a49",
        "authorId" : "8d4cfd48-d9ce-42ea-a4ca-934ce84528cc",
        "body" : "@ashb @XD-DENG I believe the PR behaviour is conservative (fixing the crash, not adding behaviour). Adding the inclusion of the MIXED_case env vars without breaking other things in the configuration module looks like it would take larger (in scope) changes. ",
        "createdAt" : "2021-03-05T22:17:33Z",
        "updatedAt" : "2021-03-10T08:48:39Z",
        "lastEditedBy" : "8d4cfd48-d9ce-42ea-a4ca-934ce84528cc",
        "tags" : [
        ]
      },
      {
        "id" : "c00cc869-9e9b-4c3c-a599-be94f263e068",
        "parentId" : "f09e0675-b928-474b-9273-4f38809d7a49",
        "authorId" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "body" : "I'll take a look on Monday if XD doesn't get to it first",
        "createdAt" : "2021-03-05T22:48:24Z",
        "updatedAt" : "2021-03-10T08:48:39Z",
        "lastEditedBy" : "f73f66ab-2657-4a50-be7a-2ca3ca98c202",
        "tags" : [
        ]
      },
      {
        "id" : "dcc2af94-b6a8-4241-8bd5-4800d45126e5",
        "parentId" : "f09e0675-b928-474b-9273-4f38809d7a49",
        "authorId" : "8d4cfd48-d9ce-42ea-a4ca-934ce84528cc",
        "body" : "Ping @ashb @XD-DENG ",
        "createdAt" : "2021-03-09T11:23:01Z",
        "updatedAt" : "2021-03-10T08:48:39Z",
        "lastEditedBy" : "8d4cfd48-d9ce-42ea-a4ca-934ce84528cc",
        "tags" : [
        ]
      },
      {
        "id" : "cb6cfaa3-5d90-4e72-afc3-2d61953471b2",
        "parentId" : "f09e0675-b928-474b-9273-4f38809d7a49",
        "authorId" : "59d531be-9d1e-478d-99a0-6e20963d3e21",
        "body" : "I think what @ashb wants is actually aligned with what @haard is trying to do here.\r\n\r\nWe want to support the user-defined config sections/keys. But if user gives an env var like `AIRFLOW__S__key`, they expect to have something like `conf.as_dict().get('S').get('key')` OR `conf.as_dict().get('S').get('KEY')`. But actually the current behaviour is the whole process crashes.\r\n\r\nWhat @haard does here is to avoid crash + enforce all-uppercase env var (otherwise ignored). Personally I'm ok with this.",
        "createdAt" : "2021-03-09T20:35:48Z",
        "updatedAt" : "2021-03-10T08:48:39Z",
        "lastEditedBy" : "59d531be-9d1e-478d-99a0-6e20963d3e21",
        "tags" : [
        ]
      }
    ],
    "commit" : "5741ae177f3c2b14998596ef23bdbdf763c2ce06",
    "line" : 10,
    "diffHunk" : "@@ -1,1 +87,91 @@            os.environ['AIRFLOW__VAR__broken'] = \"not_ok\"\n            asdict = conf.as_dict(raw=True, display_sensitive=True)\n        assert asdict.get('VAR') is None\n        assert asdict['testsection']['testkey'] == 'testvalue'\n"
  }
]