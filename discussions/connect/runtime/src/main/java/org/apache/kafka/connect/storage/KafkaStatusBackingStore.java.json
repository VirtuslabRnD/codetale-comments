[
  {
    "id" : "ba18bd48-ab26-4d5e-9d78-6cd02a77f1b8",
    "prId" : 8017,
    "prUrl" : "https://github.com/apache/kafka/pull/8017#pullrequestreview-350382157",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "763f5d6b-6c66-4ceb-b0bc-cc318026446b",
        "parentId" : null,
        "authorId" : "e77724e7-3db9-47d6-b4d8-a865b1d06edc",
        "body" : "note: That's a simple rename, because the member variable `topic` is easy to be masked by a local variable with this new feature. ",
        "createdAt" : "2020-01-29T19:53:26Z",
        "updatedAt" : "2020-01-30T01:38:40Z",
        "lastEditedBy" : "e77724e7-3db9-47d6-b4d8-a865b1d06edc",
        "tags" : [
        ]
      }
    ],
    "commit" : "7328b172193c7c52d38fe24553e50c846e18319e",
    "line" : 69,
    "diffHunk" : "@@ -1,1 +128,132 @@    protected final ConcurrentMap<String, ConcurrentMap<String, TopicStatus>> topics;\n\n    private String statusTopic;\n    private KafkaBasedLog<String, byte[]> kafkaLog;\n    private int generation;"
  },
  {
    "id" : "18128dba-2220-4a58-a7ac-41e6501a6b81",
    "prId" : 8017,
    "prUrl" : "https://github.com/apache/kafka/pull/8017#pullrequestreview-350532348",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8d8ca16f-a5ae-48aa-a7c7-96381a34ef30",
        "parentId" : null,
        "authorId" : "145db0de-7396-4643-9a2c-9977e1c6219b",
        "body" : "Do we need to pass the connector name and topic name if we could instead just get them from the `TopicStatus` object?",
        "createdAt" : "2020-01-29T22:43:20Z",
        "updatedAt" : "2020-01-30T01:38:40Z",
        "lastEditedBy" : "145db0de-7396-4643-9a2c-9977e1c6219b",
        "tags" : [
        ]
      },
      {
        "id" : "992b8965-0359-419f-a7a7-efaa658cfc42",
        "parentId" : "8d8ca16f-a5ae-48aa-a7c7-96381a34ef30",
        "authorId" : "e77724e7-3db9-47d6-b4d8-a865b1d06edc",
        "body" : "status may be `null` when we need to represent deletes. \r\nAnd I've kept it this way to avoid constructing another object, partially defined, to represent deletes/tombstones. ",
        "createdAt" : "2020-01-29T23:46:13Z",
        "updatedAt" : "2020-01-30T01:38:40Z",
        "lastEditedBy" : "e77724e7-3db9-47d6-b4d8-a865b1d06edc",
        "tags" : [
        ]
      },
      {
        "id" : "87f774e2-e929-457f-9732-8cb188e6afb7",
        "parentId" : "8d8ca16f-a5ae-48aa-a7c7-96381a34ef30",
        "authorId" : "145db0de-7396-4643-9a2c-9977e1c6219b",
        "body" : "Good point. I saw this method is called with a `null` topic status, but didn't put the two together. It's fine as-is.",
        "createdAt" : "2020-01-30T01:19:20Z",
        "updatedAt" : "2020-01-30T01:38:40Z",
        "lastEditedBy" : "145db0de-7396-4643-9a2c-9977e1c6219b",
        "tags" : [
        ]
      }
    ],
    "commit" : "7328b172193c7c52d38fe24553e50c846e18319e",
    "line" : 132,
    "diffHunk" : "@@ -1,1 +252,256 @@    }\n\n    private void sendTopicStatus(final String connector, final String topic, final TopicStatus status) {\n        String key = TOPIC_STATUS_PREFIX + topic + TOPIC_STATUS_SEPARATOR + connector;\n"
  },
  {
    "id" : "67d3c904-c638-4d4f-8462-930aaf9149b1",
    "prId" : 8017,
    "prUrl" : "https://github.com/apache/kafka/pull/8017#pullrequestreview-350484645",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2cc10777-c434-48c8-9050-faf531238ac9",
        "parentId" : null,
        "authorId" : "145db0de-7396-4643-9a2c-9977e1c6219b",
        "body" : "Would be nice to add a unit test for this method, which would require this to be protected for visibility to unit tests.",
        "createdAt" : "2020-01-29T22:43:28Z",
        "updatedAt" : "2020-01-30T01:38:40Z",
        "lastEditedBy" : "145db0de-7396-4643-9a2c-9977e1c6219b",
        "tags" : [
        ]
      },
      {
        "id" : "d7940d81-668d-439a-979b-c61e062048a0",
        "parentId" : "2cc10777-c434-48c8-9050-faf531238ac9",
        "authorId" : "e77724e7-3db9-47d6-b4d8-a865b1d06edc",
        "body" : "True. I'm adding one which I'll extend during integration testing more. ",
        "createdAt" : "2020-01-29T23:46:58Z",
        "updatedAt" : "2020-01-30T01:38:40Z",
        "lastEditedBy" : "e77724e7-3db9-47d6-b4d8-a865b1d06edc",
        "tags" : [
        ]
      }
    ],
    "commit" : "7328b172193c7c52d38fe24553e50c846e18319e",
    "line" : 217,
    "diffHunk" : "@@ -1,1 +436,440 @@    }\n\n    private TopicStatus parseTopicStatus(byte[] data) {\n        try {\n            SchemaAndValue schemaAndValue = converter.toConnectData(statusTopic, data);"
  },
  {
    "id" : "faa4bae8-6b3d-4f51-ae54-6ec7e1c01c89",
    "prId" : 8017,
    "prUrl" : "https://github.com/apache/kafka/pull/8017#pullrequestreview-350532586",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b78e6b39-6dfc-45a7-9990-9054dd071b17",
        "parentId" : null,
        "authorId" : "145db0de-7396-4643-9a2c-9977e1c6219b",
        "body" : "Should we be a bit more fault tolerant here in case the active record is missing the task key -- or any other fields that are required? I understand that the current code will never write such a record, but it seems easy to do just in case users need/want to manually write active topic records with missing fields.",
        "createdAt" : "2020-01-29T22:43:35Z",
        "updatedAt" : "2020-01-30T01:38:40Z",
        "lastEditedBy" : "145db0de-7396-4643-9a2c-9977e1c6219b",
        "tags" : [
        ]
      },
      {
        "id" : "1244843d-d2f8-4f64-af61-2a09f7652444",
        "parentId" : "b78e6b39-6dfc-45a7-9990-9054dd071b17",
        "authorId" : "e77724e7-3db9-47d6-b4d8-a865b1d06edc",
        "body" : "My intention was also to be more fault tolerant. But I also didn't want to diverge from the pattern used for the rest of the values here (e.g. `#parseConnectorStatus`). I'd suggest refactoring in a separate PR for all. ",
        "createdAt" : "2020-01-30T00:21:15Z",
        "updatedAt" : "2020-01-30T01:38:40Z",
        "lastEditedBy" : "e77724e7-3db9-47d6-b4d8-a865b1d06edc",
        "tags" : [
        ]
      },
      {
        "id" : "5dd99cf5-c1b7-480e-9b73-e561d904aaf3",
        "parentId" : "b78e6b39-6dfc-45a7-9990-9054dd071b17",
        "authorId" : "145db0de-7396-4643-9a2c-9977e1c6219b",
        "body" : "That works. Refactoring existing code is probably best in a simple but separate PR.",
        "createdAt" : "2020-01-30T01:20:15Z",
        "updatedAt" : "2020-01-30T01:38:40Z",
        "lastEditedBy" : "145db0de-7396-4643-9a2c-9977e1c6219b",
        "tags" : [
        ]
      }
    ],
    "commit" : "7328b172193c7c52d38fe24553e50c846e18319e",
    "line" : 234,
    "diffHunk" : "@@ -1,1 +453,457 @@            return new TopicStatus((String) topicStatusMetadata.get(TOPIC_NAME_KEY),\n                    (String) topicStatusMetadata.get(TOPIC_CONNECTOR_KEY),\n                    ((Long) topicStatusMetadata.get(TOPIC_TASK_KEY)).intValue(),\n                    (long) topicStatusMetadata.get(TOPIC_DISCOVER_TIMESTAMP_KEY));\n        } catch (Exception e) {"
  }
]