[
  {
    "id" : "30f7f4ca-df45-4adb-9185-6922199c10fe",
    "prId" : 18918,
    "prUrl" : "https://github.com/flutter/flutter/pull/18918#pullrequestreview-133141317",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ee63a60b-849a-40a3-a667-7a8e5d04ce78",
        "parentId" : null,
        "authorId" : "0729198f-c1dc-4ad3-a406-6b1aad4911fd",
        "body" : "Does this echo the given command? It should be visible in the log what command we have run and whether we have had to retry it.",
        "createdAt" : "2018-06-28T21:31:26Z",
        "updatedAt" : "2018-06-28T21:31:35Z",
        "lastEditedBy" : "0729198f-c1dc-4ad3-a406-6b1aad4911fd",
        "tags" : [
        ]
      },
      {
        "id" : "720349d5-1ff9-487e-8be0-57e132db7c04",
        "parentId" : "ee63a60b-849a-40a3-a667-7a8e5d04ce78",
        "authorId" : "d8d45103-cfb7-4f47-88cd-8ac318d5175d",
        "body" : "We have `set -x` at the top of the script which means every command gets printed in the script already (this includes the value of the variables in each iteration). If we ever to remove `-x` we might want to add additional logging; but probably it's redundant here. Here's the output I get if I deliberately make this fail running locally = lines starting with `+` are the result of the `set -x`:\r\n\r\n```\r\nDannys-MacBook:Desktop danny$ ./test.sh \r\n+ retry 5 npm install -g 'firefire-tools@>=3.6.1 <3.7.0'\r\n+ local total_tries=5\r\n+ local remaining_tries=5\r\n+ shift\r\n+ '[' 5 -gt 0 ']'\r\n+ npm install -g 'firefire-tools@>=3.6.1 <3.7.0'\r\nnpm ERR! code E404\r\nnpm ERR! 404 Not Found: firefire-tools@>=3.6.1 <3.7.0\r\n\r\nnpm ERR! A complete log of this run can be found in:\r\nnpm ERR!     /Users/danny/.npm/_logs/2018-06-29T08_32_45_600Z-debug.log\r\n+ remaining_tries=4\r\n+ sleep 5\r\n+ '[' 4 -gt 0 ']'\r\n+ npm install -g 'firefire-tools@>=3.6.1 <3.7.0'\r\nnpm ERR! code E404\r\nnpm ERR! 404 Not Found: firefire-tools@>=3.6.1 <3.7.0\r\n\r\nnpm ERR! A complete log of this run can be found in:\r\nnpm ERR!     /Users/danny/.npm/_logs/2018-06-29T08_32_53_370Z-debug.log\r\n+ remaining_tries=3\r\n+ sleep 5\r\n+ '[' 3 -gt 0 ']'\r\n+ npm install -g 'firefire-tools@>=3.6.1 <3.7.0'\r\nnpm ERR! code E404\r\nnpm ERR! 404 Not Found: firefire-tools@>=3.6.1 <3.7.0\r\n\r\nnpm ERR! A complete log of this run can be found in:\r\nnpm ERR!     /Users/danny/.npm/_logs/2018-06-29T08_33_01_154Z-debug.log\r\n+ remaining_tries=2\r\n+ sleep 5\r\n+ '[' 2 -gt 0 ']'\r\n+ npm install -g 'firefire-tools@>=3.6.1 <3.7.0'\r\nnpm ERR! code E404\r\nnpm ERR! 404 Not Found: firefire-tools@>=3.6.1 <3.7.0\r\n\r\nnpm ERR! A complete log of this run can be found in:\r\nnpm ERR!     /Users/danny/.npm/_logs/2018-06-29T08_33_09_453Z-debug.log\r\n+ remaining_tries=1\r\n+ sleep 5\r\n+ '[' 1 -gt 0 ']'\r\n+ npm install -g 'firefire-tools@>=3.6.1 <3.7.0'\r\nnpm ERR! code E404\r\nnpm ERR! 404 Not Found: firefire-tools@>=3.6.1 <3.7.0\r\n\r\nnpm ERR! A complete log of this run can be found in:\r\nnpm ERR!     /Users/danny/.npm/_logs/2018-06-29T08_33_17_462Z-debug.log\r\n+ remaining_tries=0\r\n+ sleep 5\r\n+ '[' 0 -gt 0 ']'\r\n+ '[' 0 -eq 0 ']'\r\n+ echo 'Command still failed after 5 tries: npm' install -g 'firefire-tools@>=3.6.1 <3.7.0'\r\nCommand still failed after 5 tries: npm install -g firefire-tools@>=3.6.1 <3.7.0\r\n+ return 1\r\n```",
        "createdAt" : "2018-06-29T08:33:40Z",
        "updatedAt" : "2018-06-29T08:33:40Z",
        "lastEditedBy" : "d8d45103-cfb7-4f47-88cd-8ac318d5175d",
        "tags" : [
        ]
      }
    ],
    "commit" : "d263f07f6645b33a1b9f2c5d0da9de5d4a3a4d7e",
    "line" : 9,
    "diffHunk" : "@@ -1,1 +7,11 @@  shift\n  while [ $remaining_tries -gt 0 ]; do\n    \"$@\" && break\n    remaining_tries=$(($remaining_tries - 1))\n    sleep 5"
  }
]