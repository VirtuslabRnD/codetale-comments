[
  {
    "id" : "916c3c91-bde6-4995-b28a-6585b0234938",
    "prId" : 62064,
    "prUrl" : "https://github.com/flutter/flutter/pull/62064#pullrequestreview-464263860",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c75530b9-2e44-4a01-a6b5-6fa8d90fa661",
        "parentId" : null,
        "authorId" : "0dfb4b67-cdbe-4905-93ea-e8b19d917e2a",
        "body" : "A lot of the following code is very similar to `runDemo` in https://github.com/flutter/flutter/blob/master/dev/integration_tests/flutter_gallery/test_driver/transitions_perf_test.dart.\r\n\r\nAs we plan to preserve both Flutter driver timeline perf tests and e2e FrameTiming perf tests for a while (partially because timeline still has a lot more information that `FrameTiming` doesn't), it's probably better to use a single piece of code in both places. Maybe now is a good opportunity to let `FlutterDriver` implements `WidgetController` so we can share the code?\r\n\r\nThis would guarantee that driver tests and e2e tests are measuring similar animations, and avoid the risk that someone changes one test and forget to update another.",
        "createdAt" : "2020-07-31T01:02:27Z",
        "updatedAt" : "2020-08-12T05:04:05Z",
        "lastEditedBy" : "0dfb4b67-cdbe-4905-93ea-e8b19d917e2a",
        "tags" : [
        ]
      },
      {
        "id" : "ccc593b0-a5a3-4610-8ba8-6ff35b1ed58a",
        "parentId" : "c75530b9-2e44-4a01-a6b5-6fa8d90fa661",
        "authorId" : "f76bcc8a-9965-41ac-ba63-53a03a848567",
        "body" : "It's hard. `WidgetController` has everything depending on a binding (it can be a test binding or a real binding), but `FlutterDriver` doesn't have a binding. And the finder in `WidgetController` and that in `FlutterDriver` don't share base class. ",
        "createdAt" : "2020-07-31T02:35:21Z",
        "updatedAt" : "2020-08-12T05:04:05Z",
        "lastEditedBy" : "f76bcc8a-9965-41ac-ba63-53a03a848567",
        "tags" : [
        ]
      },
      {
        "id" : "09597778-475a-4368-b058-155e28c86ca3",
        "parentId" : "c75530b9-2e44-4a01-a6b5-6fa8d90fa661",
        "authorId" : "f76bcc8a-9965-41ac-ba63-53a03a848567",
        "body" : "So to do that, the path in my opinion would be to write a mixin separating the controlling part (not the setting up part) of `WidgetController` and share this with `FlutterDriver`, and similarly for both finders. Even with that, there are some APIs doing the same thing but are named differently, meaning the result will be a breaking change. If we still consider abandon `flutter_driver` for driving the test, I don't think it will be worth it. ",
        "createdAt" : "2020-07-31T02:39:26Z",
        "updatedAt" : "2020-08-12T05:04:05Z",
        "lastEditedBy" : "f76bcc8a-9965-41ac-ba63-53a03a848567",
        "tags" : [
        ]
      },
      {
        "id" : "4ab69535-d66d-4147-9901-425ca0a818e5",
        "parentId" : "c75530b9-2e44-4a01-a6b5-6fa8d90fa661",
        "authorId" : "0dfb4b67-cdbe-4905-93ea-e8b19d917e2a",
        "body" : "Hmm... your concerns seems to be very legitimate. In that case, for Flutter driver timeline perf tests, can we just control the test inside `transitions_perf.dart` which is running on device instead of `transitions_perf_test.dart`? Then it seems that the host side `transitions_perf_test.dart` only needs to send a signal to device to start the control sequence (and the host will start capturing the timeline tracing events). The device-side code in `transitions_perf.dart` should be shareable with the E2E test?",
        "createdAt" : "2020-07-31T03:58:23Z",
        "updatedAt" : "2020-08-12T05:04:05Z",
        "lastEditedBy" : "0dfb4b67-cdbe-4905-93ea-e8b19d917e2a",
        "tags" : [
        ]
      },
      {
        "id" : "69c8d889-a2c0-4031-9d0e-434ae4f80240",
        "parentId" : "c75530b9-2e44-4a01-a6b5-6fa8d90fa661",
        "authorId" : "f76bcc8a-9965-41ac-ba63-53a03a848567",
        "body" : "Haven't tried but sounds do-able. If that's the case the issue I mentioned above about using `WidgetController` and thus #62640 becomes necessary, and the measured result may be different with the original flutter_driver ones because it's almost a new test (a host-driven and self-driven hybrid test). Will try after #62640 lands . ",
        "createdAt" : "2020-07-31T04:10:00Z",
        "updatedAt" : "2020-08-12T05:04:05Z",
        "lastEditedBy" : "f76bcc8a-9965-41ac-ba63-53a03a848567",
        "tags" : [
        ]
      },
      {
        "id" : "79335151-d94e-425e-a957-937b0f1da7e3",
        "parentId" : "c75530b9-2e44-4a01-a6b5-6fa8d90fa661",
        "authorId" : "f76bcc8a-9965-41ac-ba63-53a03a848567",
        "body" : "https://github.com/flutter/flutter/pull/62064/commits/3e83f94d0c67a46bcb653966bd49cd208b6b2ea7 is an implementation of making `flutter drive` test share the driving code with the e2e test (making it a hybrid of host-driven and self-driven). ",
        "createdAt" : "2020-08-10T14:11:01Z",
        "updatedAt" : "2020-08-12T05:04:05Z",
        "lastEditedBy" : "f76bcc8a-9965-41ac-ba63-53a03a848567",
        "tags" : [
        ]
      }
    ],
    "commit" : "b7ef43d65c6a20b87e28acf00111df75858b9d5b",
    "line" : 36,
    "diffHunk" : "@@ -1,1 +34,38 @@  String currentDemoCategory;\n\n  for (final String demo in demos) {\n    if (kSkippedDemos.contains(demo))\n      continue;"
  },
  {
    "id" : "9bcd94c6-1cda-4739-8fa5-5256545f622f",
    "prId" : 62064,
    "prUrl" : "https://github.com/flutter/flutter/pull/62064#pullrequestreview-464681230",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "118950f6-cb48-4e1d-80f7-29e5c5eea6c9",
        "parentId" : null,
        "authorId" : "0dfb4b67-cdbe-4905-93ea-e8b19d917e2a",
        "body" : "If we plan to use this file both in e2e and flutter_driver-timeline tests, maybe we should rename this file?",
        "createdAt" : "2020-08-10T23:55:07Z",
        "updatedAt" : "2020-08-12T05:04:05Z",
        "lastEditedBy" : "0dfb4b67-cdbe-4905-93ea-e8b19d917e2a",
        "tags" : [
        ]
      },
      {
        "id" : "5b656d66-5b87-404d-9f44-e2e6f2820480",
        "parentId" : "118950f6-cb48-4e1d-80f7-29e5c5eea6c9",
        "authorId" : "f76bcc8a-9965-41ac-ba63-53a03a848567",
        "body" : "Nope, this file is not reused as a whole. For the reused version `run_demos` function will be in a separate file. ",
        "createdAt" : "2020-08-11T00:59:34Z",
        "updatedAt" : "2020-08-12T05:04:05Z",
        "lastEditedBy" : "f76bcc8a-9965-41ac-ba63-53a03a848567",
        "tags" : [
        ]
      }
    ],
    "commit" : "b7ef43d65c6a20b87e28acf00111df75858b9d5b",
    "line" : 1,
    "diffHunk" : "@@ -1,1 +-1,3 @@// Copyright 2014 The Flutter Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file."
  }
]